<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="vibe1060" class="loom" data-theme="linen" aria-label="Celestial Loom — generative weaving">
  <style>
    /* Scoped to #vibe1060 only */
    #vibe1060 {
      --ink: #1a1a16;
      --muted: #6e6a62;
      --edge: rgba(0,0,0,0.10);
      --bg0: #f6f3ea;
      --bg1: #ffffff;
      --t1: #e06c5e;
      --t2: #5aa1a7;
      --t3: #8c83e8;
      --canvas-fade: rgba(246,243,234,0.07);
      --ring: 0 10px 30px rgba(0,0,0,0.06), inset 0 0 0 1px var(--edge);
      --radius: 22px;
      position: relative;
      overflow: hidden;
      border-radius: var(--radius);
      border: 1px solid var(--edge);
      background:
        radial-gradient(1200px 600px at -10% -10%, rgba(255,179,118,0.16), transparent 60%),
        radial-gradient(1400px 600px at 110% 10%, rgba(68,178,191,0.16), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      isolation: isolate;
    }
    /* Themes */
    #vibe1060[data-theme="linen"] {
      --ink: #1a1a16;
      --muted: #6e6a62;
      --edge: rgba(0,0,0,0.10);
      --bg0: #f6f3ea;
      --bg1: #ffffff;
      --t1: #e06c5e;
      --t2: #5aa1a7;
      --t3: #8c83e8;
      --canvas-fade: rgba(246,243,234,0.07);
    }
    #vibe1060[data-theme="mist"] {
      --ink: #0f2233;
      --muted: #556779;
      --edge: rgba(8,25,44,0.12);
      --bg0: #ebf3ff;
      --bg1: #ffffff;
      --t1: #2c78ff;
      --t2: #1bbfb3;
      --t3: #a07df3;
      --canvas-fade: rgba(235,243,255,0.06);
    }
    #vibe1060[data-theme="night"] {
      --ink: #eef5ff;
      --muted: #a7b7cc;
      --edge: rgba(255,255,255,0.12);
      --bg0: #0b0f14;
      --bg1: #0e141b;
      --t1: #5ac8ff;
      --t2: #a1f0d1;
      --t3: #b29cff;
      --canvas-fade: rgba(11,15,20,0.06);
    }

    #vibe1060 .texture {
      pointer-events: none;
      position: absolute; inset: -2px; z-index: 0;
      background:
        radial-gradient(1px 1px at 15% 20%, rgba(0,0,0,0.03) 0 1px, transparent 1px),
        radial-gradient(1px 1px at 75% 65%, rgba(0,0,0,0.02) 0 1px, transparent 1px),
        radial-gradient(1px 1px at 45% 85%, rgba(0,0,0,0.02) 0 1px, transparent 1px);
      background-size: 180px 180px, 240px 240px, 220px 220px;
      mix-blend-mode: multiply;
      opacity: 0.6;
      animation: grain1060 10s linear infinite;
    }
    @keyframes grain1060 {
      from { transform: translate3d(0,0,0); }
      to   { transform: translate3d(-2%, -3%, 0); }
    }

    #vibe1060 .wrap {
      position: relative; z-index: 1;
      display: grid; gap: 20px;
      padding: 28px;
    }

    #vibe1060 .head {
      display: flex; align-items: center; justify-content: space-between;
      gap: 14px;
    }
    #vibe1060 .brand {
      display: inline-grid; grid-auto-flow: column; gap: 10px; align-items: center;
      letter-spacing: 0.3px; font-weight: 700;
    }
    #vibe1060 .logo {
      width: 22px; height: 22px; border-radius: 6px;
      background:
        conic-gradient(from 90deg, var(--t1), var(--t2), var(--t3), var(--t1));
      box-shadow: 0 6px 14px rgba(0,0,0,0.08), inset 0 0 0 1px rgba(255,255,255,0.6);
      transform: rotate(12deg);
    }
    #vibe1060 .word {
      background: linear-gradient(90deg, var(--ink), color-mix(in srgb, var(--ink) 70%, var(--muted)));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      font-size: 15px;
    }

    #vibe1060 .controls {
      display: flex; align-items: center; gap: 10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.45));
      border: 1px solid var(--edge);
      padding: 6px 8px; border-radius: 999px;
      backdrop-filter: blur(8px) saturate(140%);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }
    #vibe1060[data-theme="night"] .controls {
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
    }

    #vibe1060 .swatches { display: inline-flex; gap: 6px; }
    #vibe1060 .sw {
      appearance: none; border: 0; width: 22px; height: 22px; border-radius: 999px; cursor: pointer;
      box-shadow: inset 0 0 0 1px var(--edge), 0 1px 0 rgba(255,255,255,0.6);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    #vibe1060 .sw:hover { transform: translateY(-1px) scale(1.06); }
    #vibe1060 .sw[aria-pressed="true"] { box-shadow: inset 0 0 0 2px var(--ink), 0 2px 10px rgba(0,0,0,0.09); }
    #vibe1060 .sw[data-theme="linen"] { background: conic-gradient(from 0deg, #e06c5e, #5aa1a7, #8c83e8, #e06c5e); }
    #vibe1060 .sw[data-theme="mist"]  { background: conic-gradient(from 0deg, #2c78ff, #1bbfb3, #a07df3, #2c78ff); }
    #vibe1060 .sw[data-theme="night"] { background: conic-gradient(from 0deg, #5ac8ff, #a1f0d1, #b29cff, #5ac8ff); }

    #vibe1060 .pause {
      appearance: none; border: 0; cursor: pointer;
      padding: 8px 12px; border-radius: 999px;
      background: linear-gradient(180deg, rgba(0,0,0,0.08), rgba(0,0,0,0.02));
      color: var(--ink); font-size: 12px; letter-spacing: 0.2px; font-weight: 600;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    #vibe1060[data-theme="night"] .pause { color: #e9f2ff; background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.05)); }
    #vibe1060 .pause:hover { transform: translateY(-1px); }

    #vibe1060 .hero { display: grid; gap: 6px; }
    #vibe1060 .hero h1 {
      margin: 0; font-weight: 800; letter-spacing: -0.02em;
      font-size: clamp(22px, 4.2vw, 36px);
      line-height: 1.06;
      background: linear-gradient(90deg, var(--ink), color-mix(in srgb, var(--ink) 65%, var(--muted)));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    #vibe1060 .hero p {
      margin: 0; color: var(--muted);
      font-size: 13px;
    }

    #vibe1060 .panel {
      display: inline-grid; grid-auto-flow: column; gap: 14px; align-items: center;
      justify-content: start;
      padding: 8px 10px; border-radius: 12px;
      border: 1px dashed var(--edge);
      background: linear-gradient(180deg, rgba(255,255,255,0.5), rgba(255,255,255,0.35));
    }
    #vibe1060[data-theme="night"] .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
    }
    #vibe1060 .slider {
      display: grid; grid-template-columns: auto 1fr; align-items: center; gap: 10px;
      font-size: 12px; color: var(--muted);
    }
    #vibe1060 input[type="range"] {
      appearance: none; width: 160px; height: 6px; border-radius: 999px;
      background: linear-gradient(90deg, var(--t1), var(--t2), var(--t3));
      outline: none; border: 1px solid var(--edge);
    }
    #vibe1060 input[type="range"]::-webkit-slider-thumb {
      appearance: none; width: 14px; height: 14px; border-radius: 50%;
      background: #fff; border: 1px solid var(--edge);
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }
    #vibe1060[data-theme="night"] input[type="range"]::-webkit-slider-thumb { background: #0f141b; border-color: rgba(255,255,255,0.3); }

    #vibe1060 .stage {
      position: relative;
      border-radius: 18px;
      overflow: hidden;
      background: linear-gradient(180deg, color-mix(in srgb, var(--bg1) 88%, #fff), var(--bg0));
      border: 1px solid var(--edge);
      box-shadow: var(--ring);
      transform-style: preserve-3d;
      transition: transform 0.2s ease;
    }
    #vibe1060 .stage:hover { transform: translateY(-2px); }
    #vibe1060 canvas {
      display: block; width: 100%; height: 340px;
    }

    #vibe1060 .foot {
      display: flex; align-items: center; justify-content: space-between;
      gap: 10px;
      padding-top: 6px; margin-top: 2px;
      border-top: 1px dashed var(--edge);
    }
    #vibe1060 .note { color: var(--muted); font-size: 12px; }

    #vibe1060 #last-updated {
      font-size: 12px; white-space: nowrap;
      color: color-mix(in srgb, var(--ink) 85%, var(--muted));
      background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.55));
      border: 1px solid var(--edge);
      padding: 6px 10px; border-radius: 999px; backdrop-filter: blur(6px);
    }
    #vibe1060[data-theme="night"] #last-updated {
      background: linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.06));
      color: #e9f2ff;
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #vibe1060 .texture { animation: none !important; }
      #vibe1060 .stage { transition: none !important; }
    }

    @media (max-width: 560px) {
      #vibe1060 .controls { display: none; }
      #vibe1060 .panel { grid-auto-flow: row; }
      #vibe1060 input[type="range"] { width: 120px; }
      #vibe1060 canvas { height: 300px; }
    }
  </style>

  <div class="texture" aria-hidden="true"></div>

  <div class="wrap">
    <div class="head">
      <div class="brand" aria-label="Weave brand">
        <span class="logo" aria-hidden="true"></span>
        <span class="word">WEAVE</span>
      </div>
      <div class="controls" aria-label="Display controls">
        <div class="swatches" role="tablist" aria-label="Palette">
          <button class="sw" data-theme="linen" aria-pressed="true" title="Linen"></button>
          <button class="sw" data-theme="mist" aria-pressed="false" title="Mist"></button>
          <button class="sw" data-theme="night" aria-pressed="false" title="Night"></button>
        </div>
        <button class="pause" type="button" aria-pressed="false" title="Pause (Space)">Pause</button>
      </div>
    </div>

    <section class="hero">
      <h1>Celestial Loom</h1>
      <p>Threads of motion weave in light. Nudge them with your cursor, tune the density, find a rhythm.</p>
    </section>

    <div class="panel" aria-label="Weave parameters">
      <label class="slider" for="density">
        <span>Density</span>
        <input id="density" type="range" min="60" max="600" value="260" />
      </label>
      <label class="slider" for="tempo">
        <span>Tempo</span>
        <input id="tempo" type="range" min="60" max="260" value="140" />
      </label>
    </div>

    <div class="stage" id="stage" aria-live="polite">
      <canvas id="weave" aria-label="Generative threads canvas"></canvas>
    </div>

    <div class="foot">
      <div class="note">Iteration 1060 — woven daylight, responsive to touch.</div>
      <span id="last-updated">Last updated: 2025-12-04 04:23:00 EST</span>
    </div>
  </div>

  <script>
    (function () {
      const root = document.getElementById('vibe1060');
      const canvas = root.querySelector('#weave');
      const stage = root.querySelector('#stage');
      const ctx = canvas.getContext('2d', { alpha: true });
      const swatches = root.querySelectorAll('.sw');
      const pauseBtn = root.querySelector('.pause');
      const densityInput = root.querySelector('#density');
      const tempoInput = root.querySelector('#tempo');
      const lastUpdatedEl = root.querySelector('#last-updated');

      // Timestamp
      try {
        const now = new Date();
        const fmt = new Intl.DateTimeFormat([], {
          year: 'numeric', month: 'short', day: '2-digit',
          hour: '2-digit', minute: '2-digit', second: '2-digit'
        });
        lastUpdatedEl.textContent = 'Updated ' + fmt.format(now);
      } catch {
        lastUpdatedEl.textContent = 'Updated ' + (new Date()).toLocaleString();
      }

      // Canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      const resize = () => {
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.max(1, Math.floor(rect.width * dpr));
        canvas.height = Math.max(1, Math.floor(rect.height * dpr));
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0); // scale drawings by DPR
        primeBackground(true);
      };
      const getCSS = (name) => getComputedStyle(root).getPropertyValue(name).trim();

      // Palette
      function currentThreadColors() {
        return [getCSS('--t1'), getCSS('--t2'), getCSS('--t3')];
      }
      function fadeColor() { return getCSS('--canvas-fade'); }

      // Background prime
      function primeBackground(hard) {
        const w = canvas.width / dpr, h = canvas.height / dpr;
        if (hard) { ctx.clearRect(0, 0, w, h); }
        // soft wash to start
        const g = ctx.createLinearGradient(0, 0, 0, h);
        g.addColorStop(0, getCSS('--bg1'));
        g.addColorStop(1, getCSS('--bg0'));
        ctx.fillStyle = g;
        ctx.fillRect(0, 0, w, h);
      }

      // Threads
      let threads = [];
      let desiredCount = +densityInput.value | 0;
      let time = 0;
      let speed = (+tempoInput.value) / 100; // ~0.6..2.6
      let paused = false;

      const rnd = (n=1) => Math.random() * n;
      function resetThreads() {
        threads.length = 0;
        const cols = currentThreadColors();
        for (let i = 0; i < desiredCount; i++) {
          const hue = cols[i % cols.length];
          threads.push({
            x: rnd(canvas.width / dpr),
            y: rnd(canvas.height / dpr),
            vx: 0, vy: 0,
            c: hue,
            w: 0.6 + (i % 5) * 0.08 + rnd(0.15)
          });
        }
      }

      // Vector field
      function field(x, y, t) {
        // Normalize to [0,1]
        const w = canvas.width / dpr, h = canvas.height / dpr;
        const nx = x / w, ny = y / h;

        // Flow angles driven by smooth trigs
        const a = Math.sin((ny * 6.283 + t * 0.00045) * 1.0);
        const b = Math.cos((nx * 6.283 - t * 0.00035) * 1.2);
        const c = Math.sin(((nx + ny) * 3.1415 + t * 0.00025) * 2.0);

        const ang = (a + b + c) * Math.PI; // -π..π-ish
        return { x: Math.cos(ang), y: Math.sin(ang) };
      }

      // Pointer influence
      let pointer = { x: 0, y: 0, active: false };
      function pointerVec(px, py, x, y) {
        const dx = px - x, dy = py - y;
        const d2 = dx*dx + dy*dy;
        if (d2 === 0) return { x: 0, y: 0 };
        const d = Math.sqrt(d2);
        const falloff = Math.max(0, 1 - d / 180); // radius of influence ~180px
        return { x: (dx / d) * falloff, y: (dy / d) * falloff };
      }

      // Draw
      function step(ts) {
        if (paused) return;
        time = ts * speed;

        const w = canvas.width / dpr, h = canvas.height / dpr;

        // Persistence fade
        ctx.fillStyle = fadeColor();
        ctx.fillRect(0, 0, w, h);

        ctx.globalCompositeOperation = 'lighter';
        for (let i = 0; i < threads.length; i++) {
          const t = threads[i];

          const f = field(t.x, t.y, time);
          let vx = f.x, vy = f.y;

          if (pointer.active) {
            const p = pointerVec(pointer.x, pointer.y, t.x, t.y);
            vx += p.x * 1.6;
            vy += p.y * 1.6;
          }

          // Integrate
          const mag = Math.hypot(vx, vy) || 1;
          vx /= mag; vy /= mag;

          const s = 0.8 + Math.sin((i * 13.37) + time * 0.001) * 0.3; // slight per-thread variance
          const stepLen = 0.8 + s * 0.6;

          const nx = t.x + vx * stepLen;
          const ny = t.y + vy * stepLen;

          // Draw segment
          ctx.beginPath();
          ctx.moveTo(t.x, t.y);
          ctx.lineTo(nx, ny);
          ctx.lineWidth = t.w;
          ctx.strokeStyle = t.c;
          ctx.stroke();

          // Wrap around edges
          t.x = (nx + w) % w;
          t.y = (ny + h) % h;
        }
        ctx.globalCompositeOperation = 'source-over';

        raf = requestAnimationFrame(step);
      }

      // Controls
      swatches.forEach(btn => {
        btn.addEventListener('click', () => {
          swatches.forEach(b => b.setAttribute('aria-pressed', 'false'));
          btn.setAttribute('aria-pressed', 'true');
          root.setAttribute('data-theme', btn.getAttribute('data-theme'));
          // Reprime and recolor
          primeBackground(true);
          resetThreads();
        }, { passive: true });
      });

      pauseBtn.addEventListener('click', () => togglePause(), { passive: true });

      function togglePause(force) {
        if (typeof force === 'boolean') paused = force;
        else paused = !paused;
        pauseBtn.setAttribute('aria-pressed', String(paused));
        pauseBtn.textContent = paused ? 'Resume' : 'Pause';
        root.classList.toggle('paused', paused);
        if (!paused) {
          primeBackground(false);
          raf = requestAnimationFrame(step);
        } else {
          cancelAnimationFrame(raf);
        }
      }

      densityInput.addEventListener('input', () => {
        desiredCount = +densityInput.value | 0;
        resetThreads();
      }, { passive: true });

      tempoInput.addEventListener('input', () => {
        speed = (+tempoInput.value) / 100;
      }, { passive: true });

      // Pointer events
      const updatePointer = (e) => {
        const r = canvas.getBoundingClientRect();
        pointer.x = (e.clientX - r.left);
        pointer.y = (e.clientY - r.top);
        pointer.active = true;
      };
      stage.addEventListener('pointermove', updatePointer);
      stage.addEventListener('pointerdown', updatePointer);
      stage.addEventListener('pointerleave', () => { pointer.active = false; });

      // Keyboard
      root.tabIndex = 0;
      root.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
          e.preventDefault();
          togglePause();
        }
      });

      // Resize handling
      const ro = new ResizeObserver(resize);
      ro.observe(canvas);
      window.addEventListener('orientationchange', () => { setTimeout(resize, 50); });

      // Reduced motion preference
      const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
      const applyRM = () => {
        if (mq.matches) togglePause(true);
      };
      mq.addEventListener ? mq.addEventListener('change', applyRM) : mq.addListener(applyRM);

      // Init
      resize();
      resetThreads();
      primeBackground(true);
      let raf = requestAnimationFrame(step);
      applyRM();
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


