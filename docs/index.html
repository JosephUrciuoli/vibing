<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="loom" role="region" aria-label="Aural Loom" data-theme="day">
  <style>
    .loom{
      --ink: #0e1220;
      --paper: #ffffff;
      --muted: color-mix(in oklab, var(--ink) 60%, transparent);
      --line: color-mix(in oklab, var(--ink) 14%, transparent);
      --a: hsl(206 95% 54%);
      --b: hsl(296 86% 62%);
      --glass: color-mix(in oklab, var(--paper) 80%, transparent);
      --grid: color-mix(in oklab, var(--ink) 12%, transparent);

      position: relative;
      border-radius: 28px;
      padding: clamp(14px, 3.2vw, 28px);
      color: var(--ink);
      background:
        radial-gradient(1200px 800px at var(--mx,65%) var(--my,35%), color-mix(in oklab, var(--a) 14%, transparent), transparent 60%),
        linear-gradient(180deg, #f8fbff, #eef3f9 55%, #e9eff7);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.7), 0 50px 120px rgba(14,18,32,.18);
      overflow: hidden; isolation: isolate;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
    }
    .loom[data-theme="night"]{
      --ink: #e8f0ff;
      --paper: #0a0f1a;
      --muted: color-mix(in oklab, var(--ink) 75%, transparent);
      --glass: color-mix(in oklab, #0b1324 80%, transparent);
      --grid: color-mix(in oklab, #ffffff 12%, transparent);
      background:
        radial-gradient(1200px 800px at var(--mx,35%) var(--my,22%), color-mix(in oklab, var(--b) 18%, transparent), transparent 60%),
        linear-gradient(180deg, #0a0f1a, #0d1628 55%, #0b1324);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04), 0 60px 160px rgba(0,0,0,.6);
    }
    .loom::before{
      content:"";
      position:absolute; inset:-20%;
      background:
        radial-gradient(1000px 800px at 15% 0%, color-mix(in oklab, var(--a) 10%, transparent), transparent 60%),
        radial-gradient(1200px 900px at 120% 10%, color-mix(in oklab, var(--b) 10%, transparent), transparent 60%);
      filter: blur(30px) saturate(120%); opacity:.5; pointer-events:none; z-index:0;
    }
    .loom::after{
      content:"";
      position:absolute; inset:-1px; pointer-events:none; z-index:1;
      background:
        repeating-linear-gradient(0deg, var(--grid) 0 1px, transparent 1px 48px),
        repeating-linear-gradient(90deg, var(--grid) 0 1px, transparent 1px 48px);
      mask: radial-gradient(140% 130% at 80% -10%, black, transparent 60%);
      opacity:.35;
    }

    /* Top bar */
    .loom .bar{
      position:relative; z-index:3;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:10px;
    }
    .loom .brand{
      display:inline-flex; align-items:center; gap:10px; color: var(--muted);
      font-weight:900; letter-spacing:.4px; text-transform:uppercase; font-size:12px;
    }
    .loom .spark{
      width:18px; height:18px; border-radius:8px;
      background: radial-gradient(circle at 35% 35%, var(--b), var(--a));
      box-shadow: 0 0 0 2px color-mix(in oklab, var(--a) 30%, transparent), 0 0 18px color-mix(in oklab, var(--b) 26%, transparent);
    }
    .loom .toggle{
      justify-self:center;
      display:inline-flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px;
      border:1px solid var(--line); background: var(--glass); backdrop-filter: blur(10px) saturate(120%);
      font-size:12px; color: var(--muted); cursor: pointer; user-select:none;
      box-shadow: 0 6px 18px rgba(0,0,0,.06);
    }
    .loom .ctrls{
      justify-self:end; display:flex; gap:8px; align-items:center;
      padding:6px; border-radius:999px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }
    .loom .btn{
      appearance:none; border:0; cursor:pointer;
      padding:10px 12px; border-radius:12px; font-weight:800; letter-spacing:.3px; font-size:12px;
      color:#0b0f16; background: linear-gradient(135deg, var(--a), var(--b));
      box-shadow: 0 14px 30px color-mix(in oklab, var(--a) 30%, transparent);
      transition: transform .14s ease, filter .18s ease;
    }
    .loom[data-theme="night"] .btn{ color:#0b0f16; }
    .loom .ghost{
      appearance:none; background:transparent; border:1px solid var(--line); color:var(--ink);
      padding:10px 12px; border-radius:12px; font-weight:800; font-size:12px; letter-spacing:.3px; cursor:pointer;
      transition: background .18s ease, transform .14s ease;
    }
    .loom .btn:hover, .loom .ghost:hover{ transform: translateY(-1px) scale(1.01); }

    /* Stage */
    .loom .stage{
      position:relative; z-index:2;
      margin-top: clamp(16px, 4vw, 28px);
      border-radius: 24px; border:1px solid var(--line); overflow:hidden;
      min-height: clamp(420px, 56vw, 720px);
      background: linear-gradient(180deg, color-mix(in oklab, var(--paper) 86%, transparent), color-mix(in oklab, var(--paper) 68%, transparent));
      perspective: 900px;
    }
    .loom .weave{
      position:absolute; inset:0; width:100%; height:100%;
      display:block; filter: saturate(115%) contrast(102%);
    }

    /* Lens */
    .loom .lens{
      position:absolute; inset: clamp(14px, 3vw, 28px);
      border-radius: 28px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(14px) saturate(130%);
      box-shadow: 0 30px 70px rgba(0,0,0,.12);
      display:grid; place-items:center;
      transform-style: preserve-3d; will-change: transform;
    }
    .loom h1{
      margin:0;
      font-size: clamp(42px, 9vw, 112px);
      line-height:.88; letter-spacing:-.02em; text-align:center;
      background: linear-gradient(180deg, var(--ink), color-mix(in oklab, var(--ink) 70%, var(--b)));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-wrap: balance;
    }
    .loom .lead{
      margin:8px 0 12px; color: var(--muted);
      font-size: clamp(14px, 2.2vw, 20px); text-align:center;
    }
    .loom .cta{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }

    /* Compass ring */
    .loom .compass{
      position:absolute; inset:auto; width:min(56vmin, 520px); height:min(56vmin, 520px);
      top: 50%; left: 50%; translate: -50% -50%;
      border-radius:50%;
      background:
        conic-gradient(from var(--spin,0deg), color-mix(in oklab, var(--a) 60%, transparent), transparent 20%, color-mix(in oklab, var(--b) 55%, transparent) 45%, transparent 60%);
      mask: radial-gradient(circle, transparent 56%, black 57% 63%, transparent 64%),
            radial-gradient(circle, black 0 55%, transparent 56%);
      opacity:.6; pointer-events:none; z-index:4;
      filter: blur(0.3px);
    }

    /* Control dock */
    .loom .dock{
      position:absolute; left: clamp(12px, 3vw, 28px); bottom: clamp(12px, 3vw, 28px);
      display:grid; gap:10px; z-index:5; justify-items:start;
    }
    .loom .glass{
      display:flex; align-items:center; gap:10px; padding:10px; border-radius:16px;
      border:1px solid var(--line); background: var(--glass); backdrop-filter: blur(10px) saturate(120%);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }
    .loom .range{ --track: color-mix(in oklab, var(--ink) 18%, transparent); --fill: linear-gradient(90deg, var(--a), var(--b)); }
    .loom .range input{ -webkit-appearance:none; appearance:none; width: 220px; height: 28px; background: transparent; cursor: pointer; }
    .loom .range input::-webkit-slider-runnable-track{ height:6px; border-radius:999px; background: var(--track); border:1px solid var(--line); }
    .loom .range input::-moz-range-track{ height:6px; border-radius:999px; background: var(--track); border:1px solid var(--line); }
    .loom .range input::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%; margin-top:-6px; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--a) 28%, transparent);
    }
    .loom .range input::-moz-range-thumb{
      width:18px; height:18px; border-radius:50%; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--a) 28%, transparent);
    }
    .loom .val{
      font-variant-numeric: tabular-nums; font-weight:800; font-size:12px; color:var(--muted);
      padding:4px 8px; border-radius:999px; border:1px solid var(--line);
      background: color-mix(in oklab, var(--paper) 70%, transparent);
    }
    .loom .palettes{ display:flex; gap:8px; flex-wrap:wrap; }
    .loom .swatch{
      width:26px; height:26px; border-radius:8px; border:1px solid var(--line); cursor:pointer; position:relative;
      box-shadow: inset 0 4px 10px rgba(0,0,0,.08);
    }
    .loom .swatch[aria-checked="true"]::after{
      content:""; position:absolute; inset:-3px; border-radius:10px;
      border: 2px solid color-mix(in oklab, var(--a) 42%, var(--b));
      box-shadow: 0 0 0 2px rgba(0,0,0,.04);
    }

    /* Footer */
    .loom .foot{
      position:relative; z-index:2; margin-top: 14px;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; color:var(--muted); font-size:12px;
    }
    .loom .foot .stamp{
      justify-self:center; display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius: 999px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(6px);
    }

    /* Motion control class */
    .loom.alive .compass{ animation: spin 22s linear infinite; }
    .loom:not(.alive) .compass{ animation: none; }
    @keyframes spin{ to{ --spin: 360deg; } }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .loom .compass{ animation: none !important; }
    }

    /* Responsive */
    @media (max-width: 940px){
      .loom .dock{ right: clamp(12px, 3vw, 28px); left: auto; }
      .loom .lens{ inset: clamp(8px, 2.8vw, 18px); }
    }
  </style>

  <div class="bar">
    <div class="brand"><span class="spark" aria-hidden="true"></span> Aural Loom</div>
    <div class="toggle" role="button" tabindex="0" aria-pressed="false" title="Toggle day/night">Tap to switch theme</div>
    <div class="ctrls" aria-label="Controls">
      <button class="btn play" aria-pressed="true" title="Play/Pause">Pause</button>
      <button class="ghost theme" title="Day/Night">Night</button>
    </div>
  </div>

  <div class="stage" aria-live="polite">
    <canvas class="weave" aria-hidden="true"></canvas>

    <div class="lens" aria-label="Hero lens">
      <div class="compass" aria-hidden="true"></div>
      <div>
        <h1>Weave light into time</h1>
        <p class="lead">Threads of color drift and meet. Your cursor bends the loom.</p>
        <div class="cta">
          <button class="btn more">Weave more</button>
          <button class="ghost notes">Design log</button>
        </div>
      </div>
    </div>

    <div class="dock" aria-label="Loom settings">
      <div class="glass range">
        <label for="threads">Threads</label>
        <input id="threads" type="range" min="8" max="160" step="2" value="60" aria-valuemin="8" aria-valuemax="160" aria-valuenow="60" aria-label="Thread count">
        <span class="val">60</span>
      </div>
      <div class="glass palettes" role="radiogroup" aria-label="Palette">
        <div class="swatch" role="radio" tabindex="0" aria-checked="true" data-p="tide" title="Tide" style="background:linear-gradient(135deg,hsl(206 95% 54%),hsl(296 86% 62%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="orchid" title="Orchid" style="background:linear-gradient(135deg,hsl(268 88% 66%),hsl(316 86% 64%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="ember" title="Ember" style="background:linear-gradient(135deg,hsl(24 92% 60%),hsl(340 80% 62%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="mint" title="Mint" style="background:linear-gradient(135deg,hsl(160 74% 48%),hsl(192 92% 46%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="dawn" title="Dawn" style="background:linear-gradient(135deg,hsl(14 90% 64%),hsl(44 92% 58%));"></div>
      </div>
    </div>
  </div>

  <div class="foot">
    <div class="quote">“Texture is how clarity breathes.”</div>
    <div class="stamp">
      <span class="spark" aria-hidden="true" style="width:10px;height:10px;box-shadow:none;"></span>
      <span id="last-updated">Last updated: 2025-11-30 01:27:16 EST</span>
    </div>
    <div class="hint">Tip: move the cursor—space toggles motion</div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.loom');
      const canvas = root.querySelector('.weave');
      const ctx = canvas.getContext('2d', { alpha: true });
      const playBtn = root.querySelector('.play');
      const themeBtn = root.querySelector('.theme');
      const badge = root.querySelector('.toggle');
      const moreBtn = root.querySelector('.more');
      const notesBtn = root.querySelector('.notes');
      const slider = root.querySelector('#threads');
      const val = root.querySelector('.val');
      const swatches = [...root.querySelectorAll('.swatch')];
      const updated = root.querySelector('#last-updated');
      const lens = root.querySelector('.lens');
      const stage = root.querySelector('.stage');

      // timestamp
      function fmt(d){
        try{
          return new Intl.DateTimeFormat(undefined, { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:true }).format(d);
        }catch(e){ return d.toLocaleString(); }
      }
      updated.textContent = 'Last updated: ' + fmt(new Date());

      // palettes
      const palettes = {
        tide:   ['hsl(206 95% 54%)','hsl(296 86% 62%)'],
        orchid: ['hsl(268 88% 66%)','hsl(316 86% 64%)'],
        ember:  ['hsl(24 92% 60%)','hsl(340 80% 62%)'],
        mint:   ['hsl(160 74% 48%)','hsl(192 92% 46%)'],
        dawn:   ['hsl(14 90% 64%)','hsl(44 92% 58%)']
      };
      function setPalette(name){
        const [a,b] = palettes[name] || palettes.tide;
        root.style.setProperty('--a', a);
        root.style.setProperty('--b', b);
        swatches.forEach(s=>{
          const on = s.dataset.p === name;
          s.setAttribute('aria-checked', on?'true':'false');
          s.tabIndex = on? 0 : -1;
        });
      }
      swatches.forEach(s=>{
        s.addEventListener('click', ()=> setPalette(s.dataset.p));
        s.addEventListener('keydown', (e)=>{
          if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setPalette(s.dataset.p); }
          if(e.key==='ArrowRight'||e.key==='ArrowLeft'){
            const i = swatches.findIndex(x=>x.getAttribute('aria-checked')==='true');
            const dir = e.key==='ArrowRight'?1:-1;
            const next = (i+dir+swatches.length)%swatches.length;
            swatches[next].focus(); setPalette(swatches[next].dataset.p);
          }
        });
      });
      setPalette('tide');

      // theme
      let night = false;
      function applyTheme(){ root.setAttribute('data-theme', night? 'night':'day'); themeBtn.textContent = night? 'Day':'Night'; }
      const themeToggle = ()=>{ night=!night; applyTheme(); }
      themeBtn.addEventListener('click', themeToggle);
      badge.addEventListener('click', themeToggle);
      badge.addEventListener('keydown', e=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); themeToggle(); }});
      applyTheme();

      // motion state
      let running = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      function setRunning(on){
        running = on;
        root.classList.toggle('alive', on);
        playBtn.textContent = on? 'Pause':'Play';
        playBtn.setAttribute('aria-pressed', on? 'true':'false');
        if(on) raf();
      }
      playBtn.addEventListener('click', ()=> setRunning(!running));
      setRunning(running);

      // slider
      function updVal(n){ slider.setAttribute('aria-valuenow', n); val.textContent = n; setup(+n); }
      slider.addEventListener('input', ()=>updVal(slider.value));
      updVal(slider.value);

      // canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      function resize(){
        const r = canvas.getBoundingClientRect();
        canvas.width = Math.floor(r.width * dpr);
        canvas.height = Math.floor(r.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      const ro = new ResizeObserver(resize); ro.observe(canvas);
      resize();

      // pointer glow + parallax tilt
      const tilt = { rx: 0, ry: 0, tx: 0, ty: 0 };
      stage.addEventListener('pointermove', (e)=>{
        const rect = stage.getBoundingClientRect();
        const nx = (e.clientX - rect.left)/rect.width;   // 0..1
        const ny = (e.clientY - rect.top)/rect.height;   // 0..1
        root.style.setProperty('--mx', (nx*100).toFixed(1)+'%');
        root.style.setProperty('--my', (ny*100).toFixed(1)+'%');
        tilt.tx = (ny - 0.5) * -10; // rx
        tilt.ty = (nx - 0.5) * 12;  // ry
        focus.tx = nx; focus.ty = ny;
      }, {passive:true});
      stage.addEventListener('pointerleave', ()=>{ tilt.tx = 0; tilt.ty = 0; focus.tx = .5; focus.ty = .5; }, {passive:true});

      // Weave system
      let threads = [];
      const focus = { x: .5, y: .5, tx: .5, ty: .5 };
      function setup(n){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        threads = [];
        for(let i=0;i<n;i++){
          const phase = Math.random()*Math.PI*2;
          const amp = (0.1 + Math.random()*0.4) * h;
          const freq = 1.5 + Math.random()*2.2;
          const speed = 0.28 + Math.random()*0.8;
          const thickness = 0.6 + Math.random()*2.2;
          threads.push({ phase, amp, freq, speed, thickness, hue: i/n });
        }
      }
      setup(+slider.value);

      // draw
      let t0 = performance.now();
      function draw(now){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        // fade clear
        ctx.globalCompositeOperation = 'source-over';
        if(root.dataset.theme==='night'){ ctx.fillStyle = 'rgba(10,16,28,0.10)'; }
        else{ ctx.fillStyle = 'rgba(255,255,255,0.10)'; }
        ctx.fillRect(0,0,w,h);

        // focus easing + tilt
        focus.x += (focus.tx - focus.x) * 0.06;
        focus.y += (focus.ty - focus.y) * 0.06;
        tilt.rx += (tilt.tx - tilt.rx) * 0.08;
        tilt.ry += (tilt.ty - tilt.ry) * 0.08;
        lens.style.transform = `rotateX(${tilt.rx.toFixed(2)}deg) rotateY(${tilt.ry.toFixed(2)}deg) translateZ(40px)`;

        const time = (now - t0)/1000;
        const acc1 = getComputedStyle(root).getPropertyValue('--a').trim();
        const acc2 = getComputedStyle(root).getPropertyValue('--b').trim();

        // warp field centered at focus
        const fx = w * (0.24 + focus.x*0.52);
        const fy = h * (0.24 + focus.y*0.52);
        const warpR = Math.min(w,h) * (0.20 + 0.05*Math.sin(time*.8));

        // draw threads
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';

        for(let i=0;i<threads.length;i++){
          const th = threads[i];
          const ph = th.phase + time * th.speed;

          // gradient per thread
          const grad = ctx.createLinearGradient(0, 0, w, h);
          grad.addColorStop(0, acc1);
          grad.addColorStop(1, acc2);

          ctx.strokeStyle = grad;
          ctx.lineWidth = th.thickness;
          ctx.lineCap = 'round';
          ctx.shadowColor = acc2;
          ctx.shadowBlur = 6;

          ctx.beginPath();
          const steps = 120;
          for(let s=0; s<=steps; s++){
            const x = (s/steps) * w;
            const baseY = h*0.5 + Math.sin((s/steps)*th.freq*Math.PI*2 + ph) * th.amp*0.12;

            // radial warp toward focus
            const dx = x - fx;
            const dy = baseY - fy;
            const dist = Math.hypot(dx, dy) || 1;
            const pull = Math.exp(- (dist*dist) / (warpR*warpR)) * (warpR*0.12);
            const wx = x - dx / dist * pull;
            const wy = baseY - dy / dist * pull;

            if(s===0) ctx.moveTo(wx, wy);
            else ctx.lineTo(wx, wy);
          }
          ctx.stroke();
        }
        ctx.restore();

        // core glow pulse
        const core = ctx.createRadialGradient(fx, fy, 0, fx, fy, warpR*1.2);
        core.addColorStop(0, 'rgba(255,255,255,.5)');
        core.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.globalAlpha = 0.9;
        ctx.fillStyle = core;
        ctx.beginPath();
        ctx.arc(fx, fy, warpR*1.2, 0, Math.PI*2);
        ctx.fill();
        ctx.globalAlpha = 1;
      }

      let af;
      function raf(){
        if(!running) return;
        af = requestAnimationFrame(function step(ts){
          if(!running) return;
          draw(ts);
          af = requestAnimationFrame(step);
        });
      }
      if(running) raf();

      // resize DPR
      window.addEventListener('resize', ()=>{
        const newDpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        if(newDpr !== dpr){ dpr = newDpr; }
        resize();
        setup(+slider.value);
      });

      // buttons
      moreBtn.addEventListener('click', ()=>{
        // Cycle palette and randomize threads
        const i = swatches.findIndex(x=>x.getAttribute('aria-checked')==='true');
        const next = swatches[(i+1)%swatches.length];
        next.click();
        const n = 12 + Math.floor(Math.random()*74)*2;
        slider.value = n; updVal(n);
      });
      notesBtn.addEventListener('click', ()=>{
        alert('Design log: embrace silence • dramatize curvature • keep contrast generous • let interaction guide composition.');
      });

      // keyboard: space toggles play when focus is on body or stage
      root.addEventListener('keydown', (e)=>{
        const targetOK = e.target === document.body || root.contains(e.target);
        if(e.key===' ' && targetOK){ e.preventDefault(); setRunning(!running); }
      });

      // initialize glow anchor
      root.style.setProperty('--mx','65%'); root.style.setProperty('--my','35%');
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


