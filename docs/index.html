<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="aurora" data-mood="dusk" aria-label="Aurora Light Garden">
  <style>
    .aurora {
      --r: 28px;
      --ink: #0e1116;
      --soft: rgba(255,255,255,0.35);
      --line: rgba(0,0,0,0.12);
      position: relative;
      padding: 28px;
      border-radius: var(--r);
      border: 1px solid rgba(0,0,0,0.14);
      background:
        radial-gradient(140% 120% at -10% 110%, rgba(0,0,0,0.12), transparent 50%),
        linear-gradient(180deg, #0f1320, #0a0d18 60%, #0a0d18);
      color: #eaf0ff;
      box-shadow: 0 20px 60px rgba(0,0,0,0.35);
      overflow: hidden;
      isolate: isolate;
    }
    /* moods */
    .aurora[data-mood="dusk"] {
      background:
        radial-gradient(140% 120% at 110% -10%, rgba(255,90,140,0.15), transparent 44%),
        radial-gradient(140% 120% at -10% 110%, rgba(0,180,255,0.12), transparent 54%),
        linear-gradient(180deg, #0e1222, #090d19 60%, #0a0d18);
    }
    .aurora[data-mood="dawn"] {
      background:
        radial-gradient(140% 120% at 110% -10%, rgba(255,180,120,0.24), transparent 44%),
        radial-gradient(140% 120% at -10% 110%, rgba(100,220,180,0.18), transparent 54%),
        linear-gradient(180deg, #fff8f2, #fff1e9 60%, #ffe9e0);
      color: #1a1a1a;
      --ink: #141414;
      --line: rgba(0,0,0,0.14);
    }
    .aurora[data-mood="neon"] {
      background:
        radial-gradient(140% 120% at 110% -10%, rgba(255,97,166,0.24), transparent 44%),
        radial-gradient(140% 120% at -10% 110%, rgba(0,255,213,0.22), transparent 54%),
        linear-gradient(180deg, #090b14, #070a13 60%, #060812);
      color: #e9f6ff;
    }
    .aurora[data-mood="ink"] {
      background:
        radial-gradient(140% 120% at 110% -10%, rgba(255,255,255,0.08), transparent 44%),
        linear-gradient(180deg, #ffffff, #f5f6f8);
      color: #111;
      --ink: #0d0d0d;
      --line: rgba(0,0,0,0.1);
      --soft: rgba(0,0,0,0.25);
      box-shadow: 0 16px 50px rgba(0,0,0,0.16);
    }

    /* Noise + vignette */
    .aurora::before {
      content: "";
      position: absolute; inset: -100px;
      background:
        repeating-conic-gradient(from 0deg, rgba(255,255,255,0.02) 0 10deg, transparent 10deg 20deg);
      opacity: 0.2; mix-blend-mode: soft-light; pointer-events: none;
      animation: spin 40s linear infinite;
    }
    .aurora::after {
      content: "";
      position: absolute; inset: 0;
      pointer-events: none;
      background:
        radial-gradient(120% 160% at 50% 120%, rgba(0,0,0,0.24), transparent 40%),
        linear-gradient(0deg, rgba(0,0,0,0.08), transparent 35%);
      mix-blend-mode: multiply;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* header */
    .a-header {
      display: flex; align-items: center; justify-content: space-between;
      gap: 12px; margin-bottom: 10px;
    }
    .brand {
      display: inline-flex; align-items: center; gap: 12px;
      font-weight: 700; letter-spacing: 0.24em; text-transform: uppercase;
      font-size: 12px;
      opacity: 0.9;
    }
    .mark {
      width: 28px; height: 28px; border-radius: 9px; position: relative; overflow: hidden;
      background: conic-gradient(from 0deg, #7b5cff, #00d7ff, #ff5894, #ffd166, #7b5cff);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.3), 0 10px 24px rgba(0,0,0,0.25);
    }
    .pill {
      font-size: 11px; letter-spacing: 1.2px; text-transform: uppercase;
      padding: 6px 10px; border-radius: 999px;
      color: #0a0d18;
      background: linear-gradient(90deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
      border: 1px solid rgba(255,255,255,0.5);
      box-shadow: 0 6px 16px rgba(0,0,0,0.18);
    }
    .aurora[data-mood="ink"] .pill { color: #111; background: linear-gradient(90deg, #fff, #f5f5f5); }

    /* title */
    .title {
      margin: 2px 0 8px;
      font-size: clamp(28px, 6vw, 62px);
      letter-spacing: -0.02em; line-height: 0.96;
      font-weight: 900;
      background: linear-gradient(90deg, currentColor, rgba(255,255,255,0.7));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(0 6px 20px rgba(0,0,0,0.25));
    }
    .sub {
      margin: 0 0 18px;
      font-size: clamp(13px, 2vw, 16px);
      color: color-mix(in oklab, currentColor 80%, transparent);
      opacity: 0.9;
    }

    /* stage */
    .stage {
      position: relative;
      border-radius: 22px; overflow: hidden; border: 1px solid var(--line);
      min-height: clamp(320px, 56vh, 620px);
      background:
        radial-gradient(160% 120% at 50% -20%, rgba(255,255,255,0.15), transparent 38%),
        linear-gradient(180deg, color-mix(in oklab, #101522 70%, transparent), transparent);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06), 0 16px 44px rgba(0,0,0,0.22);
    }
    .grid {
      position: absolute; inset: 0; pointer-events: none;
      background:
        linear-gradient(0deg, rgba(255,255,255,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
      background-size: 28px 28px, 28px 28px;
      mix-blend-mode: overlay;
    }
    .halo {
      position: absolute; inset: -20%;
      background: radial-gradient(60% 60% at 50% 50%, rgba(255,255,255,0.12), transparent 60%);
      filter: blur(30px); pointer-events: none; mix-blend-mode: screen;
    }
    canvas.field {
      position: absolute; inset: 0; display: block; width: 100%; height: 100%;
    }
    .quote {
      position: absolute; left: 16px; bottom: 14px;
      font-weight: 600; letter-spacing: 0.02em;
      font-size: clamp(12px, 1.6vw, 14px);
      color: rgba(255,255,255,0.85);
      text-shadow: 0 1px 10px rgba(0,0,0,0.35);
      opacity: 0; transform: translateY(8px);
      transition: opacity 800ms ease, transform 800ms ease;
      pointer-events: none;
    }
    .aurora[data-mood="dawn"] .quote { color: rgba(20,20,20,0.8); text-shadow: none; }
    .quote.show { opacity: 1; transform: translateY(0); }

    /* controls */
    .panel {
      display: flex; flex-wrap: wrap; align-items: center; gap: 10px;
      margin-top: 16px;
      background: color-mix(in oklab, rgba(255,255,255,0.08) 50%, transparent);
      border: 1px solid var(--line);
      border-radius: 16px; padding: 10px;
      backdrop-filter: blur(8px);
      box-shadow: 0 8px 22px rgba(0,0,0,0.18);
    }
    .btn {
      appearance: none; cursor: pointer; user-select: none;
      border: 1px solid var(--line); border-radius: 999px;
      padding: 8px 12px; font-size: 13px; color: inherit;
      background: color-mix(in oklab, rgba(255,255,255,0.14) 50%, transparent);
      transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
      box-shadow: 0 6px 16px rgba(0,0,0,0.16);
    }
    .btn:hover { transform: translateY(-2px); }
    .btn:focus-visible { outline: 2px solid rgba(120,170,255,0.8); outline-offset: 2px; }

    .range {
      appearance: none; width: clamp(140px, 24vw, 220px); height: 28px; border-radius: 999px;
      border: 1px solid var(--line);
      background: linear-gradient(90deg, rgba(255,255,255,0.18), rgba(255,255,255,0.06));
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.06);
    }
    .range::-webkit-slider-thumb {
      appearance: none; width: 20px; height: 20px; border-radius: 50%;
      background: #fff; border: 2px solid rgba(0,0,0,0.14);
      box-shadow: 0 2px 12px rgba(0,0,0,0.25); cursor: pointer;
    }
    .range::-moz-range-thumb {
      width: 20px; height: 20px; border-radius: 50%;
      background: #fff; border: 2px solid rgba(0,0,0,0.14);
      box-shadow: 0 2px 12px rgba(0,0,0,0.25); cursor: pointer;
    }

    .swatches { display: inline-flex; gap: 8px; margin-left: auto; }
    .swatch {
      width: 28px; height: 28px; border-radius: 50%; border: 1px solid var(--line);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      cursor: pointer; transition: transform 160ms ease;
    }
    .swatch:hover { transform: translateY(-2px); }
    .swatch[data-mood="dusk"] { background: conic-gradient(#7b5cff, #00d7ff, #ff5894, #ffd166, #7b5cff); }
    .swatch[data-mood="dawn"] { background: conic-gradient(#ff9a8b, #ffd3a5, #fad648, #6be585, #ff9a8b); }
    .swatch[data-mood="neon"] { background: conic-gradient(#00ffd5, #8c7cff, #ff61a6, #00a2ff, #00ffd5); }
    .swatch[data-mood="ink"]  { background: conic-gradient(#111, #777, #aaa, #fff, #111); }

    .meta {
      display: flex; align-items: center; gap: 12px; margin-top: 10px;
      font-size: 12px; color: color-mix(in oklab, currentColor 70%, transparent);
    }
    .hint { opacity: 0.8; }
    [data-ui="hidden"] .panel, [data-ui="hidden"] .a-header { opacity: 0; pointer-events: none; transform: translateY(-6px); transition: 200ms ease; }
  </style>

  <div class="a-header">
    <div class="brand">
      <div class="mark" aria-hidden="true"></div>
      Lumen Atelier
    </div>
    <div class="pill" aria-hidden="true">Generative Garden</div>
  </div>

  <h1 class="title">Lattice of Light</h1>
  <p class="sub">An ambient field that flows under your pointer — glide, pause, and grow the glow.</p>

  <div class="stage" aria-label="Generative aurora canvas">
    <canvas class="field" aria-hidden="true"></canvas>
    <div class="grid" aria-hidden="true"></div>
    <div class="halo" aria-hidden="true"></div>
    <div class="quote" aria-live="polite"></div>
  </div>

  <div class="panel" role="group" aria-label="Controls">
    <button type="button" class="btn play" aria-pressed="false" title="Pause/Resume">Pause</button>
    <label class="btn" style="padding:0 8px; display:inline-flex; align-items:center; gap:8px;">
      <span style="opacity:0.8; font-size:12px;">Intensity</span>
      <input class="range" type="range" min="0.5" max="2.0" step="0.1" value="1.0" aria-label="Intensity">
    </label>
    <button type="button" class="btn bloom" title="Bloom (shuffle flow)">Bloom</button>
    <button type="button" class="btn snap" title="Save snapshot">Capture</button>
    <div class="swatches" role="group" aria-label="Mood">
      <button class="swatch" type="button" data-mood="dusk" title="Dusk"></button>
      <button class="swatch" type="button" data-mood="dawn" title="Dawn"></button>
      <button class="swatch" type="button" data-mood="neon" title="Neon"></button>
      <button class="swatch" type="button" data-mood="ink" title="Ink"></button>
    </div>
  </div>

  <div class="meta">
    <span id="last-updated">Last updated: 2025-11-03 01:28:27 EST</span>
    <span class="hint">Space: pause • H: hide UI</span>
  </div>

  <script>
    (function () {
      const root = document.currentScript.closest('.aurora');
      const canvas = root.querySelector('canvas.field');
      const ctx = canvas.getContext('2d');
      const stage = root.querySelector('.stage');
      const playBtn = root.querySelector('.btn.play');
      const intensityInput = root.querySelector('.range');
      const bloomBtn = root.querySelector('.bloom');
      const snapBtn = root.querySelector('.snap');
      const swatches = root.querySelectorAll('.swatch');
      const quoteEl = root.querySelector('.quote');
      const last = root.querySelector('#last-updated');

      // Timestamp
      try {
        const now = new Date();
        const fmt = new Intl.DateTimeFormat([], {
          year: 'numeric', month: 'short', day: '2-digit',
          hour: '2-digit', minute: '2-digit', second: '2-digit',
          hour12: true, timeZoneName: 'short'
        });
        last.textContent = 'Updated ' + fmt.format(now);
      } catch {
        last.textContent = 'Updated ' + new Date().toLocaleString();
      }

      // Moods
      const PALETTES = {
        dusk: ['#7b5cff', '#00d7ff', '#ff5894', '#ffd166'],
        dawn: ['#ff9a8b', '#ffd3a5', '#fad648', '#6be585'],
        neon: ['#00ffd5', '#8c7cff', '#ff61a6', '#00a2ff'],
        ink:  ['#222222', '#666666', '#999999', '#ffffff']
      };
      const FADE = {
        dusk: 'rgba(5,8,16,0.07)',
        dawn: 'rgba(255,248,238,0.06)',
        neon: 'rgba(6,8,14,0.07)',
        ink:  'rgba(255,255,255,0.06)'
      };

      const savedMood = localStorage.getItem('aurora-mood');
      if (savedMood && PALETTES[savedMood]) root.setAttribute('data-mood', savedMood);

      swatches.forEach(s => s.addEventListener('click', () => {
        const mood = s.getAttribute('data-mood');
        root.setAttribute('data-mood', mood);
        localStorage.setItem('aurora-mood', mood);
        rebuildParticles(); // recolor
      }));

      // Canvas sizing
      const DPR = Math.min(2, window.devicePixelRatio || 1);
      let W = 0, H = 0, area = 0;

      function resize() {
        const r = stage.getBoundingClientRect();
        W = Math.max(1, Math.floor(r.width));
        H = Math.max(1, Math.floor(r.height));
        canvas.width = Math.floor(W * DPR);
        canvas.height = Math.floor(H * DPR);
        canvas.style.width = W + 'px';
        canvas.style.height = H + 'px';
        ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
        area = W * H;
        rebuildParticles();
      }
      const ro = new ResizeObserver(resize);
      ro.observe(stage);
      window.addEventListener('orientationchange', () => setTimeout(resize, 100));

      // Controls
      let paused = false;
      function setPaused(p) {
        paused = p;
        playBtn.setAttribute('aria-pressed', String(p));
        playBtn.textContent = p ? 'Resume' : 'Pause';
      }
      playBtn.addEventListener('click', () => setPaused(!paused));
      if (matchMedia('(prefers-reduced-motion: reduce)').matches) setPaused(true);

      let intensity = parseFloat(localStorage.getItem('aurora-intensity') || '1.0');
      intensityInput.value = String(intensity.toFixed(1));
      intensityInput.addEventListener('input', (e) => {
        intensity = parseFloat(e.target.value || '1');
        localStorage.setItem('aurora-intensity', String(intensity));
        targetCount = computeCount(); // adjust density live
      });

      // Hide UI
      root.tabIndex = 0;
      root.addEventListener('keydown', (e) => {
        if (e.code === 'Space') { e.preventDefault(); setPaused(!paused); }
        if (e.key.toLowerCase() === 'h') {
          const hide = root.getAttribute('data-ui') === 'hidden';
          root.setAttribute('data-ui', hide ? 'shown' : 'hidden');
        }
      });

      // Snapshot
      snapBtn.addEventListener('click', () => {
        try {
          const link = document.createElement('a');
          link.download = 'lattice-of-light.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        } catch {}
      });

      // Flow field + particles
      let particles = [];
      let targetCount = 0;
      let seedOffset = Math.random() * 1000;
      const rand = (a,b) => a + Math.random() * (b - a);

      function computeCount() {
        // density ~ 0.0012 per pixel, clamped
        const base = Math.max(300, Math.min(1500, Math.floor(area * 0.0012)));
        return Math.floor(base * intensity);
      }

      function colorFor(mood) {
        const pal = PALETTES[mood] || PALETTES.dusk;
        return pal[Math.floor(Math.random()*pal.length)];
      }

      function rebuildParticles() {
        const mood = root.getAttribute('data-mood') || 'dusk';
        const count = computeCount();
        targetCount = count;
        const next = [];
        for (let i = 0; i < count; i++) {
          next.push({
            x: Math.random() * W,
            y: Math.random() * H,
            px: null, py: null,
            vx: rand(-0.5,0.5), vy: rand(-0.5,0.5),
            hue: colorFor(mood),
            w: rand(0.7, 2.0)
          });
        }
        particles = next;
        ctx.clearRect(0,0,W,H);
      }

      bloomBtn.addEventListener('click', () => {
        seedOffset = Math.random() * 1000;
        // Re-seed velocities gently
        particles.forEach(p => {
          p.vx += rand(-1,1); p.vy += rand(-1,1);
        });
      });

      // Pointer attraction
      const pointer = { x: 0, y: 0, on: false };
      function setPointer(clientX, clientY) {
        const r = stage.getBoundingClientRect();
        pointer.x = (clientX - r.left);
        pointer.y = (clientY - r.top);
        pointer.on = true;
      }
      stage.addEventListener('mousemove', (e) => setPointer(e.clientX, e.clientY));
      stage.addEventListener('mouseleave', () => { pointer.on = false; });
      stage.addEventListener('touchmove', (e) => {
        const t = e.touches[0]; if (!t) return;
        setPointer(t.clientX, t.clientY);
      }, { passive: true });
      stage.addEventListener('touchend', () => { pointer.on = false; });

      // Quotes
      const QUOTES = [
        'Light sketches where time cannot.',
        'Stillness is motion slowed enough to listen.',
        'Edges are just gradients in disguise.',
        'Order is a dance; we choose the tempo.',
        'Let the canvas breathe — the glow will follow.'
      ];
      let qi = 0;
      function cycleQuote() {
        quoteEl.classList.remove('show');
        setTimeout(() => {
          quoteEl.textContent = QUOTES[qi % QUOTES.length];
          qi++;
          quoteEl.classList.add('show');
        }, 220);
      }
      cycleQuote();
      setInterval(cycleQuote, 5200);

      // Animation loop
      let start = performance.now();
      function frame(now) {
        const t = (now - start) / 1000;
        const mood = root.getAttribute('data-mood') || 'dusk';
        // gentle fade for trails
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = FADE[mood] || 'rgba(5,8,16,0.07)';
        ctx.fillRect(0, 0, W, H);

        if (!paused) {
          // adjust particle count smoothly if resized/intensity changed
          const diff = targetCount - particles.length;
          if (Math.abs(diff) > 2) {
            if (diff > 0) {
              for (let i = 0; i < Math.min(20, diff); i++) {
                particles.push({
                  x: Math.random() * W,
                  y: Math.random() * H,
                  px: null, py: null,
                  vx: rand(-0.5,0.5), vy: rand(-0.5,0.5),
                  hue: colorFor(mood), w: rand(0.7, 2.0)
                });
              }
            } else {
              particles.splice(0, Math.min(20, -diff));
            }
          }

          ctx.globalCompositeOperation = 'lighter';
          ctx.lineCap = 'round';
          ctx.lineJoin = 'round';

          const f1 = 0.0032, f2 = 0.0024;
          const s1 = 0.8 * intensity, s2 = 0.6 * intensity;
          const attractK = 0.12 * intensity;

          for (let i = 0; i < particles.length; i++) {
            const p = particles[i];

            // Flow angle from simple trig field
            const ax = Math.sin((p.y * f1) + (t + seedOffset) * s1);
            const ay = Math.cos((p.x * f2) - (t + seedOffset * 0.5) * s2);
            const ang = (ax + ay) * Math.PI;

            // velocity update
            p.vx += Math.cos(ang) * 0.18 * intensity;
            p.vy += Math.sin(ang) * 0.18 * intensity;

            // pointer attraction
            if (pointer.on) {
              const dx = (pointer.x - p.x);
              const dy = (pointer.y - p.y);
              const d2 = Math.max(24, dx*dx + dy*dy);
              const force = attractK / d2 * 800;
              p.vx += dx * force;
              p.vy += dy * force;
            }

            // damping
            p.vx *= 0.965;
            p.vy *= 0.965;

            // integrate
            const nx = p.x + p.vx;
            const ny = p.y + p.vy;

            // draw
            ctx.strokeStyle = p.hue;
            ctx.globalAlpha = 0.35;
            ctx.lineWidth = p.w;
            if (p.px !== null) {
              ctx.beginPath();
              ctx.moveTo(p.px, p.py);
              ctx.lineTo(nx, ny);
              ctx.stroke();
            }

            // store
            p.px = p.x; p.py = p.y;
            p.x = nx; p.y = ny;

            // wrap
            if (p.x < -4) { p.x = W + 4; p.px = null; p.hue = colorFor(mood); }
            if (p.x > W + 4) { p.x = -4; p.px = null; p.hue = colorFor(mood); }
            if (p.y < -4) { p.y = H + 4; p.py = null; p.hue = colorFor(mood); }
            if (p.y > H + 4) { p.y = -4; p.py = null; p.hue = colorFor(mood); }
          }
          ctx.globalAlpha = 1;
          ctx.globalCompositeOperation = 'source-over';
        }
        requestAnimationFrame(frame);
      }

      // init
      resize();
      requestAnimationFrame(frame);
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


