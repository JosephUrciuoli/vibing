<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v1477 loom" data-theme="noir" aria-label="PRISM LOOM — generative light-weave">
  <style>
    .v1477.loom{
      --r: 28px;
      --paper: #0b0e14;
      --ink: #ecf1fb;
      --muted: #a3b3cc;
      --edge: rgba(255,255,255,.08);
      --glass: rgba(255,255,255,.06);
      --a1: 208 100% 64%;
      --a2: 320 92% 66%;
      --a3: 160 86% 62%;
      color-scheme: dark;
      position: relative;
      display: grid;
      grid-template-rows: auto minmax(64vh,1fr) auto;
      gap: clamp(16px, 3vw, 40px);
      padding: clamp(22px, 6vw, 56px);
      border-radius: var(--r);
      overflow: hidden;
      isolation: isolate;
      font-family: ui-sans-serif, "SF Pro Display","SF Pro Text", Inter, "Segoe UI", system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif;
      color: var(--ink);
      background:
        radial-gradient(120% 160% at 20% -10%, hsl(var(--a2) / .20), transparent 60%),
        radial-gradient(120% 160% at 120% 120%, hsl(var(--a1) / .25), transparent 60%),
        linear-gradient(180deg, #0a0e15 0%, #0e1320 60%, #0a0e15 100%);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
    }
    .v1477.loom::before{
      content:""; position:absolute; inset:-35% -25%; z-index:0; pointer-events:none;
      background: conic-gradient(from 0turn at 60% 45%, hsl(var(--a1) / .35), transparent 20%, hsl(var(--a2) / .35), transparent 55%, hsl(var(--a3) / .35), transparent 90%, hsl(var(--a1) / .35));
      filter: blur(120px) saturate(120%); opacity:.55; mix-blend-mode: screen;
      animation: v1477-slowspin 80s linear infinite;
    }
    .v1477.loom::after{
      content:""; position:absolute; inset:0; pointer-events:none; z-index:0;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,.025) 0 1px, transparent 1px 12px),
        repeating-linear-gradient(90deg, rgba(255,255,255,.02) 0 1px, transparent 1px 12px);
      opacity:.22; mask: linear-gradient(180deg, #000, transparent 70%);
    }
    @keyframes v1477-slowspin{ to{ transform: rotate(360deg) } }

    /* THEMES */
    .v1477.loom[data-theme="noir"]{
      --paper:#0b0e14; --ink:#ecf1fb; --muted:#a3b3cc; --glass: rgba(255,255,255,.06);
      --a1: 212 100% 64%; --a2: 296 94% 70%; --a3: 166 86% 62%;
      color-scheme: dark;
    }
    .v1477.loom[data-theme="mist"]{
      --paper:#f7f9ff; --ink:#0c1430; --muted:#5f729a; --glass: rgba(255,255,255,.65);
      --a1: 206 86% 58%; --a2: 256 86% 64%; --a3: 316 86% 62%;
      color-scheme: light;
      background:
        radial-gradient(120% 160% at 0% 100%, hsl(var(--a1) / .22), transparent 60%),
        radial-gradient(120% 160% at 120% -10%, hsl(var(--a2) / .22), transparent 60%),
        linear-gradient(180deg, #edf3ff, #ffffff);
    }
    .v1477.loom[data-theme="matcha"]{
      --paper:#0e1411; --ink:#eaf7ef; --muted:#a1c3b0; --glass: rgba(255,255,255,.07);
      --a1: 150 70% 56%; --a2: 180 85% 60%; --a3: 90 70% 55%;
      color-scheme: dark;
      background:
        radial-gradient(120% 160% at 120% 0%, hsl(var(--a2) / .22), transparent 68%),
        radial-gradient(120% 160% at 0% 120%, hsl(var(--a3) / .22), transparent 68%),
        linear-gradient(180deg, #0c120f, #0e1612);
    }

    /* TOP */
    .v1477 .top{ position:relative; z-index:2; display:grid; grid-template-columns: 1fr auto; align-items:end; gap: clamp(10px, 2vw, 18px); }
    .v1477 .brand{ min-width:0; }
    .v1477 .lockup{ display:flex; align-items:center; gap:12px; }
    .v1477 .sig{
      width:56px; height:56px; border-radius:16px; display:grid; place-items:center;
      background:
        radial-gradient(circle at 32% 30%, #fff, hsl(var(--a1)) 60%, transparent 62%),
        conic-gradient(from 120deg, transparent 0 35%, hsl(var(--a2)) 0 70%, transparent 0 100%);
      border:1px solid var(--edge);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.5), 0 12px 26px rgba(0,0,0,.25);
    }
    .v1477 .chip{
      display:inline-grid; grid-auto-flow:column; gap:10px; align-items:center;
      padding:8px 12px; border-radius:999px; border:1px solid var(--edge);
      background: var(--glass); backdrop-filter: blur(10px) saturate(140%);
      font-weight:900; letter-spacing:.22em; font-size:11px; text-transform:uppercase;
      color: color-mix(in oklab, var(--ink) 86%, hsl(var(--a1)));
    }
    .v1477 .title{
      margin:.35rem 0 0;
      font-size: clamp(44px, 9vw, 112px); line-height:.9; font-weight:1000; letter-spacing:-0.03em;
      background: linear-gradient(90deg,
        color-mix(in oklab, var(--paper), hsl(var(--a1)) 70%) 0%,
        color-mix(in oklab, var(--paper), hsl(var(--a2)) 70%) 50%,
        color-mix(in oklab, var(--paper), hsl(var(--a3)) 70%) 100%);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow: 0 18px 44px rgba(0,0,0,0.12);
      background-size: 220% 100%;
      animation: v1477-sheen 14s ease-in-out infinite;
    }
    .v1477 .strap{ margin:.45rem 0 0; font-size: 14px; color: var(--muted); max-width: 68ch; }
    @keyframes v1477-sheen{ 0%,100%{ background-position: 0% 0 } 50%{ background-position: 100% 0 } }

    .v1477 .tools{ display:flex; flex-wrap:wrap; justify-content:flex-end; gap:10px; align-items:center; }
    .v1477 .btn{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:999px; border:1px solid var(--edge);
      background: var(--glass); color: var(--ink); font-weight:800; font-size:12px; letter-spacing:.25px; user-select:none; cursor:pointer;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.35), 0 10px 24px rgba(0,0,0,0.18);
      backdrop-filter: blur(12px) saturate(160%);
      transition: transform .18s ease, box-shadow .25s ease, background .25s ease, border-color .25s ease;
      -webkit-tap-highlight-color: transparent;
    }
    .v1477 .btn:hover{ transform: translateY(-1px) }
    .v1477 .btn[aria-pressed="true"]{
      background: linear-gradient(180deg, color-mix(in oklab, hsl(var(--a1)) 16%, transparent) 0%, transparent 100%), var(--glass);
      border-color: color-mix(in oklab, hsl(var(--a1)) 18%, var(--edge));
      box-shadow: 0 14px 36px color-mix(in oklab, hsl(var(--a1)) 18%, transparent), inset 0 1px 0 rgba(255,255,255,0.45);
    }

    /* STAGE */
    .v1477 .stage{
      position:relative; z-index:1; min-height:min(70vh, 960px);
      border-radius: calc(var(--r) - 2px); border:1px solid var(--edge); overflow:hidden;
      background:
        radial-gradient(120% 120% at 50% 30%, rgba(255,255,255,0.06), rgba(255,255,255,0.02)),
        linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), 0 30px 140px rgba(0,0,0,0.35);
      display:grid; place-items:center; padding: clamp(10px, 3vw, 24px);
    }
    .v1477 canvas.weave{
      position:absolute; inset:0; width:100%; height:100%; display:block; z-index:1;
      filter: saturate(120%) contrast(110%);
    }
    .v1477 .gridfx{
      position:absolute; inset:0; z-index:2; pointer-events:none;
      background:
        radial-gradient(80% 60% at 50% 40%, hsl(var(--a2) / .35), transparent 60%),
        radial-gradient(80% 60% at 50% 60%, hsl(var(--a1) / .35), transparent 60%);
      mix-blend-mode: screen; opacity:.15; filter: blur(40px);
    }
    .v1477 .caption{
      position:absolute; inset:auto 0 0; z-index:3; display:grid; place-content:end center; padding: clamp(14px, 3vw, 28px); pointer-events:none;
      text-align:center; color: var(--muted);
    }
    .v1477 .hint{
      font-size: clamp(12px, 2.2vw, 16px);
      background: color-mix(in oklab, hsl(var(--a1)) 9%, transparent);
      border:1px solid var(--edge); border-radius:999px; padding:.5em .9em; display:inline-flex; gap:.6em; align-items:center;
      backdrop-filter: blur(8px) saturate(140%);
    }
    .v1477 .kbd{ padding:.1em .45em; border-radius:6px; border:1px solid var(--edge); background: color-mix(in oklab, hsl(var(--a1)) 12%, transparent); color:inherit; }

    /* BOTTOM */
    .v1477 .bottom{ position:relative; z-index:2; display:grid; grid-template-columns:1fr auto; gap:10px; align-items:center; color:var(--muted); font-size:12px; }
    .v1477 .meta{ display:inline-flex; gap:10px; align-items:center; white-space:nowrap; flex-wrap:wrap; }
    .v1477 .led{ width:9px; height:9px; border-radius:50%; background: hsl(var(--a1)); box-shadow:0 0 0 6px hsl(var(--a1) / .22); animation: v1477-led 2.1s ease-in-out infinite; }
    @keyframes v1477-led{ 0%,100%{ transform: scale(1); opacity:1 } 50%{ transform: scale(1.12); opacity:.95 } }

    .v1477 .btn:focus-visible{ outline:2px solid color-mix(in oklab, hsl(var(--a1)) 60%, transparent); outline-offset:2px; }
    .v1477.paused *{ animation-play-state: paused !important; }

    @media (max-width: 900px){
      .v1477 .top{ grid-template-columns: 1fr; }
      .v1477 .bottom{ grid-template-columns: 1fr; gap:8px; }
    }
    @media (prefers-reduced-motion: reduce){
      .v1477, .v1477 *{ animation:none !important; transition:none !important; }
    }
  </style>

  <div class="top">
    <div class="brand">
      <div class="lockup">
        <span class="sig" aria-hidden="true"></span>
        <span class="chip">Studio</span>
      </div>
      <h2 class="title">PRISM LOOM</h2>
      <p class="strap">A generative light‑weave you can steer. Bend threads with your cursor, change moods, and capture the moment.</p>
    </div>
    <div class="tools" role="group" aria-label="Controls">
      <button class="btn play" type="button" aria-pressed="true" title="Toggle motion">Motion</button>
      <button class="btn theme" type="button" aria-pressed="true" title="Cycle theme">Noir</button>
      <button class="btn less" type="button" title="Fewer threads" aria-label="Fewer threads">–</button>
      <button class="btn more" type="button" title="More threads" aria-label="More threads">+</button>
      <button class="btn shot" type="button" title="Save PNG">Snapshot</button>
    </div>
  </div>

  <div class="stage" aria-live="polite">
    <canvas class="weave"></canvas>
    <div class="gridfx" aria-hidden="true"></div>
    <div class="caption" aria-hidden="true">
      <div class="hint">
        <span class="kbd">Space</span> pause • <span class="kbd">T</span> theme • <span class="kbd">+/–</span> threads • <span class="kbd">S</span> snapshot • Click to ripple
      </div>
    </div>
  </div>

  <div class="bottom">
    <div class="meta">
      <span class="led" aria-hidden="true"></span>
      Theme: <span class="m-theme">Noir</span> • Motion: <span class="m-motion">On</span> • Threads: <span class="m-threads">120</span>
    </div>
    <div class="meta">
      <span id="last-updated">Last updated: 2025-12-23 12:19:09 EST</span>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.v1477.loom');
      if(!root) return;

      const cv = root.querySelector('canvas.weave');
      const ctx = cv.getContext('2d');

      const playBtn = root.querySelector('.play');
      const themeBtn = root.querySelector('.theme');
      const lessBtn = root.querySelector('.less');
      const moreBtn = root.querySelector('.more');
      const shotBtn = root.querySelector('.shot');

      const mTheme = root.querySelector('.m-theme');
      const mMotion = root.querySelector('.m-motion');
      const mThreads = root.querySelector('.m-threads');
      const updated = root.querySelector('#last-updated');

      // timestamp
      try{
        const now = new Date();
        const opts = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || '';
        updated.textContent = 'Updated ' + new Intl.DateTimeFormat([], opts).format(now) + ' ' + (tz ? tz.replaceAll('_',' ') : '');
      }catch(e){ updated.textContent = 'Updated ' + new Date().toLocaleString(); }

      // themes
      const THEMES = [
        { id:'noir',   label:'Noir' },
        { id:'mist',   label:'Mist' },
        { id:'matcha', label:'Matcha' }
      ];
      let themeIndex = Math.max(0, THEMES.findIndex(t => t.id === (root.getAttribute('data-theme')||'noir')));
      if (themeIndex < 0) themeIndex = 0;

      // state
      const state = {
        playing: true,
        t: 0,
        threads: 120,
        pointer: { x:0, y:0, inside:false, rippleT:0 }
      };

      // canvas sizing
      function setCanvasSize(){
        const dpr = Math.min(2, (window.devicePixelRatio||1));
        const rect = cv.getBoundingClientRect();
        cv.width = Math.max(1, Math.floor(rect.width * dpr));
        cv.height = Math.max(1, Math.floor(rect.height * dpr));
        cv.style.width = rect.width + 'px';
        cv.style.height = rect.height + 'px';
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }

      // thread model
      let threads = [];
      function rand(a,b){ return a + Math.random()*(b-a); }
      function rebuild(n){
        const rect = cv.getBoundingClientRect();
        const H = Math.max(1, rect.height);
        threads = Array.from({length:n}, (_,i)=>{
          const y = (i+Math.random())/n * H;
          return {
            y0: y,
            amp: rand(10, 34),
            freq: rand(1.5, 3.2),
            speed: rand(0.3, 1.1),
            phase: rand(0, Math.PI*2),
            w: rand(0.7, 1.8),
            mix: Math.random()
          };
        });
        mThreads.textContent = String(n);
      }

      function getThemeColors(){
        const style = getComputedStyle(root);
        const a1 = style.getPropertyValue('--a1').trim();
        const a2 = style.getPropertyValue('--a2').trim();
        const a3 = style.getPropertyValue('--a3').trim();
        const paper = style.getPropertyValue('--paper').trim() || '#0b0e14';
        return { a1, a2, a3, paper };
      }

      function clear(){
        const { paper } = getThemeColors();
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = 1;
        ctx.fillStyle = paper;
        ctx.fillRect(0,0,cv.width,cv.height);
      }

      function drawWeave(){
        clear();
        const rect = cv.getBoundingClientRect();
        const W = rect.width, H = rect.height;
        const { a1, a2, a3 } = getThemeColors();
        const t = state.t;

        // subtle vignette
        const vig = ctx.createRadialGradient(W/2, H*0.55, Math.min(W,H)*0.2, W/2, H/2, Math.max(W,H)*0.9);
        vig.addColorStop(0, 'rgba(255,255,255,0.02)');
        vig.addColorStop(1, 'rgba(0,0,0,0.10)');
        ctx.fillStyle = vig; ctx.fillRect(0,0,W,H);

        // pointer field
        const px = state.pointer.x, py = state.pointer.y;
        const rippleTime = state.pointer.rippleT;
        const R = Math.min(W,H) * 0.35;

        ctx.lineCap = 'round';
        ctx.globalCompositeOperation = 'lighter';

        for(let i=0;i<threads.length;i++){
          const th = threads[i];
          const hue = i%3===0 ? a1 : i%3===1 ? a2 : a3;
          const alpha = 0.22 + 0.55 * th.mix;
          const lw = th.w;

          // gradient per thread
          const g = ctx.createLinearGradient(0, th.y0, W, th.y0);
          g.addColorStop(0, `hsl(${a1} / ${alpha})`);
          g.addColorStop(0.5, `hsl(${hue} / ${alpha})`);
          g.addColorStop(1, `hsl(${a3} / ${alpha})`);

          ctx.strokeStyle = g;
          ctx.lineWidth = lw;

          // build path
          const steps = 48;
          const dx = W/steps;
          let x = 0;
          // start
          let y = th.y0 + Math.sin((x/W)*th.freq*6.283 + t*th.speed*0.8 + th.phase) * th.amp;

          // pointer attraction
          if (state.pointer.inside){
            const d = Math.hypot(x - px, y - py);
            const fall = Math.exp(-(d*d)/(R*R));
            y += (py - y) * 0.22 * fall;
          }

          // ripple ring
          if (rippleTime>0 && state.pointer.inside){
            const rr = (t - rippleTime) * 280; // expanding px
            const d0 = Math.hypot(x - px, y - py);
            const wave = Math.cos((d0 - rr)/18) * Math.exp(-Math.abs(d0 - rr)/120);
            y += wave * 6;
          }

          ctx.beginPath();
          ctx.moveTo(x, y);

          for(let s=1; s<=steps; s++){
            const nx = s*dx;
            let ny = th.y0 + Math.sin((nx/W)*th.freq*6.283 + t*th.speed*0.8 + th.phase) * th.amp;
            if (state.pointer.inside){
              const d2 = Math.hypot(nx - px, ny - py);
              const fall2 = Math.exp(-(d2*d2)/(R*R));
              ny += (py - ny) * 0.22 * fall2;
            }
            if (rippleTime>0 && state.pointer.inside){
              const rr2 = (t - rippleTime) * 280;
              const d3 = Math.hypot(nx - px, ny - py);
              const wave2 = Math.cos((d3 - rr2)/18) * Math.exp(-Math.abs(d3 - rr2)/120);
              ny += wave2 * 6;
            }
            // curve to
            const cx1 = x + dx*0.5;
            const cy1 = (y + ny)/2;
            ctx.quadraticCurveTo(cx1, cy1, nx, ny);
            x = nx; y = ny;
          }

          ctx.shadowColor = `hsl(${hue} / 0.35)`;
          ctx.shadowBlur = 12 + th.mix*14;
          ctx.stroke();
        }

        // center glow
        const cg = ctx.createRadialGradient(W/2, H/2, 0, W/2, H/2, Math.min(W,H)*0.35);
        cg.addColorStop(0, `hsl(${a2} / .18)`);
        cg.addColorStop(1, 'transparent');
        ctx.shadowBlur = 0;
        ctx.globalCompositeOperation = 'screen';
        ctx.fillStyle = cg; ctx.beginPath(); ctx.rect(0,0,W,H); ctx.fill();

        ctx.globalCompositeOperation = 'source-over';
      }

      // loop
      let raf = null;
      let last = 0;
      function loop(now=performance.now()){
        if (!state.playing) return;
        const dt = Math.min(64, now - last);
        last = now;
        state.t += dt/1000;
        drawWeave();
        raf = requestAnimationFrame(loop);
      }

      // controls
      function setPlay(on){
        state.playing = on;
        playBtn.setAttribute('aria-pressed', String(on));
        mMotion.textContent = on ? 'On' : 'Off';
        root.classList.toggle('paused', !on);
        if (on){ last = performance.now(); loop(last); }
      }
      function cycleTheme(){
        themeIndex = (themeIndex + 1) % THEMES.length;
        const t = THEMES[themeIndex];
        root.setAttribute('data-theme', t.id);
        themeBtn.textContent = t.label;
        mTheme.textContent = t.label;
        drawWeave();
      }
      function setThreads(n){
        state.threads = Math.max(24, Math.min(420, n|0));
        rebuild(state.threads);
        drawWeave();
      }
      function snapshot(){
        try{
          const url = cv.toDataURL('image/png');
          const a = document.createElement('a');
          a.href = url;
          a.download = `prism-loom-${Date.now()}.png`;
          document.body.appendChild(a);
          a.click();
          a.remove();
        }catch(e){}
      }

      // pointer interactions
      function updatePointer(e){
        const rect = cv.getBoundingClientRect();
        state.pointer.x = e.clientX - rect.left;
        state.pointer.y = e.clientY - rect.top;
        state.pointer.inside = state.pointer.x>=0 && state.pointer.y>=0 && state.pointer.x<=rect.width && state.pointer.y<=rect.height;
      }
      function leavePointer(){
        state.pointer.inside = false;
      }
      function ripple(e){
        updatePointer(e);
        state.pointer.rippleT = state.t;
      }

      cv.addEventListener('pointermove', updatePointer);
      cv.addEventListener('pointerleave', leavePointer);
      cv.addEventListener('pointerdown', ripple);

      playBtn.addEventListener('click', ()=> setPlay(playBtn.getAttribute('aria-pressed') !== 'true'));
      themeBtn.addEventListener('click', cycleTheme);
      lessBtn.addEventListener('click', ()=> setThreads(state.threads - 24));
      moreBtn.addEventListener('click', ()=> setThreads(state.threads + 24));
      shotBtn.addEventListener('click', snapshot);

      // keyboard
      window.addEventListener('keydown', (e)=>{
        const k = (e.key||'').toLowerCase();
        if (e.code === 'Space'){ e.preventDefault(); setPlay(!state.playing); }
        if (k === 't'){ cycleTheme(); }
        if (k === '-' || k === '_'){ setThreads(state.threads - 24); }
        if (k === '=' || k === '+'){ setThreads(state.threads + 24); }
        if (k === 's'){ snapshot(); }
      });

      // size/rebuild
      const ro = new ResizeObserver(()=>{ setCanvasSize(); rebuild(state.threads); drawWeave(); });
      ro.observe(cv);
      setCanvasSize();
      rebuild(state.threads);

      // motion preferences and visibility
      const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)');
      if (prefersReduce.matches){ setPlay(false); }
      document.addEventListener('visibilitychange', ()=>{ if (document.hidden){ setPlay(false); } });

      // boot
      setPlay(true);
      themeBtn.textContent = THEMES[themeIndex].label; mTheme.textContent = THEMES[themeIndex].label;
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


