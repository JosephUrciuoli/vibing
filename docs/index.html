<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v1460 orrery" data-theme="dawn" aria-label="HALO ORRERY — kinetic timepiece">
  <style>
    .v1460.orrery{
      --r: 26px;
      --ink:#0b1020; --muted:#5f6778; --accent:#6b7cff;
      --bg1:#f7faff; --bg2:#fff6ef;
      --ring: rgba(40,54,120,0.22);
      --glow1:#8fb3ff; --glow2:#ffa6d6; --glow3:#88ffe1;
      position:relative; display:grid; gap:clamp(14px,3.6vw,26px);
      grid-template-rows:auto 1fr auto;
      padding:clamp(18px,5.6vw,44px);
      border-radius:var(--r);
      color:var(--ink); overflow:hidden; isolation:isolate;
      font-family: ui-sans-serif, -apple-system, "SF Pro Text", Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(140% 120% at 100% -10%, rgba(255,180,160,0.18), transparent 60%),
        radial-gradient(110% 120% at -10% 110%, rgba(160,210,255,0.20), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.7), 0 40px 140px rgba(0,0,0,0.16);
    }
    .v1460.orrery[data-theme="dusk"]{
      --ink:#eef3ff; --muted:#aab6d3; --accent:#86e7ff;
      --bg1:#0b0f1a; --bg2:#151e36;
      --ring: rgba(200,220,255,0.18);
      --glow1:#8fd7ff; --glow2:#c49bff; --glow3:#ffc39a;
      color-scheme: dark;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05), 0 50px 160px rgba(0,0,0,0.55);
    }
    .v1460.orrery::before{
      content:""; position:absolute; inset:-30% -30% -30% -30%; pointer-events:none; z-index:0;
      background:
        conic-gradient(from 0deg, transparent 0 22%, rgba(255,255,255,0.10) 23% 25%, transparent 26% 49%, rgba(255,255,255,0.08) 50% 51%, transparent 52% 100%);
      filter: blur(90px) saturate(120%); mix-blend-mode: soft-light;
      animation: v1460-sweep 36s linear infinite;
    }
    @keyframes v1460-sweep{ to{ transform: rotate(360deg) } }

    /* Header */
    .v1460 .mast{ position:relative; z-index:2; display:grid; grid-template-columns:1fr auto; gap:clamp(12px,2.6vw,20px); align-items:end; }
    .v1460 .brand{ display:flex; align-items:center; gap:14px; min-width:0; }
    .v1460 .glyph{
      width:72px; height:72px; border-radius:22px; position:relative; display:grid; place-items:center; overflow:hidden;
      background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0.08));
      border:1px solid rgba(0,0,0,0.06);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.8),
        inset 0 -40px 60px rgba(255,255,255,0.35),
        0 18px 48px rgba(0,0,0,0.10);
    }
    .v1460 .glyph::before, .v1460 .glyph::after{
      content:""; position:absolute; border-radius:50%;
      filter: blur(10px); mix-blend-mode:screen;
    }
    .v1460 .glyph::before{ inset:20% 18% 28% 18%; background: radial-gradient(closest-side, var(--glow1), transparent 70%); }
    .v1460 .glyph::after{ inset:28% 22% 18% 22%; background: radial-gradient(closest-side, var(--glow2), transparent 70%); }
    .v1460 .title{
      margin:0; line-height:.9; letter-spacing:-0.02em; font-weight:900;
      font-size: clamp(34px, 8.6vw, 90px);
      background: linear-gradient(90deg, currentColor, rgba(100,140,255,0.9) 55%, rgba(255,160,200,0.9));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }
    .v1460 .sub{ margin:.35rem 0 0; font-size:13px; letter-spacing:.25px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    /* Controls */
    .v1460 .controls{ display:flex; flex-wrap:wrap; justify-content:flex-end; align-items:center; gap:10px; }
    .v1460 .chip, .v1460 .slider{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:18px; background: rgba(255,255,255,0.5);
      border:1px solid rgba(0,0,0,0.08);
      color:var(--ink); font-weight:800; font-size:12px; letter-spacing:.25px;
      user-select:none; cursor:pointer; -webkit-tap-highlight-color: transparent;
      transition: transform .2s ease, box-shadow .25s ease, background .25s ease, border-color .25s ease;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.9), 0 10px 24px rgba(0,0,0,0.10);
      backdrop-filter: blur(8px) saturate(130%);
    }
    .v1460[data-theme="dusk"] .chip, .v1460[data-theme="dusk"] .slider{
      background: rgba(20,24,38,0.6); border-color: rgba(255,255,255,0.10); color:var(--ink);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.1), 0 10px 24px rgba(0,0,0,0.35);
    }
    .v1460 .chip:hover{ transform: translateY(-1px) }
    .v1460 .chip[aria-pressed="true"]{
      background: linear-gradient(180deg, rgba(160,180,255,0.25), rgba(255,255,255,0.10));
      border-color: rgba(120,140,255,0.45);
      box-shadow: 0 16px 36px rgba(140,180,255,0.24), inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .v1460 .slider{ padding:8px 12px; }
    .v1460 input[type="range"]{ -webkit-appearance:none; appearance:none; width:140px; height:24px; background:transparent; }
    .v1460 input[type="range"]::-webkit-slider-runnable-track{
      height:8px; border-radius:999px; background: linear-gradient(90deg, rgba(0,0,0,0.10), var(--accent));
      border:1px solid rgba(0,0,0,0.08);
    }
    .v1460[data-theme="dusk"] input[type="range"]::-webkit-slider-runnable-track{
      background: linear-gradient(90deg, rgba(255,255,255,0.15), var(--accent)); border-color: rgba(255,255,255,0.15);
    }
    .v1460 input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; margin-top:-6px; width:20px; height:20px; border-radius:50%;
      border:1px solid rgba(0,0,0,0.10);
      background: radial-gradient(circle at 30% 30%, #fff, #eef2ff);
      box-shadow: 0 8px 18px rgba(13,20,41,0.15); cursor:pointer;
    }
    .v1460[data-theme="dusk"] input[type="range"]::-webkit-slider-thumb{ border-color: rgba(255,255,255,0.25); background: radial-gradient(circle at 30% 30%, #eef4ff, #cfd9ff); }
    .v1460 input[type="range"]::-moz-range-track{
      height:8px; border-radius:999px; background: linear-gradient(90deg, rgba(0,0,0,0.10), var(--accent));
      border:1px solid rgba(0,0,0,0.08);
    }
    .v1460[data-theme="dusk"] input[type="range"]::-moz-range-track{ background: linear-gradient(90deg, rgba(255,255,255,0.15), var(--accent)); border-color: rgba(255,255,255,0.15); }
    .v1460 input[type="range"]::-moz-range-thumb{
      width:20px; height:20px; border-radius:50%; border:1px solid rgba(0,0,0,0.10);
      background: radial-gradient(circle at 30% 30%, #fff, #eef2ff);
      box-shadow: 0 8px 18px rgba(13,20,41,0.15); cursor:pointer;
    }
    .v1460[data-theme="dusk"] input[type="range"]::-moz-range-thumb{ border-color: rgba(255,255,255,0.25); background: radial-gradient(circle at 30% 30%, #eef4ff, #cfd9ff); }

    /* Stage */
    .v1460 .stage{
      position:relative; z-index:1; min-height:min(70vh, 720px);
      border-radius: calc(var(--r) - 2px);
      border:1px solid rgba(0,0,0,0.06);
      background:
        radial-gradient(120% 120% at 50% 20%, rgba(255,255,255,0.6), rgba(255,255,255,0.0)),
        linear-gradient(180deg, rgba(255,255,255,0.5), rgba(255,255,255,0.25));
      overflow:hidden; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), 0 30px 100px rgba(0,0,0,0.10);
      mask-image: radial-gradient(100% 90% at 50% 50%, black 60%, transparent 130%);
    }
    .v1460[data-theme="dusk"] .stage{
      border-color: rgba(255,255,255,0.10);
      background:
        radial-gradient(140% 140% at 50% 10%, rgba(255,255,255,0.06), rgba(255,255,255,0.00)),
        linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05), 0 30px 100px rgba(0,0,0,0.34);
    }
    .v1460 canvas.stars{ position:absolute; inset:0; width:100%; height:100%; display:block; z-index:0; }

    /* Halo Orrery */
    .v1460 .halo{
      position:absolute; left:50%; top:52%;
      transform: translate(-50%,-50%);
      transform-style: preserve-3d;
      will-change: transform;
      z-index:1;
      transition: transform 0.25s ease;
    }
    .v1460 .sun{
      position:absolute; left:50%; top:50%; width:20vmin; height:20vmin; transform:translate(-50%,-50%);
      border-radius:50%;
      background: radial-gradient(circle at 35% 35%, #fff, #ffeedd 35%, transparent 60%),
                  radial-gradient(circle at 55% 55%, var(--glow1), transparent 60%),
                  radial-gradient(circle at 45% 60%, var(--glow2), transparent 70%);
      box-shadow:
        0 0 60px 20px color-mix(in oklab, var(--glow1) 60%, #ffffff 40%),
        0 0 120px 40px color-mix(in oklab, var(--glow2) 55%, #ffffff 45%),
        0 18px 60px rgba(0,0,0,0.15);
      filter: saturate(110%);
    }
    .v1460 .ring{
      --size: 48vmin;
      position:absolute; left:50%; top:50%; width:var(--size); height:var(--size); transform:translate(-50%,-50%);
      border-radius:50%;
      background:
        radial-gradient(closest-side, rgba(255,255,255,0.0) calc(100% - 1px), var(--ring) calc(100% - 1px)),
        conic-gradient(from 90deg, rgba(255,255,255,0.0) 0 70%, rgba(255,255,255,0.08) 70% 71%, transparent 71% 100%);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.4),
        0 30px 80px rgba(0,0,0,0.10);
      mask-image: radial-gradient(100% 100% at 50% 50%, black 65%, transparent 105%);
      overflow:visible;
    }
    .v1460[data-theme="dusk"] .ring{
      background:
        radial-gradient(closest-side, rgba(255,255,255,0.0) calc(100% - 1px), var(--ring) calc(100% - 1px)),
        conic-gradient(from 90deg, rgba(255,255,255,0.0) 0 70%, rgba(255,255,255,0.12) 70% 71%, transparent 71% 100%);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.06),
        0 30px 100px rgba(0,0,0,0.35);
    }
    .v1460 .ring .planet{
      --angle: 0deg;
      position:absolute; left:50%; top:50%;
      width: clamp(10px, 1.8vmin, 22px); height: clamp(10px, 1.8vmin, 22px); border-radius:50%;
      transform: rotate(var(--angle)) translateX(calc(var(--size)/2)) rotate(calc(-1 * var(--angle)));
      transform-origin: center left;
      box-shadow:
        0 0 0 1px rgba(255,255,255,0.25),
        0 12px 28px rgba(0,0,0,0.25);
      will-change: transform;
    }
    .v1460 .ring.r1{ --size: 36vmin; }
    .v1460 .ring.r2{ --size: 52vmin; }
    .v1460 .ring.r3{ --size: 68vmin; }
    .v1460 .p1{ background: radial-gradient(circle at 35% 35%, #fff, var(--glow1)); filter: saturate(120%) drop-shadow(0 0 10px var(--glow1)); }
    .v1460 .p2{ background: radial-gradient(circle at 35% 35%, #fff, var(--glow2)); filter: saturate(120%) drop-shadow(0 0 10px var(--glow2)); }
    .v1460 .p3{ background: radial-gradient(circle at 35% 35%, #fff, var(--glow3)); filter: saturate(130%) drop-shadow(0 0 10px var(--glow3)); }

    .v1460 .hint{
      position:absolute; left:50%; bottom:10%; transform:translate(-50%,0);
      color:var(--muted); font-size:12px; background: rgba(255,255,255,0.55);
      border:1px solid rgba(0,0,0,0.08); padding:8px 12px; border-radius:999px;
      backdrop-filter: blur(6px);
      animation: v1460-hint 8s ease forwards;
      pointer-events:none;
    }
    .v1460[data-theme="dusk"] .hint{ background: rgba(15,20,35,0.55); border-color: rgba(255,255,255,0.12); }
    @keyframes v1460-hint{ 0%{ opacity:0; transform:translate(-50%,6px) } 15%,45%{ opacity:1; transform:translate(-50%,0) } 100%{ opacity:0; transform:translate(-50%,0) } }

    /* Footer */
    .v1460 .foot{ position:relative; z-index:2; display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:center; color:var(--muted); font-size:12px; }
    .v1460 .meta{ display:inline-flex; gap:10px; align-items:center; white-space:nowrap; }
    .v1460 .pulse{ width:9px; height:9px; border-radius:50%; background: var(--accent); box-shadow:0 0 0 6px color-mix(in oklab, var(--accent) 30%, transparent); animation: v1460-pulse 2.4s ease-in-out infinite; }
    @keyframes v1460-pulse{ 0%,100%{ transform: scale(1); opacity:1 } 50%{ transform: scale(1.1); opacity:.95 } }

    /* Chrome hide (H) */
    .v1460.chrome-hidden .controls,
    .v1460.chrome-hidden .hint{ opacity:0; pointer-events:none; transition: opacity .3s ease; }
    .v1460.chrome-hidden .foot{ opacity:.7; }

    @media (max-width: 900px){
      .v1460 .mast{ grid-template-columns:1fr; }
      .v1460 .foot{ grid-template-columns:1fr; gap:8px; }
      .v1460 .title{ font-size: clamp(30px, 12vw, 80px); }
      .v1460 input[type="range"]{ width:120px; }
    }
    @media (prefers-reduced-motion: reduce){
      .v1460, .v1460 *{ animation:none !important; transition:none !important; }
    }
  </style>

  <div class="mast">
    <div class="brand">
      <div class="glyph" aria-hidden="true"></div>
      <div>
        <h2 class="title">HALO ORRERY</h2>
        <p class="sub">A kinetic timepiece for your cursor. Tilt to orbit; scroll to zoom; press H to hide UI.</p>
      </div>
    </div>
    <div class="controls" role="group" aria-label="Orrery controls">
      <button class="chip play" type="button" aria-pressed="true" title="Toggle motion">Play</button>
      <button class="chip theme" type="button" aria-pressed="false" title="Toggle theme">Dawn</button>
      <label class="slider" title="Tempo">
        Tempo <input class="tempo" type="range" min="0.25" max="2.5" step="0.05" value="1.00" aria-label="Tempo">
      </label>
    </div>
  </div>

  <div class="stage" aria-live="polite">
    <canvas class="stars" aria-hidden="true"></canvas>

    <div class="halo" aria-hidden="true">
      <div class="sun"></div>
      <div class="ring r1"><span class="planet p1"></span></div>
      <div class="ring r2"><span class="planet p2"></span></div>
      <div class="ring r3"><span class="planet p3"></span></div>
    </div>

    <div class="hint" aria-hidden="true">Drag to tilt • Scroll to zoom • T toggles theme • +/- adjusts tempo</div>
  </div>

  <div class="foot">
    <div class="meta">
      <span class="pulse" aria-hidden="true"></span>
      Theme: <span class="m-theme">Dawn</span> • Motion: <span class="m-play">On</span> • Tempo: <span class="m-tempo">1.00×</span> • Zoom: <span class="m-zoom">100%</span>
    </div>
    <div class="meta">
      Local: <span class="m-clock">--:--</span> • <span id="last-updated">Last updated: 2025-12-22 17:18:57 EST</span>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.v1460.orrery');
      const stage = root.querySelector('.stage');
      const halo = root.querySelector('.halo');
      const stars = root.querySelector('canvas.stars');
      const sctx = stars.getContext('2d', { alpha:true });

      const btnPlay = root.querySelector('.play');
      const btnTheme = root.querySelector('.theme');
      const elTempo = root.querySelector('.tempo');

      const mPlay = root.querySelector('.m-play');
      const mTheme = root.querySelector('.m-theme');
      const mTempo = root.querySelector('.m-tempo');
      const mZoom = root.querySelector('.m-zoom');
      const mClock = root.querySelector('.m-clock');
      const updated = root.querySelector('#last-updated');

      // Timestamp
      try{
        const now = new Date();
        const opts = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || '';
        updated.textContent = 'Updated ' + new Intl.DateTimeFormat([], opts).format(now) + ' ' + tz.replaceAll('_',' ');
      }catch(e){
        updated.textContent = 'Updated ' + new Date().toLocaleString();
      }

      // State
      const rings = [
        { el: root.querySelector('.r1 .planet'), angle: Math.random()*360, speed: 0.045 },
        { el: root.querySelector('.r2 .planet'), angle: Math.random()*360, speed: -0.028 },
        { el: root.querySelector('.r3 .planet'), angle: Math.random()*360, speed: 0.017 }
      ];

      const state = {
        playing: true,
        tempo: Number(elTempo.value),
        zoom: 1.0,
        tiltX: -8, tiltY: 16,
        tTiltX: -8, tTiltY: 16,
        raf: 0,
        stars: [],
        dpr: 1
      };

      function setPlay(on){
        state.playing = on;
        btnPlay.setAttribute('aria-pressed', String(on));
        mPlay.textContent = on ? 'On':'Off';
        if (on){
          cancelAnimationFrame(state.raf);
          state.raf = requestAnimationFrame(step);
        }
      }
      function setTempo(v){
        state.tempo = Math.max(0.25, Math.min(2.5, Number(v)));
        mTempo.textContent = state.tempo.toFixed(2) + '×';
      }
      function setZoom(v){
        state.zoom = Math.max(0.75, Math.min(1.35, Number(v)));
        halo.style.transform = `translate(-50%,-50%) rotateX(${state.tiltX}deg) rotateY(${state.tiltY}deg) scale(${state.zoom})`;
        mZoom.textContent = Math.round(state.zoom*100) + '%';
      }
      function toggleTheme(){
        const dusk = root.getAttribute('data-theme') !== 'dusk';
        root.setAttribute('data-theme', dusk ? 'dusk' : 'dawn');
        btnTheme.textContent = dusk ? 'Dusk' : 'Dawn';
        mTheme.textContent = dusk ? 'Dusk' : 'Dawn';
        drawStars(true);
      }

      function resize(){
        const rect = stage.getBoundingClientRect();
        const dpr = Math.min(2.5, window.devicePixelRatio||1);
        stars.width = Math.max(2, Math.floor(rect.width * dpr));
        stars.height = Math.max(2, Math.floor(rect.height * dpr));
        state.dpr = dpr;
        drawStars(true);
      }

      function drawStars(reset=false){
        const { width:w, height:h } = stars;
        if (reset || !state.stars.length){
          const count = Math.floor((w*h)/9000);
          state.stars = Array.from({length: count}).map(()=>({
            x: Math.random()*w,
            y: Math.random()*h,
            r: Math.random()*1.3 + 0.4,
            p: Math.random()*Math.PI*2,
            s: 0.5 + Math.random()*1.2
          }));
        }
        sctx.setTransform(1,0,0,1,0,0);
        sctx.clearRect(0,0,w,h);
        const dusk = root.getAttribute('data-theme') === 'dusk';
        for(const st of state.stars){
          const tw = dusk ? (0.6 + 0.4*Math.sin(st.p)) : (0.25 + 0.2*Math.sin(st.p));
          const c = dusk ? `rgba(230,240,255,${tw})` : `rgba(80,100,140,${tw})`;
          sctx.beginPath();
          sctx.fillStyle = c;
          sctx.arc(st.x, st.y, st.r, 0, Math.PI*2);
          sctx.fill();
        }
      }

      function tickStars(dt){
        if (!state.playing) return;
        for(const st of state.stars){ st.p += dt*0.002*st.s; }
        // slight parallax drift
        const driftX = Math.sin(performance.now()*0.00006)*0.5;
        const driftY = Math.cos(performance.now()*0.00004)*0.5;
        sctx.save();
        sctx.globalCompositeOperation = 'source-over';
        sctx.setTransform(1,0,0,1,0,0);
        sctx.clearRect(0,0,stars.width,stars.height);
        const dusk = root.getAttribute('data-theme') === 'dusk';
        for(const st of state.stars){
          const tw = dusk ? (0.6 + 0.4*Math.sin(st.p)) : (0.25 + 0.2*Math.sin(st.p));
          const c = dusk ? `rgba(230,240,255,${tw})` : `rgba(80,100,140,${tw})`;
          sctx.beginPath();
          sctx.fillStyle = c;
          sctx.arc(st.x+driftX, st.y+driftY, st.r, 0, Math.PI*2);
          sctx.fill();
        }
        sctx.restore();
      }

      function step(ts){
        const dt = 16; // steady-ish
        // ease tilt
        state.tiltX += (state.tTiltX - state.tiltX)*0.08;
        state.tiltY += (state.tTiltY - state.tiltY)*0.08;
        halo.style.transform = `translate(-50%,-50%) rotateX(${state.tiltX}deg) rotateY(${state.tiltY}deg) scale(${state.zoom})`;

        // rings update
        for(const r of rings){
          r.angle = (r.angle + r.speed*state.tempo*60) % 360;
          r.el.style.setProperty('--angle', r.angle.toFixed(2) + 'deg');
        }

        tickStars(dt);

        try{
          const now = new Date();
          mClock.textContent = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'});
        }catch(e){}

        state.raf = requestAnimationFrame(step);
      }

      // Pointer
      let dragging = false;
      stage.addEventListener('pointerdown', (e)=>{ dragging = true; stage.setPointerCapture(e.pointerId); });
      stage.addEventListener('pointerup', ()=>{ dragging = false; });
      stage.addEventListener('pointerleave', ()=>{ dragging = false; });
      stage.addEventListener('pointermove', (e)=>{
        const rect = stage.getBoundingClientRect();
        const x = (e.clientX - rect.left)/rect.width - 0.5;
        const y = (e.clientY - rect.top)/rect.height - 0.5;
        const amp = dragging ? 28 : 18;
        state.tTiltY = x * amp;
        state.tTiltX = -y * amp;
      });

      // Wheel zoom
      stage.addEventListener('wheel', (e)=>{
        e.preventDefault();
        setZoom(state.zoom + (e.deltaY>0?-0.05:0.05));
      }, {passive:false});

      // Controls
      btnPlay.addEventListener('click', ()=> setPlay(btnPlay.getAttribute('aria-pressed') !== 'true'));
      btnTheme.addEventListener('click', toggleTheme);
      elTempo.addEventListener('input', ()=> setTempo(elTempo.value));

      // Keyboard
      window.addEventListener('keydown', (e)=>{
        const k = (e.key||'').toLowerCase();
        if (e.code === 'Space'){ e.preventDefault(); setPlay(btnPlay.getAttribute('aria-pressed') !== 'true'); }
        if (k === 't'){ toggleTheme(); }
        if (k === '+'){ const v = Math.min(2.5, state.tempo+0.05); elTempo.value = String(v); setTempo(v); }
        if (k === '-'){ const v = Math.max(0.25, state.tempo-0.05); elTempo.value = String(v); setTempo(v); }
        if (k === 'h'){ root.classList.toggle('chrome-hidden'); }
      });

      // Reduced motion
      const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)');
      if (prefersReduce.matches) setPlay(false);

      // Resize + boot
      const ro = new ResizeObserver(resize);
      ro.observe(stage);
      window.addEventListener('orientationchange', resize);
      resize();
      setTempo(state.tempo);
      setZoom(state.zoom);
      if (!prefersReduce.matches) setPlay(true); else drawStars(true);

      document.addEventListener('visibilitychange', ()=>{
        if (document.hidden){ setPlay(false); }
        else if (btnPlay.getAttribute('aria-pressed') === 'true'){ setPlay(true); }
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


