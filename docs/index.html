<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v147" aria-label="Cloud Atelier — Aurora Loom">
  <style>
    .v147 {
      --ink: hsl(230 35% 12%);
      --muted: hsl(230 10% 40%);
      --ring: hsl(230 25% 60% / 0.25);
      --surface: hsl(0 0% 100% / 0.7);
      --bg-a: hsl(210 60% 99%);
      --bg-b: hsl(280 100% 98%);
      --a1: hsl(188 78% 48%);
      --a2: hsl(326 78% 56%);
      --a3: hsl(42 90% 54%);
      --tempo: 1;
      color: var(--ink);
      background:
        radial-gradient(140% 100% at 0% 0%, var(--bg-b), transparent 60%),
        radial-gradient(140% 100% at 100% 100%, var(--bg-a), transparent 60%),
        linear-gradient(180deg, hsl(0 0% 100%), hsl(0 0% 100%));
      border-radius: 28px;
      box-shadow:
        inset 0 1px 0 hsl(0 0% 100% / 0.75),
        0 30px 120px hsl(220 40% 40% / 0.08);
      font-family: ui-sans-serif, -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial;
      position: relative;
      overflow: hidden;
      min-height: 860px;
      isolation: isolate;
    }
    .v147::before {
      content: "";
      position: absolute; inset: -20%;
      background:
        radial-gradient(60% 40% at 20% 10%, hsl(188 78% 60% / 0.15), transparent 60%),
        radial-gradient(60% 40% at 80% 90%, hsl(326 78% 66% / 0.12), transparent 60%),
        conic-gradient(from 0deg at 70% 30%, hsl(42 90% 60% / 0.10), transparent 30%, hsl(188 78% 60% / 0.10), transparent 60%, hsl(326 78% 60% / 0.10) 80%, transparent 100%);
      filter: blur(40px) saturate(120%);
      pointer-events: none;
      opacity: 0.8;
    }
    .v147 .wrap { width: min(1180px, 100%); margin-inline: auto; padding: clamp(22px, 5.4vw, 56px); position: relative; z-index: 1; }

    .v147 .top { display: grid; grid-template-columns: 1fr auto; align-items: end; gap: 14px; }
    .v147 .mark {
      display: inline-flex; align-items: center; gap: 10px;
      letter-spacing: 0.18em; text-transform: uppercase;
      color: var(--muted); font-weight: 800; font-size: 11px;
    }
    .v147 .pearl {
      width: 26px; height: 26px; border-radius: 9px;
      background: linear-gradient(135deg, var(--a1), var(--a2));
      box-shadow: 0 0 0 2px hsl(0 0% 100% / 0.5) inset, 0 8px 20px hsl(230 70% 60% / 0.35);
    }
    .v147 .pill {
      padding: 8px 12px; border-radius: 999px;
      border: 1px solid var(--ring);
      background: var(--surface);
      backdrop-filter: blur(10px) saturate(140%);
      color: var(--muted); font-weight: 700; font-size: 11px;
    }

    .v147 .title {
      margin: 14px 0 6px 0;
      font-weight: 900; letter-spacing: -0.02em; line-height: 0.96;
      font-size: clamp(48px, 9vw, 110px);
      background: linear-gradient(95deg, hsl(230 30% 18%), var(--a1) 45%, var(--a2) 65%, var(--a3));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(0 10px 26px hsl(230 80% 50% / 0.18));
      text-wrap: balance;
    }
    .v147 .sub {
      color: var(--muted); font-size: clamp(14px, 2vw, 18px);
      max-width: 72ch; text-wrap: balance;
    }

    .v147 .stage {
      position: relative; margin-top: clamp(18px, 4vw, 28px);
      border-radius: 22px; overflow: hidden; min-height: 600px;
      border: 1px solid var(--ring);
      background: linear-gradient(180deg, hsl(0 0% 100%), hsl(210 60% 99%));
      box-shadow:
        0 10px 60px hsl(230 40% 30% / 0.08),
        inset 0 1px 0 hsl(0 0% 100% / 0.9);
      perspective: 800px; transform-style: preserve-3d;
    }
    .v147 canvas { position: absolute; inset: 0; width: 100%; height: 100%; display: block; }

    .v147 .ring {
      position: absolute; inset: 0; pointer-events: none;
      border-radius: 22px;
      box-shadow:
        0 0 0 1px var(--ring) inset,
        0 0 0 2px hsl(0 0% 100% / 0.8) inset;
      mask: radial-gradient(140% 120% at 50% 50%, #000 72%, transparent);
    }

    .v147 .controls {
      position: absolute; z-index: 2;
      left: 50%; bottom: clamp(10px, 4vw, 22px); transform: translateX(-50%);
      display: grid; grid-auto-flow: column; gap: 10px; align-items: center;
      background: hsl(0 0% 100% / 0.7); border: 1px solid var(--ring); border-radius: 999px; padding: 10px 12px;
      box-shadow: 0 12px 44px hsl(220 30% 40% / 0.12), 0 1px 0 hsl(0 0% 100%) inset;
      backdrop-filter: blur(14px) saturate(160%);
    }
    .v147 .btn, .v147 .toggle {
      appearance: none; cursor: pointer; user-select: none;
      border-radius: 999px; padding: 10px 14px;
      font-weight: 800; letter-spacing: 0.01em; font-size: 12px;
      color: var(--ink); border: 1px solid var(--ring);
      background: linear-gradient(180deg, hsl(0 0% 100%), hsl(0 0% 100% / 0.7));
      box-shadow: 0 1px 0 hsl(0 0% 100%) inset, 0 6px 14px hsl(220 40% 30% / 0.13);
      transition: transform 120ms ease, background 220ms ease, border-color 220ms ease, box-shadow 220ms ease, color 220ms ease;
    }
    .v147 .btn:hover, .v147 .toggle:hover { transform: translateY(-1px); }
    .v147 .btn:active, .v147 .toggle:active { transform: translateY(0); box-shadow: 0 2px 8px hsl(220 30% 40% / 0.18) inset; }
    .v147 .primary {
      color: white;
      background: linear-gradient(92deg, var(--a1), var(--a2));
      border-color: transparent;
      box-shadow: 0 10px 22px color-mix(in oklab, var(--a2), black 36%);
    }
    .v147 .toggle[aria-pressed="true"] { outline: 2px solid var(--a1); outline-offset: 2px; }

    .v147 .slider {
      display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: 8px;
      color: var(--muted); font-size: 12px;
      border: 1px solid var(--ring);
      background: linear-gradient(180deg, hsl(0 0% 100%), hsl(0 0% 100% / 0.7));
      padding: 8px 10px; border-radius: 999px;
      box-shadow: 0 1px 0 hsl(0 0% 100%) inset;
      backdrop-filter: blur(10px) saturate(140%);
    }
    .v147 input[type="range"] {
      accent-color: hsl(188 78% 48%);
      width: 160px; height: 6px; cursor: pointer; appearance: none; outline: none; border-radius: 999px;
      background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3));
    }
    .v147 input[type="range"]::-webkit-slider-thumb {
      appearance: none; width: 18px; height: 18px; border-radius: 50%;
      background: white; border: 2px solid hsl(0 0% 100% / 0.9);
      box-shadow: 0 8px 18px hsl(220 40% 40% / 0.25);
      margin-top: -6px;
    }
    .v147 input[type="range"]::-moz-range-thumb {
      width: 18px; height: 18px; border-radius: 50%;
      background: white; border: 2px solid hsl(0 0% 100% / 0.9);
    }
    .v147 .val { font-variant-numeric: tabular-nums; color: var(--ink); font-weight: 800; padding: 6px 10px; }

    .v147 .foot {
      display: flex; justify-content: space-between; align-items: center;
      padding: 20px clamp(22px, 5.4vw, 56px) 34px; color: var(--muted);
      font-size: 12px; flex-wrap: wrap; gap: 10px; position: relative; z-index: 1;
    }
    .v147 .tags { display: flex; gap: 8px; flex-wrap: wrap; }
    .v147 .tag {
      padding: 6px 10px; border-radius: 999px;
      border: 1px solid var(--ring);
      background: hsl(0 0% 100% / 0.8);
      color: var(--ink);
      backdrop-filter: blur(6px);
    }

    /* Reduced motion */
    .v147.rm * { transition: none !important; animation: none !important; }
  </style>

  <div class="wrap">
    <div class="top">
      <div class="mark">
        <span class="pearl" aria-hidden="true"></span>
        Edition 147 — Cloud Atelier
      </div>
      <div class="pill">Light · Air · Motion</div>
    </div>

    <h2 class="title">Aurora Loom</h2>
    <p class="sub">Weave color from wind. Move the air with your cursor; press save when a tapestry appears.</p>

    <div class="stage" id="v147-stage" aria-label="Generative flow field painter">
      <canvas id="v147-canvas" role="img" aria-label="Pastel ribbons flowing across a light canvas"></canvas>
      <div class="ring" aria-hidden="true"></div>

      <div class="controls" aria-label="Controls">
        <button class="btn primary" id="v147-palette" type="button" aria-label="Cycle palette">Palette: Dawn</button>
        <button class="toggle" id="v147-trails" type="button" aria-pressed="true" aria-label="Toggle trails">Trails</button>
        <button class="toggle" id="v147-glow" type="button" aria-pressed="true" aria-label="Toggle glow">Glow</button>
        <button class="btn" id="v147-reseed" type="button" aria-label="Reseed field">Reseed</button>
        <button class="btn" id="v147-play" type="button" aria-label="Pause animation">Pause</button>
        <button class="btn" id="v147-save" type="button" aria-label="Save image">Save</button>

        <label class="slider" for="v147-flow">
          <span>Flow</span>
          <input id="v147-flow" type="range" min="20" max="200" value="110" />
          <span class="val" id="v147-flow-val">1.1×</span>
        </label>

        <label class="slider" for="v147-density">
          <span>Density</span>
          <input id="v147-density" type="range" min="8" max="72" value="28" />
          <span class="val" id="v147-density-val">28</span>
        </label>
      </div>
    </div>
  </div>

  <div class="foot">
    <div class="tags" role="list" aria-label="design notes">
      <span class="tag" role="listitem">Light theme</span>
      <span class="tag" role="listitem">Flow fields</span>
      <span class="tag" role="listitem">Save as PNG</span>
    </div>
    <small><span id="last-updated">Last updated: 2025-10-23 09:30:40 EST</span></small>
  </div>

  <script>
    (function () {
      const root = document.currentScript.closest('.v147');
      const stage = root.querySelector('#v147-stage');
      const canvas = root.querySelector('#v147-canvas');
      const ctx = canvas.getContext('2d');
      const updated = root.querySelector('#last-updated');

      // Last updated timestamp
      try {
        const fmt = new Intl.DateTimeFormat([], { dateStyle: 'medium', timeStyle: 'short' });
        updated.textContent = 'Updated ' + fmt.format(new Date());
      } catch { updated.textContent = 'Updated ' + new Date().toLocaleString(); }

      const reducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (reducedMotion) root.classList.add('rm');

      // Controls
      const paletteBtn = root.querySelector('#v147-palette');
      const trailsBtn = root.querySelector('#v147-trails');
      const glowBtn = root.querySelector('#v147-glow');
      const reseedBtn = root.querySelector('#v147-reseed');
      const playBtn = root.querySelector('#v147-play');
      const saveBtn = root.querySelector('#v147-save');
      const flowEl = root.querySelector('#v147-flow');
      const flowVal = root.querySelector('#v147-flow-val');
      const densityEl = root.querySelector('#v147-density');
      const densityVal = root.querySelector('#v147-density-val');

      // Size and DPR
      let dpr = 1;
      function size() {
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        const rect = stage.getBoundingClientRect();
        canvas.width = Math.floor(rect.width * dpr);
        canvas.height = Math.floor(rect.height * dpr);
        canvas.style.width = rect.width + 'px';
        canvas.style.height = rect.height + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        // base clear
        ctx.fillStyle = 'white';
        ctx.fillRect(0, 0, rect.width, rect.height);
      }
      size();
      addEventListener('resize', size);

      // Palettes (light, airy)
      const palettes = [
        { name: 'Dawn', ui: ['hsl(188 78% 48%)','hsl(326 78% 56%)','hsl(42 90% 54%)'], inks: ['hsl(188 78% 48%)','hsl(326 78% 56%)','hsl(42 90% 54%)'] },
        { name: 'Mist', ui: ['hsl(206 86% 48%)','hsl(266 72% 62%)','hsl(152 62% 48%)'], inks: ['hsl(206 86% 48%)','hsl(266 72% 62%)','hsl(152 62% 48%)'] },
        { name: 'Bloom', ui: ['hsl(345 78% 56%)','hsl(28 90% 58%)','hsl(210 90% 50%)'], inks: ['hsl(345 78% 56%)','hsl(28 90% 58%)','hsl(210 90% 50%)'] },
        { name: 'Tide', ui: ['hsl(199 90% 46%)','hsl(171 78% 42%)','hsl(230 72% 64%)'], inks: ['hsl(199 90% 46%)','hsl(171 78% 42%)','hsl(230 72% 64%)'] }
      ];
      let paletteIndex = 0;

      function applyPalette(i) {
        const p = palettes[i];
        root.style.setProperty('--a1', p.ui[0]);
        root.style.setProperty('--a2', p.ui[1]);
        root.style.setProperty('--a3', p.ui[2]);
        paletteBtn.textContent = 'Palette: ' + p.name;
        // recolor strands next frame
        strands.forEach((s, idx) => s.color = p.inks[idx % p.inks.length]);
        flash(paletteBtn);
      }

      // Pointer + tilt
      const pointer = { x: 0.5, y: 0.5, down: false };
      function setPointer(e) {
        const rect = stage.getBoundingClientRect();
        const t = e.touches ? e.touches[0] : e;
        pointer.x = (t.clientX - rect.left) / rect.width;
        pointer.y = (t.clientY - rect.top) / rect.height;
        tilt();
      }
      function tilt() {
        if (reducedMotion) return;
        const dx = (pointer.x - 0.5);
        const dy = (pointer.y - 0.5);
        const rx = dy * -4;
        const ry = dx * 4;
        stage.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
      }
      stage.addEventListener('mousemove', setPointer, { passive: true });
      stage.addEventListener('touchmove', setPointer, { passive: true });
      stage.addEventListener('pointerleave', () => { pointer.x = 0.5; pointer.y = 0.5; tilt(); }, { passive: true });
      stage.addEventListener('pointerdown', () => pointer.down = true);
      stage.addEventListener('pointerup', () => pointer.down = false);

      function flash(el) {
        el.classList.add('primary');
        setTimeout(() => el.classList.remove('primary'), 220);
      }

      // Flow field ribbons
      let trails = true;
      let glow = true;
      let running = !reducedMotion;

      const field = {
        kx: 0.0018, ky: 0.0016, k2: 0.0009,
        w1: 0.32, w2: -0.27, w3: 0.18,
        seed: Math.random() * 1000
      };

      function reseedField() {
        field.kx = 0.0012 + Math.random() * 0.0022;
        field.ky = 0.0012 + Math.random() * 0.0022;
        field.k2 = 0.0005 + Math.random() * 0.0012;
        field.w1 = (Math.random() * 0.5 + 0.18) * (Math.random() < 0.5 ? 1 : -1);
        field.w2 = (Math.random() * 0.5 + 0.18) * (Math.random() < 0.5 ? 1 : -1);
        field.w3 = (Math.random() * 0.4 + 0.1) * (Math.random() < 0.5 ? 1 : -1);
        field.seed = Math.random() * 1000;
      }

      function vec(x, y, t) {
        const a =
          Math.sin(x * field.kx + t * field.w1 + field.seed) +
          Math.cos(y * field.ky + t * field.w2 - field.seed * 0.5) +
          Math.sin((x + y) * field.k2 + t * field.w3);
        const ang = a * Math.PI * 0.5;
        return { x: Math.cos(ang), y: Math.sin(ang) };
      }

      // Strands
      let strands = [];
      let targetCount = 28;
      const maxLen = 64;
      let flowMult = 1.1;

      function makeStrand(color) {
        const w = stage.clientWidth, h = stage.clientHeight;
        const x = Math.random() * w;
        const y = Math.random() * h;
        const pts = Array.from({ length: maxLen }, () => ({ x, y }));
        return { pts, color, wobble: Math.random() * 6.28, life: 1 };
      }

      function syncDensity() {
        const colors = palettes[paletteIndex].inks;
        while (strands.length < targetCount) strands.push(makeStrand(colors[strands.length % colors.length]));
        while (strands.length > targetCount) strands.pop();
      }

      function resetIfOut(s) {
        const w = stage.clientWidth, h = stage.clientHeight;
        const head = s.pts[0];
        if (head.x < -40 || head.x > w + 40 || head.y < -40 || head.y > h + 40 || Math.random() < 0.0008) {
          const colors = palettes[paletteIndex].inks;
          const replacement = makeStrand(colors[Math.floor(Math.random() * colors.length)]);
          s.pts = replacement.pts;
          s.color = replacement.color;
          s.wobble = replacement.wobble;
        }
      }

      function fadeCanvas() {
        const w = stage.clientWidth, h = stage.clientHeight;
        if (trails) {
          ctx.globalCompositeOperation = 'source-over';
          ctx.fillStyle = 'rgba(255,255,255,0.06)';
          ctx.fillRect(0, 0, w, h);
        } else {
          ctx.clearRect(0, 0, w, h);
          ctx.fillStyle = '#ffffff';
          ctx.fillRect(0, 0, w, h);
        }
      }

      function draw(now) {
        const w = stage.clientWidth, h = stage.clientHeight;
        const t = now * 0.001 * flowMult;

        // soft paper grain
        ctx.save();
        ctx.globalCompositeOperation = 'multiply';
        ctx.fillStyle = 'rgba(0,0,0,0.015)';
        for (let i = 0; i < 3; i++) {
          ctx.fillRect(Math.random() * w, Math.random() * h, 1, 1);
        }
        ctx.restore();

        // draw strands
        for (let i = 0; i < strands.length; i++) {
          const s = strands[i];
          const head = s.pts[0];

          // field + pointer swirl
          const v = vec(head.x, head.y, t);
          let vx = v.x, vy = v.y;

          if (pointer.down) {
            const px = pointer.x * w, py = pointer.y * h;
            const dx = head.x - px, dy = head.y - py;
            const r2 = Math.max(80, dx * dx + dy * dy);
            // swirl around pointer
            vx += -dy / r2 * 2200;
            vy += dx / r2 * 2200;
          }

          // gentle wobble per strand
          const wob = Math.sin(t * 0.7 + s.wobble) * 0.4;
          vx += wob * 0.4; vy += wob * -0.2;

          const speed = 1.1 + i * 0.0025 + flowMult * 0.4;
          const nx = head.x + vx * speed;
          const ny = head.y + vy * speed;

          // integrate head
          for (let j = s.pts.length - 1; j > 0; j--) {
            s.pts[j].x += (s.pts[j - 1].x - s.pts[j].x) * 0.32;
            s.pts[j].y += (s.pts[j - 1].y - s.pts[j].y) * 0.32;
          }
          s.pts[0].x = nx;
          s.pts[0].y = ny;

          // draw path
          ctx.save();
          ctx.globalCompositeOperation = 'multiply';
          ctx.lineJoin = 'round';
          ctx.lineCap = 'round';
          ctx.strokeStyle = s.color;
          ctx.lineWidth = 1.6 + Math.sin(t + i) * 0.4;
          if (glow) { ctx.shadowColor = s.color; ctx.shadowBlur = 12; }

          ctx.beginPath();
          for (let j = 0; j < s.pts.length; j += 2) {
            const p = s.pts[j];
            if (j === 0) ctx.moveTo(p.x, p.y);
            else ctx.lineTo(p.x, p.y);
          }
          ctx.stroke();
          ctx.restore();

          resetIfOut(s);
        }
      }

      // Animation loop
      let last = performance.now();
      function tick(now) {
        if (!running) return;
        fadeCanvas();
        draw(now);
        if (!reducedMotion) requestAnimationFrame(tick);
      }

      // UI behavior
      function setFlow(v) {
        const mult = Math.max(0.4, Math.min(2.2, Math.round((v / 100) * 10) / 10));
        flowMult = mult;
        root.style.setProperty('--tempo', String(mult));
        flowVal.textContent = mult.toFixed(1) + '×';
      }
      function setDensity(v) {
        targetCount = Math.max(8, Math.min(72, v | 0));
        densityVal.textContent = String(targetCount);
        syncDensity();
      }

      trailsBtn.addEventListener('click', () => {
        trails = !trails;
        trailsBtn.setAttribute('aria-pressed', trails ? 'true' : 'false');
        flash(trailsBtn);
      });

      glowBtn.addEventListener('click', () => {
        glow = !glow;
        glowBtn.setAttribute('aria-pressed', glow ? 'true' : 'false');
        flash(glowBtn);
      });

      playBtn.addEventListener('click', () => {
        running = !running;
        playBtn.textContent = running ? 'Pause' : 'Play';
        flash(playBtn);
        if (running && !reducedMotion) requestAnimationFrame((t) => { last = t; tick(t); });
      });

      saveBtn.addEventListener('click', () => {
        try {
          const link = document.createElement('a');
          link.download = 'aurora-loom.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
          flash(saveBtn);
        } catch {}
      });

      reseedBtn.addEventListener('click', () => {
        reseedField();
        flash(reseedBtn);
      });

      paletteBtn.addEventListener('click', () => {
        paletteIndex = (paletteIndex + 1) % palettes.length;
        applyPalette(paletteIndex);
      });

      flowEl.addEventListener('input', (e) => setFlow(Number(e.target.value)));
      densityEl.addEventListener('input', (e) => setDensity(Number(e.target.value)));

      // Keyboard shortcuts
      root.addEventListener('keydown', (e) => {
        const k = e.key.toLowerCase();
        if (k === ' ') { e.preventDefault(); playBtn.click(); }
        if (k === 'g') glowBtn.click();
        if (k === 't') trailsBtn.click();
        if (k === 'r') reseedBtn.click();
        if (k === 'p') paletteBtn.click();
        if (k === 's') saveBtn.click();
      });

      // Init
      applyPalette(paletteIndex);
      setFlow(Number(flowEl.value));
      setDensity(Number(densityEl.value));
      syncDensity();
      if (!reducedMotion) requestAnimationFrame((t) => { last = t; tick(t); });
      else {
        // Static snapshot
        fadeCanvas();
        draw(performance.now());
      }

      // Rebuild on resize
      addEventListener('resize', () => {
        size();
        syncDensity();
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


