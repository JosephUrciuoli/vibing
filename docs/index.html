<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="loom" data-theme="velvet" aria-label="Kaleido Loom — an interactive generative tapestry">
  <style>
    .loom {
      --h: 268;                  /* base hue */
      --ink: hsl(0 0% 98%);
      --bg-1: hsl(250 36% 10%);
      --bg-2: hsl(260 42% 16%);
      --stroke: color-mix(in srgb, white, transparent 82%);
      --glass-1: rgba(255,255,255,.08);
      --glass-2: rgba(255,255,255,.18);
      --tempo: 1;
      --mx: 50%;
      --my: 50%;
      position: relative;
      display: grid;
      gap: 16px;
      padding: clamp(18px, 3.6vw, 36px);
      border-radius: 28px;
      border: 1px solid var(--stroke);
      color: var(--ink);
      background:
        radial-gradient(1000px 600px at var(--mx) var(--my), rgba(255,255,255,.10), transparent 45%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro", Inter, Segoe UI, Roboto, "Helvetica Neue", Arial;
      box-shadow: 0 40px 120px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.06);
      overflow: clip;
      isolation: isolate;
    }
    .loom[data-theme="silk"]{
      --ink: hsl(220 20% 16%);
      --bg-1: hsl(240 30% 94%);
      --bg-2: hsl(250 36% 88%);
      --stroke: color-mix(in srgb, black, transparent 86%);
      --glass-1: rgba(255,255,255,.65);
      --glass-2: rgba(255,255,255,.85);
      color: var(--ink);
      box-shadow: 0 26px 80px rgba(16, 22, 40, .20), inset 0 1px 0 rgba(255,255,255,.65);
    }

    /* Ambient texture */
    .loom::after{
      content:"";
      position: absolute; inset: -12%;
      background:
        radial-gradient(1000px 380px at 14% 10%, rgba(0,0,0,.08), transparent 60%),
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220' viewBox='0 0 220 220'%3E%3Cfilter id='n'%3E%3CfeTurbulence baseFrequency='.8' numOctaves='2' type='fractalNoise'/%3E%3CfeColorMatrix values='0 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 .04 0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
      mix-blend-mode: multiply;
      opacity: .9;
      pointer-events: none;
      animation: drift 28s linear infinite;
    }
    @keyframes drift { to { transform: translate3d(2%, -2%, 0); } }

    /* Top bar */
    .loom .topbar{ display:flex; align-items:center; justify-content:space-between; gap:12px; z-index:2; }
    .loom .brand{
      display:inline-flex; align-items:center; gap:12px; padding:10px 14px;
      border-radius:999px; border:1px solid var(--stroke);
      background: linear-gradient(180deg, var(--glass-1), transparent);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 10px 30px rgba(0,0,0,.18);
      user-select:none;
    }
    .loom .logo{
      width:22px; height:22px; border-radius:8px; position:relative; display:inline-block;
      background:
        conic-gradient(from 0deg, hsl(var(--h) 85% 62%), hsl(calc(var(--h)+80) 85% 62%), hsl(calc(var(--h)+160) 85% 62%), hsl(var(--h) 85% 62%));
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.65), 0 0 16px hsl(var(--h) 90% 60% / .55);
      animation: roll calc(18s * var(--tempo)) linear infinite;
    }
    @keyframes roll { to { transform: rotate(1turn) hue-rotate(1turn); } }
    .loom .name{ font-weight:900; letter-spacing:.2px; font-size:.98rem; }

    .loom .controls{ display:flex; flex-wrap: wrap; gap:10px; }
    .loom .pill{
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, var(--glass-1), transparent);
      color: currentColor;
      padding:10px 14px; border-radius:14px; cursor:pointer; font-weight:800; letter-spacing:.25px;
      box-shadow: 0 8px 24px rgba(0,0,0,.14);
      transition: transform .16s ease, filter .24s ease, background .24s ease;
    }
    .loom .pill:hover{ transform: translateY(-1px); filter: saturate(1.05); }
    .loom .pill.primary{
      background: linear-gradient(90deg, hsl(var(--h) 78% 60%), hsl(calc(var(--h)+90) 78% 60%));
      color: #0b1022; text-shadow: 0 1px 0 rgba(255,255,255,.45);
      box-shadow: 0 12px 32px rgba(0,0,0,.2);
    }

    /* Hero */
    .loom .hero{ display:grid; gap:6px; text-align:center; z-index:2; }
    .loom h1{
      margin:0;
      font-size: clamp(2.4rem, 6.4vw, 4.8rem);
      line-height:1.02; letter-spacing:.2px;
      background: linear-gradient(90deg, hsl(calc(var(--h)+40) 85% 70%), hsl(calc(var(--h)+240) 80% 75%));
      -webkit-background-clip:text; background-clip:text; color: transparent;
      filter: drop-shadow(0 6px 18px rgba(0,0,0,.25));
    }
    .loom .sub{ margin:0 auto; max-width:62ch; color: color-mix(in srgb, var(--ink), transparent 38%); font-size: clamp(1rem, 2.1vw, 1.14rem); }

    /* Kaleido canvas */
    .loom .kaleido{
      position: relative;
      width: min(980px, 100%);
      aspect-ratio: 1 / 1;
      margin: 8px auto 0;
      border-radius: 26px;
      border: 1px solid var(--stroke);
      overflow: hidden;
      background:
        radial-gradient(120% 120% at 40% 20%, rgba(255,255,255,.10), transparent 45%),
        linear-gradient(180deg, hsl(calc(var(--h)-20) 55% 16%), hsl(calc(var(--h)+30) 60% 12%));
      box-shadow: 0 26px 70px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.06);
      transform-style: preserve-3d;
      perspective: 1000px;
    }
    .loom[data-theme="silk"] .kaleido{
      background:
        radial-gradient(110% 110% at 40% 20%, rgba(255,255,255,.55), transparent 45%),
        linear-gradient(180deg, hsl(calc(var(--h)-20) 85% 93%), hsl(calc(var(--h)+30) 82% 86%));
    }
    .loom .kaleido-svg{
      width: 100%; height: 100%;
      display: block;
      transform-origin: 50% 50%;
      transform: rotate(var(--spin, 0deg));
      transition: filter .28s ease;
      filter: saturate(1.15) contrast(1.02);
    }
    .loom .grain{
      position:absolute; inset:-10%;
      background:
        repeating-linear-gradient(90deg, rgba(255,255,255,.04) 0 1px, transparent 1px 40px),
        repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 1px, transparent 1px 40px);
      opacity:.35; mix-blend-mode: overlay; pointer-events:none;
      animation: pan 18s linear infinite;
    }
    @keyframes pan { to { transform: translate3d(2%, -2%, 0) } }

    /* Ripples */
    .loom .ripple{
      position:absolute; left:0; top:0; width:18px; height:18px; border-radius:50%;
      background: radial-gradient(circle, rgba(255,255,255,.8), rgba(255,255,255,0) 62%);
      transform: translate(-50%, -50%) scale(.6);
      animation: ring 1100ms ease-out forwards;
      mix-blend-mode: screen;
      pointer-events:none;
    }
    @keyframes ring {
      60% { transform: translate(-50%, -50%) scale(16); opacity: .28; }
      100%{ transform: translate(-50%, -50%) scale(22); opacity: 0; }
    }

    /* Meta */
    .loom .ticker{ min-height:1.4em; margin:2px auto 0; text-align:center; color: color-mix(in srgb, var(--ink), transparent 40%); font-size:.98rem; transition: opacity .22s ease; z-index:2; }
    .loom .status{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-top:1px dashed var(--stroke); padding-top:10px; margin-top:2px;
      font-size:.92rem; color: color-mix(in srgb, var(--ink), transparent 40%);
      z-index:2;
    }
    .loom #last-updated{ font-variant-numeric: tabular-nums; white-space: nowrap; }

    /* Tilt */
    .loom .tilt{ transition: transform 260ms ease; will-change: transform; }

    @media (max-width: 760px){
      .loom .status{ flex-direction: column; align-items: flex-start; gap:6px; }
    }
    @media (prefers-reduced-motion: reduce){
      .loom *, .loom *::before, .loom *::after{
        animation: none !important; transition: none !important;
      }
    }
  </style>

  <div class="topbar">
    <div class="brand">
      <span class="logo" aria-hidden="true"></span>
      <span class="name">Kaleido Loom</span>
    </div>
    <div class="controls">
      <button class="pill primary" type="button" data-action="palette">Palette</button>
      <button class="pill" type="button" data-action="pulse">Pulse</button>
      <button class="pill" type="button" data-action="shuffle">Shuffle</button>
      <button class="pill" type="button" data-action="theme"><span class="ico" aria-hidden="true">◐</span> <span class="lab">Velvet</span></button>
    </div>
  </div>

  <div class="hero">
    <h1>Weave Light</h1>
    <p class="sub">An interactive tapestry. Drag to tilt and orbit, tap to ripple, shuffle to remix the loom.</p>
  </div>

  <div class="kaleido tilt" role="img" aria-label="Generative kaleidoscopic tapestry">
    <svg class="kaleido-svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" aria-hidden="true">
      <defs>
        <filter id="glow" color-interpolation-filters="sRGB">
          <feGaussianBlur stdDeviation="0.6" result="b"/>
          <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
      </defs>
      <!-- geometry generated by script -->
    </svg>
    <div class="grain" aria-hidden="true"></div>
  </div>

  <div class="ticker" aria-live="polite"></div>

  <div class="status tilt">
    <span>Tip: Orbit with your cursor. Click inside the canvas to cast ripples.</span>
    <span id="last-updated">Last updated: 2026-02-04 01:49:55 EST</span>
  </div>

  <script>
    (function(){
      const root = document.currentScript.parentElement;
      const svg = root.querySelector('.kaleido-svg');
      const canvas = root.querySelector('.kaleido');
      const ticker = root.querySelector('.ticker');
      const lab = root.querySelector('[data-action="theme"] .lab');

      // Theme
      const saved = localStorage.getItem('loomTheme');
      if(saved) root.dataset.theme = saved;
      reflectTheme();
      root.querySelector('[data-action="theme"]').addEventListener('click', () => {
        root.dataset.theme = root.dataset.theme === 'silk' ? 'velvet' : 'silk';
        localStorage.setItem('loomTheme', root.dataset.theme);
        reflectTheme();
        speak(root.dataset.theme === 'silk' ? "Silk morning, crisp and clear." : "Velvet night, deep and warm.");
      });
      function reflectTheme(){ lab.textContent = root.dataset.theme === 'silk' ? 'Silk' : 'Velvet'; }

      // Palette
      const hues = [195, 222, 268, 312, 18, 142, 356];
      root.querySelector('[data-action="palette"]').addEventListener('click', () => {
        const hue = hues[Math.floor(Math.random()*hues.length)];
        root.style.setProperty('--h', hue);
        draw(); // recolor strokes
        speak("Palette threads shift.");
      });

      // Pulse
      let pulsing = false;
      root.querySelector('[data-action="pulse"]').addEventListener('click', () => {
        pulsing = !pulsing;
        root.style.setProperty('--tempo', pulsing ? 1.8 : 1);
        speak(pulsing ? "The loom quickens." : "The loom settles.");
      });

      // Shuffle geometry
      root.querySelector('[data-action="shuffle"]').addEventListener('click', () => {
        seed = Math.random();
        draw(true);
        speak("Pattern remixed.");
      });

      // Ticker
      const lines = [
        "Symmetry is a kind of kindness.",
        "Tension, then release.",
        "Let color breathe.",
        "Small motions, big feelings."
      ];
      let idx = 0, timer;
      function cycle(){
        ticker.style.opacity = 0;
        setTimeout(() => {
          ticker.textContent = lines[idx % lines.length];
          ticker.style.opacity = 1;
          idx++;
        }, 160);
      }
      function speak(text){
        clearInterval(timer);
        ticker.textContent = text;
        ticker.style.opacity = 1;
        timer = setInterval(cycle, 5200);
      }
      speak(lines[0]);

      // Pointer glow + tilt + orbit speed
      const tilts = root.querySelectorAll('.tilt');
      let speed = 0.035, base = 0.035, spin = 0, drag = false;
      canvas.addEventListener('pointermove', e => {
        const r = root.getBoundingClientRect();
        const px = (e.clientX - r.left) / r.width;
        const py = (e.clientY - r.top) / r.height;
        root.style.setProperty('--mx', Math.round(px*100)+'%');
        root.style.setProperty('--my', Math.round(py*100)+'%');

        const rx = (py - .5) * -8;
        const ry = (px - .5) * 8;
        tilts.forEach(el => el.style.transform = `perspective(900px) rotateX(${rx}deg) rotateY(${ry}deg)`);

        const skew = (px - .5) * .12;
        speed = base + skew * (pulsing ? 14 : 8);
      });
      canvas.addEventListener('pointerleave', () => {
        root.style.removeProperty('--mx'); root.style.removeProperty('--my');
        tilts.forEach(el => el.style.transform = 'none');
        speed = base;
      });
      canvas.addEventListener('pointerdown', () => { drag = true; });
      window.addEventListener('pointerup', () => { drag = false; });

      // Ripples
      canvas.addEventListener('click', e => {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left, y = e.clientY - rect.top;
        const r = document.createElement('span');
        r.className = 'ripple';
        r.style.left = x + 'px';
        r.style.top = y + 'px';
        canvas.appendChild(r);
        setTimeout(() => r.remove(), 1200);
        speak("A ripple threads through.");
      });

      // Kaleidoscope geometry
      let seed = Math.random();
      let slices = 16, layers = 8;
      function draw(remix=false){
        while (svg.lastChild && svg.lastChild.tagName !== 'DEFS') svg.removeChild(svg.lastChild);
        const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        group.setAttribute('filter', 'url(#glow)');
        svg.appendChild(group);

        const step = 360 / slices;
        const rnd = mulberry(seed);
        const hue = getComputedStyle(root).getPropertyValue('--h').trim() || '268';

        for(let L=0; L<layers; L++){
          const t = L / (layers - 1 || 1);
          const sat = 68 + Math.round(18*Math.sin(t*Math.PI));
          const lit = 55 + Math.round(10*Math.cos(t*Math.PI/2));
          const tint = (parseFloat(hue) + (L*22)) % 360;
          const width = 1.2 - t*0.6;
          const wobble = 6 + t*16;

          for(let i=0; i<slices; i++){
            const a0 = i * step;
            const p = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            const r0 = 10 + t*10 + rnd()*4;
            const r1 = 40 + t*22 + rnd()*8;

            const d = petal(50,50, a0, step, r0, r1, wobble, rnd);
            p.setAttribute('d', d);
            p.setAttribute('fill', 'none');
            p.setAttribute('stroke-linecap', 'round');
            p.setAttribute('stroke', `hsl(${tint} ${sat}% ${lit}%)`);
            p.setAttribute('stroke-width', width);
            p.setAttribute('opacity', 0.85);
            group.appendChild(p);
          }
        }
        if(remix){
          // occasionally change slice count to keep it fresh
          slices = [12, 14, 16, 18, 20][Math.floor(rnd()*5)];
        }
      }

      function petal(cx, cy, deg, span, r0, r1, bulge, rnd){
        const a = toRad(deg), s = toRad(span);
        const mid = a + s/2;
        const twist = (rnd()-0.5) * 0.6;
        const b = mid + twist;

        const i0 = polar(cx, cy, r0, a);
        const oM = polar(cx, cy, r1, mid);
        const i1 = polar(cx, cy, r0, a + s);
        const ctrl = polar(cx, cy, (r0 + r1)/2 + bulge*(rnd()-0.5), b);

        return `M ${i0.x.toFixed(2)} ${i0.y.toFixed(2)} Q ${ctrl.x.toFixed(2)} ${ctrl.y.toFixed(2)} ${oM.x.toFixed(2)} ${oM.y.toFixed(2)} T ${i1.x.toFixed(2)} ${i1.y.toFixed(2)}`;
      }
      function polar(cx, cy, r, ang){
        return { x: cx + r*Math.cos(ang), y: cy + r*Math.sin(ang) };
      }
      function toRad(d){ return d * Math.PI / 180; }

      // Small deterministic PRNG
      function mulberry(a){
        let t = Math.floor(a*1e9) ^ 0x9E3779B9;
        return function(){
          t |= 0; t = (t + 0x6D2B79F5) | 0;
          let r = Math.imul(t ^ (t >>> 15), 1 | t);
          r ^= r + Math.imul(r ^ (r >>> 7), 61 | r);
          return ((r ^ (r >>> 14)) >>> 0) / 4294967296;
        }
      }

      // Spin loop
      let raf;
      function loop(){
        spin += (drag ? speed*1.6 : speed) * (pulsing ? 1.8 : 1);
        svg.style.setProperty('--spin', spin + 'deg');
        raf = requestAnimationFrame(loop);
      }

      // Build initial
      draw();
      loop();

      // Last updated
      const last = root.querySelector('#last-updated');
      try{
        const dt = new Date();
        const fmt = new Intl.DateTimeFormat([], {
          year:'numeric', month:'short', day:'2-digit',
          hour:'2-digit', minute:'2-digit', timeZoneName:'short'
        }).format(dt);
        last.textContent = `Last updated: ${fmt}`;
      }catch{
        last.textContent = `Last updated: ${new Date().toLocaleString()}`;
      }

      // Resize responsiveness hint: redraw on resize for crispness
      let resizeTimer;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => draw(), 80);
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


