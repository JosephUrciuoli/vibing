<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="kin" data-theme="ivory" style="--mx:50%;--my:50%">
  <style>
    .kin{
      --ink:#0b1320;
      --muted:rgba(11,19,32,.7);
      --bg1:#f8fbff;
      --bg2:#fff7ee;
      --edge:rgba(0,0,0,.12);
      --a1:#5f8cff;
      --a2:#7ee8c6;
      --a3:#ff77b8;
      --glass:rgba(255,255,255,.6);
      position: relative;
      padding: clamp(18px,2.6vw,36px);
      border-radius: 30px;
      border: 1px solid var(--edge);
      background:
        radial-gradient(1200px 800px at var(--mx) var(--my), rgba(0,0,0,.06), transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      box-shadow: 0 28px 80px rgba(0,0,0,.18), inset 0 1px 0 rgba(255,255,255,.85);
      color: var(--ink);
      overflow: hidden;
      isolation: isolate;
      display: grid;
      grid-template-rows: auto 1fr;
      gap: clamp(16px,2.6vw,28px);
      min-height: clamp(560px, 72vh, 940px);
      font-family: ui-sans-serif, -apple-system, Inter, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    .kin::before{
      content:"";
      position:absolute; inset:-30%;
      background:
        conic-gradient(from 0deg at 70% 30%, rgba(95,140,255,.18), rgba(126,232,198,.18), rgba(255,119,184,.16), transparent 70%);
      filter: blur(60px) saturate(1.1);
      mix-blend-mode: screen;
      animation: slowTurn 50s linear infinite;
      opacity:.55; pointer-events:none;
    }
    .kin::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(700px 520px at var(--mx) var(--my), rgba(255,255,255,.45), transparent 55%),
        linear-gradient(transparent 60%, rgba(0,0,0,.06));
      mask: radial-gradient(130% 120% at 50% 40%, #000, transparent);
      pointer-events:none;
      mix-blend-mode: soft-light;
    }
    @keyframes slowTurn { to { transform: rotate(1turn); } }

    /* Noir theme */
    .kin[data-theme="noir"]{
      --ink:#eaf2ff;
      --muted:rgba(234,242,255,.78);
      --bg1:#070b14;
      --bg2:#121c2c;
      --edge:rgba(255,255,255,.14);
      --glass:rgba(255,255,255,.08);
      background:
        radial-gradient(1200px 800px at var(--mx) var(--my), rgba(255,255,255,.10), transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      box-shadow: 0 40px 120px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.06);
    }

    .row{ display:grid; justify-items:center; text-align:center; gap:10px; position:relative; z-index:2; }
    .crest{
      display:inline-flex; align-items:center; gap:10px;
      padding:8px 14px; border-radius:999px;
      border:1px solid var(--edge);
      background: var(--glass);
      color:var(--muted);
      font-weight:800; font-size:11px; letter-spacing:.28em; text-transform:uppercase;
      backdrop-filter: blur(8px);
    }
    .kin[data-theme="noir"] .crest{ background: rgba(255,255,255,.06); }

    .title{
      margin:6px 0 0;
      font-weight:1000; letter-spacing:-.035em; line-height:.86;
      font-size: clamp(54px, 9vw, 122px);
      background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3));
      -webkit-background-clip: text; background-clip:text; color: transparent;
      text-shadow: 0 6px 40px rgba(255,255,255,.08);
    }
    .subtitle{
      margin:0; max-width: 68ch; color: var(--muted);
      font-size: clamp(14px, 2vw, 18px);
    }

    .controls{
      display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-top:6px;
    }
    .btn, .chip{
      appearance:none; cursor:pointer; user-select:none;
      border-radius:16px; padding:12px 16px;
      font-weight:850; letter-spacing:.2px;
      border:1px solid rgba(0,0,0,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.76));
      color:#0b1320;
      box-shadow: 0 14px 28px rgba(0,0,0,.18), inset 0 1px 0 rgba(255,255,255,.8);
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease, background .18s ease, color .18s ease;
    }
    .btn:hover, .chip:hover{ transform: translateY(-1px); box-shadow: 0 20px 44px rgba(0,0,0,.22), inset 0 1px 0 rgba(255,255,255,.85); }
    .btn:active, .chip:active{ transform: translateY(0); }
    .ghost{
      background: var(--glass); color: var(--ink);
      border-color: var(--edge); box-shadow: inset 0 1px 0 rgba(255,255,255,.12);
      backdrop-filter: blur(8px);
    }
    .outline{ background: transparent; color: var(--ink); border-color: var(--edge); box-shadow:none; }
    .kin[data-theme="noir"] .btn, .kin[data-theme="noir"] .chip{ color:#0b1320; }
    .kin[data-theme="noir"] .ghost{ background: rgba(255,255,255,.08); color: var(--ink); }

    .knob{
      display:flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:14px; border:1px solid var(--edge);
      background: var(--glass); backdrop-filter: blur(8px);
      color: var(--ink); font-weight:700;
    }
    .knob input[type="range"]{
      -webkit-appearance:none; appearance:none; width:160px; height:8px; border-radius:999px; background: rgba(0,0,0,.1); outline:none;
    }
    .knob input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%;
      background: linear-gradient(180deg, var(--a2), var(--a3)); border:1px solid rgba(0,0,0,.22); box-shadow: 0 4px 10px rgba(0,0,0,.24);
      cursor:pointer;
    }
    .kin[data-theme="noir"] .knob{ background: rgba(255,255,255,.06); }

    .meta{
      display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:center;
      margin-top:2px; color:var(--muted); font-size:12px;
    }
    .live{ display:inline-flex; align-items:center; gap:8px; }
    .dot{
      width:8px; height:8px; border-radius:50%; background: var(--a3);
      box-shadow: 0 0 0 0 rgba(255,119,184,.6);
      animation: pulse 2s ease-out infinite;
    }
    @keyframes pulse { 0%{ box-shadow: 0 0 0 0 rgba(255,119,184,.6);} 70%{ box-shadow: 0 0 0 10px rgba(255,119,184,0);} 100%{ box-shadow: 0 0 0 0 rgba(255,119,184,0);} }

    .poster{
      position:relative; z-index:1;
      border-radius:24px; overflow:hidden;
      border:1px solid var(--edge);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.4), 0 28px 80px rgba(0,0,0,.25);
      min-height: 460px;
      background:
        radial-gradient(800px 600px at var(--mx) var(--my), rgba(255,255,255,.35), transparent 60%),
        repeating-linear-gradient(45deg, rgba(0,0,0,.04) 0 2px, transparent 2px 20px);
      display:grid; place-items:center;
    }

    svg#bloom{ width:min(88vmin, 1100px); height:min(88vmin, 1100px); display:block; overflow:visible; }
    .ring{ fill:none; stroke-linecap:round; stroke-linejoin:round; }
    .hints{
      position:absolute; right:12px; bottom:12px;
      padding:8px 10px; border-radius:12px; border:1px solid var(--edge);
      background: var(--glass); color: var(--ink); font-size:12px; backdrop-filter: blur(6px);
      pointer-events:none;
    }
    .kin[data-theme="noir"] .hints{ background: rgba(255,255,255,.06); }

    @media (max-width: 900px){
      .title{ font-size: clamp(46px, 11vw, 78px); }
      .poster{ min-height: 420px; }
      .knob input[type="range"]{ width:120px; }
    }
    @media (prefers-reduced-motion: reduce){
      .kin::before{ animation:none !important; }
    }
  </style>

  <div class="row">
    <div class="crest">Edition 440 • Kinetic Poster</div>
    <h1 class="title">Lucent Lab</h1>
    <p class="subtitle">A living print that breathes in rings. Drag the light, tune the density, let time draw the bloom.</p>

    <div class="controls">
      <button class="btn" id="themeBtn" aria-pressed="false" title="Toggle theme">Switch to Noir</button>
      <button class="btn ghost" id="runBtn" aria-pressed="true" title="Pause/Resume">Pause</button>
      <button class="btn outline" id="modeBtn" title="Cycle styles">Mode: Halo</button>
      <div class="knob" title="Petal density">
        <span>Density</span>
        <input type="range" id="density" min="24" max="220" step="2" value="120" />
      </div>
      <button class="chip ghost" id="randomBtn" title="Randomize palette">Randomize</button>
      <button class="chip outline" id="saveBtn" title="Save SVG">Save SVG</button>
    </div>

    <div class="meta">
      <span class="live"><span class="dot" aria-hidden="true"></span>Live</span>
      <span id="clock" aria-live="polite"></span>
      <span id="last-updated">Last updated: 2025-11-05 11:23:35 EST</span>
    </div>
  </div>

  <div class="poster" id="stage" aria-label="Interactive kinetic poster">
    <svg id="bloom" viewBox="-300 -300 600 600" role="img" aria-label="Generative bloom">
      <defs>
        <linearGradient id="gradStroke" x1="-1" y1="0" x2="1" y2="0">
          <stop offset="0" stop-color="var(--a1)"/>
          <stop offset="0.5" stop-color="var(--a2)"/>
          <stop offset="1" stop-color="var(--a3)"/>
        </linearGradient>
        <radialGradient id="glow" cx="0" cy="0" r="1">
          <stop offset="0" stop-color="var(--a2)" stop-opacity=".85"/>
          <stop offset=".6" stop-color="var(--a1)" stop-opacity=".2"/>
          <stop offset="1" stop-color="transparent" stop-opacity="0"/>
        </radialGradient>
        <filter id="soft">
          <feGaussianBlur stdDeviation="1.2" />
        </filter>
      </defs>

      <g id="rings"></g>

      <g id="center" filter="url(#soft)">
        <circle cx="0" cy="0" r="50" fill="url(#glow)" opacity=".55"></circle>
      </g>

      <g id="timeArcs" stroke="url(#gradStroke)" fill="none" stroke-width="6" stroke-linecap="round" opacity=".9"></g>
    </svg>

    <div class="hints" aria-hidden="true">Move = steer light • Space = pause • T/M/R/S = shortcuts</div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.kin');
      const stage = root.querySelector('#stage');
      const svg   = root.querySelector('#bloom');
      const rings = root.querySelector('#rings');
      const timeG = root.querySelector('#timeArcs');

      const btnTheme = root.querySelector('#themeBtn');
      const btnRun   = root.querySelector('#runBtn');
      const btnMode  = root.querySelector('#modeBtn');
      const btnRand  = root.querySelector('#randomBtn');
      const btnSave  = root.querySelector('#saveBtn');
      const density  = root.querySelector('#density');
      const clockEl  = root.querySelector('#clock');
      const updated  = root.querySelector('#last-updated');

      // Timestamp
      try{
        const now = new Date();
        updated.textContent = 'Updated ' + now.toLocaleString([], { weekday:'short', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' });
      }catch(e){}

      function tickClock(){
        try{
          const d = new Date();
          clockEl.textContent = d.toLocaleTimeString([], { hour:'2-digit', minute:'2-digit', second:'2-digit' }) + ' • ' + d.toLocaleDateString([], { month:'short', day:'2-digit' });
        }catch(e){}
      }
      tickClock(); const clk = setInterval(tickClock, 1000);

      // State
      const state = {
        running: true,
        mode: 0, // 0 Halo, 1 Iris, 2 Solar
        t: 0,
        dash: 0,
        layers: [],
        baseR: 220,
        mx: 0, my: 0, active: false
      };

      // Pointer for light steering
      root.addEventListener('pointermove', (e)=>{
        const R = root.getBoundingClientRect();
        const x = ((e.clientX - R.left) / R.width) * 100;
        const y = ((e.clientY - R.top) / R.height) * 100;
        root.style.setProperty('--mx', x + '%');
        root.style.setProperty('--my', y + '%');
        state.active = true;
        // bias rotation by pointer offset
        const cx = (x - 50)/50, cy = (y - 50)/50;
        svg.style.transform = `rotate(${(cx - cy) * 6}deg)`;
      }, {passive:true});
      root.addEventListener('pointerleave', ()=>{ state.active = false; svg.style.transform = 'rotate(0deg)'; });

      // Build rings
      function rebuild(){
        rings.innerHTML = '';
        state.layers = [];
        const N = parseInt(density.value, 10);
        const maxR = 250;
        const minR = 20;
        for(let i=0;i<N;i++){
          const r = minR + (i/(N-1))*(maxR-minR);
          const path = circlePath(0,0,r);
          const p = document.createElementNS('http://www.w3.org/2000/svg','path');
          p.setAttribute('d', path);
          p.setAttribute('class','ring');
          p.setAttribute('stroke','url(#gradStroke)');
          const thick = modeThickness(i,N);
          p.setAttribute('stroke-width', thick.toFixed(2));
          p.setAttribute('opacity', ringOpacity(i,N));
          p.setAttribute('vector-effect','non-scaling-stroke');

          // Dash pattern by mode
          const pattern = dashPattern(i,N);
          if(pattern){ p.setAttribute('stroke-dasharray', pattern); }

          rings.appendChild(p);
          state.layers.push(p);
        }
        draw(true);
      }

      function circlePath(cx, cy, r){
        // Full circle with two arcs for consistent stroking
        return [
          `M ${cx - r}, ${cy}`,
          `a ${r} ${r} 0 1 0 ${r*2} 0`,
          `a ${r} ${r} 0 1 0 -${r*2} 0`
        ].join(' ');
      }

      function modeThickness(i,N){
        const u = i/(N-1);
        if(state.mode===0) return 1.2 + 2.2*Math.pow(1-Math.abs(0.5-u)*2, 1.2);
        if(state.mode===1) return 0.8 + 1.6*Math.sin(u*Math.PI);
        return 1 + 1.2*(u);
      }
      function ringOpacity(i,N){
        const u = i/(N-1);
        if(state.mode===0) return 0.35 + 0.4*(1-Math.abs(0.5-u)*2);
        if(state.mode===1) return 0.22 + 0.6*Math.pow(Math.sin(u*Math.PI),1.5);
        return 0.18 + 0.6*u;
      }
      function dashPattern(i,N){
        const u = i/(N-1);
        if(state.mode===0){
          const d = 18 + 22*u; const g = 6 + 14*(1-u);
          return `${d} ${g}`;
        }else if(state.mode===1){
          const petals = 6 + Math.round(10*u);
          const arc = (2*Math.PI* (20 + 230*u))/petals; // proportional
          const gap = arc*0.6;
          return `${arc.toFixed(2)} ${gap.toFixed(2)}`;
        }else{
          const d = 4 + 3*Math.sin(u*12); const g = 10 + 18*u;
          return `${Math.abs(d).toFixed(2)} ${g.toFixed(2)}`;
        }
      }

      // Time arcs at center
      function drawTime(){
        timeG.innerHTML = '';
        const now = new Date();
        const sec = now.getSeconds() + now.getMilliseconds()/1000;
        const min = now.getMinutes() + sec/60;
        const hr  = now.getHours()%12 + min/60;

        const arcs = [
          { r: 64, frac: hr/12, w: 8, color: 'var(--a1)' },
          { r: 52, frac: min/60, w: 7, color: 'var(--a2)' },
          { r: 40, frac: sec/60, w: 6, color: 'var(--a3)' }
        ];
        for(const a of arcs){
          const end = a.frac * Math.PI*2 - Math.PI/2;
          const large = a.frac > .5 ? 1 : 0;
          const x = Math.cos(end)*a.r, y = Math.sin(end)*a.r;
          const path = [
            `M 0 ${-a.r}`,
            `A ${a.r} ${a.r} 0 ${large} 1 ${x.toFixed(2)} ${y.toFixed(2)}`
          ].join(' ');
          const p = document.createElementNS('http://www.w3.org/2000/svg','path');
          p.setAttribute('d', path);
          p.setAttribute('stroke', 'url(#gradStroke)');
          p.setAttribute('stroke-width', a.w);
          p.setAttribute('fill', 'none');
          p.setAttribute('stroke-linecap','round');
          timeG.appendChild(p);
        }
      }

      // Palette helpers
      function setPalette(a1,a2,a3){
        root.style.setProperty('--a1', a1);
        root.style.setProperty('--a2', a2);
        root.style.setProperty('--a3', a3);
      }
      function randColor(){
        const h = Math.floor(Math.random()*360);
        const s = 62 + Math.random()*18;
        const l = 52 + Math.random()*8;
        return `hsl(${h} ${s}% ${l}%)`;
      }

      // Animation
      let raf;
      function draw(staticOnly){
        state.t += 1;
        state.dash += 0.6 + (state.mode===2 ? 0.6 : 0.3);
        const wobble = Math.sin(state.t*0.01)*0.6;

        for(let i=0;i<state.layers.length;i++){
          const p = state.layers[i];
          const speed = (i/state.layers.length);
          const offset = state.dash * (0.6 + speed*1.4) * (i%2?1:-1);
          p.setAttribute('stroke-dashoffset', offset.toFixed(2));

          // subtle breathing via scale on middle rings
          if(state.mode!==2){
            const u = i/(state.layers.length-1);
            const s = 1 + wobble * (0.25*Math.sin(u*Math.PI));
            p.setAttribute('transform', `scale(${s.toFixed(4)})`);
          }else{
            p.removeAttribute('transform');
          }
        }

        drawTime();

        if(!staticOnly && state.running) raf = requestAnimationFrame(()=>draw(false));
      }

      // Controls
      btnTheme.addEventListener('click', ()=>{
        const noir = root.getAttribute('data-theme') === 'noir';
        if(noir){
          root.setAttribute('data-theme','ivory');
          btnTheme.textContent = 'Switch to Noir';
          btnTheme.setAttribute('aria-pressed','false');
        }else{
          root.setAttribute('data-theme','noir');
          btnTheme.textContent = 'Switch to Ivory';
          btnTheme.setAttribute('aria-pressed','true');
        }
      });

      btnRun.addEventListener('click', ()=>{
        state.running = !state.running;
        btnRun.textContent = state.running ? 'Pause' : 'Resume';
        btnRun.setAttribute('aria-pressed', String(state.running));
        if(state.running){ cancelAnimationFrame(raf); draw(false); }
        else cancelAnimationFrame(raf);
      });

      btnMode.addEventListener('click', ()=>{
        state.mode = (state.mode + 1) % 3;
        const names = ['Halo','Iris','Solar'];
        btnMode.textContent = 'Mode: ' + names[state.mode];
        rebuild();
      });

      density.addEventListener('input', rebuild);

      btnRand.addEventListener('click', ()=>{
        setPalette(randColor(), randColor(), randColor());
      });

      btnSave.addEventListener('click', ()=>{
        try{
          const ser = new XMLSerializer().serializeToString(svg);
          const blob = new Blob([ser], {type:'image/svg+xml;charset=utf-8'});
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = 'lucent-lab.svg';
          document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
        }catch(e){}
      });

      // Keyboard
      window.addEventListener('keydown', (e)=>{
        const k = e.key.toLowerCase();
        if(e.code === 'Space'){ e.preventDefault(); btnRun.click(); }
        else if(k === 't'){ btnTheme.click(); }
        else if(k === 'm'){ btnMode.click(); }
        else if(k === 'r'){ btnRand.click(); }
        else if(k === 's'){ btnSave.click(); }
      });

      // Start
      rebuild();
      if(state.running) raf = requestAnimationFrame(()=>draw(false));
      document.addEventListener('visibilitychange', ()=>{ if(document.hidden) cancelAnimationFrame(raf); else if(state.running) draw(false); });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


