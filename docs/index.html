<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<style>
/* Scoped to this snippet only */
.vibe777 {
  --ink: #edf2ff;
  --muted: #9aa6c6;
  --edge: rgba(255,255,255,0.12);
  --ring: #7dd3fc;
  --a: #60a5fa; /* blue */
  --b: #a78bfa; /* violet */
  --c: #34d399; /* green */
  --bg-1: #060913;
  --bg-2: #0e162b;
  --mx: 50%;
  --my: 50%;
  position: relative;
  border-radius: 30px;
  overflow: hidden;
  color: var(--ink);
  font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, system-ui;
  background:
    radial-gradient(1200px 800px at var(--mx) var(--my), rgba(125,211,252,0.12), transparent 60%),
    linear-gradient(155deg, var(--bg-1), var(--bg-2));
  box-shadow: 0 40px 120px rgba(8, 10, 22, 0.7);
  isolation: isolate;
}

/* Day theme */
.vibe777[data-theme="day"] {
  --ink: #0f172a;
  --muted: #5b647a;
  --edge: rgba(15,23,42,0.12);
  --ring: #2563eb;
  --bg-1: #f6f7ff;
  --bg-2: #eaf0ff;
  color: var(--ink);
  box-shadow: 0 30px 90px rgba(16, 24, 40, 0.18);
  background:
    radial-gradient(1200px 800px at var(--mx) var(--my), rgba(37,99,235,0.10), transparent 60%),
    linear-gradient(170deg, var(--bg-1), var(--bg-2));
}

/* soft grain + grid */
.vibe777::before {
  content: "";
  position: absolute; inset: 0;
  background:
    radial-gradient(circle at 30% 20%, rgba(255,255,255,0.04), transparent 40%),
    repeating-linear-gradient(0deg, rgba(255,255,255,0.04) 0 1px, transparent 1px 34px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.04) 0 1px, transparent 1px 34px);
  mix-blend-mode: overlay;
  pointer-events: none;
  z-index: 0;
  opacity: .45;
}

/* top chrome */
.vibe777 .chrome {
  position: relative;
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 18px;
  border-bottom: 1px solid var(--edge);
  background: linear-gradient(to bottom, rgba(255,255,255,0.08), rgba(255,255,255,0));
  backdrop-filter: blur(10px);
  z-index: 3;
}
.vibe777[data-theme="day"] .chrome { background: linear-gradient(to bottom, rgba(255,255,255,0.6), rgba(255,255,255,0)); }
.vibe777 .brand {
  display: flex; align-items: center; gap: 12px;
}
.vibe777 .logo {
  width: 30px; height: 30px; border-radius: 50%;
  position: relative;
  background: radial-gradient(65% 60% at 35% 35%, #fff, rgba(255,255,255,0) 70%);
  box-shadow: inset 0 1px 1px rgba(255,255,255,0.8), 0 10px 30px rgba(0,0,0,0.25);
}
.vibe777 .logo::after {
  content: ""; position: absolute; inset: -6px;
  border-radius: 50%;
  background: conic-gradient(from 210deg, var(--a), var(--b), var(--c), var(--a));
  filter: blur(6px) saturate(130%);
  animation: spin777 12s linear infinite;
  mix-blend-mode: screen;
}
@keyframes spin777 { to { transform: rotate(360deg); } }
.vibe777 .title {
  font-weight: 800; letter-spacing: .4px; font-size: 13px; opacity: .95;
}

/* controls */
.vibe777 .controls { display:flex; align-items:center; gap: 10px; }
.vibe777 .pill {
  appearance: none;
  border: 1px solid var(--edge);
  background: rgba(255,255,255,0.06);
  color: var(--ink);
  padding: 8px 12px;
  border-radius: 999px;
  font-size: 12px;
  cursor: pointer;
  transition: transform .15s ease, box-shadow .25s ease, background .2s ease, border-color .2s ease;
  box-shadow: 0 12px 30px rgba(0,0,0,0.18);
}
.vibe777[data-theme="day"] .pill { background: rgba(255,255,255,0.7); }
.vibe777 .pill:hover { transform: translateY(-1px); box-shadow: 0 18px 44px rgba(0,0,0,0.24); }
.vibe777 .pill[aria-pressed="true"] { outline: 2px solid var(--ring); outline-offset: 2px; }
.vibe777 .slider {
  -webkit-appearance: none; appearance: none;
  height: 10px; width: 130px; border-radius: 999px;
  background: linear-gradient(90deg, var(--a), var(--b));
  border: 1px solid var(--edge);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08), 0 12px 30px rgba(0,0,0,0.18);
}
.vibe777 .slider::-webkit-slider-thumb,
.vibe777 .slider::-moz-range-thumb {
  -webkit-appearance: none; appearance: none;
  width: 18px; height: 18px; border-radius: 50%;
  background: #fff; border: 2px solid rgba(0,0,0,0.05);
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
  cursor: grab;
}

/* layout */
.vibe777 .shell {
  display: grid;
  grid-template-columns: 1.1fr 1fr;
  gap: 20px;
  padding: 18px;
  min-height: 440px;
  z-index: 1;
}
@media (max-width: 980px) { .vibe777 .shell { grid-template-columns: 1fr; min-height: 560px; } }

/* copy panel */
.vibe777 .poster {
  position: relative;
  border: 1px solid var(--edge);
  border-radius: 24px;
  background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
  backdrop-filter: blur(6px);
  box-shadow: 0 30px 90px rgba(0,0,0,0.35);
  overflow: hidden;
  padding: 26px;
  transition: transform .2s ease, box-shadow .25s ease;
}
.vibe777[data-theme="day"] .poster {
  background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.45));
  box-shadow: 0 26px 70px rgba(0,0,0,0.16);
}
.vibe777 .poster:hover { transform: translateY(-2px); box-shadow: 0 40px 120px rgba(0,0,0,0.35); }

/* morph veil */
.vibe777 .veil {
  position: absolute; inset: -30% -20% 10% -20%;
  filter: blur(16px) saturate(120%);
  pointer-events: none;
  mix-blend-mode: screen;
  background:
    conic-gradient(from 180deg at 50% 50%, rgba(96,165,250,0.0) 0 18%, rgba(96,165,250,0.35) 32%, rgba(167,139,250,0.28) 55%, rgba(52,211,153,0.22) 72%, rgba(52,211,153,0.0) 88% 100%);
  animation: drift777 28s ease-in-out infinite alternate;
}
.vibe777[data-theme="day"] .veil { mix-blend-mode: multiply; }
@keyframes drift777 { 0% { transform: rotate(0deg) scale(1); } 100% { transform: rotate(16deg) scale(1.06); } }

.vibe777 .kicker {
  display:inline-block; font-size: 11px; letter-spacing: .28em; text-transform: uppercase;
  background: linear-gradient(90deg, var(--a), var(--c));
  -webkit-background-clip: text; background-clip: text; color: transparent;
}

.vibe777 h1 {
  margin: 12px 0 10px;
  line-height: 0.96; letter-spacing: -0.02em;
  font-size: clamp(38px, 6.2vw, 90px);
  background: linear-gradient(120deg, var(--ink), var(--a), var(--c));
  -webkit-background-clip: text; background-clip: text; color: transparent;
  filter: drop-shadow(0 10px 32px rgba(96,165,250,0.22));
  animation: shimmer777 12s ease-in-out infinite alternate;
}
@keyframes shimmer777 {
  0% { background-position: 0% 50%; }
  100% { background-position: 120% 50%; }
}
.vibe777 .sub {
  color: var(--muted); font-size: 15px; line-height: 1.7; max-width: 62ch;
}

.vibe777 .cta-row { display:flex; flex-wrap:wrap; gap: 10px; margin-top: 14px; }
.vibe777 .cta {
  border: 1px solid var(--edge);
  border-radius: 999px;
  padding: 10px 14px;
  font-size: 13px;
  background: rgba(255,255,255,0.06);
  color: var(--ink);
  cursor:pointer;
  box-shadow: 0 16px 40px rgba(0,0,0,0.28);
  transition: transform .15s ease, box-shadow .25s ease, background .2s ease;
}
.vibe777[data-theme="day"] .cta { background: rgba(255,255,255,0.7); }
.vibe777 .cta.primary {
  background: linear-gradient(135deg, rgba(96,165,250,0.28), rgba(52,211,153,0.22));
  border-color: rgba(96,165,250,0.3);
}
.vibe777 .cta:hover { transform: translateY(-1px); box-shadow: 0 22px 60px rgba(0,0,0,0.34); }

/* kinetic field panel */
.vibe777 .kinetic {
  position: relative;
  border: 1px solid var(--edge);
  border-radius: 24px;
  background: linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.02));
  overflow: hidden;
  box-shadow: 0 30px 90px rgba(0,0,0,0.35);
}
.vibe777[data-theme="day"] .kinetic { background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.45)); }
.vibe777 .field {
  position:absolute; inset:0; width:100%; height:100%; display:block; filter: saturate(120%) contrast(105%);
}
.vibe777 .kinetic::before {
  content:"";
  position: absolute; inset: 0;
  background:
    radial-gradient(700px 500px at var(--mx) var(--my), rgba(255,255,255,0.06), transparent 60%),
    repeating-linear-gradient(0deg, rgba(255,255,255,0.05), rgba(255,255,255,0.05) 1px, transparent 1px, transparent 28px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.05), rgba(255,255,255,0.05) 1px, transparent 1px, transparent 28px);
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* feature chips */
.vibe777 .chips {
  display:grid; grid-template-columns: repeat(3, 1fr); gap: 12px;
  margin-top: 16px;
}
@media (max-width: 680px) { .vibe777 .chips { grid-template-columns: 1fr; } }
.vibe777 .chip {
  position: relative;
  border: 1px solid var(--edge);
  border-radius: 16px;
  padding: 12px 14px;
  background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
  box-shadow: 0 20px 50px rgba(0,0,0,0.28);
  font-size: 13px; color: var(--muted);
  transition: transform .18s ease, box-shadow .25s ease;
}
.vibe777[data-theme="day"] .chip { background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.45)); }
.vibe777 .chip:hover { transform: translateY(-2px); box-shadow: 0 28px 80px rgba(0,0,0,0.36); }
.vibe777 .dot {
  width: 20px; height: 20px; border-radius: 7px; margin-right: 10px; flex: 0 0 auto;
  background: linear-gradient(135deg, var(--a), var(--c));
  box-shadow: inset 0 1px 1px rgba(255,255,255,0.8);
}
.vibe777 .chip strong { color: var(--ink); display:block; margin-bottom: 2px; }

/* footer */
.vibe777 .foot {
  display:flex; align-items:center; justify-content:space-between; gap: 10px;
  padding: 14px 18px 18px;
  border-top: 1px solid var(--edge);
  color: var(--muted); font-size: 12px;
  z-index:3;
}

/* ripple for taps */
.vibe777 .ripple {
  position: absolute; width: 10px; height: 10px; border-radius: 50%;
  pointer-events: none;
  background: radial-gradient(circle, rgba(255,255,255,0.9), rgba(255,255,255,0) 70%);
  transform: translate(-50%, -50%) scale(1);
  animation: ripple777 900ms ease-out forwards;
  mix-blend-mode: screen;
}
@keyframes ripple777 { to { transform: translate(-50%, -50%) scale(18); opacity: 0; } }

/* accessibility */
@media (prefers-reduced-motion: reduce) {
  .vibe777 * { animation: none !important; transition: none !important; }
  .vibe777 .veil { display: none !important; }
}
</style>

<div class="vibe777" data-theme="night" role="region" aria-label="Nebula Loom 777">
  <div class="chrome">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div class="title">Nebula Loom — 777</div>
    </div>
    <div class="controls" aria-label="Controls">
      <button class="pill" data-action="theme" aria-pressed="true" title="Toggle theme">Night</button>
      <button class="pill" data-action="palette" aria-pressed="false" title="Cycle palette">Palette</button>
      <button class="pill" data-action="pause" aria-pressed="false" title="Pause/Play motion">Pause</button>
      <input class="slider" type="range" min="0.5" max="2.0" step="0.1" value="1.0" aria-label="Flow speed">
    </div>
  </div>

  <section class="shell">
    <div class="poster">
      <div class="veil" aria-hidden="true"></div>
      <span class="kicker">Kinetic poster</span>
      <h1>Bend the quiet. Paint with motion.</h1>
      <p class="sub">A living field powered by your cursor. Lines lean, light pools, and gradients breathe—minimal, responsive, and a little bit magical.</p>
      <div class="cta-row">
        <button class="cta primary" data-action="ignite">Ignite flow</button>
        <button class="cta" data-action="snapshot">Snapshot</button>
      </div>

      <div class="chips">
        <div class="chip" role="note">
          <div style="display:flex;align-items:flex-start;">
            <div class="dot" aria-hidden="true"></div>
            <div>
              <strong>Vector field</strong>
              Particles follow a calm, musical flow—no libraries.
            </div>
          </div>
        </div>
        <div class="chip" role="note">
          <div style="display:flex;align-items:flex-start;">
            <div class="dot" style="background:linear-gradient(135deg, var(--b), var(--a))" aria-hidden="true"></div>
            <div>
              <strong>Cursor gravity</strong>
              The scene tilts toward your touch, softly.
            </div>
          </div>
        </div>
        <div class="chip" role="note">
          <div style="display:flex;align-items:flex-start;">
            <div class="dot" style="background:linear-gradient(135deg, var(--c), var(--b))" aria-hidden="true"></div>
            <div>
              <strong>Day & Night</strong>
              Contrast stays kind; color stays bold.
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="kinetic" aria-label="Kinetic field">
      <canvas class="field" aria-hidden="true"></canvas>
    </div>
  </section>

  <div class="foot">
    <span>“Clarity is a luxury we can design.”</span>
    <span id="last-updated">Last updated: 2025-11-21 02:18:11 EST</span>
  </div>
</div>

<script>
(function(){
  const root = document.currentScript.previousElementSibling;
  if (!root || !root.classList.contains('vibe777')) return;

  // Theme based on system preference
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  root.dataset.theme = prefersDark ? 'night' : 'day';
  const themeBtn = root.querySelector('[data-action="theme"]');
  themeBtn.textContent = root.dataset.theme === 'night' ? 'Night' : 'Day';
  themeBtn.setAttribute('aria-pressed', String(root.dataset.theme === 'night'));

  // Last updated
  const lu = root.querySelector('#last-updated');
  try {
    const now = new Date();
    const fmt = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'short', timeZoneName: 'short' });
    lu.textContent = 'Last updated: ' + fmt.format(now);
  } catch (e) {
    lu.textContent = 'Last updated: ' + new Date().toLocaleString();
  }

  // Palette control
  const palettes = [
    ['#60a5fa','#a78bfa','#34d399'], // aurora
    ['#f59e0b','#22d3ee','#84cc16'], // sunlit
    ['#06b6d4','#f43f5e','#8b5cf6'], // neon dusk
    ['#14b8a6','#f472b6','#38bdf8'], // lagoon
    ['#ff7aa2','#7dd3fc','#a7f3d0']  // blossom ice
  ];
  function applyPalette([A,B,C]){
    root.style.setProperty('--a', A);
    root.style.setProperty('--b', B);
    root.style.setProperty('--c', C);
    pulse(root.querySelector('.poster'), 360);
  }
  let pIndex = 0;

  // Controls
  const pauseBtn = root.querySelector('[data-action="pause"]');
  const paletteBtn = root.querySelector('[data-action="palette"]');
  const igniteBtn = root.querySelector('[data-action="ignite"]');
  const snapBtn = root.querySelector('[data-action="snapshot"]');
  const speedSlider = root.querySelector('.slider');

  themeBtn.addEventListener('click', () => {
    const t = root.dataset.theme === 'night' ? 'day' : 'night';
    root.dataset.theme = t;
    themeBtn.textContent = t === 'night' ? 'Night' : 'Day';
    themeBtn.setAttribute('aria-pressed', String(t === 'night'));
    pulse(root.querySelector('.kinetic'), 420);
  });

  paletteBtn.addEventListener('click', () => {
    pIndex = (pIndex + 1) % palettes.length;
    applyPalette(palettes[pIndex]);
    paletteBtn.setAttribute('aria-pressed', String(pIndex !== 0));
    rippleAt(root, root.getBoundingClientRect().width*0.8, 22);
  });

  let paused = false;
  pauseBtn.addEventListener('click', () => {
    paused = !paused;
    pauseBtn.setAttribute('aria-pressed', String(paused));
    setCSSPlayState(paused);
    if (paused) cancelAnimationFrame(rafId);
    else loop();
  });
  function setCSSPlayState(isPaused){
    root.querySelectorAll('*').forEach(el => el.style.animationPlayState = isPaused ? 'paused' : 'running');
  }

  // Speed
  let speed = parseFloat(speedSlider.value) || 1.0;
  speedSlider.addEventListener('input', () => { speed = parseFloat(speedSlider.value) || 1.0; });

  // Pointer: set CSS vars and attractor
  let cursor = { x: 0.5, y: 0.5 };
  function onMove(e){
    const r = root.getBoundingClientRect();
    cursor.x = (e.clientX - r.left) / r.width;
    cursor.y = (e.clientY - r.top) / r.height;
    root.style.setProperty('--mx', (cursor.x*100).toFixed(2) + '%');
    root.style.setProperty('--my', (cursor.y*100).toFixed(2) + '%');
  }
  root.addEventListener('mousemove', onMove);

  function rippleAt(container, x, y){
    const s = document.createElement('span');
    s.className = 'ripple';
    const r = container.getBoundingClientRect();
    s.style.left = (x || r.width*0.5) + 'px';
    s.style.top = (y || r.height*0.4) + 'px';
    container.appendChild(s);
    s.addEventListener('animationend', () => s.remove());
  }
  function pulse(el, duration=420){
    if (!el) return;
    el.animate([{ filter:'saturate(130%) brightness(1.1)' }, { filter:'saturate(100%) brightness(1)' }], { duration, easing:'ease' });
  }
  igniteBtn.addEventListener('click', () => {
    rippleAt(root);
    burst();
  });
  snapBtn.addEventListener('click', () => {
    try {
      const dataURL = canvas.toDataURL('image/png');
      const w = window.open('', '_blank');
      if (w) {
        w.document.write('<title>Snapshot — Nebula Loom 777</title><img alt="Kinetic snapshot" style="display:block;max-width:100%;height:auto" src="'+dataURL+'"/>');
      }
    } catch (e) { /* ignore */ }
  });

  // Canvas flow field
  const canvas = root.querySelector('.field');
  const ctx = canvas.getContext('2d', { alpha: true });
  let DPR = Math.max(1, window.devicePixelRatio || 1);
  let W = 300, H = 300;
  let rafId;
  let t = 0;
  let particles = [];
  const MAX = 320; // particle count

  function resize(){
    const rect = canvas.getBoundingClientRect();
    W = Math.max(1, Math.floor(rect.width));
    H = Math.max(1, Math.floor(rect.height));
    canvas.width = W * DPR;
    canvas.height = H * DPR;
    ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
    initParticles();
  }

  function initParticles(){
    particles = Array.from({length: MAX}, () => ({
      x: Math.random()*W,
      y: Math.random()*H,
      px: 0, py: 0,
      hue: Math.random(),
      life: Math.random()*200 + 100
    }));
    ctx.clearRect(0,0,W,H);
  }

  function fieldAngle(x, y, time){
    const s1 = 0.0016, s2 = 0.0009;
    const f = Math.sin(x*s1 + time*0.9) + Math.cos(y*s1 - time*0.7) + Math.sin((x+y)*s2 + Math.sin(time*0.4));
    return f * Math.PI; // angle
  }

  function loop(){
    const style = getComputedStyle(root);
    const a = style.getPropertyValue('--a').trim();
    const b = style.getPropertyValue('--b').trim();
    const c = style.getPropertyValue('--c').trim();
    const palette = [a,b,c];

    ctx.globalCompositeOperation = 'source-over';
    const fade = root.dataset.theme === 'night' ? 'rgba(6,9,19,0.08)' : 'rgba(246,247,255,0.08)';
    ctx.fillStyle = fade;
    ctx.fillRect(0,0,W,H);

    ctx.globalCompositeOperation = 'lighter';
    const cx = cursor.x * W;
    const cy = cursor.y * H;

    for (let i=0; i<particles.length; i++){
      const p = particles[i];
      p.px = p.x; p.py = p.y;

      // Vector field + mild attraction to cursor
      const ang = fieldAngle(p.x, p.y, t*0.6);
      const vx = Math.cos(ang), vy = Math.sin(ang);
      const dx = cx - p.x, dy = cy - p.y;
      const d = Math.hypot(dx, dy) + 0.0001;
      const attract = Math.min(0.06, 20/d/d); // gentle
      p.x += (vx*1.0 + dx/d*attract) * (0.9 + Math.random()*0.3) * speed;
      p.y += (vy*1.0 + dy/d*attract) * (0.9 + Math.random()*0.3) * speed;

      // wrap
      if (p.x < -2) p.x = W+2; if (p.x > W+2) p.x = -2;
      if (p.y < -2) p.y = H+2; if (p.y > H+2) p.y = -2;

      // draw
      const col = palette[i % palette.length];
      ctx.strokeStyle = col;
      ctx.globalAlpha = 0.26 + ((i%3)/10);
      ctx.lineWidth = 1.0 + (i%5===0 ? 0.4 : 0);
      ctx.beginPath();
      ctx.moveTo(p.px, p.py);
      ctx.lineTo(p.x, p.y);
      ctx.stroke();

      // life
      if (--p.life < 0) {
        p.x = Math.random()*W; p.y = Math.random()*H;
        p.life = Math.random()*200 + 120;
      }
    }

    t += 0.008 * speed;
    if (!paused) rafId = requestAnimationFrame(loop);
  }

  function burst(){
    // radial nudge on particles near center for a playful burst
    const cx = cursor.x * W;
    const cy = cursor.y * H;
    for (let i=0; i<particles.length; i++){
      const p = particles[i];
      const dx = p.x - cx, dy = p.y - cy;
      const d = Math.hypot(dx, dy);
      if (d < Math.min(W,H)*0.35) {
        const k = 2.0 - d/Math.min(W,H)*0.35;
        p.x += (dx/(d+0.001)) * 16 * k;
        p.y += (dy/(d+0.001)) * 16 * k;
      }
    }
  }

  window.addEventListener('resize', resize, { passive: true });
  resize();

  if (!(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches)) {
    loop();
  } else {
    paused = true;
    pauseBtn.setAttribute('aria-pressed','true');
  }

  // Focus rings
  root.querySelectorAll('button, input[type="range"]').forEach(el => {
    el.addEventListener('focus', () => el.style.outline = `2px solid var(--ring)`);
    el.addEventListener('blur', () => el.style.outline = 'none');
  });
})();
</script>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


