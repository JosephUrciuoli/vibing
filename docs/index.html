<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="loom998" data-grid="off" data-grain="on" data-glow="on" tabindex="0" role="region" aria-label="Nebula Loom — a living gradient tapestry you can guide">
  <style>
    /* Design tokens */
    #loom998{
      --bg1:#0a0f1f; --bg2:#0f1630;
      --ink:#ecf3ff; --muted:#9fb0ff;
      --c1:#7aa6ff; --c2:#4ff3d4; --c3:#ff99e7; --c4:#c7d2ff;
      --bloom:1;
      --ring:#ffffff18;
      --edge:#ffffff24;
      --glass: rgba(255,255,255,.08);
      --lx:50%; --ly:50%;
      position:relative; isolation:isolate;
      min-height:76vh; padding: clamp(14px, 3.4vw, 28px); border-radius:36px; overflow:hidden;
      color:var(--ink);
      font-family: ui-sans-serif, -apple-system, Inter, "SF Pro", Segoe UI, Roboto, "Noto Sans", Arial, sans-serif;
      background: radial-gradient(1200px 900px at 66% 28%, color-mix(in oklab, var(--c3) 12%, transparent), transparent 60%), linear-gradient(180deg, var(--bg1), var(--bg2));
      box-shadow:
        0 1px 0 rgba(255,255,255,.05) inset,
        0 0 0 1px rgba(255,255,255,.08) inset,
        0 70px 240px rgba(0,0,0,.60);
    }

    /* Header chrome */
    #loom998 .chrome{
      position:relative; z-index:3;
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
      border:1px solid var(--edge); border-radius:22px; padding:10px 12px;
      background: color-mix(in oklab, var(--glass) 70%, transparent);
      backdrop-filter: blur(14px) saturate(120%);
      box-shadow: 0 12px 36px rgba(0,0,0,.28);
    }
    #loom998 .brand{ display:flex; align-items:center; gap:10px; letter-spacing:.18em; text-transform:uppercase; font-weight:900; font-size:12px; color:var(--muted); }
    #loom998 .logo{ width:22px; height:22px; display:block; filter: drop-shadow(0 2px 8px rgba(0,0,0,.35)); }
    #loom998 .logo .g{ transform-origin:50% 50%; animation: spin998 12s linear infinite; }
    @keyframes spin998{ to{ transform: rotate(360deg); } }

    #loom998 .actions{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    #loom998 button, #loom998 .toggle, #loom998 .slider{
      appearance:none; border:1px solid var(--edge); color:var(--ink);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer;
      transition: transform 120ms ease, box-shadow 220ms ease, background 240ms ease, color .2s ease;
      box-shadow: 0 2px 0 rgba(0,0,0,.28); user-select:none; font-size:12px;
    }
    #loom998 button:hover{ transform: translateY(-1px); box-shadow: 0 12px 28px rgba(0,0,0,.24); }
    #loom998 .toggle, #loom998 .slider{ display:inline-flex; align-items:center; gap:10px; color:var(--muted); }
    #loom998 .toggle input{
      appearance:none; width:44px; height:24px; border-radius:999px; background: rgba(255,255,255,.12); position:relative; border:1px solid var(--edge);
    }
    #loom998 .toggle input::after{
      content:""; position:absolute; top:3px; left:3px; width:18px; height:18px; border-radius:50%; background:#fff; border:1px solid var(--edge);
      box-shadow:0 2px 6px rgba(0,0,0,.18); transition: transform 160ms ease;
    }
    #loom998 .toggle input:checked{ background: linear-gradient(90deg, var(--c1), var(--c2)); }
    #loom998 .toggle input:checked::after{ transform: translateX(18px); }
    #loom998 .slider input[type="range"]{ width:160px; height:18px; background:transparent; -webkit-appearance:none; }
    #loom998 .slider input[type="range"]::-webkit-slider-runnable-track{ height:6px; border-radius:999px; background: linear-gradient(90deg, var(--c2), var(--c3)); opacity:.9; }
    #loom998 .slider input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; width:18px; height:18px; border-radius:50%; background:#fff; border:1px solid var(--edge); margin-top:-6px;
      box-shadow:0 2px 6px rgba(0,0,0,.18);
    }
    #loom998 .slider input[type="range"]::-moz-range-track{ height:6px; border-radius:999px; background: linear-gradient(90deg, var(--c2), var(--c3)); opacity:.9; }
    #loom998 .slider input[type="range"]::-moz-range-thumb{
      width:18px; height:18px; border-radius:50%; background:#fff; border:1px solid var(--edge); box-shadow:0 2px 6px rgba(0,0,0,.18);
    }

    /* Stage */
    #loom998 .stage{
      position:relative; z-index:1; margin-top:16px;
      border:1px solid var(--edge); border-radius:28px; overflow:hidden;
      background: linear-gradient(180deg, color-mix(in oklab, var(--glass) 64%, transparent), color-mix(in oklab, var(--glass) 30%, transparent));
      backdrop-filter: blur(12px) saturate(130%);
      box-shadow: 0 22px 70px rgba(0,0,0,.34);
      min-height: clamp(460px, 62vh, 760px);
    }
    #loom998 canvas{
      position:absolute; inset:0; width:100%; height:100%;
      filter:
        drop-shadow(0 0 24px color-mix(in oklab, var(--c2) calc(24%*var(--bloom)), transparent))
        drop-shadow(0 0 36px color-mix(in oklab, var(--c3) calc(20%*var(--bloom)), transparent))
        saturate(120%);
      transition: filter .25s ease;
    }
    #loom998[data-glow="off"] canvas{ filter: saturate(110%); }
    #loom998 .title{
      position:relative; z-index:2; pointer-events:none;
      display:grid; place-items:center; text-align:center; inset:0; min-height:100%;
    }
    #loom998 .hero{
      margin:0;
      font-weight:1000; letter-spacing:-.02em; line-height:.9;
      font-size: clamp(44px, 10vw, 132px);
      color: transparent;
      background: linear-gradient(90deg, var(--c1), var(--c2), var(--c3), var(--c1));
      background-size: 220% 100%;
      -webkit-background-clip: text; background-clip: text;
      animation: sheen998 18s linear infinite;
      filter: drop-shadow(0 6px 18px color-mix(in oklab, var(--c1) 24%, transparent));
    }
    @keyframes sheen998{ 0%{ background-position: 0% 0; } 100%{ background-position: 200% 0; } }
    #loom998 .lede{
      margin:10px auto 0; color:var(--muted); font-size: clamp(13px, 1.6vw, 18px); line-height:1.7; text-wrap:balance; max-width:72ch;
    }

    /* Lens */
    #loom998 .lens{
      position:absolute; z-index:2; width: clamp(140px, 24vmin, 240px); aspect-ratio:1/1; border-radius:50%;
      left:var(--lx); top:var(--ly); transform: translate(-50%,-50%) scale(1);
      pointer-events:none;
      background:
        radial-gradient(closest-side, #fff8 0, #fff0 60%),
        radial-gradient(closest-side, color-mix(in oklab, var(--c2) 30%, transparent), transparent 70%);
      border:1px solid var(--ring);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.06),
        0 20px 60px rgba(0,0,0,.35),
        0 0 0 8px rgba(255,255,255,.02);
      mix-blend-mode: color-dodge;
      opacity:.85;
      transition: opacity .28s ease, transform .28s ease;
    }
    #loom998 .stage:hover .lens{ opacity:1; transform: translate(-50%,-50%) scale(1.04); }

    /* Overlays */
    #loom998 .grid{
      position:absolute; inset:0; z-index:1; pointer-events:none; opacity:.22; display:none;
      background-image:
        linear-gradient(to right, var(--ring) 1px, transparent 1px),
        linear-gradient(to bottom, var(--ring) 1px, transparent 1px),
        linear-gradient(45deg, transparent 49%, var(--ring) 50%, transparent 51%),
        linear-gradient(-45deg, transparent 49%, var(--ring) 50%, transparent 51%);
      background-size: 40px 40px, 40px 40px, 40px 40px, 40px 40px;
      mix-blend-mode: overlay;
    }
    #loom998[data-grid="on"] .grid{ display:block; }

    #loom998 .grain{
      position:absolute; inset:-2px; z-index:1; opacity:.10; mix-blend-mode: overlay; pointer-events:none; display:block;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.55'/%3E%3C/svg%3E");
    }
    #loom998[data-grain="off"] .grain{ display:none; }

    /* Meta */
    #loom998 .meta{
      margin-top:14px; color:var(--muted); font-size:12px; display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }

    /* Focus */
    #loom998 :is(button, input, [tabindex]):focus-visible{
      outline: 2px solid color-mix(in oklab, var(--c1) 55%, #fff);
      outline-offset: 2px;
    }

    @media (max-width: 880px){
      #loom998 .slider input[type="range"]{ width:130px; }
      #loom998 .hero{ font-size: clamp(42px, 12vw, 112px); }
      #loom998 .lens{ width: clamp(120px, 30vmin, 220px); }
    }
    @media (prefers-reduced-motion: reduce){
      #loom998 .hero, #loom998 .logo .g{ animation: none !important; }
      #loom998 canvas{ filter: none; }
    }
  </style>

  <div class="chrome">
    <div class="brand">
      <svg class="logo" viewBox="0 0 32 32" aria-hidden="true">
        <defs>
          <linearGradient id="lg998" x1="0" y1="0" x2="32" y2="32">
            <stop offset="0%" stop-color="var(--c1)"/><stop offset="50%" stop-color="var(--c2)"/><stop offset="100%" stop-color="var(--c3)"/>
          </linearGradient>
        </defs>
        <g class="g">
          <path d="M16 2 L29 11 L16 30 L3 11 Z" fill="url(#lg998)" opacity=".95"/>
          <circle cx="16" cy="16" r="4" fill="var(--ink)" opacity=".15"/>
        </g>
      </svg>
      <span>Nebula Loom • 998</span>
    </div>
    <div class="actions">
      <button id="palette998" title="Cycle palette">Palette</button>
      <label class="slider" title="Tempo">
        Tempo
        <input type="range" id="tempo998" min="0.30" max="2.00" step="0.01" value="1.00">
      </label>
      <label class="toggle" title="Grain">
        Grain
        <input type="checkbox" id="grain998" checked>
      </label>
      <label class="toggle" title="Glow">
        Glow
        <input type="checkbox" id="glow998" checked>
      </label>
      <button id="grid998" title="Toggle grid">Grid</button>
    </div>
  </div>

  <div class="stage" role="img" aria-label="Glowing, blending orbs weave across a gradient field you can guide with your pointer">
    <canvas id="field998"></canvas>
    <div class="grid" aria-hidden="true"></div>
    <div class="grain" aria-hidden="true"></div>
    <div class="lens" aria-hidden="true"></div>
    <div class="title">
      <h1 class="hero">Weave light.</h1>
      <p class="lede">Drag to shepherd the glow. P palette • G grid • Space pause</p>
    </div>
  </div>

  <div class="meta">
    <span id="last-updated">Last updated: 2025-12-01 07:39:42 EST</span>
    <span class="keys">Keys: P palette • G grid • Space pause</span>
  </div>

  <script>
    (function(){
      const root = document.getElementById('loom998');
      const canvas = root.querySelector('#field998');
      const ctx = canvas.getContext('2d', { alpha: true });
      const lens = root.querySelector('.lens');

      // Timestamp
      try{
        const d = new Date();
        const fmt = new Intl.DateTimeFormat([], { month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' });
        root.querySelector('#last-updated').textContent = 'Last updated: ' + fmt.format(d);
      }catch{}

      // Palettes
      const palettes = [
        { name:'Aurora', colors:['#7aa6ff','#4ff3d4','#ff99e7','#c7d2ff'], bg:['#0a0f1f','#0f1630'], ink:'#ecf3ff', muted:'#9fb0ff' },
        { name:'Sunset', colors:['#ff8aa3','#ffd36f','#9ea6ff','#ff9fd5'], bg:['#1b0f16','#301625'], ink:'#ffeef8', muted:'#ffcbdc' },
        { name:'Marine', colors:['#20c7a6','#5be3c3','#9ae2ff','#46ffd9'], bg:['#041c17','#0b342c'], ink:'#eafff8', muted:'#9ee1d0' },
        { name:'Paper', colors:['#6b7cff','#53a6ff','#ff8ad6','#ffd889'], bg:['#f6fbff','#e9f3ff'], ink:'#0e1323', muted:'#5b6a84' },
        { name:'Violet', colors:['#bb86ff','#7ad5ff','#ff7ad5','#a7b3ff'], bg:['#14081f','#241046'], ink:'#ece6ff', muted:'#cdbbff' }
      ];
      let paletteIndex = 0;

      function applyPalette(p){
        // Colors
        root.style.setProperty('--c1', p.colors[0]);
        root.style.setProperty('--c2', p.colors[1]);
        root.style.setProperty('--c3', p.colors[2]);
        root.style.setProperty('--c4', p.colors[3]);
        root.style.setProperty('--bg1', p.bg[0]);
        root.style.setProperty('--bg2', p.bg[1]);
        root.style.setProperty('--ink', p.ink);
        root.style.setProperty('--muted', p.muted);
        paletteBtn.textContent = 'Palette • ' + p.name;
        // repaint background of container (handled by CSS vars)
      }

      const paletteBtn = root.querySelector('#palette998');
      paletteBtn.addEventListener('click', ()=>{
        paletteIndex = (paletteIndex + 1) % palettes.length;
        applyPalette(palettes[paletteIndex]);
      });
      applyPalette(palettes[paletteIndex]);

      // Controls
      const tempo = root.querySelector('#tempo998');
      const grainToggle = root.querySelector('#grain998');
      const glowToggle = root.querySelector('#glow998');
      const gridBtn = root.querySelector('#grid998');

      function syncToggles(){
        root.setAttribute('data-grain', grainToggle.checked ? 'on' : 'off');
        root.setAttribute('data-glow',  glowToggle.checked ? 'on' : 'off');
      }
      grainToggle.addEventListener('change', syncToggles);
      glowToggle.addEventListener('change', syncToggles);
      syncToggles();

      gridBtn.addEventListener('click', ()=>{
        root.setAttribute('data-grid', root.getAttribute('data-grid')==='on' ? 'off' : 'on');
        gridBtn.textContent = 'Grid • ' + (root.getAttribute('data-grid')==='on' ? 'on' : 'off');
      });
      gridBtn.textContent = 'Grid • off';

      // Canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
      function resize(){
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
        const r = canvas.getBoundingClientRect();
        canvas.width = Math.max(300, Math.floor(r.width * dpr));
        canvas.height = Math.max(300, Math.floor(r.height * dpr));
      }
      resize();
      let rsTO; window.addEventListener('resize', ()=>{ clearTimeout(rsTO); rsTO = setTimeout(resize, 120); }, {passive:true});

      // Field simulation: luminous orbs with additive blend
      const ORB_COUNT = 10;
      const orbs = [];
      function rand(min,max){ return Math.random()*(max-min)+min; }
      function seedOrbs(){
        orbs.length = 0;
        const cols = palettes[paletteIndex].colors;
        for(let i=0;i<ORB_COUNT;i++){
          const r = rand(60, 160);
          orbs.push({
            x: rand(r, canvas.width - r),
            y: rand(r, canvas.height - r),
            vx: rand(-0.4, 0.4),
            vy: rand(-0.4, 0.4),
            r,
            c: cols[i % cols.length]
          });
        }
      }
      seedOrbs();

      // Interaction: "wind" vector nudged by pointer
      let wind = {x:0, y:0};
      let targetWind = {x:0, y:0};
      let dragging = false;

      function setLens(e){
        const rect = canvas.getBoundingClientRect();
        const x = Math.max(0, Math.min(rect.width, e.clientX - rect.left));
        const y = Math.max(0, Math.min(rect.height, e.clientY - rect.top));
        // CSS lens position
        const lx = (x / rect.width)*100;
        const ly = (y / rect.height)*100;
        root.style.setProperty('--lx', lx.toFixed(2)+'%');
        root.style.setProperty('--ly', ly.toFixed(2)+'%');
        // target wind influenced by pointer delta from center
        const cx = rect.width/2, cy = rect.height/2;
        targetWind.x = (x - cx) / rect.width;
        targetWind.y = (y - cy) / rect.height;
      }

      root.querySelector('.stage').addEventListener('pointermove', (e)=>{ setLens(e); if(dragging) { targetWind.x *= 2.2; targetWind.y *= 2.2; } }, {passive:true});
      root.querySelector('.stage').addEventListener('pointerdown', (e)=>{ dragging = true; setLens(e); }, {passive:true});
      window.addEventListener('pointerup', ()=>{ dragging=false; }, {passive:true});
      // Start lens at center
      (function seedLens(){
        const rect = canvas.getBoundingClientRect();
        root.style.setProperty('--lx', '50%'); root.style.setProperty('--ly','50%');
        targetWind.x = 0; targetWind.y = 0;
      })();

      // Reduced motion
      let REDUCE=false;
      try{ REDUCE = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches; }catch{}
      if(REDUCE){ tempo.value = '0.50'; }

      // Animation loop
      let paused = false;
      let t0 = performance.now();

      function render(now){
        if(paused){ requestAnimationFrame(render); return; }
        const dt = Math.min(0.04, (now-(t0||now))/1000); t0=now;

        // Ease wind and read tempo
        const tempoMul = Math.max(0.2, Math.min(2, parseFloat(tempo.value)||1));
        wind.x += (targetWind.x - wind.x) * 0.06;
        wind.y += (targetWind.y - wind.y) * 0.06;

        // Clear with background gradient
        ctx.setTransform(1,0,0,1,0,0);
        const w = canvas.width, h = canvas.height;
        const g = ctx.createLinearGradient(0,0,0,h);
        g.addColorStop(0, getComputedStyle(root).getPropertyValue('--bg1').trim());
        g.addColorStop(1, getComputedStyle(root).getPropertyValue('--bg2').trim());
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        // Draw orbs with additive glow
        ctx.globalCompositeOperation = 'lighter';
        for(const o of orbs){
          o.x += (o.vx + wind.x*1.4)*tempoMul;
          o.y += (o.vy + wind.y*1.4)*tempoMul;

          // bounce
          if(o.x < o.r || o.x > w - o.r){ o.vx *= -1; }
          if(o.y < o.r || o.y > h - o.r){ o.vy *= -1; }
          o.x = Math.max(o.r, Math.min(w - o.r, o.x));
          o.y = Math.max(o.r, Math.min(h - o.r, o.y));

          const grad = ctx.createRadialGradient(o.x, o.y, 0, o.x, o.y, o.r);
          grad.addColorStop(0, o.c + (o.c.length===7 ? 'cc':''));
          grad.addColorStop(0.5, o.c + (o.c.length===7 ? '66':''));
          grad.addColorStop(1, '#00000000');

          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(o.x, o.y, o.r, 0, Math.PI*2);
          ctx.fill();

          // Soft core
          ctx.fillStyle = '#ffffff0f';
          ctx.beginPath(); ctx.arc(o.x, o.y, Math.max(6, o.r*0.10), 0, Math.PI*2); ctx.fill();
        }

        // Filaments between nearest neighbors
        ctx.globalCompositeOperation = 'lighter';
        for(let i=0;i<orbs.length;i++){
          for(let j=i+1;j<orbs.length;j++){
            const a = orbs[i], b = orbs[j];
            const dx = a.x - b.x, dy = a.y - b.y;
            const d2 = dx*dx + dy*dy;
            const max = (a.r + b.r)*1.2;
            if(d2 < max*max){
              const d = Math.sqrt(d2);
              const alpha = Math.max(0, 1 - d/max) * 0.25;
              ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
              ctx.lineWidth = 2 * dpr;
              ctx.beginPath(); ctx.moveTo(a.x, a.y); ctx.lineTo(b.x, b.y); ctx.stroke();
            }
          }
        }

        requestAnimationFrame(render);
      }
      requestAnimationFrame(render);

      // Keyboard: P palette, G grid, Space pause
      root.addEventListener('keydown', (e)=>{
        if(e.key==='p' || e.key==='P'){ e.preventDefault(); paletteBtn.click(); }
        if(e.key==='g' || e.key==='G'){ e.preventDefault(); gridBtn.click(); }
        if(e.key===' '){
          e.preventDefault();
          paused = !paused;
          if(!paused){ t0 = performance.now(); }
        }
      }, {passive:false});

      // Re-seed orbs on resize occasionally
      let reseedTO;
      window.addEventListener('resize', ()=>{
        clearTimeout(reseedTO);
        reseedTO = setTimeout(()=>{ seedOrbs(); }, 220);
      }, {passive:true});
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


