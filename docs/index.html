<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section id="vibe2405" data-theme="nebula" aria-label="Orbit Studio">
  <style>
    /* Scoped to #vibe2405 */
    #vibe2405 {
      --r: 28px;

      /* Theme: Nebula (default) */
      --bg: hsl(255 45% 7%);
      --bg2: hsl(220 60% 12%);
      --fg: hsl(0 0% 98%);
      --muted: hsl(0 0% 88% / 0.75);
      --line: hsl(0 0% 100% / 0.14);
      --p1: hsl(196 90% 62%);
      --p2: hsl(286 86% 64%);
      --p3: hsl(16 92% 60%);

      position: relative;
      isolation: isolate;
      color: var(--fg);
      background:
        radial-gradient(1400px 1000px at 120% -10%, hsl(286 60% 30% / 0.35), transparent 60%),
        radial-gradient(1100px 900px at -10% 120%, hsl(196 60% 28% / 0.35), transparent 60%),
        radial-gradient(100% 180% at 50% 0%, var(--bg2), var(--bg));
      border-radius: var(--r);
      border: 1px solid var(--line);
      box-shadow: 0 40px 120px hsl(0 0% 0% / 0.6), inset 0 0 0 1px hsl(0 0% 100% / 0.06);
      min-height: 78vh;
      padding: clamp(18px, 4vw, 48px);
      font: 400 15px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      overflow: hidden;
      container-type: inline-size;
    }

    /* Theme: Aurora (light, airy) */
    #vibe2405[data-theme="aurora"] {
      --bg: hsl(200 55% 96%);
      --bg2: hsl(150 60% 94%);
      --fg: hsl(232 24% 12%);
      --muted: hsl(232 12% 38% / 0.85);
      --line: hsl(232 12% 24% / 0.18);
      --p1: hsl(168 85% 45%);
      --p2: hsl(264 86% 52%);
      --p3: hsl(22 90% 56%);
      background:
        radial-gradient(1200px 860px at -10% -10%, hsl(168 70% 80% / 0.5), transparent 60%),
        radial-gradient(1200px 900px at 120% 120%, hsl(264 70% 85% / 0.45), transparent 60%),
        radial-gradient(100% 180% at 50% 0%, var(--bg2), var(--bg));
      box-shadow: 0 30px 90px hsl(232 50% 10% / 0.2), inset 0 0 0 1px hsl(0 0% 100% / 0.7);
    }

    /* Theme: Mono (hi-contrast minimal) */
    #vibe2405[data-theme="mono"] {
      --bg: hsl(0 0% 6%);
      --bg2: hsl(0 0% 12%);
      --fg: hsl(0 0% 98%);
      --muted: hsl(0 0% 85% / 0.78);
      --line: hsl(0 0% 100% / 0.16);
      --p1: hsl(52 100% 65%);
      --p2: hsl(0 0% 100%);
      --p3: hsl(52 100% 65%);
      background:
        radial-gradient(1200px 860px at 120% -20%, hsl(0 0% 100% / 0.06), transparent 60%),
        radial-gradient(1200px 860px at -20% 120%, hsl(0 0% 100% / 0.06), transparent 60%),
        radial-gradient(100% 180% at 50% 0%, var(--bg2), var(--bg));
    }

    /* Ambient veils */
    #vibe2405::before, #vibe2405::after {
      content: "";
      position: absolute; inset: -30%;
      filter: blur(70px) saturate(130%);
      mix-blend-mode: screen;
      opacity: 0.55;
      pointer-events: none;
      z-index: 0;
    }
    #vibe2405::before {
      background:
        conic-gradient(from 20deg at 30% 60%, var(--p1), transparent 65%),
        conic-gradient(from -40deg at 70% 40%, var(--p2), transparent 65%);
      animation: v2405-wash-a 28s ease-in-out infinite alternate;
    }
    #vibe2405::after {
      background: conic-gradient(from 100deg at 50% 45%, var(--p3), transparent 70%);
      animation: v2405-wash-b 36s ease-in-out infinite alternate-reverse;
    }

    /* Fine grain */
    #vibe2405 .grain {
      position: absolute; inset: 0; z-index: 1; pointer-events: none;
      background:
        repeating-linear-gradient(0deg, hsl(0 0% 100% / 0.02) 0 1px, transparent 1px 34px),
        repeating-linear-gradient(90deg, hsl(0 0% 0% / 0.03) 0 1px, transparent 1px 34px);
      mask: radial-gradient(120% 90% at 50% 20%, black, transparent);
    }

    /* Top bar */
    #vibe2405 .top {
      position: relative; z-index: 3;
      display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 12px;
      margin-bottom: clamp(12px, 3.8vw, 28px);
    }
    #vibe2405 .brand {
      display: inline-grid; grid-auto-flow: column; place-items: center; gap: 12px;
      padding: 10px 14px; border-radius: 14px; border: 1px solid var(--line);
      background: hsl(0 0% 100% / 0.06);
      backdrop-filter: blur(10px) saturate(160%);
      color: var(--fg); font-weight: 900; letter-spacing: 0.08em; text-transform: uppercase; font-size: 12px;
    }
    #vibe2405[data-theme="aurora"] .brand { background: hsl(0 0% 100% / 0.75); }
    #vibe2405 .orb {
      width: 18px; height: 18px; border-radius: 50%;
      background:
        radial-gradient(circle at 30% 30%, white 0 30%, transparent 30%),
        conic-gradient(var(--p1), var(--p2), var(--p3), var(--p1));
      box-shadow: inset 0 0 0 1px hsl(0 0% 100% / 0.5), 0 0 0 6px hsl(0 0% 0% / 0.08);
      position: relative;
    }
    #vibe2405 .orb::after {
      content: ""; position: absolute; inset: -6px;
      border-radius: 50%;
      border: 2px dashed hsl(0 0% 100% / 0.22);
      animation: v2405-spin 10s linear infinite;
    }

    #vibe2405 .ctrls { display: inline-flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    #vibe2405 .seg {
      display: inline-flex; gap: 2px; padding: 4px; border-radius: 999px;
      border: 1px solid var(--line);
      background: hsl(0 0% 100% / 0.06);
      backdrop-filter: blur(10px) saturate(160%);
    }
    #vibe2405[data-theme="aurora"] .seg { background: hsl(0 0% 100% / 0.78); }
    #vibe2405 .seg button {
      appearance: none; border: 0; background: transparent; color: var(--fg);
      padding: 8px 12px; border-radius: 999px; font-weight: 800; font-size: 12px; cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease;
    }
    #vibe2405 .seg button[aria-pressed="true"] {
      color: white;
      background: linear-gradient(90deg, var(--p1), var(--p2), var(--p3));
      text-shadow: 0 1px 0 hsl(0 0% 0% / 0.25);
    }

    #vibe2405 .knob {
      display: inline-grid; grid-template-columns: auto 1fr; align-items: center; gap: 8px;
      padding: 8px 10px; border: 1px solid var(--line); border-radius: 12px;
      background: hsl(0 0% 100% / 0.06); font-size: 12px; color: var(--muted);
      backdrop-filter: blur(10px) saturate(160%);
    }
    #vibe2405[data-theme="aurora"] .knob { background: hsl(0 0% 100% / 0.76); }

    #vibe2405 input[type="range"] {
      -webkit-appearance: none; appearance: none;
      width: 140px; height: 10px; border-radius: 999px;
      background: linear-gradient(90deg, var(--p1), var(--p2), var(--p3));
      border: 1px solid hsl(0 0% 100% / 0.35);
      box-shadow: inset 0 1px 0 hsl(0 0% 100% / 0.45), 0 2px 9px hsl(0 0% 0% / 0.2);
      outline: none; cursor: pointer;
    }
    #vibe2405 input[type="range"]::-webkit-slider-thumb,
    #vibe2405 input[type="range"]::-moz-range-thumb {
      -webkit-appearance: none; appearance: none;
      width: 18px; height: 18px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, hsl(0 0% 100%), hsl(0 0% 92%));
      border: 1px solid hsl(0 0% 100% / 0.65);
      box-shadow: 0 2px 8px hsl(0 0% 0% / 0.35), 0 0 0 6px color-mix(in oklab, var(--p2) 30%, transparent);
    }

    /* Hero: Orrery */
    #vibe2405 .hero {
      position: relative; z-index: 2;
      width: min(1200px, 100cqi); aspect-ratio: 16/9;
      border-radius: calc(var(--r) + 12px);
      border: 1px solid var(--line);
      overflow: hidden;
      background: linear-gradient(180deg, hsl(0 0% 100% / 0.07), hsl(0 0% 100% / 0.03));
      backdrop-filter: blur(18px) saturate(160%);
      box-shadow: 0 34px 96px hsl(0 0% 0% / 0.5), inset 0 0 0 1px hsl(0 0% 100% / 0.08);
      display: grid; place-items: center;
    }
    #vibe2405[data-theme="aurora"] .hero {
      background: linear-gradient(180deg, hsl(0 0% 100% / 0.86), hsl(0 0% 100% / 0.66));
      box-shadow: 0 30px 90px hsl(232 50% 10% / 0.2), inset 0 0 0 1px hsl(0 0% 100% / 0.6);
    }

    /* Subtle radial grid overlay */
    #vibe2405 .grid {
      position: absolute; inset: 0; z-index: 0; pointer-events: none; opacity: 0.35;
      background:
        radial-gradient(circle at 50% 50%, transparent 0 6%, hsl(0 0% 100% / 0.04) 6.2% 6.6%, transparent 6.8% 12%),
        radial-gradient(circle at 50% 50%, transparent 0 12%, hsl(0 0% 100% / 0.04) 12.2% 12.6%, transparent 12.8% 18%),
        radial-gradient(circle at 50% 50%, transparent 0 18%, hsl(0 0% 100% / 0.04) 18.2% 18.6%, transparent 18.8% 24%),
        radial-gradient(circle at 50% 50%, transparent 0 24%, hsl(0 0% 100% / 0.04) 24.2% 24.6%, transparent 24.8% 30%);
      mask: radial-gradient(90% 90% at 50% 50%, black, transparent);
    }

    #vibe2405 .sky { position: absolute; inset: 0; width: 100%; height: 100%; display: block; z-index: 1; mix-blend-mode: screen; }
    #vibe2405 .overlay {
      position: relative; z-index: 2; text-align: center; padding: clamp(10px, 5vw, 40px);
      display: grid; gap: 10px; place-items: center;
    }
    #vibe2405 .t {
      margin: 0;
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      font-size: clamp(34px, 9.5cqi, 108px);
      line-height: 0.92; letter-spacing: -0.02em; font-weight: 900;
      background: linear-gradient(90deg, var(--p1), var(--p2), var(--p3));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 1px 0 hsl(0 0% 0% / 0.42);
      animation: v2405-sheen 8s ease-in-out infinite;
    }
    #vibe2405[data-theme="aurora"] .t { text-shadow: 0 1px 0 hsl(0 0% 100% / 0.32); }
    #vibe2405 .s { margin: 0; font-size: clamp(13px, 2.6cqi, 22px); color: var(--muted); text-wrap: pretty; }

    /* Marquee mantra */
    #vibe2405 .marquee {
      position: relative; z-index: 2;
      width: 100%; overflow: hidden;
      border-radius: 12px; border: 1px solid var(--line);
      background: hsl(0 0% 100% / 0.06);
      backdrop-filter: blur(6px) saturate(160%);
      margin-top: clamp(14px, 3.2vw, 26px);
    }
    #vibe2405[data-theme="aurora"] .marquee { background: hsl(0 0% 100% / 0.76); }
    #vibe2405 .marquee .row {
      display: flex; gap: 20px; align-items: center; white-space: nowrap;
      padding: 10px 12px; font-weight: 800; font-size: 12px; letter-spacing: 0.06em; text-transform: uppercase; color: var(--fg);
      animation: v2405-slide 22s linear infinite;
    }
    #vibe2405 .badge {
      display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px;
      border-radius: 999px; border: 1px solid var(--line);
      background: linear-gradient(90deg, var(--p1), var(--p2), var(--p3));
      color: white; text-shadow: 0 1px 0 hsl(0 0% 0% / 0.25);
    }
    #vibe2405 .dot { width: 8px; height: 8px; border-radius: 50%; background: white; }

    /* Footer */
    #vibe2405 .foot {
      position: relative; z-index: 2; display: grid; place-items: center; text-align: center;
      margin-top: clamp(18px, 4vw, 36px); gap: 10px; color: var(--muted);
    }
    #vibe2405 .foot small {
      font-size: 12px; letter-spacing: 0.06em; text-transform: uppercase;
      border: 1px solid var(--line); padding: 8px 12px; border-radius: 10px; background: hsl(0 0% 100% / 0.08);
    }
    #vibe2405[data-theme="aurora"] .foot small { background: hsl(0 0% 100% / 0.64); }

    /* Keyframes */
    @keyframes v2405-wash-a {
      0% { transform: translate3d(-2%, -3%, 0) rotate(0deg) scale(1); }
      50% { transform: translate3d(2%, 2%, 0) rotate(18deg) scale(1.06); }
      100% { transform: translate3d(-2%, 3%, 0) rotate(26deg) scale(1.02); }
    }
    @keyframes v2405-wash-b {
      0% { transform: translate3d(2%, 1%, 0) rotate(0deg) scale(1.02); }
      50% { transform: translate3d(-2%, -1%, 0) rotate(-12deg) scale(1.09); }
      100% { transform: translate3d(1%, -2%, 0) rotate(-26deg) scale(1.02); }
    }
    @keyframes v2405-spin { to { transform: rotate(360deg); } }
    @keyframes v2405-sheen {
      0%, 100% { filter: drop-shadow(0 2px 0 hsl(0 0% 0% / 0.35)); }
      50% { filter: drop-shadow(0 6px 12px color-mix(in oklab, var(--p2) 35%, transparent)); }
    }
    @keyframes v2405-slide {
      from { transform: translateX(0); }
      to { transform: translateX(-50%); }
    }

    /* Reduced motion */
    #vibe2405.reduce-motion::before,
    #vibe2405.reduce-motion::after { animation: none !important; }
    #vibe2405.reduce-motion .t { animation: none !important; }
    #vibe2405.reduce-motion .marquee .row { animation-duration: 0s; }
  </style>

  <div class="grain" aria-hidden="true"></div>

  <div class="top">
    <div class="brand" aria-label="Orbit Studio">
      <i class="orb" aria-hidden="true"></i>
      <span>Orbit Studio</span>
    </div>

    <div class="ctrls" role="group" aria-label="Appearance and motion controls">
      <div class="seg" role="tablist" aria-label="Theme">
        <button class="theme" data-theme="nebula" aria-pressed="true" role="tab">Nebula</button>
        <button class="theme" data-theme="aurora" aria-pressed="false" role="tab">Aurora</button>
        <button class="theme" data-theme="mono" aria-pressed="false" role="tab">Mono</button>
      </div>

      <label class="knob" for="tempo">
        Tempo
        <input id="tempo" type="range" min="0.3" max="2.5" step="0.1" value="1.0" aria-label="Adjust orbital tempo">
      </label>

      <label class="knob" for="orbits">
        Orbits
        <input id="orbits" type="range" min="80" max="1400" step="40" value="700" aria-label="Adjust orbit density">
      </label>

      <label class="knob" for="bloom">
        Bloom
        <input id="bloom" type="range" min="0.2" max="1.8" step="0.1" value="1.0" aria-label="Adjust bloom intensity">
      </label>
    </div>
  </div>

  <div class="hero" tabindex="0" aria-label="Interactive orrery canvas">
    <div class="grid" aria-hidden="true"></div>
    <canvas class="sky" aria-hidden="true"></canvas>
    <div class="overlay" aria-hidden="true">
      <h1 class="t">Orbits, not pages.</h1>
      <p class="s">Elegant systems in steady motion. Click to launch a comet.</p>
    </div>
  </div>

  <div class="marquee" aria-hidden="true">
    <div class="row">
      <span class="badge"><i class="dot"></i> Rhythm</span>
      <span>Balance over bustle</span>
      <span class="badge"><i class="dot"></i> Clarity</span>
      <span>Contrast with kindness</span>
      <span class="badge"><i class="dot"></i> Play</span>
      <span>Delight without demand</span>
      <span class="badge"><i class="dot"></i> Care</span>
      <span>Accessibility is essential</span>
      <!-- loop -->
      <span class="badge"><i class="dot"></i> Rhythm</span>
      <span>Balance over bustle</span>
      <span class="badge"><i class="dot"></i> Clarity</span>
      <span>Contrast with kindness</span>
      <span class="badge"><i class="dot"></i> Play</span>
      <span>Delight without demand</span>
      <span class="badge"><i class="dot"></i> Care</span>
      <span>Accessibility is essential</span>
    </div>
  </div>

  <div class="foot">
    <small>Design that orbits the user.</small>
    <span id="last-updated">Last updated: 2026-02-05 05:38:09 EST</span>
  </div>

  <script>
    (function () {
      const root = document.getElementById('vibe2405');
      const hero = root.querySelector('.hero');
      const cvs = root.querySelector('.sky');
      const ctx = cvs.getContext('2d', { alpha: true });
      const themes = Array.from(root.querySelectorAll('.theme'));
      const tempo = root.querySelector('#tempo');
      const orbits = root.querySelector('#orbits');
      const bloom = root.querySelector('#bloom');
      const stamp = root.querySelector('#last-updated');

      // Stamp
      try {
        const now = new Date();
        const fmt = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'medium' });
        stamp.textContent = 'Last updated: ' + fmt.format(now);
      } catch {
        stamp.textContent = 'Last updated: just now';
      }

      // Reduced motion
      const prefersReduce = window.matchMedia ? matchMedia('(prefers-reduced-motion: reduce)') : null;
      const applyReduce = on => root.classList.toggle('reduce-motion', !!on);
      if (prefersReduce) {
        applyReduce(prefersReduce.matches);
        prefersReduce.addEventListener('change', e => applyReduce(e.matches));
      }

      // Theme switching
      const applyTheme = (m) => {
        root.setAttribute('data-theme', m);
        themes.forEach(b => b.setAttribute('aria-pressed', b.dataset.theme === m ? 'true' : 'false'));
        readPalette();
        resize();
        seed();
        start();
      };
      themes.forEach(btn => btn.addEventListener('click', () => applyTheme(btn.dataset.theme)));

      // Canvas setup
      const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      let raf, W = 0, H = 0, CX = 0, CY = 0, T0 = 0, lastT = 0;
      const state = {
        speed: parseFloat(tempo.value),
        count: parseInt(orbits.value, 10),
        bloom: parseFloat(bloom.value),
        t: 0
      };
      const palette = { p1: '#fff', p2: '#fff', p3: '#fff', fg: '#000' };

      const readPalette = () => {
        const s = getComputedStyle(root);
        palette.p1 = s.getPropertyValue('--p1').trim();
        palette.p2 = s.getPropertyValue('--p2').trim();
        palette.p3 = s.getPropertyValue('--p3').trim();
        palette.fg = s.getPropertyValue('--fg').trim();
      };

      const resize = () => {
        const r = hero.getBoundingClientRect();
        W = Math.floor(r.width);
        H = Math.floor(r.height);
        CX = W / 2; CY = H / 2;
        cvs.width = Math.floor(W * DPR);
        cvs.height = Math.floor(H * DPR);
        cvs.style.width = W + 'px';
        cvs.style.height = H + 'px';
        ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
      };

      // Stars
      let stars = [];
      const seedStars = () => {
        const n = Math.floor(Math.min(240, (W * H) / 18000));
        stars = new Array(n).fill(0).map(() => ({
          x: Math.random() * W,
          y: Math.random() * H,
          a: Math.random() * Math.PI * 2,
          r: Math.random() * 1.4 + 0.4,
          tw: 0.4 + Math.random() * 0.9
        }));
      };

      // Orbits
      let bodies = [];
      const rand = (min, max) => min + Math.random() * (max - min);
      const lerp = (a, b, t) => a + (b - a) * t;

      const gradient = () => {
        const g = ctx.createLinearGradient(0, 0, W, H);
        g.addColorStop(0, palette.p1);
        g.addColorStop(0.5, palette.p2);
        g.addColorStop(1, palette.p3);
        return g;
      };

      const spawnBody = (i = 0) => {
        const R = Math.pow(i / Math.max(1, state.count), 0.65) * Math.min(W, H) * 0.48 + rand(-6, 6);
        const dir = Math.random() > 0.5 ? 1 : -1;
        return {
          r: Math.max(8, R),
          a: Math.random() * Math.PI * 2,
          s: (1 / Math.pow(R + 30, 0.6)) * (0.8 + Math.random() * 0.4) * dir,
          hue: i / Math.max(1, state.count),
          px: 0, py: 0
        };
      };

      const seed = () => {
        bodies = new Array(state.count).fill(0).map((_, i) => spawnBody(i));
        seedStars();
        ctx.clearRect(0, 0, W, H);
      };

      // Comets
      let comets = [];
      const spawnComet = (x = rand(0, W), y = rand(0, H)) => {
        const ang = Math.atan2(y - CY, x - CX) + (Math.random() * 0.8 - 0.4);
        const speed = 4 + Math.random() * 2;
        comets.push({
          x, y,
          vx: Math.cos(ang) * speed,
          vy: Math.sin(ang) * speed,
          life: 120 + Math.floor(Math.random() * 60)
        });
      };

      // Pointer gravity
      let pointerInside = false;
      hero.addEventListener('pointerenter', () => pointerInside = true);
      hero.addEventListener('pointerleave', () => { pointerInside = false; CX = W / 2; CY = H / 2; });
      hero.addEventListener('pointermove', (e) => {
        const r = hero.getBoundingClientRect();
        CX = e.clientX - r.left;
        CY = e.clientY - r.top;
      });
      hero.addEventListener('pointerdown', (e) => {
        const r = hero.getBoundingClientRect();
        spawnComet(e.clientX - r.left, e.clientY - r.top);
      });

      // Draw routines
      const drawStars = (t) => {
        ctx.save();
        for (let i = 0; i < stars.length; i++) {
          const s = stars[i];
          const tw = 0.5 + 0.5 * Math.sin(t * s.tw + s.a);
          ctx.globalAlpha = 0.25 + 0.75 * tw;
          ctx.fillStyle = 'white';
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r * (0.8 + tw * 0.4), 0, Math.PI * 2);
          ctx.fill();
        }
        ctx.restore();
      };

      const drawStaticRings = () => {
        ctx.clearRect(0, 0, W, H);
        drawStars(0);
        ctx.save();
        ctx.strokeStyle = gradient();
        for (let r = Math.min(W, H) * 0.08; r < Math.min(W, H) * 0.48; r += 16) {
          ctx.globalAlpha = 0.12 + 0.22 * Math.pow(1 - r / (Math.min(W, H) * 0.48), 1.4);
          ctx.lineWidth = (r % 32 === 0 ? 1.4 : 0.8);
          ctx.beginPath();
          ctx.arc(W / 2, H / 2, r, 0, Math.PI * 2);
          ctx.stroke();
        }
        ctx.restore();
      };

      const step = (tms) => {
        if (root.classList.contains('reduce-motion')) {
          drawStaticRings();
          return;
        }

        if (!T0) T0 = tms, lastT = tms;
        const t = (tms - T0) * 0.001;
        let dt = Math.min(0.05, (tms - lastT) * 0.001);
        lastT = tms;
        state.t = t;

        // Fade canvas (trail persistence)
        ctx.globalCompositeOperation = 'source-over';
        const theme = root.getAttribute('data-theme');
        ctx.fillStyle = theme === 'aurora' ? 'rgba(255,255,255,0.06)' : 'rgba(0,0,0,0.06)';
        ctx.fillRect(0, 0, W, H);

        drawStars(t);

        // Orbits
        ctx.globalCompositeOperation = 'lighter';
        ctx.strokeStyle = gradient();
        ctx.fillStyle = gradient();
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        ctx.shadowColor = palette.p2;
        ctx.shadowBlur = 6 * state.bloom;

        const speedScale = 1.0 * state.speed;
        const len = 0.6 + 1.6 * state.bloom;

        const cX = CX, cY = CY;
        for (let i = 0; i < bodies.length; i++) {
          const b = bodies[i];
          const px = cX + Math.cos(b.a) * b.r;
          const py = cY + Math.sin(b.a) * b.r;

          b.a += b.s * speedScale * dt;

          const nx = cX + Math.cos(b.a) * b.r;
          const ny = cY + Math.sin(b.a) * b.r;

          ctx.globalAlpha = 0.05 + 0.5 * (1 - Math.abs(0.5 - b.hue));
          ctx.lineWidth = 0.5 + 1.2 * Math.sin((i * 0.015) + t);
          ctx.beginPath();
          ctx.moveTo(px, py);
          ctx.lineTo(lerp(px, nx, len), lerp(py, ny, len));
          ctx.stroke();

          // highlight tiny body
          if (i % 60 === 0) {
            ctx.globalAlpha = 0.6;
            ctx.beginPath();
            ctx.arc(nx, ny, 1.2 + 0.8 * Math.sin(t * 3 + i), 0, Math.PI * 2);
            ctx.fill();
          }

          b.px = nx; b.py = ny;
        }

        // Comets
        for (let i = comets.length - 1; i >= 0; i--) {
          const c = comets[i];
          c.x += c.vx * state.speed;
          c.y += c.vy * state.speed;
          c.life -= 1;
          // tail
          ctx.globalAlpha = 0.5;
          ctx.strokeStyle = gradient();
          ctx.lineWidth = 1.4 + 1.4 * Math.sin((t + i) * 2);
          ctx.beginPath();
          ctx.moveTo(c.x, c.y);
          ctx.lineTo(c.x - c.vx * 6, c.y - c.vy * 6);
          ctx.stroke();
          // head
          ctx.globalAlpha = 0.9;
          ctx.beginPath();
          ctx.arc(c.x, c.y, 1.6 + state.bloom * 0.8, 0, Math.PI * 2);
          ctx.fill();

          if (c.x < -20 || c.x > W + 20 || c.y < -20 || c.y > H + 20 || c.life < 0) {
            comets.splice(i, 1);
          }
        }

        raf = requestAnimationFrame(step);
      };

      const start = () => {
        cancelAnimationFrame(raf);
        raf = requestAnimationFrame(step);
      };

      // Controls
      tempo.addEventListener('input', e => { state.speed = parseFloat(e.target.value); });
      orbits.addEventListener('input', e => {
        state.count = parseInt(e.target.value, 10);
        seed();
      });
      bloom.addEventListener('input', e => { state.bloom = parseFloat(e.target.value); });

      // Resize observer
      const ro = new ResizeObserver(() => { resize(); seed(); start(); });
      ro.observe(hero);

      // Init
      readPalette();
      resize();
      seed();
      start();

      // Cleanup if removed
      root.addEventListener('DOMNodeRemoved', () => { cancelAnimationFrame(raf); ro.disconnect(); });

      // Accessibility: keyboard comet
      hero.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          spawnComet(CX, CY);
        }
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


