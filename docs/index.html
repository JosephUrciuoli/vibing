<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="v1093" data-theme="lunar" data-motion="on" role="region" aria-label="Aurora Orrery">
  <style>
    /* Aurora Orrery â€” v1093 (aggressive shift) */
    #v1093 {
      --r: 28px;

      /* Lunar (default) */
      --bg0: #060913;
      --bg1: #0b1224;
      --fg: #eaf2ff;
      --muted: rgba(234,242,255,0.78);
      --line: rgba(255,255,255,0.10);

      /* Palette */
      --p1: #6fffe9; /* mint-aurora */
      --p2: #7a8cff; /* periwave */
      --p3: #ff8fb0; /* rosy ion */

      /* Gradient locus */
      --gx: 50%;
      --gy: 50%;

      position: relative;
      border-radius: var(--r);
      color: var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      box-shadow: 0 30px 70px rgba(0,0,0,0.45), inset 0 0 0 1px rgba(255,255,255,0.06);
      overflow: hidden;
      min-height: 680px;
      background:
        radial-gradient(900px 680px at var(--gx) var(--gy), rgba(255,255,255,0.06), transparent 60%),
        radial-gradient(1400px 1000px at calc(var(--gx) + 12%) calc(var(--gy) + 8%), color-mix(in oklab, var(--p2), transparent 90%), transparent 70%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      isolation: isolate;
    }

    #v1093[data-theme="dawn"] {
      --bg0: #fcfdff;
      --bg1: #eaf2ff;
      --fg: #0c1326;
      --muted: rgba(12,19,38,0.78);
      --line: rgba(12,19,38,0.12);
      --p1: #2fd5bf;
      --p2: #4d7cff;
      --p3: #ff7aa4;
      background:
        radial-gradient(900px 680px at var(--gx) var(--gy), rgba(0,0,0,0.08), transparent 60%),
        radial-gradient(1400px 1000px at calc(var(--gx) + 10%) calc(var(--gy) + 6%), color-mix(in oklab, var(--p2), transparent 92%), transparent 70%),
        linear-gradient(180deg, #ffffff, var(--bg1) 40%, var(--bg0));
      box-shadow: 0 20px 46px rgba(11,18,32,0.18), inset 0 0 0 1px rgba(11,18,32,0.08);
    }

    /* Layout */
    #v1093 .grid {
      display: grid;
      grid-template-rows: 1fr auto;
      min-height: 680px;
    }

    /* Sky stage */
    #v1093 .sky {
      position: relative;
      overflow: hidden;
      border-radius: var(--r);
      margin: 0;
      perspective: 1000px;
      transform-style: preserve-3d;
      background:
        radial-gradient(60% 50% at 20% 10%, color-mix(in oklab, var(--p1), transparent 92%), transparent 60%),
        radial-gradient(70% 60% at 80% 80%, color-mix(in oklab, var(--p3), transparent 92%), transparent 60%);
    }

    #v1093 .veil {
      position: absolute; inset: -20% -30% -10% -30%;
      background:
        conic-gradient(from 120deg at 30% 20%, color-mix(in oklab, var(--p1), transparent 88%), transparent 40%),
        conic-gradient(from -40deg at 70% 80%, color-mix(in oklab, var(--p2), transparent 90%), transparent 40%);
      filter: blur(38px) saturate(115%);
      opacity: 0.6;
      mix-blend-mode: screen;
      pointer-events: none;
      transform: translateZ(0);
    }
    #v1093[data-theme="dawn"] .veil { mix-blend-mode: multiply; opacity: 0.45; }

    #v1093 .tilt {
      position: absolute; inset: 0;
      transform-style: preserve-3d;
      will-change: transform;
    }

    #v1093 canvas.stars {
      position: absolute; inset: 0;
      display: block;
      width: 100%; height: 100%;
      mix-blend-mode: screen;
      opacity: 0.75;
      pointer-events: none;
      filter: saturate(120%);
    }
    #v1093[data-theme="dawn"] canvas.stars { mix-blend-mode: multiply; opacity: 0.5; }

    #v1093 svg.orbits {
      position: absolute; inset: 0;
      overflow: visible;
      filter: drop-shadow(0 20px 30px rgba(0,0,0,0.25));
    }

    #v1093 .planet {
      position: absolute;
      width: 18px; height: 18px;
      border-radius: 50%;
      transform: translate(-50%,-50%);
      background:
        radial-gradient(circle at 30% 30%, white 0 30%, color-mix(in oklab, var(--p2), transparent 30%) 30% 72%, transparent 72%),
        radial-gradient(circle at 50% 50%, color-mix(in oklab, var(--p1), transparent 10%), color-mix(in oklab, var(--p3), black 10%));
      box-shadow:
        0 4px 14px color-mix(in oklab, var(--p2), transparent 70%),
        0 0 0 1px rgba(255,255,255,0.25);
      will-change: transform, left, top;
      filter: saturate(115%);
      z-index: 2;
    }
    #v1093 .planet::after {
      content: "";
      position: absolute; left: 50%; top: 50%;
      width: 36px; height: 8px;
      transform: translate(-50%,-50%) rotate(var(--ang, 0deg));
      transform-origin: 0% 50%;
      border-radius: 999px;
      background: linear-gradient(90deg, color-mix(in oklab, var(--p3), transparent 0%), transparent 60%);
      opacity: 0.45;
      filter: blur(3px);
      pointer-events: none;
    }

    #v1093 .comet {
      width: 14px; height: 14px;
      background:
        radial-gradient(circle at 30% 30%, #fff 0 25%, color-mix(in oklab, var(--p3), transparent 20%) 25% 70%, transparent 70%),
        radial-gradient(circle at 50% 50%, color-mix(in oklab, var(--p3), white 8%), color-mix(in oklab, var(--p2), black 12%));
      box-shadow:
        0 6px 20px color-mix(in oklab, var(--p3), transparent 70%),
        0 0 0 1px rgba(255,255,255,0.28);
    }
    #v1093 .comet::after {
      width: 70px; height: 10px; opacity: 0.6;
      background: linear-gradient(90deg, color-mix(in oklab, var(--p1), transparent 0%), transparent 70%);
      filter: blur(5px);
    }

    /* Panel */
    #v1093 .panel {
      position: relative;
      z-index: 4;
      margin: 22px;
      margin-top: -110px; /* overlap elegantly */
      justify-self: start;
      max-width: 560px;
      padding: 22px 20px;
      border-radius: calc(var(--r) - 8px);
      background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));
      backdrop-filter: blur(12px) saturate(115%);
      -webkit-backdrop-filter: blur(12px) saturate(115%);
      box-shadow: inset 0 0 0 1px var(--line), 0 16px 40px rgba(0,0,0,0.26);
    }
    #v1093[data-theme="dawn"] .panel {
      background: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.02));
      box-shadow: inset 0 0 0 1px var(--line), 0 16px 32px rgba(11,18,32,0.14);
    }

    #v1093 h1 {
      margin: 0 0 8px 0;
      font-size: clamp(36px, 6.8vw, 64px);
      line-height: 0.95;
      letter-spacing: -0.03em;
      background: conic-gradient(from 20deg at 0% 50%, var(--p1), var(--p2), var(--p3), var(--p1));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      filter: drop-shadow(0 10px 24px rgba(0,0,0,0.25));
      animation: v1093-hue 22s linear infinite;
    }
    #v1093 .lede {
      margin: 6px 0 16px 0;
      color: var(--muted);
      font-size: clamp(14px, 2vw, 18px);
      letter-spacing: 0.01em;
    }

    /* Controls */
    #v1093 .controls {
      display: flex; flex-wrap: wrap; gap: 10px; align-items: center;
      margin-bottom: 12px;
    }
    #v1093 .btn {
      appearance: none; border: 0; cursor: pointer;
      border-radius: 14px; padding: 10px 14px;
      font-size: 13px; font-weight: 700; letter-spacing: 0.02em;
      color: #0a1222;
      background: linear-gradient(180deg,
        color-mix(in oklab, var(--p1), white 44%),
        color-mix(in oklab, var(--p2), white 32%));
      box-shadow: 0 10px 16px rgba(0,0,0,0.18), inset 0 0 0 1px rgba(255,255,255,0.55);
      transition: transform 120ms ease, filter 220ms ease;
    }
    #v1093 .btn.ghost {
      color: var(--fg);
      background: linear-gradient(180deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06));
      box-shadow: inset 0 0 0 1px var(--line);
    }
    #v1093 .btn:hover { filter: brightness(1.05) saturate(1.08); }
    #v1093 .btn:active { transform: translateY(1px) scale(0.99); }

    #v1093 .range {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 8px 12px; border-radius: 999px;
      background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.05));
      box-shadow: inset 0 0 0 1px var(--line);
      color: var(--fg);
      font-size: 12px;
    }
    #v1093[data-theme="dawn"] .range {
      background: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.03));
    }
    #v1093 input[type="range"] {
      -webkit-appearance: none; appearance: none; width: 160px; height: 4px;
      background: linear-gradient(90deg, var(--p1), var(--p2), var(--p3));
      border-radius: 999px; outline: none; cursor: pointer;
    }
    #v1093 input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 16px; height: 16px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 35%, color-mix(in oklab, var(--p2), transparent 15%) 35% 70%, transparent 70%);
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.6);
    }
    #v1093 input[type="range"]::-moz-range-thumb {
      width: 16px; height: 16px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 35%, color-mix(in oklab, var(--p2), transparent 15%) 35% 70%, transparent 70%);
      border: 1px solid rgba(255,255,255,0.6);
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
    }

    #v1093 .meta {
      display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center;
      margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--line);
      color: var(--muted); font-size: 12.5px;
    }
    #v1093 .live { display: inline-flex; align-items: center; gap: 8px; }
    #v1093 .pulse {
      width: 10px; height: 10px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 25%, color-mix(in oklab, var(--p1), transparent 25%) 25% 70%, transparent 70%);
      box-shadow: 0 0 12px color-mix(in oklab, var(--p1), transparent 55%);
      animation: v1093-breathe 3s ease-in-out infinite;
    }

    /* Grain */
    #v1093 .grain {
      position: absolute; inset: 0; pointer-events: none;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 2px),
        repeating-linear-gradient(90deg, rgba(0,0,0,0.03) 0 1px, transparent 1px 2px);
      mix-blend-mode: overlay; opacity: 0.3;
    }
    #v1093[data-theme="dawn"] .grain { mix-blend-mode: multiply; opacity: 0.22; }

    /* Animations */
    @keyframes v1093-hue { to { filter: hue-rotate(360deg) drop-shadow(0 10px 24px rgba(0,0,0,0.25)); } }
    @keyframes v1093-breathe { 0%,100% { transform: scale(1); filter: saturate(1); } 50% { transform: scale(1.25); filter: saturate(1.25); } }

    /* Motion respect */
    @media (prefers-reduced-motion: reduce) {
      #v1093 * { animation: none !important; transition: none !important; }
    }
    #v1093[data-motion="off"] * { animation-play-state: paused !important; transition: none !important; }
  </style>

  <div class="grid">
    <section class="sky" id="v1093-sky" aria-label="Kinetic orrery">
      <div class="veil" aria-hidden="true"></div>
      <div class="tilt" id="v1093-tilt">
        <canvas class="stars" id="v1093-stars" aria-hidden="true"></canvas>
        <svg class="orbits" id="v1093-orbits" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true"></svg>
        <!-- Planets injected here -->
      </div>
      <div class="grain" aria-hidden="true"></div>
    </section>

    <section class="panel" aria-label="Controls and description">
      <h1>Aurora Orrery</h1>
      <p class="lede" id="v1093-lede">Silent mechanics. Light draws the sky. Drag to bend gravity.</p>

      <div class="controls" aria-label="Controls">
        <button class="btn" id="v1093-theme" aria-pressed="false" title="Toggle theme">Switch to Dawn</button>
        <button class="btn ghost" id="v1093-motion" aria-pressed="true" title="Toggle motion">Motion: On</button>
        <button class="btn ghost" id="v1093-recompose" title="Shuffle palette & system">Recompose</button>
        <div class="range" title="Tempo">
          Tempo
          <input id="v1093-tempo" type="range" min="0" max="2" step="0.02" value="1" aria-label="Tempo">
        </div>
      </div>

      <div class="meta">
        <div class="live"><span class="pulse" aria-hidden="true"></span>Gravity simulation</div>
        <span id="last-updated">Last updated: 2025-12-05 14:15:04 EST</span>
      </div>
    </section>
  </div>

  <script>
    (function(){
      const root = document.getElementById('v1093');
      const sky = document.getElementById('v1093-sky');
      const tilt = document.getElementById('v1093-tilt');
      const svg = document.getElementById('v1093-orbits');
      const starsCanvas = document.getElementById('v1093-stars');
      const themeBtn = document.getElementById('v1093-theme');
      const motionBtn = document.getElementById('v1093-motion');
      const recomposeBtn = document.getElementById('v1093-recompose');
      const tempoInput = document.getElementById('v1093-tempo');
      const lede = document.getElementById('v1093-lede');
      const updated = document.getElementById('last-updated');

      // Last updated: viewer locale
      try {
        const dtf = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'medium', timeZoneName: 'short' });
        updated.textContent = 'Last updated: ' + dtf.format(new Date());
      } catch {
        updated.textContent = 'Last updated: ' + new Date().toLocaleString();
      }

      // Time-of-day theme hint
      const hour = new Date().getHours();
      if (hour >= 6 && hour < 18) {
        root.dataset.theme = 'dawn';
        themeBtn.textContent = 'Switch to Lunar';
        themeBtn.setAttribute('aria-pressed','true');
        lede.textContent = 'Daylight mechanics. Drag to bend gravity.';
      }

      // Scene sizing
      let bounds = sky.getBoundingClientRect();
      function setBounds(){
        bounds = sky.getBoundingClientRect();
        stars.resize();
      }
      window.addEventListener('resize', setBounds, { passive:true });

      // Gradient follow
      root.style.setProperty('--gx', '50%');
      root.style.setProperty('--gy', '50%');

      // Tilt & pointer interactions
      let center = { x: 0.5, y: 0.5 };
      let target = { x: 0.5, y: 0.5 };
      sky.addEventListener('pointermove', (e)=>{
        const rect = bounds;
        target.x = Math.min(1, Math.max(0, (e.clientX - rect.left)/rect.width));
        target.y = Math.min(1, Math.max(0, (e.clientY - rect.top)/rect.height));
      });
      sky.addEventListener('pointerleave', ()=>{
        target.x = 0.5; target.y = 0.5;
      });
      sky.addEventListener('click', ()=>{
        pulseSystem();
      });
      window.addEventListener('keydown', (e)=>{
        if (e.code === 'Space') { e.preventDefault(); pulseSystem(); }
        if (e.code === 'ArrowRight') tempoInput.value = Math.min(2, (+tempoInput.value + 0.1)).toFixed(2);
        if (e.code === 'ArrowLeft') tempoInput.value = Math.max(0, (+tempoInput.value - 0.1)).toFixed(2);
      });

      // Palettes
      const palettes = [
        ['#6fffe9','#7a8cff','#ff8fb0'],
        ['#ffd36e','#78c7ff','#ff8bd3'],
        ['#9ef3a1','#8df0ff','#a3a1ff'],
        ['#c8ff8f','#6bd0ff','#ff94c7'],
        ['#ffcf96','#84ffc9','#aab2ff']
      ];
      function setPalette([a,b,c]){
        root.style.setProperty('--p1', a);
        root.style.setProperty('--p2', b);
        root.style.setProperty('--p3', c);
      }

      // Orbits & planets
      const PLANET_COUNT = 7;
      const planets = [];
      const ellipses = [];
      function clearSystem(){
        planets.splice(0, planets.length);
        ellipses.splice(0, ellipses.length);
        svg.innerHTML = '';
        for (const p of sky.querySelectorAll('.planet')) p.remove();
      }

      function createEllipse(cx, cy, rx, ry, rot, hue){
        const g = document.createElementNS('http://www.w3.org/2000/svg','g');

        // Glow stroke
        const glow = document.createElementNS('http://www.w3.org/2000/svg','ellipse');
        glow.setAttribute('cx', String(cx));
        glow.setAttribute('cy', String(cy));
        glow.setAttribute('rx', String(rx));
        glow.setAttribute('ry', String(ry));
        glow.setAttribute('transform', `rotate(${rot} ${cx} ${cy})`);
        glow.setAttribute('fill','none');
        glow.setAttribute('stroke', hue);
        glow.setAttribute('stroke-width','0.6');
        glow.setAttribute('opacity','0.35');
        glow.style.filter = 'blur(0.6px)';

        // Hairline
        const line = document.createElementNS('http://www.w3.org/2000/svg','ellipse');
        line.setAttribute('cx', String(cx));
        line.setAttribute('cy', String(cy));
        line.setAttribute('rx', String(rx));
        line.setAttribute('ry', String(ry));
        line.setAttribute('transform', `rotate(${rot} ${cx} ${cy})`);
        line.setAttribute('fill','none');
        line.setAttribute('stroke','currentColor');
        line.setAttribute('stroke-opacity','0.18');
        line.setAttribute('stroke-width','0.25');

        g.appendChild(glow);
        g.appendChild(line);
        svg.appendChild(g);
        return g;
      }

      function buildSystem(){
        clearSystem();
        const rect = bounds = sky.getBoundingClientRect();
        const minSide = Math.min(rect.width, rect.height);
        const cx = 50; const cy = 50; // SVG viewBox space

        for (let i=0;i<PLANET_COUNT;i++){
          const t = (i+1)/PLANET_COUNT;
          const rx = 14 + t*30 + (Math.random()*4 - 2);
          const ry = rx * (0.65 + Math.random()*0.25);
          const rot = Math.floor(Math.random()*180);
          const hue = i%2===0 ? getComputedStyle(root).getPropertyValue('--p2').trim() : getComputedStyle(root).getPropertyValue('--p3').trim();
          const eg = createEllipse(cx, cy, rx, ry, rot, hue);
          ellipses.push({ rx, ry, rotDeg: rot });

          const el = document.createElement('div');
          el.className = 'planet' + (i===PLANET_COUNT-1 ? ' comet' : '');
          el.style.width = (14 + i*1.3) + 'px';
          el.style.height = (14 + i*1.3) + 'px';
          tilt.appendChild(el);

          const speed = (0.25 + t*0.6) * (Math.random()<0.5 ? 1 : -1);
          const theta = Math.random() * Math.PI*2;
          planets.push({ el, rx, ry, rot: rot*Math.PI/180, speed, theta, size: el.offsetWidth });
        }
      }

      function pulseSystem(){
        for (const p of planets){
          p.theta += (Math.random()*0.8 + 0.4) * (Math.random()<0.5?1:-1);
        }
        const lines = [
          'The sky is clockwork and we are listening.',
          'Design by gravity, color by chance.',
          'Orbits hum where sound would be.',
          'Bend the night, redraw the light.',
          'Every ellipse is a thought in motion.'
        ];
        lede.textContent = lines[Math.floor(Math.random()*lines.length)];
      }

      // Stars
      const stars = (function(){
        let ctx, w=0, h=0, pool=[];
        function resize(){
          const dpr = Math.min(2, (window.devicePixelRatio||1));
          w = starsCanvas.clientWidth|0; h = starsCanvas.clientHeight|0;
          starsCanvas.width = Math.max(1, Math.floor(w*dpr));
          starsCanvas.height = Math.max(1, Math.floor(h*dpr));
          ctx = starsCanvas.getContext('2d');
          ctx.setTransform(dpr,0,0,dpr,0,0);
          seed();
        }
        function seed(){
          const count = Math.floor((w*h)/7000);
          pool = Array.from({length: count}, ()=>({
            x: Math.random(), y: Math.random(),
            r: Math.random()*1.6 + 0.2,
            a: Math.random()*Math.PI*2,
            s: 0.5 + Math.random()*1.5
          }));
        }
        function draw(t){
          if (!ctx) return;
          ctx.clearRect(0,0,w,h);
          const parX = (center.x - 0.5) * 28;
          const parY = (center.y - 0.5) * 28;
          for (const s of pool){
            const tw = (Math.sin(t*0.001*s.s + s.a)*0.5 + 0.5) * 0.7 + 0.3;
            const x = s.x*w + parX * (s.s*0.6);
            const y = s.y*h + parY * (s.s*0.6);
            ctx.globalAlpha = 0.65 * tw;
            const grad = ctx.createRadialGradient(x,y,0,x,y,s.r*2.2);
            grad.addColorStop(0,'#fff');
            grad.addColorStop(1, getComputedStyle(root).getPropertyValue('--p2').trim());
            ctx.fillStyle = grad;
            ctx.beginPath();
            ctx.arc(x,y,s.r,0,Math.PI*2);
            ctx.fill();
          }
        }
        return { resize, draw };
      })();

      // Animation loop
      let tempo = parseFloat(tempoInput.value || '1');
      tempoInput.addEventListener('input', ()=> tempo = parseFloat(tempoInput.value || '1'));

      if ((typeof matchMedia!=='undefined') && matchMedia('(prefers-reduced-motion: reduce)').matches) {
        root.dataset.motion = 'off';
        motionBtn.textContent = 'Motion: Off';
        motionBtn.setAttribute('aria-pressed','false');
      }

      motionBtn.addEventListener('click', ()=>{
        const on = root.dataset.motion !== 'off';
        root.dataset.motion = on ? 'off' : 'on';
        motionBtn.textContent = 'Motion: ' + (on ? 'Off' : 'On');
        motionBtn.setAttribute('aria-pressed', String(!on));
      });

      themeBtn.addEventListener('click', ()=>{
        const isDawn = root.dataset.theme === 'dawn';
        root.dataset.theme = isDawn ? 'lunar' : 'dawn';
        themeBtn.textContent = isDawn ? 'Switch to Dawn' : 'Switch to Lunar';
      });

      recomposeBtn.addEventListener('click', ()=>{
        setPalette(palettes[Math.floor(Math.random()*palettes.length)]);
        buildSystem();
        pulseSystem();
      });

      function updatePlanets(dt, t){
        // Lerp the gravity center
        center.x += (target.x - center.x) * Math.min(1, dt*6);
        center.y += (target.y - center.y) * Math.min(1, dt*6);

        // Tilt and background locus
        const tiltX = (0.5 - center.y) * 8;
        const tiltY = (center.x - 0.5) * 8;
        tilt.style.transform = `rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
        root.style.setProperty('--gx', (center.x*100).toFixed(2) + '%');
        root.style.setProperty('--gy', (center.y*100).toFixed(2) + '%');

        // SVG is in 0..100 space; we keep center fixed in SVG but visually shift planets toward pointer for parallax feel
        const rect = bounds;
        for (let i=0;i<planets.length;i++){
          const p = planets[i];
          p.theta += p.speed * tempo * dt;
          const ct = Math.cos(p.theta), st = Math.sin(p.theta);

          const ex = 50 + ct*p.rx*Math.cos(p.rot) - st*p.ry*Math.sin(p.rot);
          const ey = 50 + ct*p.rx*Math.sin(p.rot) + st*p.ry*Math.cos(p.rot);

          const px = ex/100 * rect.width;
          const py = ey/100 * rect.height;

          // Tangent angle for tail
          const tx = -Math.sin(p.theta)*p.rx*Math.cos(p.rot) - Math.cos(p.theta)*p.ry*Math.sin(p.rot);
          const ty = -Math.sin(p.theta)*p.rx*Math.sin(p.rot) + Math.cos(p.theta)*p.ry*Math.cos(p.rot);
          const ang = Math.atan2(ty, tx) * 180/Math.PI;

          p.el.style.left = px + 'px';
          p.el.style.top = py + 'px';
          p.el.style.setProperty('--ang', ang + 'deg');
        }
      }

      let raf=0, last=0;
      function frame(t){
        if (!last) last = t;
        const dt = Math.min(50, t - last) / 1000;
        last = t;

        if (root.dataset.motion !== 'off'){
          updatePlanets(dt, t);
          stars.draw(t);
        }
        raf = requestAnimationFrame(frame);
      }

      // Initialize
      setBounds();
      setPalette([getComputedStyle(root).getPropertyValue('--p1').trim(), getComputedStyle(root).getPropertyValue('--p2').trim(), getComputedStyle(root).getPropertyValue('--p3').trim()]);
      stars.resize();
      buildSystem();
      raf = requestAnimationFrame(frame);

    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


