<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v1349-celest" data-theme="noir" data-paused="false" aria-label="Orbital Kinetic Timepiece">
  <style>
    .v1349-celest {
      --bg-1: #0b0f1d;
      --bg-2: #12182b;
      --ink: #ecf2ff;
      --muted: rgba(236,242,255,0.75);
      --accent: #7ae0ff;
      --accent-2: #b29cff;
      --ring: rgba(255,255,255,0.12);
      --chip-bg: rgba(255,255,255,0.06);
      --chip-brd: rgba(255,255,255,0.14);
      position: relative;
      border-radius: 28px;
      overflow: hidden;
      padding: clamp(22px, 3.6vw, 42px);
      background: radial-gradient(120% 140% at 10% 0%, var(--bg-2), var(--bg-1));
      color: var(--ink);
      box-shadow: 0 28px 80px rgba(0,0,0,0.55), inset 0 0 0 1px rgba(255,255,255,0.05);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      isolation: isolate;
    }
    .v1349-celest[data-theme="pearl"] {
      --bg-1: #f6f9ff;
      --bg-2: #e9f0ff;
      --ink: #0e1426;
      --muted: rgba(14,20,38,0.7);
      --accent: #2a7fff;
      --accent-2: #9a7cff;
      --ring: rgba(14,20,38,0.12);
      --chip-bg: rgba(255,255,255,0.7);
      --chip-brd: rgba(14,20,38,0.12);
      background: radial-gradient(120% 140% at 85% 0%, var(--bg-2), var(--bg-1));
      box-shadow: 0 30px 90px rgba(10,20,40,0.18), inset 0 0 0 1px rgba(10,20,40,0.06);
    }

    /* animated border halo */
    .v1349-celest::before {
      content: "";
      position: absolute;
      inset: -1px;
      border-radius: inherit;
      padding: 1.5px;
      background:
        conic-gradient(from 0turn, var(--accent), var(--accent-2), transparent 20%, transparent 60%, var(--accent), var(--accent-2));
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
              mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
              mask-composite: exclude;
      opacity: 0.9;
      animation: v1349-spin 26s linear infinite;
      pointer-events: none;
      z-index: -1;
    }
    @keyframes v1349-spin { to { transform: rotate(360deg); } }

    /* top bar */
    .v1349-celest .mast {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }
    .v1349-celest .glyph {
      width: 44px; height: 44px; border-radius: 50%;
      display: grid; place-items: center;
      background: radial-gradient(circle at 35% 30%, rgba(255,255,255,0.16), rgba(255,255,255,0.04));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.12), 0 14px 28px rgba(0,0,0,0.35);
      position: relative;
      overflow: hidden;
    }
    .v1349-celest[data-theme="pearl"] .glyph {
      background: radial-gradient(circle at 35% 30%, rgba(255,255,255,0.9), rgba(255,255,255,0.6));
      box-shadow: inset 0 0 0 1px rgba(10,20,40,0.08), 0 12px 24px rgba(10,20,40,0.12);
    }
    .v1349-celest .glyph::after{
      content:"";
      position:absolute; inset: -40%;
      background: conic-gradient(from 0turn, var(--accent), transparent 35%, var(--accent-2), transparent 70%, var(--accent));
      animation: v1349-spin 10s linear infinite;
      opacity: 0.6;
      filter: blur(6px);
    }
    .v1349-celest .brand h2{
      margin: 0;
      font-weight: 900;
      letter-spacing: -0.02em;
      font-size: clamp(16px, 2vw, 20px);
    }
    .v1349-celest .brand .tag{
      margin-top: 2px;
      font-size: 12px;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: var(--muted);
    }
    .v1349-celest .chip {
      margin-left: auto;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--chip-brd);
      background: var(--chip-bg);
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
      backdrop-filter: blur(6px);
    }
    .v1349-celest .led {
      width: 9px; height: 9px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--accent), var(--accent-2));
      box-shadow: 0 0 0 2px rgba(255,255,255,0.08), 0 0 16px var(--accent);
    }
    .v1349-celest[data-paused="true"] .led {
      background: radial-gradient(circle at 30% 30%, #93a0c0, #6e7aa1);
      box-shadow: 0 0 0 2px rgba(255,255,255,0.06);
    }

    /* hero */
    .v1349-celest .hero {
      margin-top: clamp(8px, 1.6vw, 16px);
    }
    .v1349-celest h1{
      margin: 0;
      font-size: clamp(36px, 6.6vw, 88px);
      line-height: 1.02;
      letter-spacing: -0.02em;
      background: linear-gradient(180deg, var(--ink), color-mix(in oklab, var(--ink), transparent 35%));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-wrap: balance;
    }
    .v1349-celest .lede{
      margin: 10px 0 0 0;
      color: var(--muted);
      font-size: clamp(14px, 2vw, 18px);
      max-width: 70ch;
    }

    /* stage */
    .v1349-celest .stage {
      position: relative;
      margin-top: clamp(18px, 3vw, 28px);
      border-radius: 24px;
      overflow: hidden;
      aspect-ratio: 1 / 1;
      background:
        radial-gradient(60% 60% at 50% 55%, rgba(255,255,255,0.08), transparent 60%),
        radial-gradient(120% 90% at 50% 100%, rgba(0,0,0,0.25), transparent 70%);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.06),
        0 22px 60px rgba(0,0,0,0.5);
    }
    .v1349-celest[data-theme="pearl"] .stage {
      background:
        radial-gradient(60% 60% at 50% 55%, rgba(255,255,255,0.7), transparent 60%),
        radial-gradient(120% 90% at 50% 100%, rgba(10,20,40,0.06), transparent 70%);
      box-shadow:
        inset 0 0 0 1px rgba(10,20,40,0.08),
        0 20px 56px rgba(10,20,40,0.16);
    }
    .v1349-celest canvas{
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      filter: saturate(115%) contrast(106%);
    }
    .v1349-celest .caustic {
      position: absolute;
      inset: -30%;
      pointer-events: none;
      background:
        radial-gradient(40% 50% at 30% 30%, rgba(122,224,255,0.13), transparent 60%),
        radial-gradient(40% 50% at 70% 70%, rgba(178,156,255,0.10), transparent 60%),
        radial-gradient(35% 35% at 50% 50%, rgba(255,255,255,0.06), transparent 70%);
      mix-blend-mode: screen;
      animation: v1349-drift 22s ease-in-out infinite alternate;
      transform: rotate(12deg);
    }
    .v1349-celest[data-theme="pearl"] .caustic { mix-blend-mode: multiply; opacity: 0.7; }
    @keyframes v1349-drift {
      0% { transform: translate3d(-2%, 1%, 0) rotate(8deg) scale(1.03); }
      100% { transform: translate3d(2%, -1%, 0) rotate(-6deg) scale(1.06); }
    }

    /* controls */
    .v1349-celest .controlbar{
      position: absolute;
      left: 12px; right: 12px; bottom: 12px;
      display: flex; gap: 10px; align-items: center; flex-wrap: wrap;
      z-index: 2;
    }
    .v1349-celest .pill{
      padding: 8px 12px; border-radius: 999px;
      border: 1px dashed var(--chip-brd);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      color: var(--muted);
      font-size: 12px;
      display: inline-flex; align-items: center; gap: 8px;
      backdrop-filter: blur(6px);
    }
    .v1349-celest[data-theme="pearl"] .pill{
      background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.45));
      color: var(--muted);
    }
    .v1349-celest .btn {
      appearance: none;
      border: 1px solid var(--chip-brd);
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 800; font-size: 13px; letter-spacing: 0.02em;
      background: linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.04));
      color: var(--ink);
      cursor: pointer;
      transition: transform 160ms ease, box-shadow 220ms ease, background 240ms ease, color 240ms ease, border-color 240ms ease;
      box-shadow: 0 14px 26px rgba(0,0,0,0.35);
    }
    .v1349-celest .btn:hover { transform: translateY(-1px); box-shadow: 0 16px 30px rgba(0,0,0,0.45); }
    .v1349-celest .btn:active { transform: translateY(0); }
    .v1349-celest[data-theme="pearl"] .btn {
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6));
      color: #0e1426;
      box-shadow: 0 12px 24px rgba(10,20,40,0.15);
    }

    /* lens cue */
    .v1349-celest .lens {
      position: absolute;
      width: 140px; height: 140px;
      pointer-events: none;
      border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.22), rgba(255,255,255,0.06) 45%, transparent 60%),
                  radial-gradient(circle at 65% 65%, rgba(122,224,255,0.10), transparent 50%);
      mix-blend-mode: screen;
      opacity: 0;
      transition: opacity 240ms ease, transform 160ms ease;
      filter: blur(0.2px);
      transform: translate(-50%, -50%) scale(0.98);
      z-index: 1;
    }
    .v1349-celest[data-theme="pearl"] .lens { mix-blend-mode: multiply; }
    .v1349-celest .lens.active { opacity: 0.9; transform: translate(-50%, -50%) scale(1); }

    /* accessibility & responsive */
    @media (prefers-reduced-motion: reduce) {
      .v1349-celest::before, .v1349-celest .caustic { animation: none !important; }
      .v1349-celest .btn { transition: none; }
    }
    @media (max-width: 760px){
      .v1349-celest .chip, .v1349-celest .controlbar { gap: 8px; }
      .v1349-celest .controlbar { left: 10px; right: 10px; bottom: 10px; }
    }
  </style>

  <div class="mast">
    <div class="glyph" aria-hidden="true"></div>
    <div class="brand">
      <h2>Orbital</h2>
      <div class="tag">Kinetic Timepiece</div>
    </div>
    <div class="chip" aria-live="polite">
      <span class="led" aria-hidden="true"></span>
      <span id="last-updated">Last updated: 2025-12-17 11:26:24 EST</span>
    </div>
  </div>

  <div class="hero">
    <h1>Time, drawn in light.</h1>
    <p class="lede">Hours as halos, minutes as rings, seconds as sparks. Drag to bend the paths; add orbits to play.</p>
  </div>

  <div class="stage" aria-label="Orbital Canvas">
    <canvas id="orbits"></canvas>
    <div class="caustic" aria-hidden="true"></div>
    <div class="lens" id="lens" aria-hidden="true"></div>
    <div class="controlbar">
      <div class="pill">Local <strong id="clock" style="font-variant-numeric: tabular-nums;">--:--:--</strong></div>
      <button class="btn" id="pause" aria-pressed="false">Pause</button>
      <button class="btn" id="theme" aria-pressed="false">Daylight</button>
      <button class="btn" id="add" aria-pressed="false">Add Orbit</button>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.v1349-celest');
      const canvas = root.querySelector('#orbits');
      const ctx = canvas.getContext('2d');
      const lens = root.querySelector('#lens');
      const pauseBtn = root.querySelector('#pause');
      const themeBtn = root.querySelector('#theme');
      const addBtn = root.querySelector('#add');
      const clockEl = root.querySelector('#clock');
      const updated = root.querySelector('#last-updated');

      // timestamp
      try {
        const now = new Date();
        updated.textContent = "Updated " + now.toLocaleString(undefined, {
          year: 'numeric', month: 'short', day: '2-digit',
          hour: '2-digit', minute: '2-digit', second: '2-digit',
          timeZoneName: 'short'
        });
      } catch { updated.textContent = "Updated " + new Date().toString(); }

      // sizing
      let w=0,h=0,dpr=Math.max(1, Math.min(window.devicePixelRatio||1, 2));
      function resize(){
        const r = canvas.getBoundingClientRect();
        w = Math.max(1, Math.floor(r.width));
        h = Math.max(1, Math.floor(r.height));
        canvas.width = Math.floor(w*dpr);
        canvas.height = Math.floor(h*dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      resize();
      window.addEventListener('resize', resize);

      const center = ()=>({x: w/2, y: h/2});
      let raf = null, t = 0;
      const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      // pointer / lens
      const pointer = {x: w/2, y: h/2, active: false, strength: 12000};
      function setLens(e){
        const rect = canvas.getBoundingClientRect();
        pointer.x = e.clientX - rect.left;
        pointer.y = e.clientY - rect.top;
        lens.style.left = e.clientX - rect.left + "px";
        lens.style.top = e.clientY - rect.top + "px";
        lens.classList.add('active');
        pointer.active = true;
      }
      function clearLens(){ pointer.active = false; lens.classList.remove('active'); }

      root.addEventListener('pointermove', setLens);
      root.addEventListener('pointerdown', setLens);
      root.addEventListener('pointerleave', clearLens);
      root.addEventListener('pointerup', ()=>{ pointer.active = false; });

      // rings
      const rings = [];
      function hsl(h,s,l,a=1){ return `hsla(${h},${s}%,${l}%,${a})`; }

      function basePalette(theme){
        if (theme==='pearl') {
          return [
            {h:210,s:90,l:46},
            {h:260,s:85,l:55},
            {h:330,s:80,l:54},
            {h:42,s:95,l:52}
          ];
        }
        return [
          {h:190,s:95,l:60},
          {h:260,s:90,l:66},
          {h:310,s:90,l:64},
          {h:198,s:94,l:68}
        ];
      }
      let palette = basePalette(root.getAttribute('data-theme'));

      function timeAngles(){
        const d = new Date();
        const ms = d.getMilliseconds();
        const s = d.getSeconds() + ms/1000;
        const m = d.getMinutes() + s/60;
        const hr = (d.getHours()%12) + m/60;
        const TAU = Math.PI*2;
        const base = -Math.PI/2; // 12 o'clock at top
        return {
          hour: base + (hr/12)*TAU,
          minute: base + (m/60)*TAU,
          second: base + (s/60)*TAU
        };
      }

      function makeTrail(limit=44){ const q=[]; return {
        push(p){ q.push(p); while(q.length>limit) q.shift(); },
        draw(color){
          if (q.length<2) return;
          ctx.save();
          ctx.globalCompositeOperation='lighter';
          for (let i=1;i<q.length;i++){
            const a = i/q.length;
            ctx.strokeStyle = color.replace('hsla','hsla').replace('%)', `%, ${Math.min(0.5, a*0.8)})`);
            ctx.lineWidth = Math.max(1, 3*a);
            ctx.beginPath();
            ctx.moveTo(q[i-1].x,q[i-1].y);
            ctx.lineTo(q[i].x,q[i].y);
            ctx.stroke();
          }
          ctx.restore();
        }
      };}

      function addCoreRings(){
        rings.length = 0;
        const c = center();
        const R = Math.min(w,h)/2 - 28;
        const layers = [
          { kind:'hour',   r: R*0.42, w: 8, col: palette[0], trail: makeTrail(70) },
          { kind:'minute', r: R*0.62, w: 7, col: palette[1], trail: makeTrail(60) },
          { kind:'second', r: R*0.80, w: 5, col: palette[2], trail: makeTrail(50) }
        ];
        layers.forEach(l=> rings.push({ ...l, phi: 0, speed: 0, jitter: Math.random()*0.002+0.001 }));
      }
      function addOrbit(){
        const R = Math.min(w,h)/2 - 28;
        const r = R*(0.30 + Math.random()*0.6);
        const col = palette[(rings.length)%palette.length];
        const speed = (Math.random()*0.6 + 0.15) * (Math.random()<0.5?-1:1);
        rings.push({
          kind:'free',
          r, w: 3 + Math.random()*3,
          col, phi: Math.random()*Math.PI*2,
          speed, trail: makeTrail(36), jitter: Math.random()*0.004+0.0015
        });
      }

      // background grid
      function drawGrid(){
        const c = center();
        const maxR = Math.min(w,h)/2 - 16;
        ctx.save();
        ctx.strokeStyle = getComputedStyle(root).getPropertyValue('--ring').trim() || 'rgba(255,255,255,0.12)';
        ctx.lineWidth = 1;
        ctx.setLineDash([2,6]);
        for (let i=1;i<=6;i++){
          ctx.beginPath();
          ctx.arc(c.x, c.y, (maxR*i/6), 0, Math.PI*2);
          ctx.stroke();
        }
        ctx.setLineDash([]);
        // 12 ticks
        for (let i=0;i<12;i++){
          const a = -Math.PI/2 + i*(Math.PI*2/12);
          const r0 = maxR*0.86, r1 = maxR*0.92;
          ctx.beginPath();
          ctx.moveTo(c.x + r0*Math.cos(a), c.y + r0*Math.sin(a));
          ctx.lineTo(c.x + r1*Math.cos(a), c.y + r1*Math.sin(a));
          ctx.stroke();
        }
        ctx.restore();
      }

      function drawRings(){
        const c = center();
        const theme = root.getAttribute('data-theme');
        const TAU = Math.PI*2;
        const laps = timeAngles();

        // face glow
        ctx.save();
        const g = ctx.createRadialGradient(c.x, c.y, Math.min(w,h)*0.05, c.x, c.y, Math.min(w,h)*0.55);
        if (theme==='pearl'){ g.addColorStop(0,'rgba(255,255,255,0.5)'); g.addColorStop(1,'rgba(255,255,255,0)'); }
        else { g.addColorStop(0,'rgba(122,224,255,0.12)'); g.addColorStop(1,'rgba(0,0,0,0)'); }
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);
        ctx.restore();

        // ring strokes
        rings.forEach((r,i)=>{
          ctx.save();
          ctx.lineWidth = r.w;
          const hue = r.col.h + Math.sin((t*0.0006)+(i*0.8))*8;
          ctx.strokeStyle = hsl(hue, r.col.s, r.col.l, theme==='pearl' ? 0.55 : 0.4);
          ctx.beginPath();
          ctx.arc(c.x, c.y, r.r, 0, TAU);
          ctx.stroke();
          ctx.restore();

          // angle
          let ang = r.phi;
          if (r.kind==='hour')   ang = laps.hour;
          if (r.kind==='minute') ang = laps.minute;
          if (r.kind==='second') ang = laps.second;

          // wander for free rings
          if (r.kind==='free') r.phi += r.speed*0.01;

          // position on ring
          let x = c.x + r.r*Math.cos(ang);
          let y = c.y + r.r*Math.sin(ang);

          // gravitational nudge
          if (pointer.active){
            const dx = pointer.x - x, dy = pointer.y - y;
            const d2 = dx*dx + dy*dy + 60;
            const f = Math.min(18, pointer.strength / d2) * 0.06;
            x += dx * f;
            y += dy * f;
          }

          // spark
          const grad = ctx.createRadialGradient(x, y, 0, x, y, 16);
          grad.addColorStop(0, hsl(hue, r.col.s, Math.min(90, r.col.l+18), 0.95));
          grad.addColorStop(1, hsl(hue, r.col.s, r.col.l, 0));
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(x,y, Math.max(2.5, r.w*0.9), 0, TAU);
          ctx.fill();

          // trail
          if (r.trail){ r.trail.push({x,y}); r.trail.draw(hsl(hue, r.col.s, r.col.l, 0.4)); }
        });

        // center cap
        ctx.save();
        const cap = ctx.createRadialGradient(c.x,c.y, 0, c.x,c.y, 22);
        cap.addColorStop(0, 'rgba(255,255,255,0.85)');
        cap.addColorStop(1, 'rgba(255,255,255,0.0)');
        ctx.fillStyle = cap;
        ctx.beginPath();
        ctx.arc(c.x,c.y,22,0,TAU);
        ctx.fill();
        ctx.restore();
      }

      function drawBackground(){
        ctx.clearRect(0,0,w,h);
        // soft vignette
        ctx.save();
        const vg = ctx.createRadialGradient(w/2,h/2, Math.min(w,h)*0.1, w/2,h/2, Math.max(w,h)*0.7);
        const theme = root.getAttribute('data-theme');
        if (theme==='pearl'){
          vg.addColorStop(0,'rgba(255,255,255,0.65)');
          vg.addColorStop(1,'rgba(10,20,40,0.03)');
        } else {
          vg.addColorStop(0,'rgba(122,224,255,0.08)');
          vg.addColorStop(1,'rgba(0,0,0,0.28)');
        }
        ctx.fillStyle = vg;
        ctx.fillRect(0,0,w,h);
        ctx.restore();
        drawGrid();
      }

      function loop(){
        t += 16;
        drawBackground();
        drawRings();
        raf = requestAnimationFrame(loop);
      }

      function start(){ if(!raf && !reduced){ raf = requestAnimationFrame(loop);} }
      function stop(){ if(raf){ cancelAnimationFrame(raf); raf = null; } }

      // clock text update
      function tickClock(){
        const d = new Date();
        clockEl.textContent = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'});
      }
      const clockTimer = setInterval(tickClock, 250);

      // controls
      pauseBtn.addEventListener('click', ()=>{
        const paused = root.getAttribute('data-paused')==='true';
        if (paused){
          root.setAttribute('data-paused','false');
          pauseBtn.textContent = 'Pause';
          pauseBtn.setAttribute('aria-pressed','false');
          start();
        } else {
          root.setAttribute('data-paused','true');
          pauseBtn.textContent = 'Resume';
          pauseBtn.setAttribute('aria-pressed','true');
          stop();
        }
      });

      themeBtn.addEventListener('click', ()=>{
        const isPearl = root.getAttribute('data-theme')==='pearl';
        root.setAttribute('data-theme', isPearl ? 'noir' : 'pearl');
        themeBtn.textContent = isPearl ? 'Daylight' : 'Midnight';
        themeBtn.setAttribute('aria-pressed', String(!isPearl));
        palette = basePalette(isPearl ? 'noir' : 'pearl');
        addCoreRings();
        drawBackground();
        drawRings();
      });

      addBtn.addEventListener('click', ()=>{
        if (rings.filter(r=>r.kind==='free').length < 6) {
          addOrbit();
        } else {
          // gently shuffle colors if maxed
          palette = palette.map(p=>({
            h: (p.h + Math.floor(Math.random()*40 - 20) + 360)%360,
            s: Math.min(98, Math.max(60, p.s + Math.floor(Math.random()*16 - 8))),
            l: Math.min(85, Math.max(45, p.l + Math.floor(Math.random()*12 - 6)))
          }));
        }
      });

      // keyboard
      root.tabIndex = 0;
      root.addEventListener('keydown', (e)=>{
        if (e.code==='Space'){ e.preventDefault(); pauseBtn.click(); }
        if (e.key.toLowerCase()==='t'){ themeBtn.click(); }
        if (e.key.toLowerCase()==='a'){ addBtn.click(); }
      });

      // init
      addCoreRings();
      for (let i=0;i<2;i++) addOrbit();
      tickClock();
      drawBackground();
      drawRings();
      if (!reduced) start(); else {
        root.setAttribute('data-paused','true');
        pauseBtn.textContent = 'Resume';
        pauseBtn.setAttribute('aria-pressed','true');
      }

      // cleanup on detach
      document.addEventListener('visibilitychange', ()=>{
        if (document.hidden) stop(); else if (root.getAttribute('data-paused')!=='true') start();
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


