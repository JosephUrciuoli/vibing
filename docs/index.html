<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="kite" role="region" aria-label="Kite Studio" data-theme="dawn">
  <style>
    .kite{
      --bg: #0b0f16;
      --bg2:#0e1524;
      --fg: #eef3ff;
      --muted: color-mix(in oklab, var(--fg) 60%, transparent);
      --line: color-mix(in oklab, var(--fg) 18%, transparent);
      --glass: color-mix(in oklab, #0b1220 78%, transparent);
      --a: hsl(192 95% 60%);
      --b: hsl(304 85% 64%);
      --ring: color-mix(in oklab, var(--fg) 18%, transparent);

      position:relative; isolation:isolate;
      border-radius:32px; padding: clamp(16px, 3.2vw, 32px);
      color: var(--fg);
      background:
        radial-gradient(1400px 800px at var(--mx,70%) var(--my,20%), color-mix(in oklab, var(--a) 10%, transparent), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.04),
        0 80px 160px rgba(0,0,0,.6);
      font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      overflow:hidden;
    }
    .kite[data-theme="noon"]{
      --bg:#f6f9ff; --bg2:#e9f0fb;
      --fg:#0b1220; --muted: color-mix(in oklab, var(--fg) 58%, transparent);
      --glass: color-mix(in oklab, #ffffff 72%, transparent);
      --ring: color-mix(in oklab, var(--fg) 16%, transparent);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.7),
        0 60px 120px rgba(10,18,40,.18);
      background:
        radial-gradient(1200px 700px at var(--mx,30%) var(--my,35%), color-mix(in oklab, var(--b) 12%, transparent), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg2));
    }
    .kite::before{
      content:"";
      position:absolute; inset:-25%;
      background:
        radial-gradient(700px 700px at -10% 10%, color-mix(in oklab, var(--a) 18%, transparent), transparent 50%),
        radial-gradient(900px 700px at 110% -10%, color-mix(in oklab, var(--b) 16%, transparent), transparent 60%);
      filter: blur(46px) saturate(120%);
      opacity:.5; pointer-events:none; z-index:0;
    }

    /* Top bar */
    .rail{
      position:relative; z-index:2;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:12px;
    }
    .brand{
      display:inline-flex; align-items:center; gap:10px; font-weight:900; letter-spacing:.12em; text-transform:uppercase;
      font-size:12px; color: var(--muted);
    }
    .kite-glyph{
      width:18px; height:18px; border-radius:4px; transform: rotate(45deg);
      background: linear-gradient(135deg, var(--a), var(--b));
      box-shadow: 0 0 0 2px color-mix(in oklab, var(--a) 30%, transparent), 0 0 16px color-mix(in oklab, var(--b) 26%, transparent);
    }
    .seg{
      justify-self:center;
      display:inline-flex; gap:6px; padding:6px; border-radius:999px; align-items:center;
      border:1px solid var(--line); background: var(--glass);
      backdrop-filter: blur(10px) saturate(120%);
      font-size:12px; color: var(--muted);
      box-shadow: 0 8px 22px rgba(0,0,0,.10);
      user-select:none;
    }
    .seg button{
      appearance:none; border:0; background:transparent; color:var(--fg);
      padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:800; letter-spacing:.3px; font-size:12px;
      transition: transform .14s ease, background .2s ease, color .2s ease;
    }
    .seg button:hover{ transform: translateY(-1px); background: color-mix(in oklab, var(--fg) 10%, transparent); }
    .deck{ justify-self:end; display:flex; gap:8px; }
    .btn, .ghost{
      appearance:none; border:1px solid var(--line); cursor:pointer; padding:10px 14px; border-radius:14px;
      font-weight:800; letter-spacing:.3px; font-size:12px;
      color:var(--fg); background: var(--glass);
      transition: transform .14s ease, filter .18s ease, background .18s ease;
      backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 16px 28px rgba(0,0,0,.10);
    }
    .btn.primary{
      border:0; color:#0b0f16;
      background: linear-gradient(135deg, var(--a), var(--b));
      box-shadow: 0 16px 34px color-mix(in oklab, var(--a) 30%, transparent);
    }
    .btn:hover, .ghost:hover { transform: translateY(-1px) scale(1.01); }

    /* Layout */
    .stage{
      position:relative; z-index:1;
      margin-top: clamp(10px, 2.8vw, 18px);
      display:grid; grid-template-columns: 6fr 7fr; gap: clamp(12px, 2.2vw, 24px);
      min-height: clamp(520px, 60vw, 860px);
    }

    .card{
      align-self: stretch;
      border:1px solid var(--line); border-radius: 26px; overflow:hidden;
      background: var(--glass);
      backdrop-filter: blur(14px) saturate(130%);
      box-shadow: 0 30px 70px rgba(0,0,0,.14);
      display:grid; grid-template-rows: auto 1fr auto;
    }
    .pad{ padding: clamp(14px, 2.8vw, 28px); }

    .title{
      margin:0;
      font-size: clamp(42px, 8vw, 96px);
      line-height:.9; letter-spacing:-.02em;
      background: linear-gradient(180deg, var(--fg), color-mix(in oklab, var(--fg) 70%, var(--b)));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-wrap: balance;
    }
    .sub{ margin:10px 0 16px; color: var(--muted); font-size: clamp(14px, 2.2vw, 20px); }
    .ctas{ display:flex; gap:10px; flex-wrap:wrap; }

    .controls{
      display:grid; gap:12px;
    }
    .glass{
      display:flex; align-items:center; gap:10px; padding:10px; border-radius:14px;
      border:1px solid var(--line); background: var(--glass);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }
    .range{ --track: color-mix(in oklab, var(--fg) 16%, transparent); --fill: linear-gradient(90deg, var(--a), var(--b)); width:100%; justify-content:space-between; }
    .range label{ font-weight:800; font-size:12px; color: var(--muted); }
    .range input{ -webkit-appearance:none; appearance:none; width: 60%; height: 28px; background: transparent; cursor: pointer; }
    .range input::-webkit-slider-runnable-track{ height:6px; border-radius:999px; background: var(--track); border:1px solid var(--line); }
    .range input::-moz-range-track{ height:6px; border-radius:999px; background: var(--track); border:1px solid var(--line); }
    .range input::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%; margin-top:-6px; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--a) 28%, transparent);
    }
    .range input::-moz-range-thumb{
      width:18px; height:18px; border-radius:50%; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--a) 28%, transparent);
    }
    .val{
      font-variant-numeric: tabular-nums; font-weight:800; font-size:12px; color:var(--muted);
      padding:4px 8px; border-radius:999px; border:1px solid var(--line);
      background: color-mix(in oklab, var(--bg) 70%, transparent);
    }

    .chips{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
      width:28px; height:28px; border-radius:8px; border:1px solid var(--line); cursor:pointer; position:relative;
      box-shadow: inset 0 4px 10px rgba(0,0,0,.08);
    }
    .chip[aria-checked="true"]::after{
      content:""; position:absolute; inset:-3px; border-radius:10px;
      border: 2px solid color-mix(in oklab, var(--a) 42%, var(--b));
      box-shadow: 0 0 0 2px rgba(0,0,0,.04);
    }

    /* Canvas side */
    .skybox{
      position:relative; border-radius:26px; overflow:hidden;
      border:1px solid var(--line);
      background: linear-gradient(180deg, color-mix(in oklab, var(--bg) 88%, transparent), color-mix(in oklab, var(--bg2) 68%, transparent));
      box-shadow: 0 30px 70px rgba(0,0,0,.14);
      transform-style:preserve-3d; will-change: transform;
    }
    canvas.kites{ position:absolute; inset:0; width:100%; height:100%; display:block; filter: saturate(112%) contrast(102%); }

    .caption{
      position:absolute; left:14px; bottom:14px; right:14px;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      color: var(--muted); font-size:12px;
      padding:8px 10px; border-radius:12px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(8px);
    }

    /* Footer */
    .foot{
      position:relative; z-index:2; margin-top: 16px;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; color:var(--muted); font-size:12px;
    }
    .stamp{
      justify-self:center; display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius: 999px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(6px);
    }

    /* Motion helpers */
    .kite.alive .float{ animation: float 14s ease-in-out infinite; }
    @keyframes float{
      0%{ transform: translateY(0px); } 50%{ transform: translateY(-6px); } 100%{ transform: translateY(0px); }
    }
    @media (max-width: 980px){
      .stage{ grid-template-columns: 1fr; }
    }
    @media (prefers-reduced-motion: reduce){
      .kite * { animation: none !important; transition: none !important; }
    }
  </style>

  <div class="rail">
    <div class="brand"><span class="kite-glyph" aria-hidden="true"></span> Kite Studio</div>
    <div class="seg" role="group" aria-label="Playback">
      <button class="t-theme" title="Toggle day/night" aria-pressed="false">Theme</button>
      <button class="t-play" title="Start/Stop breeze" aria-pressed="true">Pause</button>
    </div>
    <div class="deck" aria-label="Quick actions">
      <button class="btn primary t-launch" title="Launch more kites">Launch</button>
      <button class="ghost t-shuffle" title="Shuffle palette">Shuffle</button>
    </div>
  </div>

  <div class="stage">
    <article class="card float">
      <div class="pad">
        <h1 class="title">Kinetic Calm</h1>
        <p class="sub">Soft gradients, airy motion, and a hint of seaside wind. A living poster for quiet interfaces.</p>
        <div class="ctas">
          <button class="btn primary t-launch">Add 5</button>
          <button class="ghost t-notes">Design notes</button>
        </div>
      </div>

      <div class="pad controls" aria-label="Windboard">
        <div class="glass range">
          <label for="count">Kites</label>
          <input id="count" type="range" min="3" max="60" step="1" value="14" aria-valuemin="3" aria-valuemax="60" aria-valuenow="14" aria-label="Kite count">
          <span class="val v-count">14</span>
        </div>
        <div class="glass range">
          <label for="wind">Wind</label>
          <input id="wind" type="range" min="0" max="100" step="1" value="42" aria-label="Wind speed">
          <span class="val v-wind">42</span>
        </div>
        <div class="glass chips" role="radiogroup" aria-label="Palette">
          <div class="chip" role="radio" tabindex="0" aria-checked="true" data-p="reef" title="Reef" style="background:linear-gradient(135deg,hsl(192 95% 60%),hsl(304 85% 64%));"></div>
          <div class="chip" role="radio" tabindex="-1" aria-checked="false" data-p="sunset" title="Sunset" style="background:linear-gradient(135deg,hsl(14 90% 64%),hsl(340 80% 60%));"></div>
          <div class="chip" role="radio" tabindex="-1" aria-checked="false" data-p="fern" title="Fern" style="background:linear-gradient(135deg,hsl(90 55% 50%),hsl(160 70% 48%));"></div>
          <div class="chip" role="radio" tabindex="-1" aria-checked="false" data-p="iris" title="Iris" style="background:linear-gradient(135deg,hsl(250 85% 66%),hsl(200 85% 56%));"></div>
          <div class="chip" role="radio" tabindex="-1" aria-checked="false" data-p="amber" title="Amber" style="background:linear-gradient(135deg,hsl(44 92% 58%),hsl(14 90% 64%));"></div>
        </div>
      </div>

      <div class="pad" style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
        <div style="display:flex; align-items:center; gap:8px; color:var(--muted); font-size:12px;">
          <span aria-hidden="true" class="kite-glyph" style="width:12px;height:12px;box-shadow:none;"></span>
          Gentle interfaces prefer good spacing and honest colors.
        </div>
        <span class="val">Space toggles motion</span>
      </div>
    </article>

    <div class="skybox" aria-live="polite">
      <canvas class="kites" aria-hidden="true"></canvas>
      <div class="caption">
        <div>Drag the wind with your cursor</div>
        <div class="val stamp-time">
          <span id="last-updated">Last updated: 2025-11-30 03:22:01 EST</span>
        </div>
      </div>
    </div>
  </div>

  <div class="foot">
    <div class="quote">“Design is the wind you barely notice, but always feel.”</div>
    <div class="stamp">
      <span class="kite-glyph" aria-hidden="true" style="width:10px;height:10px;box-shadow:none;"></span>
      Kite Studio
    </div>
    <div class="hint">Tip: press Shuffle for a fresh palette</div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.kite');
      const canvas = root.querySelector('canvas.kites');
      const ctx = canvas.getContext('2d', { alpha: true });
      const themeBtn = root.querySelector('.t-theme');
      const playBtn = root.querySelector('.t-play');
      const launchBtns = [...root.querySelectorAll('.t-launch')];
      const shuffleBtn = root.querySelector('.t-shuffle');
      const notesBtn = root.querySelector('.t-notes');
      const sliderCount = root.querySelector('#count');
      const sliderWind = root.querySelector('#wind');
      const vCount = root.querySelector('.v-count');
      const vWind = root.querySelector('.v-wind');
      const chips = [...root.querySelectorAll('.chip')];
      const updated = root.querySelector('#last-updated');
      const skybox = root.querySelector('.skybox');

      // timestamp
      function fmt(d){
        try{
          return new Intl.DateTimeFormat(undefined, { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:true }).format(d);
        }catch(e){ return d.toLocaleString(); }
      }
      updated.textContent = 'Last updated: ' + fmt(new Date());

      // palettes
      const palettes = {
        reef:   ['hsl(192 95% 60%)','hsl(304 85% 64%)'],
        sunset: ['hsl(14 90% 64%)','hsl(340 80% 60%)'],
        fern:   ['hsl(90 55% 50%)','hsl(160 70% 48%)'],
        iris:   ['hsl(250 85% 66%)','hsl(200 85% 56%)'],
        amber:  ['hsl(44 92% 58%)','hsl(14 90% 64%)']
      };
      function setPalette(name){
        const [a,b] = palettes[name] || palettes.reef;
        root.style.setProperty('--a', a);
        root.style.setProperty('--b', b);
        chips.forEach(c=>{
          const on = c.dataset.p === name;
          c.setAttribute('aria-checked', on?'true':'false');
          c.tabIndex = on? 0 : -1;
        });
      }
      chips.forEach(c=>{
        c.addEventListener('click', ()=> setPalette(c.dataset.p));
        c.addEventListener('keydown', (e)=>{
          if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setPalette(c.dataset.p); }
          if(e.key==='ArrowRight'||e.key==='ArrowLeft'){
            const i = chips.findIndex(x=>x.getAttribute('aria-checked')==='true');
            const dir = e.key==='ArrowRight'?1:-1;
            const next = (i+dir+chips.length)%chips.length;
            chips[next].focus(); setPalette(chips[next].dataset.p);
          }
        });
      });
      setPalette('reef');

      // theme
      let day = false;
      function applyTheme(){ root.setAttribute('data-theme', day? 'noon':'dawn'); }
      themeBtn.addEventListener('click', ()=>{ day=!day; applyTheme(); });
      applyTheme();

      // motion toggle
      let running = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      function setRunning(on){
        running = on;
        root.classList.toggle('alive', on);
        playBtn.textContent = on? 'Pause':'Play';
        playBtn.setAttribute('aria-pressed', on? 'true':'false');
        if(on) raf();
      }
      playBtn.addEventListener('click', ()=> setRunning(!running));
      setRunning(running);

      // sliders
      const updateCount = (n)=>{ sliderCount.setAttribute('aria-valuenow', n); vCount.textContent = n; seed(+n); };
      const updateWind  = (n)=>{ vWind.textContent = n; wind.target = n/100; };
      sliderCount.addEventListener('input', ()=> updateCount(+sliderCount.value));
      sliderWind.addEventListener('input', ()=> updateWind(+sliderWind.value));

      // canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      function resize(){
        const r = canvas.getBoundingClientRect();
        canvas.width = Math.floor(r.width * dpr);
        canvas.height = Math.floor(r.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      const ro = new ResizeObserver(resize); ro.observe(canvas);
      resize();

      // wind + pointer
      const wind = { value: sliderWind.value/100, target: sliderWind.value/100, vx: 0, vy: 0, px: .5, py: .5, tx:.5, ty:.5 };
      skybox.addEventListener('pointermove', (e)=>{
        const rect = skybox.getBoundingClientRect();
        const nx = (e.clientX - rect.left)/rect.width;
        const ny = (e.clientY - rect.top)/rect.height;
        wind.tx = nx; wind.ty = ny;
        root.style.setProperty('--mx', (nx*100).toFixed(1)+'%');
        root.style.setProperty('--my', (ny*100).toFixed(1)+'%');
      }, {passive:true});
      skybox.addEventListener('pointerleave', ()=>{ wind.tx=.5; wind.ty=.5; }, {passive:true});

      // skybox tilt
      function tilt(){
        const rx = (wind.py - .5) * -10;
        const ry = (wind.px - .5) * 12;
        skybox.style.transform = `rotateX(${rx.toFixed(2)}deg) rotateY(${ry.toFixed(2)}deg) translateZ(40px)`;
      }

      // kite system
      const kites = [];
      const tails = 10;
      function rng(){ return (Math.sin(++rng.s*12345.678)%1+1)%1; } rng.s = 1;
      function spawn(){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        const s = 10 + rng()*26;
        const speed = 0.4 + rng()*1.4;
        const hueJit = rng()*0.6 + 0.7;
        const k = {
          x: rng()*w, y: rng()*h,
          vx: (rng()-.5)*speed, vy:(rng()-.5)*speed,
          size: s, wob: rng()*Math.PI*2, wobSpd: 0.8 + rng()*1.4,
          hueJit, tail: Array.from({length: tails}, ()=>({x:0,y:0})),
        };
        k.tail.forEach((t,i)=>{ t.x=k.x - i*2; t.y=k.y + i*2; });
        kites.push(k);
      }
      function seed(n){
        kites.length = 0;
        for(let i=0;i<n;i++) spawn();
      }
      seed(+sliderCount.value);

      // draw helpers
      function grad(a,b){ const g = ctx.createLinearGradient(0,0,canvas.clientWidth,canvas.clientHeight); g.addColorStop(0,a); g.addColorStop(1,b); return g; }

      // draw loop
      let t0 = performance.now();
      function draw(now){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        ctx.clearRect(0,0,w,h);

        // background mist
        const gbg = ctx.createLinearGradient(0,0,0,h);
        const isDay = root.dataset.theme === 'noon';
        gbg.addColorStop(0, isDay? 'rgba(246,249,255,0.55)':'rgba(11,15,22,0.55)');
        gbg.addColorStop(1, isDay? 'rgba(233,239,251,0.85)':'rgba(10,14,22,0.85)');
        ctx.fillStyle = gbg;
        ctx.fillRect(0,0,w,h);

        // ease pointer + wind
        wind.px += (wind.tx - wind.px)*0.06;
        wind.py += (wind.ty - wind.py)*0.06;
        wind.value += (wind.target - wind.value)*0.04;
        wind.vx = (wind.px - .5) * (0.6 + wind.value*1.8);
        wind.vy = (wind.py - .5) * (0.4 + wind.value*1.2);
        tilt();

        // palette
        const gradA = getComputedStyle(root).getPropertyValue('--a').trim();
        const gradB = getComputedStyle(root).getPropertyValue('--b').trim();
        const g = grad(gradA, gradB);

        // kites
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';
        for(const k of kites){
          // motion
          const time = (now - t0)/1000;
          k.wob += k.wobSpd*0.015;
          k.vx += Math.cos(k.wob)*0.02 * wind.value + wind.vx*0.01;
          k.vy += Math.sin(k.wob)*0.02 * wind.value + wind.vy*0.01;
          k.vx *= 0.996; k.vy *= 0.996;
          k.x += k.vx + wind.vx*0.2;
          k.y += k.vy + wind.vy*0.2;

          // wrap
          if(k.x<-40) k.x = w+40; if(k.x>w+40) k.x=-40;
          if(k.y<-40) k.y = h+40; if(k.y>h+40) k.y=-40;

          // tail physics
          const head = {x:k.x, y:k.y};
          k.tail[0].x += (head.x - k.tail[0].x)*0.3;
          k.tail[0].y += (head.y - k.tail[0].y)*0.3;
          for(let i=1;i<k.tail.length;i++){
            k.tail[i].x += (k.tail[i-1].x - k.tail[i].x)*0.28;
            k.tail[i].y += (k.tail[i-1].y - k.tail[i].y)*0.28;
          }

          // draw tail diamonds
          ctx.strokeStyle = g;
          ctx.fillStyle = g;
          ctx.globalAlpha = 0.85;
          for(let i=2;i<k.tail.length;i++){
            const t = k.tail[i];
            const s = Math.max(1, (k.size/8) * (1 - i/k.tail.length));
            ctx.save();
            ctx.translate(t.x, t.y);
            ctx.rotate((Math.atan2(k.vy, k.vx)+Math.PI/4));
            ctx.beginPath();
            ctx.moveTo(0,-s); ctx.lineTo(s,0); ctx.lineTo(0,s); ctx.lineTo(-s,0); ctx.closePath();
            ctx.fill();
            ctx.restore();
          }

          // draw kite (rotated diamond + cross spars)
          const a = Math.atan2(k.vy, k.vx) - Math.PI/4;
          const s = k.size;
          ctx.save();
          ctx.translate(k.x, k.y);
          ctx.rotate(a);
          const bodyGrad = ctx.createLinearGradient(-s, -s, s, s);
          bodyGrad.addColorStop(0, gradA);
          bodyGrad.addColorStop(1, gradB);
          ctx.fillStyle = bodyGrad;
          ctx.shadowColor = gradB; ctx.shadowBlur = 12;
          ctx.beginPath();
          ctx.moveTo(0,-s);
          ctx.lineTo(s,0);
          ctx.lineTo(0,s);
          ctx.lineTo(-s,0);
          ctx.closePath();
          ctx.fill();
          ctx.shadowBlur = 0;
          // spars
          ctx.globalAlpha = 0.45;
          ctx.strokeStyle = isDay? 'rgba(0,0,0,.5)':'rgba(255,255,255,.6)';
          ctx.lineWidth = 1.2;
          ctx.beginPath(); ctx.moveTo(-s,0); ctx.lineTo(s,0); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(0,-s); ctx.lineTo(0,s); ctx.stroke();
          ctx.restore();

          // glow puff
          const rg = ctx.createRadialGradient(k.x, k.y, 0, k.x, k.y, s*3);
          rg.addColorStop(0, gradA);
          rg.addColorStop(1, 'rgba(255,255,255,0)');
          ctx.globalAlpha = 0.22;
          ctx.fillStyle = rg;
          ctx.beginPath(); ctx.arc(k.x, k.y, s*2.6, 0, Math.PI*2); ctx.fill();
          ctx.globalAlpha = 1;
        }
        ctx.restore();
      }

      let af;
      function raf(){
        if(!running) return;
        af = requestAnimationFrame(function step(ts){
          if(!running) return;
          draw(ts);
          af = requestAnimationFrame(step);
        });
      }
      if(running) raf();

      // interactions
      launchBtns.forEach(b=> b.addEventListener('click', ()=>{
        const add = 5;
        const n = Math.min(60, (+sliderCount.value) + add);
        sliderCount.value = n; updateCount(n);
      }));
      shuffleBtn.addEventListener('click', ()=>{
        const i = Math.floor(Math.random()*chips.length);
        setPalette(chips[i].dataset.p);
      });
      notesBtn?.addEventListener('click', ()=>{
        alert('Notes: reduce chrome • celebrate whitespace • motion with purpose • color as guidance, not garnish.');
      });

      // keyboard
      root.addEventListener('keydown', (e)=>{
        const inside = root.contains(e.target);
        if((e.key===' '||e.code==='Space') && inside){ e.preventDefault(); setRunning(!running); }
      });

      // resize / DPR changes
      window.addEventListener('resize', ()=>{
        const newDpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        if(newDpr !== dpr){ dpr = newDpr; }
        resize();
        seed(+sliderCount.value);
      });

      // init pointer pos
      root.style.setProperty('--mx','70%'); root.style.setProperty('--my','20%');
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


