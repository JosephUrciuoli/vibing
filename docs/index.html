<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="vibe882" data-theme="midnight" aria-live="polite">
  <style>
    .vibe882 {
      --fg: #eaf1ff;
      --muted: #a6b4cf;
      --panel: rgba(18,22,34,0.55);
      --line: rgba(255,255,255,0.14);
      --accent: #78e1ff;
      --bg-a: #05080f;
      --bg-b: #0c1322;
      --ring-a: #7ef5c8;
      --ring-b: #b17dff;
      --radius: 26px;
      --spin: 0deg;
      position: relative;
      padding: 28px;
      border-radius: var(--radius);
      color: var(--fg);
      background:
        radial-gradient(1200px 800px at 120% -20%, rgba(160,180,255,0.28), transparent 60%),
        radial-gradient(1100px 700px at -20% 120%, rgba(255,160,160,0.20), transparent 65%),
        conic-gradient(from var(--spin), rgba(255,255,255,0.06), transparent 20%, rgba(255,255,255,0.06) 40%, transparent 60%, rgba(255,255,255,0.06) 80%, transparent),
        linear-gradient(180deg, var(--bg-a), var(--bg-b));
      box-shadow:
        0 1px 0 rgba(255,255,255,0.06) inset,
        0 50px 120px rgba(0,0,0,0.50);
      overflow: hidden;
      isolation: isolate;
    }
    .vibe882[data-theme="dawn"] {
      --fg: #0d1022;
      --muted: #505d7b;
      --panel: rgba(255,255,255,0.60);
      --line: rgba(16,22,40,0.12);
      --accent: #546cff;
      --bg-a: #fcfdff;
      --bg-b: #eef4ff;
      --ring-a: #ff9a6b;
      --ring-b: #26d7b0;
      background:
        radial-gradient(1200px 800px at 0% -20%, rgba(255,214,176,0.35), transparent 60%),
        radial-gradient(1100px 700px at 120% 120%, rgba(123,126,255,0.22), transparent 65%),
        conic-gradient(from var(--spin), rgba(0,0,0,0.03), transparent 20%, rgba(0,0,0,0.03) 40%, transparent 60%, rgba(0,0,0,0.03) 80%, transparent),
        linear-gradient(180deg, var(--bg-a), var(--bg-b));
    }
    .vibe882 * { box-sizing: border-box; }
    .vibe882 .grain {
      position: absolute; inset: 0; pointer-events: none; z-index: 1;
      background:
        repeating-conic-gradient(from 0deg, rgba(255,255,255,0.02) 0 6deg, transparent 6deg 12deg),
        radial-gradient(200px 200px at 20% 10%, rgba(255,255,255,0.08), transparent 60%),
        radial-gradient(300px 300px at 90% 80%, rgba(255,255,255,0.06), transparent 70%);
      mix-blend-mode: overlay; opacity: .35;
    }

    /* Header */
    .vibe882 .chrome {
      position: relative;
      z-index: 2;
      display: grid;
      gap: 18px;
    }
    .vibe882 .topline {
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
    }
    .vibe882 .brand {
      display: inline-flex; align-items: center; gap: 12px; user-select: none;
      padding: 8px 12px; border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.02));
      border: 1px solid var(--line);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.35);
    }
    .vibe882 .seal {
      width: 28px; height: 28px; border-radius: 10px; position: relative; overflow: hidden;
      background: radial-gradient(circle at 30% 30%, var(--ring-a), transparent 60%), radial-gradient(circle at 70% 70%, var(--ring-b), transparent 60%);
      box-shadow: 0 0 0 1px rgba(255,255,255,0.6) inset, 0 10px 22px rgba(0,0,0,0.25);
      transform: rotate(22deg);
    }
    .vibe882 .brand b {
      font: 900 12px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      letter-spacing: .18em; text-transform: uppercase;
      color: color-mix(in oklab, var(--fg) 85%, var(--muted));
      white-space: nowrap;
    }

    .vibe882 .controls { display: flex; flex-wrap: wrap; gap: 8px; }
    .vibe882 .chip {
      appearance: none; border: 1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), color-mix(in oklab, var(--panel) 50%, transparent));
      color: var(--fg); padding: 10px 12px; border-radius: 999px;
      font: 800 11px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      letter-spacing: .12em; text-transform: uppercase; cursor: pointer;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.45);
      transition: transform 160ms ease, box-shadow 220ms ease, background 220ms ease, opacity 180ms ease;
    }
    .vibe882 .chip:hover { transform: translateY(-1px); }
    .vibe882 .chip:focus-visible { outline: none; box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent) 60%, white 20%); }

    /* Hero */
    .vibe882 .hero {
      position: relative;
      border: 1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), color-mix(in oklab, var(--panel) 55%, transparent));
      backdrop-filter: blur(14px) saturate(120%);
      border-radius: 24px;
      padding: 18px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.4), 0 18px 46px rgba(0,0,0,0.28);
    }
    .vibe882 h1 {
      margin: 0 0 8px;
      font: 1000 clamp(28px, 6vw, 62px)/1.02 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      letter-spacing: -0.03em;
      background: linear-gradient(90deg, var(--ring-a), var(--ring-b), var(--accent));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 1px 0 rgba(255,255,255,0.35);
    }
    .vibe882 .sub {
      margin: 0 0 14px;
      color: var(--muted);
      font: 500 14px/1.6 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
    }

    /* Stage */
    .vibe882 .stage {
      position: relative; z-index: 2;
      border: 1px dashed var(--line);
      border-radius: 22px;
      padding: 10px;
      background: linear-gradient(180deg, color-mix(in oklab, var(--panel) 65%, transparent), transparent);
    }
    .vibe882 .orbital {
      position: relative;
      border-radius: 20px;
      overflow: hidden;
      height: min(70vh, 560px);
      min-height: 320px;
      background:
        radial-gradient(circle at 50% 50%, rgba(255,255,255,0.08), transparent 60%),
        radial-gradient(600px 600px at -10% 120%, rgba(255,255,255,0.06), transparent 50%);
      perspective: 1200px;
    }
    .vibe882 .layer {
      position: absolute; inset: 0; transform-style: preserve-3d;
      transition: transform 0.2s ease;
    }
    .vibe882 canvas.orrery {
      position: absolute; inset: 0; width: 100%; height: 100%;
    }
    .vibe882 .ringOverlay {
      position: absolute; inset: 0; pointer-events: none; z-index: 2;
      background:
        radial-gradient(closest-side, transparent calc(50% - 1px), rgba(255,255,255,0.18) calc(50%), transparent calc(50% + 1px)) center/100% 100% no-repeat;
      opacity: .6;
      mix-blend-mode: screen;
    }
    .vibe882 .ticks {
      position: absolute; inset: 10% 10%; border-radius: 50%; pointer-events: none; z-index: 3;
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.12);
      mask-image: radial-gradient(circle at 50% 50%, transparent 43%, black 44%);
    }

    /* Panel */
    .vibe882 .panel {
      display: grid; gap: 14px; grid-template-columns: 1.1fr .9fr;
      margin-top: 14px;
    }
    @media (max-width: 760px) { .vibe882 .panel { grid-template-columns: 1fr; } }

    .vibe882 .actionbar { display: flex; flex-wrap: wrap; gap: 10px; }
    .vibe882 .btn {
      appearance: none; border: 0; cursor: pointer; border-radius: 16px;
      padding: 12px 16px;
      font: 900 13px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      letter-spacing: .02em;
      transition: transform 160ms ease, box-shadow 220ms ease, background 220ms ease, opacity 180ms ease;
    }
    .vibe882 .btn.primary {
      color: #0a1018;
      background: linear-gradient(180deg, color-mix(in oklab, var(--ring-a) 70%, white 10%), color-mix(in oklab, var(--ring-b) 55%, black 0%));
      text-shadow: 0 1px 0 rgba(255,255,255,0.55);
      box-shadow: 0 14px 34px color-mix(in oklab, var(--ring-a) 28%, black 62%);
    }
    .vibe882 .btn.ghost {
      color: var(--fg);
      background: linear-gradient(180deg, rgba(255,255,255,0.60), rgba(255,255,255,0.28));
      border: 1px solid var(--line);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.45);
    }
    .vibe882 .btn:hover { transform: translateY(-1px); }
    .vibe882 .btn:focus-visible { outline: none; box-shadow: 0 0 0 3px color-mix(in oklab, var(--accent) 60%, white 20%), 0 8px 24px rgba(0,0,0,0.25); }

    .vibe882 .controlsRow {
      display: grid; gap: 12px; grid-template-columns: 1fr;
      border: 1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), color-mix(in oklab, var(--panel) 55%, transparent));
      border-radius: 18px; padding: 14px;
      backdrop-filter: blur(12px) saturate(115%);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.4);
    }
    .vibe882 .controlGroup { display: grid; gap: 10px; }
    .vibe882 label {
      font: 800 11px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      letter-spacing: .18em; text-transform: uppercase; color: color-mix(in oklab, var(--fg) 75%, var(--muted));
    }
    .vibe882 input[type="range"] {
      -webkit-appearance: none; appearance: none; width: 100%;
      height: 6px; border-radius: 999px; outline: none; cursor: pointer;
      background: linear-gradient(90deg, var(--ring-a), var(--ring-b), var(--accent));
    }
    .vibe882 input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 18px; height: 18px; border-radius: 50%;
      background: #fff; border: 2px solid color-mix(in oklab, var(--accent) 70%, white 10%);
      box-shadow: 0 6px 16px rgba(0,0,0,0.25);
    }
    .vibe882 input[type="range"]::-moz-range-thumb {
      width: 18px; height: 18px; border-radius: 50%;
      background: #fff; border: 2px solid color-mix(in oklab, var(--accent) 70%, white 10%);
      box-shadow: 0 6px 16px rgba(0,0,0,0.25);
    }

    /* Stats */
    .vibe882 .stats {
      margin-top: 12px;
      display: grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 10px;
    }
    .vibe882 .stat {
      border: 1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), color-mix(in oklab, var(--panel) 55%, transparent));
      border-radius: 16px; padding: 12px;
      backdrop-filter: blur(10px) saturate(115%);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.4);
    }
    .vibe882 .stat b {
      display: block; font: 900 22px/1.1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      letter-spacing: -0.01em; color: var(--fg);
    }
    .vibe882 .stat span {
      display: block; margin-top: 2px; color: var(--muted);
      font: 700 12px/1.4 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
      letter-spacing: .08em; text-transform: uppercase;
    }

    /* Footer */
    .vibe882 .foot {
      margin-top: 14px; display: flex; align-items: center; justify-content: space-between; gap: 12px;
      color: var(--muted);
      font: 500 12px/1.45 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto;
    }
    .vibe882 .hint { display: inline-flex; align-items: center; gap: 8px; }
    .vibe882 .hint .dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 14px color-mix(in oklab, var(--accent) 70%, transparent);
      animation: breathe882 3s ease-in-out infinite;
    }
    @keyframes breathe882 { 0%,100% { transform: scale(.9); opacity: .8 } 50% { transform: scale(1.15); opacity: 1 } }

    @media (prefers-reduced-motion: reduce) {
      .vibe882 .hint .dot { animation: none; }
      .vibe882 .chip, .vibe882 .btn { transition: none; }
    }
  </style>

  <div class="grain" aria-hidden="true"></div>

  <div class="chrome" role="region" aria-label="Orbital Almanac 882">
    <div class="topline">
      <div class="brand" aria-label="Brand">
        <span class="seal" aria-hidden="true"></span>
        <b>Orbital Almanac â€¢ 882</b>
      </div>
      <div class="controls">
        <button class="chip" data-action="theme" aria-pressed="true" title="Toggle Dawn/Midnight">Midnight</button>
        <button class="chip" data-action="motion" aria-pressed="true" title="Pause/Play">Motion: On</button>
        <button class="chip" data-action="palette" title="Cycle palette">Palette: Prism</button>
        <button class="chip" data-action="center" title="Re-center tilt">Center</button>
      </div>
    </div>

    <section class="hero" aria-label="Headline">
      <h1>Time, Drawn in Orbits</h1>
      <p class="sub">A kinetic clock-orrery. Hours, minutes, seconds become planets with luminous trails. Tilt with your cursor. Speed time as you wish.</p>

      <div class="stage" aria-label="Orbital stage">
        <div class="orbital" data-tilt>
          <div class="layer">
            <canvas class="orrery" aria-hidden="true"></canvas>
            <div class="ringOverlay" aria-hidden="true"></div>
            <div class="ticks" aria-hidden="true"></div>
          </div>
        </div>
      </div>

      <div class="panel" aria-label="Actions and controls">
        <div class="actionbar">
          <button class="btn primary" data-action="pulse">Ping Orbit</button>
          <button class="btn ghost" data-action="remix">Remix</button>
        </div>
        <div class="controlsRow">
          <div class="controlGroup">
            <label for="speedRange">Time Warp</label>
            <input id="speedRange" type="range" min="0" max="4" step="0.05" value="1.0" aria-label="Time warp speed">
          </div>
          <div class="controlGroup">
            <label for="trailRange">Trail Length</label>
            <input id="trailRange" type="range" min="10" max="160" step="5" value="80" aria-label="Trail length">
          </div>
        </div>
      </div>

      <div class="stats" role="list">
        <div class="stat" role="listitem"><b data-stat="orbiters">3</b><span>Orbiters</span></div>
        <div class="stat" role="listitem"><b data-stat="palette">Prism</b><span>Palette</span></div>
        <div class="stat" role="listitem"><b data-stat="motion">On</b><span>Motion</span></div>
      </div>
    </section>

    <div class="foot">
      <div class="hint"><span class="dot" aria-hidden="true"></span><span>Move cursor to tilt. Ping to send a ripple. Palette cycles colors.</span></div>
      <span id="last-updated">Last updated: 2025-11-25 22:13:27 EST</span>
    </div>
  </div>

  <script>
    (function () {
      const root = document.currentScript.closest('.vibe882');
      const canvas = root.querySelector('canvas.orrery');
      const ctx = canvas.getContext('2d');
      const layer = root.querySelector('.layer');
      const btnTheme = root.querySelector('[data-action="theme"]');
      const btnMotion = root.querySelector('[data-action="motion"]');
      const btnPalette = root.querySelector('[data-action="palette"]');
      const btnCenter = root.querySelector('[data-action="center"]');
      const btnPulse = root.querySelector('[data-action="pulse"]');
      const btnRemix = root.querySelector('[data-action="remix"]');
      const speedRange = root.querySelector('#speedRange');
      const trailRange = root.querySelector('#trailRange');
      const statPalette = root.querySelector('[data-stat="palette"]');
      const statMotion = root.querySelector('[data-stat="motion"]');
      const stamp = root.querySelector('#last-updated');

      // Timestamp
      try {
        const d = new Date();
        const fmt = new Intl.DateTimeFormat(undefined, { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', timeZoneName:'short' });
        stamp.textContent = 'Last updated: ' + fmt.format(d);
      } catch {
        stamp.textContent = 'Last updated: ' + new Date().toLocaleString();
      }

      // Palettes
      const palettes = [
        { name: 'Prism', rings: ['#70f6d6','#6ea8ff','#c684ff'], glow: '#88f7ff' },
        { name: 'Sol', rings: ['#ff8a66','#ffc66d','#ff6ec4'], glow: '#ffd66d' },
        { name: 'Glacier', rings: ['#54d5ff','#a7f0ff','#e2fff6'], glow: '#c8fbff' },
        { name: 'Neon', rings: ['#aaff00','#00ffd0','#00a2ff'], glow: '#8cffc3' }
      ];
      let paletteIndex = 0;

      // Size + DPR
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      let W = 0, H = 0, CX = 0, CY = 0, R = 0;
      function resize() {
        const rect = canvas.getBoundingClientRect();
        W = Math.max(320, Math.floor(rect.width));
        H = Math.max(260, Math.floor(rect.height));
        CX = W / 2; CY = H / 2;
        R = Math.min(W, H) * 0.42;
        canvas.width = Math.floor(W * dpr);
        canvas.height = Math.floor(H * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        draw(true);
      }
      resize();
      window.addEventListener('resize', resize, { passive: true });

      // Motion + Time
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      let running = !prefersReduced;
      let speed = parseFloat(speedRange.value) || 1;
      let trailMax = parseInt(trailRange.value, 10) || 80;
      let vt = Date.now(); // virtual time
      let last = performance.now();
      let ping = 0;

      const orbs = [
        { name:'Hours', radius: R * 0.35, color: () => palettes[paletteIndex].rings[0], history: [] },
        { name:'Minutes', radius: R * 0.55, color: () => palettes[paletteIndex].rings[1], history: [] },
        { name:'Seconds', radius: R * 0.75, color: () => palettes[paletteIndex].rings[2], history: [] }
      ];

      // Update stats & controls text
      function syncUI() {
        statMotion.textContent = running ? 'On' : 'Off';
        statPalette.textContent = palettes[paletteIndex].name;
        btnPalette.textContent = 'Palette: ' + palettes[paletteIndex].name;
        btnMotion.textContent = 'Motion: ' + (running ? 'On' : 'Off');
      }
      syncUI();

      // Drawing
      function draw(force) {
        ctx.clearRect(0, 0, W, H);

        // Soft fade for trails (if running)
        if (!force && running) {
          ctx.globalCompositeOperation = 'source-over';
          const theme = root.getAttribute('data-theme');
          ctx.fillStyle = theme === 'dawn' ? 'rgba(238,245,255,0.08)' : 'rgba(5,8,15,0.08)';
          ctx.fillRect(0,0,W,H);
        }

        // Rings (orbits)
        ctx.lineWidth = 1.25;
        ctx.globalAlpha = 0.8;
        for (let i = 0; i < 3; i++) {
          ctx.beginPath();
          ctx.arc(CX, CY, [R*0.35, R*0.55, R*0.75][i], 0, Math.PI * 2);
          const col = palettes[paletteIndex].rings[i];
          ctx.strokeStyle = col;
          ctx.shadowColor = col;
          ctx.shadowBlur = 6;
          ctx.stroke();
        }
        ctx.shadowBlur = 0;

        // Trails
        ctx.globalCompositeOperation = 'lighter';
        for (const orb of orbs) {
          const path = orb.history;
          for (let i = 0; i < path.length - 1; i++) {
            const a = path[i], b = path[i+1];
            const t = i / path.length;
            ctx.beginPath();
            ctx.moveTo(a.x, a.y);
            ctx.lineTo(b.x, b.y);
            ctx.strokeStyle = orb.color();
            ctx.globalAlpha = (0.1 + t * 0.9) * 0.6;
            ctx.lineWidth = 2.6 * (1 - t) + 0.6;
            ctx.stroke();
          }
        }
        ctx.globalAlpha = 1;

        // Planets
        for (const orb of orbs) {
          const lastPos = orb.history[orb.history.length - 1];
          if (!lastPos) continue;
          const c = orb.color();
          ctx.beginPath();
          ctx.fillStyle = c;
          ctx.shadowColor = c;
          ctx.shadowBlur = 24 + ping * 8;
          ctx.arc(lastPos.x, lastPos.y, 6 + ping * 2, 0, Math.PI*2);
          ctx.fill();
          ctx.shadowBlur = 0;
        }

        // Center glow
        ctx.beginPath();
        const cg = ctx.createRadialGradient(CX, CY, 0, CX, CY, R*0.35);
        cg.addColorStop(0, palettes[paletteIndex].glow);
        cg.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = cg;
        ctx.globalAlpha = 0.35 + ping * 0.15;
        ctx.arc(CX, CY, R*0.36, 0, Math.PI*2);
        ctx.fill();
        ctx.globalAlpha = 1;

        // decay ping
        ping *= 0.92;
      }

      function loop(now) {
        if (!running) return;
        const dt = Math.min(48, now - last); // cap
        last = now;
        vt += dt * speed;

        // compute angles from virtual time
        const d = new Date(vt);
        const s = d.getSeconds() + d.getMilliseconds() / 1000;
        const m = d.getMinutes() + s / 60;
        const h = (d.getHours() % 12) + m / 60;

        const angles = [
          (h / 12) * Math.PI * 2,
          (m / 60) * Math.PI * 2,
          (s / 60) * Math.PI * 2
        ];

        // update positions & histories
        [orbs[0].radius, orbs[1].radius, orbs[2].radius] = [R*0.35, R*0.55, R*0.75];
        for (let i = 0; i < orbs.length; i++) {
          const a = angles[i] - Math.PI/2;
          const r = orbs[i].radius;
          const x = CX + Math.cos(a) * r;
          const y = CY + Math.sin(a) * r;
          orbs[i].history.push({ x, y });
          if (orbs[i].history.length > trailMax) orbs[i].history.shift();
        }

        // background conic spin
        const spin = (parseFloat(getComputedStyle(root).getPropertyValue('--spin')) || 0);
        root.style.setProperty('--spin', (spin + 0.25) + 'deg');

        draw(false);
        requestAnimationFrame(loop);
      }

      // First render
      draw(true);
      if (!prefersReduced) requestAnimationFrame((t)=>{ last=t; requestAnimationFrame(loop); });

      // Interactions
      // Tilt
      let tilt = { x: 0, y: 0, tx: 0, ty: 0 };
      function onMove(e) {
        const rect = canvas.getBoundingClientRect();
        const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
        const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
        const nx = (x / rect.width) * 2 - 1;
        const ny = (y / rect.height) * 2 - 1;
        tilt.tx = nx * 8;
        tilt.ty = ny * -8;
      }
      function rafTilt() {
        tilt.x += (tilt.tx - tilt.x) * 0.08;
        tilt.y += (tilt.ty - tilt.y) * 0.08;
        layer.style.transform = 'rotateX(' + tilt.y + 'deg) rotateY(' + tilt.x + 'deg)';
        requestAnimationFrame(rafTilt);
      }
      requestAnimationFrame(rafTilt);
      root.addEventListener('pointermove', onMove, { passive: true });
      root.addEventListener('touchmove', onMove, { passive: true });

      // Buttons
      btnTheme.addEventListener('click', () => {
        const isNight = root.getAttribute('data-theme') === 'midnight';
        root.setAttribute('data-theme', isNight ? 'dawn' : 'midnight');
        btnTheme.textContent = isNight ? 'Dawn' : 'Midnight';
        btnTheme.setAttribute('aria-pressed', String(!isNight));
        draw(true);
      });

      btnMotion.addEventListener('click', () => {
        running = !running;
        btnMotion.setAttribute('aria-pressed', String(running));
        syncUI();
        if (running) {
          last = performance.now();
          requestAnimationFrame(loop);
        } else {
          draw(true);
        }
      });

      btnPalette.addEventListener('click', () => {
        paletteIndex = (paletteIndex + 1) % palettes.length;
        syncUI();
        draw(true);
      });

      btnCenter.addEventListener('click', () => {
        tilt.tx = 0; tilt.ty = 0;
      });

      btnPulse.addEventListener('click', () => {
        ping = Math.min(ping + 0.8, 1.6);
        // quick illumination if paused
        if (!running) draw(true);
      });

      btnRemix.addEventListener('click', () => {
        // shuffle trail lengths & small ring jitter
        trailMax = Math.floor(40 + Math.random() * 120);
        trailRange.value = String(trailMax);
        for (const orb of orbs) orb.history.length = 0;
        paletteIndex = (paletteIndex + 1) % palettes.length;
        syncUI();
        draw(true);
      });

      speedRange.addEventListener('input', () => {
        speed = parseFloat(speedRange.value) || 1;
      });
      trailRange.addEventListener('input', () => {
        trailMax = parseInt(trailRange.value, 10) || 80;
        for (const orb of orbs) {
          while (orb.history.length > trailMax) orb.history.shift();
        }
      });

      // Respect reduced motion
      if (prefersReduced) {
        running = false;
        btnMotion.setAttribute('aria-pressed', 'false');
        syncUI();
      }
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


