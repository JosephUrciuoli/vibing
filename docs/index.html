<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section id="vibe1805" aria-label="Studio Orbit · Vibe 1805">
  <style>
    /* STUDIO ORBIT — scoped to #vibe1805 */
    #vibe1805{
      --ink:#141a22; --muted:#6b7486; --edge:#e6ebf5;
      --bg1:#f9fbff; --bg2:#f1f5ff; --panel:rgba(255,255,255,0.75);
      --p1:#5aa3ff; --p2:#ff9fc4; --p3:#80ffd3;
      --tempo:1.0; /* 0.2–4.0 */
      color-scheme: light;
      position: relative; isolation:isolate;
      padding: clamp(18px, 4vw, 48px);
      border-radius: 36px;
      background:
        radial-gradient(120% 180% at 0% 0%, color-mix(in oklab, var(--p1) 10%, transparent) 0%, transparent 65%),
        radial-gradient(140% 200% at 110% 120%, color-mix(in oklab, var(--p3) 12%, transparent) 0%, transparent 70%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      box-shadow:
        inset 0 0 0 1px rgba(20,30,60,0.08),
        0 40px 160px rgba(90,110,180,0.22);
      overflow: clip;
      color: var(--ink);
    }
    #vibe1805::after{
      content:""; position:absolute; inset:0; border-radius:36px; pointer-events:none;
      padding: 2px;
      background: linear-gradient(135deg,
        color-mix(in oklab, var(--p1) 60%, #fff),
        color-mix(in oklab, var(--p2) 60%, #fff),
        color-mix(in oklab, var(--p3) 60%, #fff));
      mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude;
      opacity: 0.35;
    }

    /* Top bar */
    #vibe1805 .top{
      display:grid; grid-template-columns: 1fr auto; gap: 12px; align-items:center;
    }
    #vibe1805 .brand{
      display:inline-grid; grid-auto-flow:column; gap:12px; align-items:center;
      padding: 10px 14px; border-radius: 999px;
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6));
      border:1px solid var(--edge);
      box-shadow: 0 10px 28px rgba(120,140,180,0.20), inset 0 1px 0 rgba(255,255,255,0.9);
      color: var(--muted);
      font: 900 10px/1.1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      letter-spacing: .16em; text-transform: uppercase;
    }
    #vibe1805 .dot{
      width:16px; height:16px; border-radius:50%;
      background: conic-gradient(from 0deg, var(--p1), var(--p2), var(--p3), var(--p1));
      box-shadow: 0 0 0 1px rgba(0,0,0,0.08) inset, 0 0 12px color-mix(in oklab, var(--p1) 45%, transparent);
      animation: v1805_spin 12s linear infinite;
    }
    @keyframes v1805_spin{ to{ transform: rotate(360deg);} }

    #vibe1805 .ctrls{ display:flex; gap:8px; justify-self:end; flex-wrap:wrap; }
    #vibe1805 .chip{
      appearance:none; border:1px solid var(--edge); border-radius:14px; cursor:pointer;
      padding: 10px 14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.65));
      color: var(--ink);
      font: 800 11px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      letter-spacing: 0.14em; text-transform: uppercase; user-select:none;
      transition: transform 140ms ease, box-shadow 220ms ease, border-color 200ms ease, filter 200ms ease, background 200ms ease, color 200ms ease;
      box-shadow: 0 8px 24px rgba(120,140,180,0.18), inset 0 1px 0 rgba(255,255,255,0.9);
    }
    #vibe1805 .chip:hover{ transform: translateY(-1px); box-shadow: 0 16px 44px rgba(120,140,180,0.28); }
    #vibe1805 .chip[aria-pressed="true"]{
      border-color: color-mix(in oklab, var(--p2) 50%, #8aa2ff);
      color: color-mix(in oklab, var(--p2) 70%, var(--ink));
      filter: saturate(115%);
    }

    /* Stage */
    #vibe1805 .stage{
      position:relative; margin-top: clamp(14px, 3vw, 22px);
      border-radius: 28px; overflow: clip;
      min-height: clamp(520px, 64vh, 980px);
      background: radial-gradient(180% 120% at 50% 10%, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      border:1px solid var(--edge);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.75), 0 30px 120px rgba(90,110,180,0.22);
      perspective: 900px;
    }
    #vibe1805 .tilt{
      position:absolute; inset:0; transform-style: preserve-3d;
      transition: transform 280ms cubic-bezier(.2,.6,.2,1);
    }
    #vibe1805 svg.halo{
      position:absolute; inset:0; width:100%; height:100%; display:block;
      filter: saturate(115%);
      mix-blend-mode: multiply;
    }
    #vibe1805 .tag{
      position:absolute; bottom: 14px; left: 16px; right: 16px; text-align:center;
      color: var(--muted); font-size: 12px; letter-spacing: .12em; text-transform: uppercase;
      opacity: 0.85;
    }

    /* Panel */
    #vibe1805 .glass{
      position:relative; z-index:2;
      margin-top: clamp(16px, 3vw, 26px);
      display:grid; gap:12px; max-width:min(820px, 96%);
      padding: 16px 18px; border-radius: 16px;
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.55));
      border: 1px solid var(--edge);
      backdrop-filter: blur(8px);
      box-shadow: 0 14px 40px rgba(120,140,180,0.24), inset 0 1px 0 rgba(255,255,255,0.9);
    }
    #vibe1805 h1{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      font-weight: 1000;
      font-size: clamp(42px, 9vw, 112px);
      line-height: .86; letter-spacing: -0.02em; text-transform: lowercase;
      background: linear-gradient(90deg,
        color-mix(in oklab, var(--ink) 92%, var(--p1)),
        color-mix(in oklab, var(--p2) 65%, var(--ink)),
        color-mix(in oklab, var(--p3) 65%, var(--ink)));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      background-size: 220% 100%; animation: v1805_gloss 16s ease-in-out infinite;
      filter: drop-shadow(0 10px 18px rgba(90,110,180,0.20));
    }
    @keyframes v1805_gloss{ 0%,100%{background-position:0% 50%} 50%{background-position:100% 50%} }
    #vibe1805 .lede{ margin:0; color: var(--muted); font-size: clamp(14px, 2vw, 18px); text-wrap: balance; }
    #vibe1805 .readouts{ display:flex; gap:10px; flex-wrap:wrap; }
    #vibe1805 .stat{
      display:inline-grid; gap:3px; padding:8px 10px; border-radius:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.45));
      border:1px dashed var(--edge);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.85);
    }
    #vibe1805 .stat .k{ font: 800 10px/1 ui-sans-serif, system-ui; letter-spacing:0.12em; text-transform:uppercase; color: var(--muted);}
    #vibe1805 .stat .v{ font: 700 14px/1.2 ui-sans-serif, system-ui; color: var(--ink); }

    #vibe1805 .slider{ display:grid; gap:6px; align-items:center; justify-items:start; }
    #vibe1805 .slider label{
      font: 800 10px/1 ui-sans-serif, system-ui; letter-spacing:0.14em; text-transform:uppercase; color: var(--muted);
    }
    #vibe1805 input[type="range"]{
      -webkit-appearance:none; appearance:none; width:min(44vw, 380px); height: 28px; background: transparent; cursor:pointer;
    }
    #vibe1805 input[type="range"]::-webkit-slider-runnable-track,
    #vibe1805 input[type="range"]::-moz-range-track{
      height: 6px; border-radius: 999px;
      background: linear-gradient(90deg,
        color-mix(in oklab, var(--p1) 60%, #fff),
        color-mix(in oklab, var(--p2) 60%, #fff),
        color-mix(in oklab, var(--p3) 60%, #fff));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.90), 0 8px 18px rgba(120,140,180,0.28);
    }
    #vibe1805 input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:20px; height:20px; margin-top:-7px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, #eaf1ff 45%, #bcd0ff 70%);
      border:1px solid rgba(150,170,210,0.7);
      box-shadow: 0 6px 12px rgba(90,110,180,0.35), inset 0 -2px 6px rgba(0,0,0,0.12);
    }
    #vibe1805 input[type="range"]::-moz-range-thumb{
      width:20px; height:20px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, #eaf1ff 45%, #bcd0ff 70%);
      border:1px solid rgba(150,170,210,0.7);
      box-shadow: 0 6px 12px rgba(90,110,180,0.35), inset 0 -2px 6px rgba(0,0,0,0.12);
    }

    /* Footer */
    #vibe1805 .foot{
      display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;
      margin-top: clamp(16px, 3vw, 26px); padding-top: 14px;
      border-top: 1px dashed var(--edge);
      color: var(--muted); font-size: 12px;
    }

    /* Dark theme (Obsidian) */
    #vibe1805[data-theme="obsidian"]{
      --ink:#eef2ff; --muted:#9aa6c2; --edge:rgba(255,255,255,0.14);
      --bg1:#0b0f16; --bg2:#101725; --panel:rgba(16,23,37,0.65);
      color-scheme: dark;
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.06),
        0 50px 170px rgba(0,0,0,0.55);
      background:
        radial-gradient(120% 180% at 0% 0%, color-mix(in oklab, var(--p2) 16%, transparent) 0%, transparent 65%),
        radial-gradient(140% 200% at 110% 120%, color-mix(in oklab, var(--p1) 12%, transparent) 0%, transparent 70%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }
    #vibe1805[data-theme="obsidian"] svg.halo{ mix-blend-mode: screen; }
    #vibe1805[data-theme="obsidian"] .chip,
    #vibe1805[data-theme="obsidian"] .brand,
    #vibe1805[data-theme="obsidian"] .glass{
      background: linear-gradient(180deg, rgba(18,24,38,0.86), rgba(18,24,38,0.55));
      border-color: rgba(255,255,255,0.12);
      box-shadow: 0 12px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
    }
    #vibe1805[data-theme="obsidian"] .stat{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      border-color: rgba(255,255,255,0.12);
    }
    #vibe1805[data-running="false"] *{ animation-play-state: paused !important; }

    /* Motion accessibility */
    @media (prefers-reduced-motion: reduce){
      #vibe1805 .dot{ animation: none; }
      #vibe1805 h1{ animation: none; }
      #vibe1805 .tilt{ transition: none; }
      #vibe1805{ --tempo: 0; }
    }
  </style>

  <div class="top" role="group" aria-label="Header">
    <div class="brand"><span class="dot" aria-hidden="true"></span> Studio Orbit · No. 1805</div>
    <div class="ctrls" role="group" aria-label="Controls">
      <button class="chip" data-act="run" aria-pressed="false" title="Play/Pause">Pause</button>
      <button class="chip" data-act="theme" aria-pressed="false" title="Theme">Porcelain</button>
      <button class="chip" data-act="mode" aria-pressed="true" title="Engine">Bloom</button>
    </div>
  </div>

  <div class="stage" role="img" aria-label="Kinetic mandala">
    <div class="tilt">
      <svg class="halo" viewBox="-300 -300 600 600" aria-hidden="true"></svg>
    </div>
    <div class="tag">Drag to tilt · Click to recolor · Scroll to change tempo</div>
  </div>

  <div class="glass" aria-label="Headline and controls">
    <h1>studio orbit</h1>
    <p class="lede">A calm, kinetic bloom for focus. Meticulous geometry; gentle motion.</p>
    <div class="readouts">
      <div class="stat"><span class="k">Local</span><span class="v" data-clock>—</span></div>
      <div class="stat"><span class="k">Tempo</span><span class="v" data-tempo>1.0×</span></div>
      <div class="stat"><span class="k">Mode</span><span class="v" data-mode>Bloom</span></div>
    </div>
    <div class="slider" role="group" aria-label="Tempo">
      <label for="v1805-tempo">Tempo</label>
      <input id="v1805-tempo" type="range" min="0.2" max="4" step="0.01" value="1.0">
    </div>
  </div>

  <div class="foot">
    <span>Calm energy, carefully engineered.</span>
    <span id="last-updated">Last updated: 2026-01-07 14:19:04 EST</span>
  </div>

  <script>
    (function(){
      const root = document.getElementById('vibe1805');
      const svg = root.querySelector('svg.halo');
      const tilt = root.querySelector('.tilt');

      const btnRun = root.querySelector('.chip[data-act="run"]');
      const btnTheme = root.querySelector('.chip[data-act="theme"]');
      const btnMode = root.querySelector('.chip[data-act="mode"]');
      const tempoSlider = root.querySelector('#v1805-tempo');
      const tempoEl = root.querySelector('[data-tempo]');
      const modeEl = root.querySelector('[data-mode]');
      const clockEl = root.querySelector('[data-clock]');

      // Timestamp
      try{
        const stamp = new Date().toLocaleString(undefined, {
          year:'numeric', month:'short', day:'2-digit',
          hour:'2-digit', minute:'2-digit', second:'2-digit'
        });
        root.querySelector('#last-updated').textContent = 'Last updated: ' + stamp;
      }catch(e){}

      // Clock
      function tickClock(){
        try{
          clockEl.textContent = new Date().toLocaleString(undefined, { hour:'2-digit', minute:'2-digit', second:'2-digit' });
        }catch(e){}
      }
      tickClock();
      const clockTimer = setInterval(tickClock, 1000);

      // Palettes
      const PALETTES = [
        { name:'Porcelain Pop', p1:'#5aa3ff', p2:'#ff9fc4', p3:'#80ffd3' },
        { name:'Citrus Sky',    p1:'#ffd36a', p2:'#6ccfff', p3:'#9ff5b5' },
        { name:'Lilac Heat',    p1:'#9aa6ff', p2:'#ff8fb2', p3:'#ffdca6' },
        { name:'Glacier Mint',  p1:'#8be3ff', p2:'#a6bcff', p3:'#74f6c2' },
        { name:'Solar Bloom',   p1:'#ffb86b', p2:'#ff7aa9', p3:'#78e8ff' }
      ];
      let palIndex = 0;
      function setPalette(i){
        palIndex = (i + PALETTES.length) % PALETTES.length;
        const p = PALETTES[palIndex];
        root.style.setProperty('--p1', p.p1);
        root.style.setProperty('--p2', p.p2);
        root.style.setProperty('--p3', p.p3);
        svg.style.filter = 'saturate(125%) brightness(1.02)';
        setTimeout(()=> svg.style.filter='', 280);
      }
      setPalette(0);

      // Theme
      let theme = 'porcelain'; // porcelain | obsidian
      function applyTheme(next){
        theme = next;
        if(theme === 'obsidian'){
          root.setAttribute('data-theme', 'obsidian');
          btnTheme.textContent = 'Obsidian'; btnTheme.setAttribute('aria-pressed','true');
        } else {
          root.removeAttribute('data-theme');
          btnTheme.textContent = 'Porcelain'; btnTheme.setAttribute('aria-pressed','false');
        }
      }
      applyTheme('porcelain');

      // Mode + tempo
      let modeBloom = true; // Bloom | Orbit
      modeEl.textContent = modeBloom ? 'Bloom' : 'Orbit';
      btnMode.setAttribute('aria-pressed', modeBloom ? 'true' : 'false');
      let tempo = parseFloat(tempoSlider.value);
      tempoEl.textContent = tempo.toFixed(1)+'×';
      root.style.setProperty('--tempo', String(tempo));

      // Running
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      let running = !prefersReduced;
      btnRun.textContent = running ? 'Pause' : 'Play';
      btnRun.setAttribute('aria-pressed', running ? 'false' : 'true');
      if(!running) root.setAttribute('data-running','false');

      // Build SVG scene
      function clearSVG(){
        while(svg.firstChild) svg.removeChild(svg.firstChild);
      }
      function add(el){ svg.appendChild(el); return el; }

      function wedgePath(r0, r1, a0, a1){
        const c0 = Math.cos(a0), s0=Math.sin(a0);
        const c1 = Math.cos(a1), s1=Math.sin(a1);
        const x0 = r1*c0, y0 = r1*s0;
        const x1 = r1*c1, y1 = r1*s1;
        const x2 = r0*c1, y2 = r0*s1;
        const x3 = r0*c0, y3 = r0*s0;
        const large = (a1-a0) > Math.PI ? 1 : 0;
        return `M ${x0} ${y0} A ${r1} ${r1} 0 ${large} 1 ${x1} ${y1} L ${x2} ${y2} A ${r0} ${r0} 0 ${large} 0 ${x3} ${y3} Z`;
      }

      function buildScene(){
        clearSVG();
        const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');

        function makeGrad(id, c1, c2, c3){
          const rg = document.createElementNS('http://www.w3.org/2000/svg','radialGradient');
          rg.id = id; rg.setAttribute('cx','50%'); rg.setAttribute('cy','50%'); rg.setAttribute('r','60%');
          const s0 = document.createElementNS(rg.namespaceURI, 'stop'); s0.setAttribute('offset','0%'); s0.setAttribute('stop-color', c1);
          const s1 = document.createElementNS(rg.namespaceURI, 'stop'); s1.setAttribute('offset','55%'); s1.setAttribute('stop-color', c2);
          const s2 = document.createElementNS(rg.namespaceURI, 'stop'); s2.setAttribute('offset','100%'); s2.setAttribute('stop-color', c3); s2.setAttribute('stop-opacity','0.0');
          rg.append(s0,s1,s2);
          return rg;
        }
        function makeLinear(id, c1, c2){
          const lg = document.createElementNS('http://www.w3.org/2000/svg','linearGradient');
          lg.id = id; lg.setAttribute('x1','0%'); lg.setAttribute('y1','0%'); lg.setAttribute('x2','100%'); lg.setAttribute('y2','100%');
          const s0 = document.createElementNS(lg.namespaceURI, 'stop'); s0.setAttribute('offset','0%'); s0.setAttribute('stop-color', c1);
          const s1 = document.createElementNS(lg.namespaceURI, 'stop'); s1.setAttribute('offset','100%'); s1.setAttribute('stop-color', c2);
          lg.append(s0,s1);
          return lg;
        }
        defs.appendChild(makeGrad('rg-a', getVar('--p1'), getVar('--p2'), getVar('--p3')));
        defs.appendChild(makeGrad('rg-b', getVar('--p2'), getVar('--p3'), getVar('--p1')));
        defs.appendChild(makeGrad('rg-c', getVar('--p3'), getVar('--p1'), getVar('--p2')));
        defs.appendChild(makeLinear('lg-a', getVar('--p1'), getVar('--p2')));
        defs.appendChild(makeLinear('lg-b', getVar('--p2'), getVar('--p3')));
        defs.appendChild(makeLinear('lg-c', getVar('--p3'), getVar('--p1')));

        const flt = document.createElementNS(defs.namespaceURI, 'filter');
        flt.id='soft'; flt.innerHTML = '<feGaussianBlur stdDeviation="3" result="b"/><feBlend in="SourceGraphic" in2="b" mode="screen"/>';
        defs.appendChild(flt);

        add(defs);

        const rings = modeBloom ? 4 : 5;
        const petals = modeBloom ? 24 : 12;
        const thickness = modeBloom ? 0.78 : 0.48;
        const baseR = 50;
        const gap = 8;

        for(let r=0; r<rings; r++){
          const g = document.createElementNS('http://www.w3.org/2000/svg','g');
          g.setAttribute('class','ring');
          const spin = (r%2?1:-1) * (0.8 + r*0.2);
          g.style.animation = `v1805_spin calc(${(48/(spin))}s / var(--tempo)) linear infinite`;
          g.style.transformOrigin = '50% 50%';
          g.style.filter = 'url(#soft)';

          const inner = baseR + r*60;
          const outer = inner + (modeBloom ? 42 : 58);
          for(let i=0; i<petals; i++){
            const step = (Math.PI*2)/petals;
            const a0 = i*step;
            const a1 = a0 + step*thickness;
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            const gid = r%3===0?'rg-a':r%3===1?'rg-b':'rg-c';
            path.setAttribute('d', wedgePath(inner, outer, a0, a1));
            path.setAttribute('fill', `url(#${gid})`);
            path.setAttribute('opacity', String(0.85 - r*0.12));
            path.style.mixBlendMode = 'inherit';
            g.appendChild(path);
          }

          // orbit lines
          const orbit = document.createElementNS('http://www.w3.org/2000/svg','circle');
          orbit.setAttribute('cx','0'); orbit.setAttribute('cy','0');
          orbit.setAttribute('r', String((inner+outer)/2));
          const lid = r%3===0?'lg-a':r%3===1?'lg-b':'lg-c';
          orbit.setAttribute('fill','none');
          orbit.setAttribute('stroke', `url(#${lid})`);
          orbit.setAttribute('stroke-width','1.5');
          orbit.setAttribute('stroke-dasharray', `${30 + r*12} ${28 + r*10}`);
          orbit.setAttribute('opacity', '0.65');
          g.appendChild(orbit);

          svg.appendChild(g);
        }

        // center dot
        const core = document.createElementNS('http://www.w3.org/2000/svg','circle');
        core.setAttribute('cx','0'); core.setAttribute('cy','0'); core.setAttribute('r','18');
        core.setAttribute('fill','url(#rg-a)');
        core.setAttribute('stroke','rgba(255,255,255,0.7)'); core.setAttribute('stroke-width','1');
        svg.appendChild(core);
      }

      function getVar(name){ return getComputedStyle(root).getPropertyValue(name).trim(); }

      buildScene();

      // Interactions
      const center = { x:0, y:0 };
      function updateTilt(e){
        const rect = svg.getBoundingClientRect();
        const cx = rect.left + rect.width/2;
        const cy = rect.top + rect.height/2;
        const dx = (e.clientX - cx) / rect.width;
        const dy = (e.clientY - cy) / rect.height;
        const max = 12;
        tilt.style.transform = `rotateX(${(-dy*max).toFixed(2)}deg) rotateY(${(dx*max).toFixed(2)}deg) translateZ(0)`;
      }
      root.addEventListener('pointermove', e=>{
        if(!running || prefersReduced) return;
        updateTilt(e);
      });
      root.addEventListener('pointerleave', ()=>{
        tilt.style.transform = '';
      });

      // Click to palette-swap
      svg.addEventListener('click', ()=>{
        setPalette(palIndex+1);
      });

      // Wheel = tempo
      root.addEventListener('wheel', (e)=>{
        if(!e.ctrlKey && !e.metaKey){
          e.preventDefault();
          const step = Math.sign(e.deltaY) * 0.12;
          const next = Math.min(4, Math.max(0.2, parseFloat(tempoSlider.value) - step));
          tempoSlider.value = String(next);
          tempo = next;
          tempoEl.textContent = tempo.toFixed(1)+'×';
          root.style.setProperty('--tempo', String(tempo));
        }
      }, { passive:false });

      // Controls
      btnRun.addEventListener('click', ()=>{
        running = !running;
        btnRun.textContent = running ? 'Pause' : 'Play';
        btnRun.setAttribute('aria-pressed', running ? 'false' : 'true');
        if(!running){ root.setAttribute('data-running','false'); } else { root.removeAttribute('data-running'); }
      });

      btnTheme.addEventListener('click', ()=>{
        applyTheme(theme==='obsidian' ? 'porcelain' : 'obsidian');
      });

      btnMode.addEventListener('click', ()=>{
        modeBloom = !modeBloom;
        modeEl.textContent = modeBloom ? 'Bloom' : 'Orbit';
        btnMode.textContent = modeBloom ? 'Bloom' : 'Orbit';
        btnMode.setAttribute('aria-pressed', modeBloom ? 'true' : 'false');
        buildScene();
      });

      tempoSlider.addEventListener('input', ()=>{
        tempo = parseFloat(tempoSlider.value);
        tempoEl.textContent = tempo.toFixed(1)+'×';
        root.style.setProperty('--tempo', String(tempo));
      });

      // Accessibility: reduce motion
      if(prefersReduced){
        running = false;
        root.setAttribute('data-running','false');
      }

      // Cleanup
      window.addEventListener('beforeunload', ()=> clearInterval(clockTimer));
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


