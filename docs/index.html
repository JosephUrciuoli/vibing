<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section id="loom2263" data-theme="light" aria-label="Quiet Kinetic — Edition 2263">
  <style>
    /* Tokens */
    #loom2263 {
      --r: 28px;
      --pad: clamp(18px, 5vw, 56px);
      --ink: #0f1220;
      --muted: color-mix(in hsl, var(--ink) 56%, transparent);
      --bg-1: #f8fbff;
      --bg-2: #eef3fb;
      --edge: rgba(0,0,0,0.12);
      --glass: 255,255,255;
      --a1: 208 92% 54%;
      --a2: 276 84% 60%;
      --a3: 332 86% 60%;
      --shadow: 0 40px 120px rgba(0,0,0,.16);
      color-scheme: light;
      position: relative; isolation: isolate;
      border-radius: var(--r);
      padding: var(--pad);
      background:
        radial-gradient(160% 120% at 10% -10%, hsl(var(--a1) / .14), transparent 45%),
        radial-gradient(160% 120% at 110% 110%, hsl(var(--a3) / .16), transparent 55%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      box-shadow: inset 0 1px 0 rgba(255,255,255,.8), var(--shadow);
      font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial, system-ui;
      overflow: clip;
      color: var(--ink);
    }
    #loom2263[data-theme="dark"]{
      --ink: #eaf2ff;
      --muted: color-mix(in hsl, var(--ink) 60%, transparent);
      --bg-1: #0a0e15;
      --bg-2: #0d1320;
      --edge: rgba(255,255,255,0.12);
      color-scheme: dark;
      background:
        radial-gradient(160% 120% at 10% -10%, hsl(var(--a1) / .18), transparent 45%),
        radial-gradient(160% 120% at 110% 110%, hsl(var(--a3) / .20), transparent 55%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06), var(--shadow);
    }

    /* Ambient moiré veil */
    #loom2263::before{
      content:""; position:absolute; inset:-20%;
      background:
        conic-gradient(from 0deg at 60% 40%, hsl(var(--a1) / .18), transparent 35% 70%, hsl(var(--a2) / .16), transparent),
        conic-gradient(from 180deg at 35% 70%, hsl(var(--a3) / .16), transparent 40% 80%, hsl(var(--a1) / .12));
      filter: blur(60px) saturate(120%);
      mix-blend-mode: overlay; pointer-events:none;
      animation: veil2263 80s linear infinite;
      opacity:.42;
    }
    @keyframes veil2263 { to{ transform: rotate(360deg); } }

    /* Top bar */
    #loom2263 .top{
      display:flex; align-items:center; justify-content:space-between; gap:16px;
      margin-bottom: clamp(12px, 3vw, 24px); position:relative; z-index:2;
    }
    #loom2263 .crest{
      display:flex; align-items:center; gap:14px;
      padding:12px 16px; border-radius:999px; font-weight:900; letter-spacing:.01em;
      background: rgba(var(--glass), .65);
      backdrop-filter: blur(12px) saturate(160%);
      box-shadow: inset 0 0 0 1px var(--edge), 0 14px 36px rgba(0,0,0,.08);
      color: var(--ink);
    }
    #loom2263 .mark{
      width:28px; height:28px; border-radius:8px; position:relative; overflow:hidden; display:grid; place-items:center;
      background:
        radial-gradient(20px 20px at 25% 25%, hsl(var(--a1)), transparent 60%),
        radial-gradient(16px 16px at 75% 75%, hsl(var(--a3)), transparent 60%);
      box-shadow: inset 0 0 0 1px var(--edge), 0 6px 18px rgba(0,0,0,.12);
      transform: rotate(8deg);
    }
    #loom2263 .ed{ opacity:.6; font-weight:800; font-size:12px; letter-spacing:.18em; text-transform:uppercase; margin-left:6px; }

    #loom2263 .actions{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    #loom2263 .chip, #loom2263 .btn{
      appearance:none; border:0; cursor:pointer;
      font-weight:850; font-size:14px; letter-spacing:.02em;
      padding:11px 15px; border-radius:14px;
      background: rgba(var(--glass), .60); color: var(--ink);
      box-shadow: inset 0 0 0 1px var(--edge), 0 12px 28px rgba(0,0,0,.10);
      backdrop-filter: blur(10px) saturate(160%);
      transition: transform .14s ease, background .25s ease, box-shadow .25s ease;
    }
    #loom2263 .chip:hover, #loom2263 .btn:hover{ transform: translateY(-1px); background: rgba(var(--glass), .75); }

    /* Hero */
    #loom2263 .hero{ position:relative; z-index:2; display:grid; gap:10px; margin-bottom: clamp(8px, 3.6vw, 20px); }
    #loom2263 h1{
      margin:0; line-height:.86; letter-spacing:-0.02em; font-weight:1000;
      font-size: clamp(56px, 10vw, 150px);
      color: transparent;
      background: linear-gradient(120deg, hsl(var(--a1)), hsl(var(--a2)), hsl(var(--a3)));
      background-size: 220% 220%;
      -webkit-background-clip:text; background-clip:text;
      animation: hue2263 14s ease-in-out infinite;
      filter: drop-shadow(0 8px 24px rgba(0,0,0,.18));
      text-wrap: balance;
    }
    #loom2263 .lede{ margin:0; color: var(--muted); font-size: clamp(14px, 2.1vw, 18px); text-wrap: pretty; }
    @keyframes hue2263 { 50%{ background-position: 100% 0%; } }

    /* Stage */
    #loom2263 .stage{
      --w: min(96vw, 1180px);
      width: var(--w); aspect-ratio: 16/9; margin: clamp(10px, 3vw, 22px) auto;
      border-radius: 36px; position:relative; z-index:2; overflow:hidden;
      display:grid; place-items:center; cursor: crosshair;
      background:
        radial-gradient(100% 80% at 50% 0%, rgba(255,255,255,.12), transparent 70%),
        linear-gradient(180deg, color-mix(in hsl, hsl(var(--a1) / 8%), transparent), transparent 60%);
      box-shadow:
        inset 0 0 0 1px var(--edge),
        inset 0 0 160px rgba(255,255,255,0.10),
        0 40px 120px rgba(0,0,0,.18);
      transform-style: preserve-3d; transition: transform 160ms ease;
    }
    #loom2263 canvas{ width:100%; height:100%; display:block; }
    #loom2263 .rim{
      position:absolute; inset:-1px; border-radius:inherit; pointer-events:none;
      background:
        radial-gradient(100% 100% at 50% 0%, hsl(var(--a1) / .30), transparent 60%),
        radial-gradient(100% 100% at 0% 100%, hsl(var(--a2) / .30), transparent 60%),
        radial-gradient(100% 100% at 100% 100%, hsl(var(--a3) / .30), transparent 60%);
      mask: radial-gradient(90% 80% at 50% 50%, #000 60%, transparent);
      opacity:.45;
    }
    #loom2263 .grain{
      position:absolute; inset:0; pointer-events:none;
      background:
        repeating-linear-gradient(90deg, rgba(0,0,0,.02) 0 1px, transparent 1px 3px),
        repeating-linear-gradient(0deg, rgba(0,0,0,.02) 0 1px, transparent 1px 3px);
      mix-blend-mode: soft-light; opacity:.10;
      animation: grain2263 22s linear infinite;
    }
    @keyframes grain2263 { to{ background-position: 260px 0, 0 260px; } }

    /* Dock */
    #loom2263 .dock{
      display:flex; flex-wrap:wrap; align-items:center; justify-content:center;
      gap: 12px 14px; margin: clamp(16px, 3.2vw, 28px) auto 0; position:relative; z-index:2;
    }
    #loom2263 .seg{ display:inline-flex; padding:4px; border-radius:14px; background: rgba(var(--glass), .65);
      box-shadow: inset 0 0 0 1px var(--edge); backdrop-filter: blur(10px) saturate(160%); }
    #loom2263 .sw{
      border:0; background:transparent; color: var(--ink); font-weight:900; font-size:13px; padding:8px 12px; border-radius:12px; cursor:pointer;
      display:inline-flex; align-items:center; gap:8px; transition: background .2s ease, transform .16s ease;
    }
    #loom2263 .sw[aria-pressed="true"]{ background: color-mix(in hsl, hsl(var(--a2) / 16%), transparent); box-shadow: inset 0 0 0 1px var(--edge); }
    #loom2263 .dot{ width:12px; height:12px; border-radius:50%;
      background: conic-gradient(from 0deg, hsl(var(--a1)), hsl(var(--a2)), hsl(var(--a3)), hsl(var(--a1)));
      box-shadow: 0 0 0 3px color-mix(in hsl, hsl(var(--a1) / 30%), transparent);
    }
    #loom2263 .group{
      display:inline-flex; align-items:center; gap:10px;
      padding: 8px 10px; border-radius:14px; font-weight:800; font-size:14px;
      color: var(--muted); background: rgba(var(--glass), .65);
      box-shadow: inset 0 0 0 1px var(--edge); backdrop-filter: blur(10px) saturate(160%);
    }
    #loom2263 input[type="range"]{
      -webkit-appearance:none; appearance:none; width:min(44vw, 300px); height:24px; background:transparent; cursor:pointer;
    }
    #loom2263 input[type="range"]::-webkit-slider-runnable-track,
    #loom2263 input[type="range"]::-moz-range-track{
      height:6px; border-radius:999px;
      background: linear-gradient(90deg, hsl(var(--a1)), hsl(var(--a2)), hsl(var(--a3)));
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.10);
    }
    #loom2263 input[type="range"]::-webkit-slider-thumb,
    #loom2263 input[type="range"]::-moz-range-thumb{
      width:18px; height:18px; border-radius:50%;
      background: #fff; border:2px solid hsl(var(--a2));
      box-shadow: 0 4px 12px rgba(0,0,0,0.18);
      -webkit-appearance:none; appearance:none; margin-top:-6px;
    }

    /* Clock chip */
    #loom2263 .clock{
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 10px; border-radius:14px; font-weight:800; font-size:14px;
      color: var(--muted); background: rgba(var(--glass), .65);
      box-shadow: inset 0 0 0 1px var(--edge); backdrop-filter: blur(10px) saturate(160%);
    }

    /* Footer */
    #loom2263 .meta{
      display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:12px;
      margin-top: clamp(18px, 3.6vw, 26px);
      padding-top: 14px; border-top: 1px solid var(--edge);
      color: var(--muted); font-size:12.5px; position:relative; z-index:2;
    }
    #loom2263 .live{ display:inline-flex; align-items:center; gap:8px; }
    #loom2263 .pulse{
      width:9px; height:9px; border-radius:50%;
      background: hsl(var(--a1));
      box-shadow: 0 0 0 0 color-mix(in hsl, hsl(var(--a1) / 55%), transparent);
      animation: pulse2263 2s ease-out infinite;
    }
    @keyframes pulse2263{ 0%{ box-shadow: 0 0 0 0 color-mix(in hsl, hsl(var(--a1) / 55%), transparent);} 100%{ box-shadow: 0 0 0 14px transparent;} }

    /* Motion safety */
    @media (prefers-reduced-motion: reduce){
      #loom2263 *{ animation: none !important; transition: none !important; }
    }
  </style>

  <div class="top">
    <div class="crest">
      <span class="mark" aria-hidden="true"></span>
      Quiet Kinetic
      <span class="ed">Edition 2263</span>
    </div>
    <div class="actions">
      <button id="theme2263" class="chip" aria-pressed="false" title="Toggle light/dark">Light</button>
      <button id="mode2263" class="chip" aria-pressed="true" title="Switch visual mode">Rings</button>
      <button id="shot2263" class="chip" title="Save snapshot">Capture</button>
      <button id="reset2263" class="btn" aria-pressed="false">Clear</button>
    </div>
  </div>

  <div class="hero">
    <h1>Shape the moment</h1>
    <p class="lede">Brush the surface. Soundless waves or orbiting glass—your choice.</p>
  </div>

  <div class="stage" id="stage2263" aria-label="Kinetic poster">
    <canvas id="poster2263" role="img" aria-label="Expanding rings and luminous orbs on a soft gradient field"></canvas>
    <div class="rim" aria-hidden="true"></div>
    <div class="grain" aria-hidden="true"></div>
  </div>

  <div class="dock" aria-label="Controls">
    <div class="seg" role="tablist" aria-label="Palettes">
      <button class="sw" id="palA2263" role="tab" aria-pressed="true">
        <span class="dot" aria-hidden="true" style="background: conic-gradient(from 0deg, hsl(208 92% 54%), hsl(276 84% 60%), hsl(332 86% 60%), hsl(208 92% 54%)); box-shadow: 0 0 0 3px color-mix(in hsl, hsl(208 92% 54% / 30%), transparent);"></span>
        Aster
      </button>
      <button class="sw" id="palB2263" role="tab" aria-pressed="false">
        <span class="dot" aria-hidden="true" style="background: conic-gradient(from 0deg, hsl(190 88% 50%), hsl(160 78% 50%), hsl(220 86% 60%), hsl(190 88% 50%)); box-shadow: 0 0 0 3px color-mix(in hsl, hsl(190 88% 50% / 30%), transparent);"></span>
        Lagoon
      </button>
      <button class="sw" id="palC2263" role="tab" aria-pressed="false">
        <span class="dot" aria-hidden="true" style="background: conic-gradient(from 0deg, hsl(14 86% 58%), hsl(344 86% 62%), hsl(40 88% 58%), hsl(14 86% 58%)); box-shadow: 0 0 0 3px color-mix(in hsl, hsl(14 86% 58% / 30%), transparent);"></span>
        Rose
      </button>
      <button class="sw" id="palD2263" role="tab" aria-pressed="false">
        <span class="dot" aria-hidden="true" style="background: conic-gradient(from 0deg, hsl(0 0% 92%), hsl(0 0% 60%), hsl(0 0% 24%), hsl(0 0% 92%)); box-shadow: 0 0 0 3px color-mix(in hsl, hsl(0 0% 70% / 30%), transparent);"></span>
        Graphite
      </button>
    </div>

    <div class="group" aria-label="Tempo">
      Tempo
      <input id="tempo2263" type="range" min="50" max="200" value="100" aria-valuemin="50" aria-valuemax="200" aria-valuenow="100" aria-label="Animation speed">
    </div>
    <div class="group" aria-label="Glow">
      Glow
      <input id="glow2263" type="range" min="0" max="30" value="16" aria-valuemin="0" aria-valuemax="30" aria-valuenow="16" aria-label="Bloom strength">
    </div>
    <div class="clock" id="clock2263" aria-live="polite">—:—</div>
  </div>

  <div class="meta">
    <div class="live"><span class="pulse" aria-hidden="true"></span> Studio is live</div>
    <span id="last-updated">Last updated: 2026-01-29 00:41:30 EST</span>
  </div>

  <script>
    (function(){
      const root = document.getElementById('loom2263');
      const stage = document.getElementById('stage2263');
      const canvas = document.getElementById('poster2263');
      const ctx = canvas.getContext('2d', { alpha: true });

      const themeBtn = document.getElementById('theme2263');
      const modeBtn = document.getElementById('mode2263');
      const shotBtn = document.getElementById('shot2263');
      const resetBtn = document.getElementById('reset2263');
      const clockChip = document.getElementById('clock2263');

      const palA = document.getElementById('palA2263');
      const palB = document.getElementById('palB2263');
      const palC = document.getElementById('palC2263');
      const palD = document.getElementById('palD2263');

      const tempoEl = document.getElementById('tempo2263');
      const glowEl = document.getElementById('glow2263');

      // Last updated
      const updated = document.getElementById('last-updated');
      try{
        const now = new Date();
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || 'local';
        const fmt = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        updated.textContent = `Updated ${now.toLocaleString(undefined, fmt)} (${tz})`;
      }catch(_){ updated.textContent = 'Updated just now'; }

      // Live clock
      function tickClock(){
        const d = new Date();
        const hh = String(d.getHours()).padStart(2,'0');
        const mm = String(d.getMinutes()).padStart(2,'0');
        clockChip.textContent = `${hh}:${mm}`;
      }
      tickClock();
      setInterval(tickClock, 1000 * 15);

      // Palettes
      const palettes = {
        aster:   { accents: [[208,92,54],[276,84,60],[332,86,60]], hues:[208,276,332] },
        lagoon:  { accents: [[190,88,50],[160,78,50],[220,86,60]], hues:[190,160,220] },
        rose:    { accents: [[14,86,58],[344,86,62],[40,88,58]], hues:[14,344,40] },
        graphite:{ accents: [[0,0,92],[0,0,60],[0,0,24]],        hues:[0,0,0] }
      };
      let current = palettes.aster;
      function setAccents(a){
        root.style.setProperty('--a1', `${a[0][0]} ${a[0][1]}% ${a[0][2]}%`);
        root.style.setProperty('--a2', `${a[1][0]} ${a[1][1]}% ${a[1][2]}%`);
        root.style.setProperty('--a3', `${a[2][0]} ${a[2][1]}% ${a[2][2]}%`);
      }
      function applyPalette(p){
        current = p; setAccents(p.accents);
        [palA,palB,palC,palD].forEach(b=>b.setAttribute('aria-pressed','false'));
        const map = new Map([[palA,palettes.aster],[palB,palettes.lagoon],[palC,palettes.rose],[palD,palettes.graphite]]);
        for(const [btn, pal] of map){ if(p===pal) btn.setAttribute('aria-pressed','true'); }
        reseed();
      }
      palA.addEventListener('click', ()=>applyPalette(palettes.aster));
      palB.addEventListener('click', ()=>applyPalette(palettes.lagoon));
      palC.addEventListener('click', ()=>applyPalette(palettes.rose));
      palD.addEventListener('click', ()=>applyPalette(palettes.graphite));

      // State
      let tempo = 1.0;
      let glow = parseInt(glowEl.value,10) || 16;
      let mode = 'rings'; // or 'orbs'

      tempoEl.addEventListener('input', e=>{
        const v = Math.max(50, Math.min(200, parseInt(e.target.value,10)||100));
        tempo = v/100;
        tempoEl.setAttribute('aria-valuenow', String(v));
      });
      glowEl.addEventListener('input', e=>{
        glow = Math.max(0, Math.min(30, parseInt(e.target.value,10)||16));
        glowEl.setAttribute('aria-valuenow', String(glow));
      });

      // Resize & DPR
      let dpr = Math.min(2, window.devicePixelRatio || 1);
      function resize(){
        const r = stage.getBoundingClientRect();
        canvas.width = Math.max(2, Math.floor(r.width * dpr));
        canvas.height = Math.max(2, Math.floor(r.height * dpr));
        canvas.style.width = r.width + 'px';
        canvas.style.height = r.height + 'px';
        ctx.setTransform(1,0,0,1,0,0);
        ctx.scale(dpr, dpr);
        clear(true);
      }
      function clear(hard){
        const r = stage.getBoundingClientRect();
        const isLight = root.getAttribute('data-theme')==='light';
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = 1;
        ctx.fillStyle = isLight ? '#f8fbff' : '#0a0e15';
        ctx.fillRect(0,0,r.width,r.height);
        if(!hard){
          const cg = ctx.createRadialGradient(r.width/2, r.height/2, Math.min(r.width,r.height)*0.10, r.width/2, r.height/2, Math.max(r.width,r.height)*0.8);
          if(isLight){
            cg.addColorStop(0, 'rgba(255,255,255,0.40)');
            cg.addColorStop(1, 'rgba(255,255,255,0)');
          }else{
            cg.addColorStop(0, 'rgba(255,255,255,0.10)');
            cg.addColorStop(1, 'rgba(0,0,0,0)');
          }
          ctx.fillStyle = cg; ctx.fillRect(0,0,r.width,r.height);
        }
      }
      resize();
      addEventListener('resize', ()=>{ dpr = Math.min(2, window.devicePixelRatio || 1); resize(); });

      // Theme toggle
      themeBtn.addEventListener('click', ()=>{
        const next = root.getAttribute('data-theme')==='light' ? 'dark' : 'light';
        root.setAttribute('data-theme', next);
        themeBtn.textContent = next.charAt(0).toUpperCase() + next.slice(1);
        themeBtn.setAttribute('aria-pressed', next==='dark' ? 'true' : 'false');
        clear(true);
      });

      // Mode toggle
      modeBtn.addEventListener('click', ()=>{
        mode = (mode === 'rings') ? 'orbs' : 'rings';
        modeBtn.textContent = mode === 'rings' ? 'Rings' : 'Orbs';
        modeBtn.setAttribute('aria-pressed', mode==='rings' ? 'true' : 'false');
        reseed(); clear(true);
      });

      // Tilt & pointer
      let px=.5, py=.5, pointer={x:0,y:0,down:false};
      stage.addEventListener('pointermove', (e)=>{
        const r = stage.getBoundingClientRect();
        px = Math.min(1, Math.max(0, (e.clientX - r.left)/r.width));
        py = Math.min(1, Math.max(0, (e.clientY - r.top)/r.height));
        pointer.x = (e.clientX - r.left); pointer.y = (e.clientY - r.top);
        stage.style.transform = `rotateX(${-(py - 0.5)*5}deg) rotateY(${(px - 0.5)*7}deg)`;
        if(mode==='rings' && !pointer.down) spawnRipple(pointer.x, pointer.y, 0.4);
      }, {passive:true});
      stage.addEventListener('pointerleave', ()=>{ stage.style.transform = 'rotateX(0deg) rotateY(0deg)'; pointer.down=false; });
      stage.addEventListener('pointerdown', (e)=>{ pointer.down=true; const r=stage.getBoundingClientRect(); spawnRipple(e.clientX-r.left, e.clientY-r.top, 1.0); });
      stage.addEventListener('pointerup', ()=>{ pointer.down=false; });

      // Seed
      let seed = Math.random()*10000;
      function rnd(){ const x = Math.sin(seed+=0.12345)*43758.5453; return x-Math.floor(x); }
      function reseed(){ seed = Math.random()*10000; initOrbs(); }

      // Rings
      const ripples = [];
      function spawnRipple(x,y,str){
        if(mode!=='rings') return;
        const hue = current.hues[Math.floor(rnd()*current.hues.length)] || 208;
        ripples.push({
          x, y,
          r: 4 + rnd()*12,
          w: 1.8 + rnd()*2.4,
          alpha: 0.55 * Math.min(1, Math.max(0.3, str)),
          hue,
          life: 1.0
        });
        if(ripples.length>240) ripples.splice(0, ripples.length-240);
      }

      // Orbs
      const orbs = [];
      function initOrbs(){
        orbs.length = 0;
        const r = stage.getBoundingClientRect();
        const count = 42;
        for(let i=0;i<count;i++){
          const hue = current.hues[i % current.hues.length];
          orbs.push({
            base: Math.min(r.width, r.height) * (0.15 + (i%14)/40),
            amp:  20 + (i%7)*6,
            spd:  (0.3 + (i%9)*0.06) * (rnd()<0.5?-1:1),
            th:   rnd()*Math.PI*2,
            hue,
            size: 2 + (i%5),
          });
        }
      }
      initOrbs();

      // Animation
      let t0 = performance.now();
      function step(now){
        const r = stage.getBoundingClientRect();
        const w = r.width, h = r.height;
        const dt = Math.min(32, now - t0) * 0.016 * tempo;
        const t = now*0.001;

        // Subtle fade for trails
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = (mode==='rings') ? 0.08 : 0.12;
        const isLight = root.getAttribute('data-theme')==='light';
        ctx.fillStyle = isLight ? 'rgba(248,251,255,0.08)' : 'rgba(10,14,21,0.10)';
        ctx.fillRect(0,0,w,h);

        if(mode==='rings'){
          ctx.globalCompositeOperation = 'lighter';
          for(let i=0;i<ripples.length;i++){
            const rp = ripples[i];
            rp.r += (60 + rp.w*25) * dt*0.5;
            rp.alpha *= (1 - 0.015*tempo);
            rp.life -= 0.012*tempo;

            const grad = ctx.createRadialGradient(rp.x, rp.y, Math.max(0, rp.r - rp.w*6), rp.x, rp.y, rp.r + rp.w*6);
            grad.addColorStop(0, `hsla(${rp.hue}, 90%, 60%, 0)`);
            grad.addColorStop(0.5, `hsla(${(rp.hue+24)%360}, 90%, 65%, ${Math.max(0, rp.alpha*0.6)})`);
            grad.addColorStop(1, `hsla(${(rp.hue+48)%360}, 90%, 70%, 0)`);

            ctx.fillStyle = grad;
            ctx.shadowColor = `hsla(${rp.hue}, 90%, 70%, ${Math.min(0.4, rp.alpha)})`;
            ctx.shadowBlur = glow;
            ctx.beginPath();
            ctx.arc(rp.x, rp.y, rp.r + rp.w*3, 0, Math.PI*2);
            ctx.fill();
          }
          // cleanup
          for(let i=ripples.length-1;i>=0;i--) if(ripples[i].life<=0.02) ripples.splice(i,1);
        } else {
          ctx.globalCompositeOperation = 'lighter';
          for(let i=0;i<orbs.length;i++){
            const o = orbs[i];
            o.th += o.spd * dt * 0.6;
            const cx = w/2, cy = h/2;
            const lx = Math.cos(o.th*1.0) * o.base + Math.cos((o.th*1.7)) * o.amp;
            const ly = Math.sin(o.th*1.0) * o.base + Math.sin((o.th*1.3)) * o.amp;
            const x = cx + lx, y = cy + ly;

            const grad = ctx.createRadialGradient(x, y, 0, x, y, 28+o.size*3);
            grad.addColorStop(0, `hsla(${o.hue}, 92%, 72%, 0.55)`);
            grad.addColorStop(1, `hsla(${(o.hue+32)%360}, 92%, 66%, 0)`);
            ctx.fillStyle = grad;
            ctx.shadowColor = `hsla(${o.hue}, 92%, 70%, 0.6)`;
            ctx.shadowBlur = glow + 2;

            ctx.beginPath();
            ctx.arc(x, y, 6+o.size, 0, Math.PI*2);
            ctx.fill();
          }
        }

        t0 = now;
        requestAnimationFrame(step);
      }

      // Snapshot
      function snapshotName(){ return `quiet-kinetic-2263.png`; }
      shotBtn.addEventListener('click', ()=>{
        try{
          const rect = stage.getBoundingClientRect();
          const tmp = document.createElement('canvas');
          const tctx = tmp.getContext('2d');
          const scale = Math.min(2, window.devicePixelRatio || 1);
          tmp.width = Math.floor(rect.width * scale);
          tmp.height = Math.floor(rect.height * scale);
          tctx.scale(scale, scale);

          // background
          const isLight = root.getAttribute('data-theme')==='light';
          tctx.fillStyle = isLight ? '#f8fbff' : '#0a0e15';
          tctx.fillRect(0,0,rect.width,rect.height);
          // draw current frame
          tctx.drawImage(canvas, 0, 0, rect.width, rect.height);
          const a = document.createElement('a');
          a.href = tmp.toDataURL('image/png');
          a.download = snapshotName();
          document.body.appendChild(a); a.click(); a.remove();
        }catch(_){}
      });

      // Clear
      resetBtn.addEventListener('click', ()=>{
        ripples.length = 0;
        clear(true);
      });

      // Keyboard shortcuts
      window.addEventListener('keydown', (e)=>{
        const k = e.key.toLowerCase();
        if(k==='t') themeBtn.click();
        if(k==='m') modeBtn.click();
        if(k==='s') shotBtn.click();
        if(k==='c') resetBtn.click();
        if(k==='1') palA.click();
        if(k==='2') palB.click();
        if(k==='3') palC.click();
        if(k==='4') palD.click();
      });

      // Start
      setAccents(current.accents);
      requestAnimationFrame(step);

      // Respect reduced motion: render a handful of frames
      const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
      if(prefersReduce){
        for(let i=0;i<80;i++){ step(performance.now()+i*16); }
      }
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


