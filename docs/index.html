<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<style>
  .vibe-2123 {
    --bg: #f6f7fb;
    --panel: rgba(255,255,255,0.75);
    --ink: #0e1320;
    --muted: #5b6475;
    --edge: rgba(14,19,35,0.12);

    --a: #6ee7ff;   /* ice */
    --b: #8a5cf6;   /* violet */
    --c: #ffb86b;   /* apricot */

    --ring: color-mix(in oklab, var(--a), var(--b) 50%);
    --glow: color-mix(in oklab, var(--b), var(--c) 50%);

    --tiltX: 0deg;
    --tiltY: 0deg;
    --grain: 0.12;

    position: relative;
    border-radius: 32px;
    padding: 26px 18px 22px;
    color: var(--ink);
    background:
      radial-gradient(900px 700px at 120% -10%, color-mix(in oklab, var(--c), transparent 92%), transparent 60%),
      radial-gradient(700px 600px at -10% 120%, color-mix(in oklab, var(--a), transparent 92%), transparent 60%),
      linear-gradient(180deg, #f7f9ff, var(--bg));
    box-shadow:
      0 50px 120px rgba(12,18,32,0.16),
      0 0 0 1px rgba(14,19,35,0.06) inset;
    overflow: hidden;
    isolation: isolate;
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  .vibe-2123.night {
    --bg: #0b1020;
    --panel: rgba(8,12,24,0.55);
    --ink: #e8eefb;
    --muted: #9aa3b6;
    --edge: rgba(255,255,255,0.1);
    background:
      radial-gradient(900px 700px at 90% -20%, color-mix(in oklab, var(--b), transparent 88%), transparent 60%),
      radial-gradient(700px 600px at -20% 110%, color-mix(in oklab, var(--c), transparent 90%), transparent 60%),
      linear-gradient(180deg, #070c18, var(--bg));
    box-shadow:
      0 60px 160px rgba(0,0,0,0.6),
      0 0 0 1px rgba(255,255,255,0.06) inset;
  }
  .vibe-2123 .wrap { max-width: 1080px; margin: 0 auto; position: relative; z-index: 1; }

  /* Ambient blooms */
  .vibe-2123::after, .vibe-2123::before {
    content: ""; position: absolute; pointer-events: none; mix-blend-mode: color-dodge; filter: blur(22px) saturate(120%);
  }
  .vibe-2123::after {
    inset: -60px; opacity: 0.55;
    background:
      radial-gradient(500px 360px at var(--mx,70%) var(--my,30%), color-mix(in oklab, var(--a), transparent 92%), transparent 62%),
      radial-gradient(600px 420px at 18% 85%, color-mix(in oklab, var(--c), transparent 90%), transparent 70%);
  }
  .vibe-2123::before {
    width: 60vw; max-width: 820px; aspect-ratio: 1;
    right: -10%; top: -20%;
    background: conic-gradient(from 210deg, color-mix(in oklab, var(--a), transparent 90%), color-mix(in oklab, var(--b), transparent 88%), color-mix(in oklab, var(--c), transparent 90%), transparent 70%);
    opacity: 0.3;
  }

  /* Topline */
  .vibe-2123 .top {
    display: flex; align-items: center; justify-content: space-between; gap: 12px;
  }
  .vibe-2123 .brand {
    display: inline-flex; align-items: center; gap: 10px;
    padding: 10px 14px; border-radius: 999px;
    border: 1px solid var(--edge);
    background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.5));
    color: var(--muted);
    font-size: 11px; letter-spacing: 0.22em; text-transform: uppercase;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 26px rgba(0,0,0,0.06) inset, 0 8px 26px rgba(0,0,0,0.06);
  }
  .vibe-2123.night .brand { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); }
  .vibe-2123 .dot {
    width: 10px; height: 10px; border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #fff, color-mix(in srgb, var(--a), white 20%));
    box-shadow:
      0 0 0 6px color-mix(in srgb, var(--a), transparent 90%),
      0 0 20px color-mix(in srgb, var(--a), transparent 70%);
    animation: v2123-p 2.8s ease-in-out infinite;
  }
  @keyframes v2123-p { 0%,100% { transform: scale(1) } 50% { transform: scale(1.25) } }

  .vibe-2123 .actions { display: inline-flex; gap: 8px; }
  .vibe-2123 .chip {
    appearance: none; border: 1px solid var(--edge);
    background: rgba(255,255,255,0.65);
    color: var(--ink);
    border-radius: 12px; padding: 8px 10px; cursor: pointer;
    font-size: 14px; line-height: 1;
    transition: transform 0.12s ease, background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    backdrop-filter: blur(8px);
  }
  .vibe-2123.night .chip { background: rgba(255,255,255,0.08); color: var(--ink); }
  .vibe-2123 .chip:hover { transform: translateY(-1px); background: rgba(255,255,255,0.85); }
  .vibe-2123.night .chip:hover { background: rgba(255,255,255,0.14); }

  /* Headline */
  .vibe-2123 h1 {
    margin: 16px 0 8px;
    font-size: clamp(44px, 10vw, 112px);
    line-height: 0.88; letter-spacing: -0.04em; font-weight: 900;
    text-wrap: balance;
    background: linear-gradient(120deg, var(--a), var(--b) 50%, var(--c)) 0/200% 200%;
    -webkit-background-clip: text; background-clip: text; color: transparent;
    filter: drop-shadow(0 16px 50px color-mix(in srgb, var(--b), transparent 80%));
    animation: v2123-shift 14s ease-in-out infinite;
  }
  @keyframes v2123-shift { 0%,100% { background-position: 0% 50% } 50% { background-position: 100% 50% } }

  .vibe-2123 .lead {
    margin: 8px 0 14px; max-width: 68ch;
    font-size: clamp(15px, 2.2vw, 20px);
    color: var(--muted);
  }

  /* Console */
  .vibe-2123 .console {
    display: flex; flex-wrap: wrap; align-items: center; gap: 10px 14px; margin: 10px 0 18px;
  }
  .vibe-2123 .pane {
    display: inline-flex; align-items: center; gap: 10px;
    padding: 8px 10px; border-radius: 14px; border: 1px solid var(--edge);
    background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.5));
    color: var(--muted); font-size: 11px; letter-spacing: 0.15em; text-transform: uppercase;
    backdrop-filter: blur(10px);
    box-shadow: 0 1px 0 rgba(255,255,255,0.6) inset;
  }
  .vibe-2123.night .pane { background: rgba(255,255,255,0.07); box-shadow: 0 1px 0 rgba(255,255,255,0.08) inset; }

  .vibe-2123 .toggle { display: inline-flex; align-items: center; gap: 8px; }
  .vibe-2123 .toggle button {
    width: 48px; height: 24px; border-radius: 999px; position: relative; border: 0; cursor: pointer;
    background: linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.65));
    box-shadow: 0 0 0 1px rgba(14,19,35,0.12) inset, 0 6px 14px rgba(0,0,0,0.08);
    transition: background 0.2s ease;
  }
  .vibe-2123.night .toggle button { background: linear-gradient(180deg, rgba(255,255,255,0.24), rgba(255,255,255,0.1)); }
  .vibe-2123 .toggle button::after {
    content: ""; position: absolute; top: 3px; left: 3px; width: 18px; height: 18px; border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #fff, #e6ebf5);
    border: 1px solid rgba(10,16,28,0.22);
    box-shadow: 0 2px 10px rgba(10,16,28,0.18);
    transition: transform 0.18s ease;
  }
  .vibe-2123 .toggle button[aria-pressed="true"]::after { transform: translateX(24px); }

  .vibe-2123 .swatch { gap: 8px; padding: 8px 10px; }
  .vibe-2123 .sw {
    width: 28px; height: 28px; border-radius: 8px; border: 1px solid var(--edge); cursor: pointer;
    background: var(--preview, linear-gradient(90deg, var(--a), var(--b), var(--c)));
    transform: rotate(6deg); transition: transform 0.18s ease, filter 0.22s ease, box-shadow 0.22s ease;
    box-shadow: 0 14px 22px rgba(0,0,0,0.16);
  }
  .vibe-2123 .sw:hover { transform: rotate(6deg) translateY(-2px) scale(1.06); filter: saturate(1.1); }
  .vibe-2123 .sw.active { box-shadow: 0 0 0 3px rgba(255,255,255,0.9), 0 0 0 8px color-mix(in srgb, var(--b), transparent 86%); }
  .vibe-2123.night .sw.active { box-shadow: 0 0 0 3px rgba(255,255,255,0.18), 0 0 0 8px color-mix(in srgb, var(--b), transparent 86%); }

  .vibe-2123 .range { gap: 10px; }
  .vibe-2123 .range input[type="range"] { appearance: none; width: 190px; height: 22px; background: transparent; }
  .vibe-2123 .range output { min-width: 4ch; text-align: right; font-variant-numeric: tabular-nums; }
  .vibe-2123 .range input[type="range"]::-webkit-slider-runnable-track {
    height: 6px; border-radius: 999px; background: linear-gradient(90deg, var(--a), var(--b), var(--c));
    box-shadow: 0 0 0 1px rgba(0,0,0,0.08) inset;
  }
  .vibe-2123 .range input[type="range"]::-webkit-slider-thumb {
    appearance: none; width: 18px; height: 18px; margin-top: -6px; border-radius: 50%;
    background: #ffffff; border: 1px solid rgba(14,18,32,0.22);
    box-shadow: 0 0 0 3px rgba(14,18,32,0.06), 0 6px 16px rgba(10,16,28,0.16);
  }
  .vibe-2123 .range input[type="range"]::-moz-range-track {
    height: 6px; border-radius: 999px; background: linear-gradient(90deg, var(--a), var(--b), var(--c));
    box-shadow: 0 0 0 1px rgba(0,0,0,0.08) inset;
  }
  .vibe-2123 .range input[type="range"]::-moz-range-thumb {
    width: 18px; height: 18px; border-radius: 50%;
    background: #ffffff; border: 1px solid rgba(14,18,32,0.22);
    box-shadow: 0 0 0 3px rgba(14,18,32,0.06), 0 6px 16px rgba(10,16,28,0.16);
  }

  /* Orbital Garden */
  .vibe-2123 .orb {
    position: relative; margin: 12px 0 18px;
    width: 100%; aspect-ratio: 1/1;
    border-radius: 28px; overflow: hidden; border: 1px solid var(--edge);
    background: radial-gradient(circle at 50% 55%, var(--panel), rgba(255,255,255,0.25) 60%, transparent 80%), var(--panel);
    box-shadow:
      0 60px 140px rgba(0,0,0,0.18),
      0 12px 30px rgba(0,0,0,0.06),
      0 0 0 1px rgba(255,255,255,0.6) inset;
    transform: perspective(1200px) rotateX(var(--tiltX)) rotateY(var(--tiltY));
    transition: transform 0.12s ease, box-shadow 0.25s ease;
  }
  .vibe-2123.night .orb { background: radial-gradient(circle at 50% 55%, rgba(255,255,255,0.06), rgba(255,255,255,0.02) 60%, transparent 80%), var(--panel);
    box-shadow: 0 60px 160px rgba(0,0,0,0.5), 0 18px 40px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.06) inset;
  }

  .vibe-2123 canvas.stage { position: absolute; inset: 0; width: 100%; height: 100%; }

  /* Halo ring */
  .vibe-2123 .halo {
    position: absolute; inset: 0; pointer-events: none; z-index: 2;
    background:
      radial-gradient(closest-side, transparent calc(50% - 140px), color-mix(in srgb, var(--ring), transparent 80%) calc(50% - 138px), color-mix(in oklab, var(--ring), white 40%) calc(50% - 130px), transparent calc(50% - 90px)),
      radial-gradient(closest-side, transparent calc(50% - 90px), color-mix(in oklab, var(--glow), transparent 70%) calc(50% - 88px), transparent calc(50% - 40px));
    mix-blend-mode: screen;
    animation: v2123-halo 18s ease-in-out infinite;
  }
  @keyframes v2123-halo {
    0%,100% { filter: hue-rotate(0deg) blur(0.4px) }
    50% { filter: hue-rotate(22deg) blur(1px) }
  }

  /* Gridlet */
  .vibe-2123 .rings {
    position: absolute; inset: 0; pointer-events: none; z-index: 1;
    background:
      radial-gradient(circle at 50% 50%, rgba(14,19,35,0.06) 1px, transparent 1px) 0 0 / 40px 40px;
    opacity: 0; transition: opacity 0.2s ease;
  }
  .vibe-2123.night .rings { background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.08) 1px, transparent 1px) 0 0 / 40px 40px; }
  .vibe-2123 .orb.grid-on .rings { opacity: 1; }

  /* Label cluster */
  .vibe-2123 .label {
    position: absolute; inset: 0; z-index: 3; display: grid; grid-template-rows: 1fr auto auto 1fr;
    padding: clamp(16px, 4.5vw, 38px);
  }
  .vibe-2123 .stamp {
    place-self: start;
    display: inline-flex; align-items: center; gap: 8px;
    padding: 8px 12px; border-radius: 999px;
    font-size: 11px; letter-spacing: 0.18em; text-transform: uppercase;
    background: rgba(255,255,255,0.85);
    border: 1px solid var(--edge); color: var(--muted);
    box-shadow: 0 0 0 1px rgba(255,255,255,0.8) inset;
  }
  .vibe-2123.night .stamp { background: rgba(0,0,0,0.35); color: var(--ink); box-shadow: 0 0 0 1px rgba(255,255,255,0.12) inset; }

  .vibe-2123 .big {
    align-self: end;
    font-size: clamp(40px, 8.5vw, 96px); line-height: 0.9; letter-spacing: -0.03em; font-weight: 900;
    background: linear-gradient(100deg, var(--a), var(--b) 45%, var(--c)) 0/200% 200%;
    -webkit-background-clip: text; background-clip: text; color: transparent;
    animation: v2123-shift 16s ease-in-out infinite reverse;
  }
  .vibe-2123 .sub { align-self: start; margin-top: 10px; font-size: clamp(14px, 2.2vw, 18px); color: color-mix(in srgb, var(--ink), var(--muted) 42%); opacity: 0.9; }

  .vibe-2123 .meta {
    display: flex; gap: 12px; align-items: center; flex-wrap: wrap;
    font-size: 12px; color: var(--muted); margin-top: 14px;
  }
  .vibe-2123 .sep { width: 4px; height: 4px; border-radius: 50%; background: var(--edge); }

  @media (prefers-reduced-motion: reduce) {
    .vibe-2123 h1, .vibe-2123 .big, .vibe-2123 .halo { animation: none; }
    .vibe-2123 .orb { transform: none !important; }
  }

  @media (max-width: 900px) {
    .vibe-2123 { border-radius: 28px; padding: 22px 16px; }
    .vibe-2123 h1 { font-size: clamp(34px, 12vw, 86px); }
    .vibe-2123 .range input[type="range"] { width: 150px; }
  }
</style>

<div class="vibe-2123" role="region" aria-label="Orbitarium â€” generative light garden v2123">
  <div class="wrap">
    <div class="top">
      <div class="brand"><span class="dot" aria-hidden="true"></span> Orbitarium Â· 2123</div>
      <div class="actions">
        <button class="chip btn-dice" title="Remix palette" aria-label="Remix">ðŸŽ²</button>
        <button class="chip btn-theme" title="Toggle theme" aria-pressed="false" aria-label="Theme">â˜€ï¸Ž</button>
      </div>
    </div>

    <h1>Neon Bloom Studio</h1>
    <p class="lead">Grow a living haloâ€”orbits, trails, and glow that respond to your touch. Tweak the garden below.</p>

    <div class="console" role="group" aria-label="Controls">
      <label class="pane range" title="Orbits">
        <span>Orbits</span>
        <input class="sl-orbits" type="range" min="6" max="120" value="42" step="2" aria-label="Orbit count">
        <output class="out orbits">42</output>
      </label>

      <label class="pane range" title="Bloom">
        <span>Bloom</span>
        <input class="sl-bloom" type="range" min="0" max="100" value="55" step="1" aria-label="Bloom">
        <output class="out bloom">0.55</output>
      </label>

      <div class="pane toggle" title="Trails">
        <span>Trails</span>
        <button class="btn-trails" aria-pressed="true" aria-label="Toggle trails"></button>
      </div>

      <div class="pane toggle" title="Grid">
        <span>Grid</span>
        <button class="btn-grid" aria-pressed="false" aria-label="Toggle grid"></button>
      </div>

      <div class="pane toggle" title="Parallax">
        <span>Parallax</span>
        <button class="btn-parallax" aria-pressed="true" aria-label="Toggle parallax"></button>
      </div>

      <div class="pane swatch" aria-label="Palette">
        <button class="sw" data-colors="#6ee7ff|#8a5cf6|#ffb86b" style="--preview:linear-gradient(90deg,#6ee7ff,#8a5cf6,#ffb86b)" aria-label="Iris Frost"></button>
        <button class="sw" data-colors="#22d3ee|#a78bfa|#34d399" style="--preview:linear-gradient(90deg,#22d3ee,#a78bfa,#34d399)" aria-label="Lagoon"></button>
        <button class="sw" data-colors="#f97316|#06b6d4|#84cc16" style="--preview:linear-gradient(90deg,#f97316,#06b6d4,#84cc16)" aria-label="Citrus Sea"></button>
        <button class="sw" data-colors="#60a5fa|#f472b6|#a3e635" style="--preview:linear-gradient(90deg,#60a5fa,#f472b6,#a3e635)" aria-label="Aurora Pop"></button>
        <button class="sw" data-colors="#111827|#6b7280|#60a5fa" style="--preview:linear-gradient(90deg,#111827,#6b7280,#60a5fa)" aria-label="Ink Frost"></button>
      </div>
    </div>

    <div class="orb" aria-hidden="true">
      <canvas class="stage"></canvas>
      <div class="rings" aria-hidden="true"></div>
      <div class="halo" aria-hidden="true"></div>

      <div class="label" aria-hidden="true">
        <div class="stamp">Edition&nbsp;2123</div>
        <div class="big">Bloom&nbsp;Cycle</div>
        <div class="sub">Drawn by math, guided by you.</div>
      </div>
    </div>

    <div class="meta">
      <span id="last-updated">Last updated: 2026-01-22 12:26:56 EST</span>
      <span class="sep" aria-hidden="true"></span>
      <span>Move to tilt Â· sliders to tune Â· dice to remix</span>
    </div>
  </div>
</div>

<script>
(function () {
  const root = document.currentScript.previousElementSibling;
  const updatedEl = root.querySelector('#last-updated');

  // Timestamp
  try {
    const now = new Date();
    const fmt = new Intl.DateTimeFormat([], {
      year: 'numeric', month: '2-digit', day: '2-digit',
      hour: '2-digit', minute: '2-digit', second: '2-digit',
      hour12: false, timeZoneName: 'short'
    });
    updatedEl.textContent = 'Last updated: ' + fmt.format(now);
  } catch (_) {
    updatedEl.textContent = 'Last updated: ' + new Date().toLocaleString();
  }

  // Elements
  const canvas = root.querySelector('canvas.stage');
  const ctx = canvas.getContext('2d', { alpha: true });
  const orb = root.querySelector('.orb');
  const themeBtn = root.querySelector('.btn-theme');
  const dice = root.querySelector('.btn-dice');
  const swatches = Array.from(root.querySelectorAll('.sw'));
  const trailsBtn = root.querySelector('.btn-trails');
  const gridBtn = root.querySelector('.btn-grid');
  const parallaxBtn = root.querySelector('.btn-parallax');
  const slOrbits = root.querySelector('.sl-orbits');
  const slBloom = root.querySelector('.sl-bloom');
  const outOrbits = root.querySelector('.out.orbits');
  const outBloom = root.querySelector('.out.bloom');

  // Theme
  let night = false;
  function applyTheme(setNight) {
    night = setNight ?? !night;
    root.classList.toggle('night', night);
    themeBtn.textContent = night ? 'â˜¾' : 'â˜€ï¸Ž';
    themeBtn.setAttribute('aria-pressed', String(night));
  }
  themeBtn.addEventListener('click', () => applyTheme());
  applyTheme(false);

  // Palette
  function setPalette(a,b,c) {
    root.style.setProperty('--a', a);
    root.style.setProperty('--b', b);
    root.style.setProperty('--c', c);
    root.style.setProperty('--ring', `color-mix(in oklab, ${a}, ${b} 50%)`);
    root.style.setProperty('--glow', `color-mix(in oklab, ${b}, ${c} 50%)`);
  }
  swatches.forEach((b,i) => {
    b.addEventListener('click', () => {
      swatches.forEach(x => x.classList.toggle('active', x===b));
      const [c1,c2,c3] = (b.getAttribute('data-colors')||'').split('|');
      setPalette(c1,c2,c3);
      root.animate({transform:['scale(0.995)','scale(1)']},{duration:160,easing:'ease-out'});
    });
    if (i===0) b.classList.add('active');
  });
  {
    const init = swatches[0].getAttribute('data-colors').split('|');
    setPalette(init[0], init[1], init[2]);
  }
  dice.addEventListener('click', () => {
    const picks = [
      ['#6ee7ff','#8a5cf6','#ffb86b'],
      ['#22d3ee','#a78bfa','#34d399'],
      ['#f97316','#06b6d4','#84cc16'],
      ['#60a5fa','#f472b6','#a3e635'],
      ['#ff8ab3','#7dd3fc','#ffd166'],
      ['#0ea5e9','#a3e635','#f59e0b'],
      ['#e879f9','#38bdf8','#fca5a5']
    ];
    const pick = picks[Math.floor(Math.random()*picks.length)];
    setPalette(...pick);
  });

  // Toggles
  let trails = true;
  let grid = false;
  let parallax = true;
  trailsBtn.addEventListener('click', () => {
    trails = !trails; trailsBtn.setAttribute('aria-pressed', String(trails));
  });
  gridBtn.addEventListener('click', () => {
    grid = !grid; gridBtn.setAttribute('aria-pressed', String(grid));
    orb.classList.toggle('grid-on', grid);
  });
  parallaxBtn.addEventListener('click', () => {
    parallax = !parallax; parallaxBtn.setAttribute('aria-pressed', String(parallax));
    if (!parallax) root.style.setProperty('--tiltX', '0deg'), root.style.setProperty('--tiltY','0deg');
  });

  // Sliders
  let ORBITS = parseInt(slOrbits.value, 10);
  let BLOOM = parseInt(slBloom.value, 10)/100;
  outOrbits.textContent = ORBITS;
  outBloom.textContent = BLOOM.toFixed(2);
  slOrbits.addEventListener('input', e => { ORBITS = parseInt(e.target.value,10); outOrbits.textContent = ORBITS; reset(); });
  slBloom.addEventListener('input', e => { BLOOM = parseInt(e.target.value,10)/100; outBloom.textContent = BLOOM.toFixed(2); });

  // Stage
  let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
  let W = 0, H = 0, CX = 0, CY = 0, R = 0;
  function size() {
    const rect = orb.getBoundingClientRect();
    W = Math.max(2, Math.floor(rect.width));
    H = Math.max(2, Math.floor(rect.height));
    CX = W/2; CY = H/2; R = Math.min(W,H)*0.44;
    canvas.width = Math.floor(W*dpr);
    canvas.height = Math.floor(H*dpr);
    canvas.style.width = W+'px';
    canvas.style.height = H+'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);
    ctx.globalCompositeOperation = 'source-over';
  }
  size();
  new ResizeObserver(size).observe(orb);

  // Orbiters
  let seeds = [];
  function reset() {
    seeds = Array.from({length: ORBITS}, (_,i) => {
      const u = (i+0.5)/ORBITS;
      return {
        r: (0.22 + 0.68*u*u) * R,
        a: Math.random()*Math.PI*2,
        s: (0.2 + u*1.3) * (Math.random()>0.5?1:-1),
        w: 1 + u*2.2,
        hue: u
      };
    });
  }
  reset();

  // Color helpers
  function hexToRgb(hex) {
    const m = hex.trim().replace('#','');
    const p = m.length === 3 ? m.split('').map(ch => ch+ch).join('') : m;
    const n = parseInt(p, 16);
    return { r: (n>>16)&255, g: (n>>8)&255, b: n&255 };
  }
  function mix(a,b,t){ return { r: Math.round(a.r+(b.r-a.r)*t), g: Math.round(a.g+(b.g-a.g)*t), b: Math.round(a.b+(b.b-a.b)*t) }; }
  function getPalette() {
    const style = getComputedStyle(root);
    return [
      hexToRgb((style.getPropertyValue('--a')||'#6ee7ff').trim()),
      hexToRgb((style.getPropertyValue('--b')||'#8a5cf6').trim()),
      hexToRgb((style.getPropertyValue('--c')||'#ffb86b').trim())
    ];
  }
  function paletteSample(t) {
    const [c1,c2,c3] = getPalette();
    if (t<0.5) return mix(c1,c2,t*2);
    return mix(c2,c3,(t-0.5)*2);
  }

  // Parallax tilt + attractor
  const tilt = { x:0, y:0, tx:0, ty:0 };
  let attract = { x: 0, y: 0 };
  orb.addEventListener('pointermove', (e) => {
    const r = orb.getBoundingClientRect();
    const nx = ((e.clientX - r.left)/r.width - 0.5)*2;
    const ny = ((e.clientY - r.top)/r.height - 0.5)*2;
    tilt.tx = nx; tilt.ty = ny;
    attract.x = nx * R * 0.35;
    attract.y = ny * R * 0.35;
    root.style.setProperty('--mx', (e.clientX / window.innerWidth) * 100 + '%');
    root.style.setProperty('--my', (e.clientY / window.innerHeight) * 100 + '%');
  }, { passive: true });
  orb.addEventListener('pointerleave', ()=>{ tilt.tx=0; tilt.ty=0; attract.x=0; attract.y=0; });

  // Animation
  const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  let live = !reduce;
  if (reduce) {
    trails = false; trailsBtn.setAttribute('aria-pressed','false');
    parallax = false; parallaxBtn.setAttribute('aria-pressed','false');
  }

  let t = 0;
  function step() {
    if (!live) return;
    t += 0.016;

    // Tilt easing
    if (parallax) {
      tilt.x += (tilt.tx - tilt.x)*0.08;
      tilt.y += (tilt.ty - tilt.y)*0.08;
      const maxDeg = 7;
      root.style.setProperty('--tiltY', (tilt.x*maxDeg).toFixed(3)+'deg');
      root.style.setProperty('--tiltX', (-tilt.y*maxDeg).toFixed(3)+'deg');
    }

    // Trails
    if (trails) {
      ctx.fillStyle = night ? 'rgba(0,0,0,'+(0.12 + (1-BLOOM)*0.08)+')' : 'rgba(255,255,255,'+(0.08 + (1-BLOOM)*0.06)+')';
      ctx.fillRect(0,0,W,H);
    } else {
      ctx.clearRect(0,0,W,H);
    }

    ctx.save();
    ctx.translate(CX, CY);

    // Draw orbits
    for (let i=0;i<seeds.length;i++) {
      const o = seeds[i];
      const speed = 0.4 + BLOOM*1.6;
      o.a += o.s * 0.0025 * speed;

      // Orbit position with attractor influence
      const bx = Math.cos(o.a)*o.r;
      const by = Math.sin(o.a)*o.r;
      const px = bx + attract.x*(0.15 + 0.45*(i/seeds.length));
      const py = by + attract.y*(0.15 + 0.45*(i/seeds.length));

      // Color
      const c = paletteSample(o.hue);
      const alpha = 0.18 + BLOOM*0.35;
      ctx.globalCompositeOperation = 'lighter';
      const grad = ctx.createRadialGradient(px,py,0,px,py, 30 + o.w*8);
      grad.addColorStop(0, `rgba(${c.r},${c.g},${c.b},${Math.min(0.65, alpha+0.15)})`);
      grad.addColorStop(1, `rgba(${c.r},${c.g},${c.b},0)`);
      ctx.fillStyle = grad;
      ctx.beginPath();
      ctx.arc(px, py, 28 + o.w*6*BLOOM, 0, Math.PI*2);
      ctx.fill();

      // Small core
      ctx.globalCompositeOperation = 'source-over';
      ctx.fillStyle = `rgba(${c.r},${c.g},${c.b},${Math.min(1, alpha+0.2)})`;
      ctx.beginPath(); ctx.arc(px, py, 1.2 + o.w*0.6, 0, Math.PI*2); ctx.fill();
    }

    // Center bloom
    const g = ctx.createRadialGradient(0,0, R*0.05, 0,0, R*0.75);
    const core = paletteSample((Math.sin(t*0.3)+1)/2);
    g.addColorStop(0, `rgba(${core.r},${core.g},${core.b},${0.18 + BLOOM*0.3})`);
    g.addColorStop(1, night ? 'rgba(0,0,0,0.35)' : 'rgba(255,255,255,0.22)');
    ctx.globalCompositeOperation = 'soft-light';
    ctx.fillStyle = g;
    ctx.beginPath(); ctx.arc(0,0,R*0.92,0,Math.PI*2); ctx.fill();

    ctx.restore();

    requestAnimationFrame(step);
  }
  // Start
  if (!reduce) step();

  // Idle tilt maintenance when motion is off
  function idleTilt() {
    if (!parallax) return;
    tilt.x += (tilt.tx - tilt.x)*0.12;
    tilt.y += (tilt.ty - tilt.y)*0.12;
    const maxDeg = 7;
    root.style.setProperty('--tiltY', (tilt.x*maxDeg).toFixed(3)+'deg');
    root.style.setProperty('--tiltX', (-tilt.y*maxDeg).toFixed(3)+'deg');
    if (!live) requestAnimationFrame(idleTilt);
  }
  orb.addEventListener('pointermove', () => { if (!live) idleTilt(); });
  orb.addEventListener('pointerleave', () => { if (!live) idleTilt(); });

})();
</script>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


