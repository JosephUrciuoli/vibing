<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="sunlit728" class="sunlit" data-theme="dawn" aria-label="SUNLIT 728 • Paper Garden">
  <style>
    /* SUNLIT 728 — Paper Garden (scoped) */
    #sunlit728 {
      --paper: #f7f8fc;
      --ink: #202230;
      --muted: #6b7086;
      --ring: rgba(20, 24, 38, 0.08);
      --glass: rgba(255,255,255,0.55);
      --t1: #ff8aa2; /* accent A */
      --t2: #ffcf6b; /* accent B */
      --t3: #78e0c5; /* accent C */
      position: relative;
      color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      border-radius: 36px;
      padding: clamp(18px, 4.8vw, 44px);
      background:
        radial-gradient(120% 140% at 10% -10%, rgba(255,255,255,0.9), transparent 50%),
        radial-gradient(100% 120% at 100% 100%, rgba(255,255,255,0.7), transparent 50%),
        linear-gradient(180deg, #ffffff, var(--paper));
      border: 1px solid var(--ring);
      box-shadow: 0 24px 70px rgba(18, 22, 38, 0.14), inset 0 1px 0 rgba(255,255,255,0.8);
      overflow: hidden;
      isolation: isolate;
      transform-style: preserve-3d;
    }
    #sunlit728::before {
      content: "";
      position: absolute; inset: -30%;
      background:
        radial-gradient(32% 26% at 18% 20%, color-mix(in srgb, var(--t1) 28%, transparent), transparent 70%),
        radial-gradient(26% 20% at 85% 18%, color-mix(in srgb, var(--t2) 28%, transparent), transparent 70%),
        radial-gradient(34% 28% at 40% 88%, color-mix(in srgb, var(--t3) 28%, transparent), transparent 70%);
      filter: blur(70px) saturate(1.06);
      opacity: 0.75;
      z-index: 0;
      transform: translate3d(calc(var(--mx, 0) * 6px), calc(var(--my, 0) * 6px), 0);
      transition: transform 300ms ease;
      pointer-events: none;
    }
    #sunlit728::after {
      /* soft paper grain */
      content: "";
      position: absolute; inset: 0; z-index: 0; pointer-events: none;
      background-image:
        radial-gradient(1px 1px at 14% 28%, rgba(0,0,0,0.05), transparent 50%),
        radial-gradient(1px 1px at 72% 70%, rgba(0,0,0,0.04), transparent 50%),
        radial-gradient(1px 1px at 86% 16%, rgba(0,0,0,0.04), transparent 50%);
      background-size: 140px 140px, 200px 200px, 260px 260px;
      mix-blend-mode: soft-light;
    }

    /* Header */
    #sunlit728 .hdr {
      position: relative; z-index: 2;
      display: grid; grid-template-columns: 1fr auto; gap: 14px; align-items: center;
    }
    #sunlit728 .brand {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 8px 12px; border-radius: 999px;
      background: var(--glass);
      border: 1px solid rgba(20,24,38,0.10);
      letter-spacing: 0.18em; text-transform: uppercase; font-size: 12px; color: var(--muted);
      backdrop-filter: blur(10px);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 10px 30px rgba(18,22,38,0.07);
    }
    #sunlit728 .sigil {
      width: 16px; height: 16px; border-radius: 50%;
      background: conic-gradient(from 0deg, var(--t1), var(--t2), var(--t3), var(--t1));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.7), 0 0 18px color-mix(in srgb, var(--t2) 40%, transparent);
      animation: spin728 16s linear infinite;
    }
    @keyframes spin728 { to { transform: rotate(360deg); } }

    #sunlit728 .h1 {
      grid-column: 1/-1;
      font-weight: 900; letter-spacing: -0.02em; line-height: 1.02;
      font-size: clamp(38px, 6.6vw, 96px);
      margin: 10px 0 0;
      background: linear-gradient(90deg, #0f172a 0%, #334155 40%, #0f172a 100%);
      -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(0 10px 18px rgba(18,22,38,0.10));
    }
    #sunlit728 .lede {
      grid-column: 1/-1; max-width: 75ch;
      color: var(--muted);
      font-size: clamp(14px, 1.7vw, 18px);
      margin-top: 6px;
    }

    /* Theme chips */
    #sunlit728 .chips {
      display: inline-flex; gap: 8px; padding: 6px;
      background: var(--glass);
      border: 1px solid rgba(20,24,38,0.12);
      border-radius: 999px; backdrop-filter: blur(10px);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.8), 0 10px 24px rgba(18,22,38,0.06);
    }
    #sunlit728 .chip {
      -webkit-tap-highlight-color: transparent;
      appearance: none; border: 0; cursor: pointer;
      font-weight: 800; font-size: 12px; color: var(--ink);
      padding: 8px 12px; border-radius: 999px; position: relative;
      background: transparent; border: 1px solid rgba(20,24,38,0.10);
      transition: transform 140ms ease, background 200ms ease, color 200ms ease, box-shadow 200ms ease;
    }
    #sunlit728 .chip:hover { transform: translateY(-1px); }
    #sunlit728 .chip[aria-pressed="true"] {
      background:
        linear-gradient(180deg, rgba(255,255,255,0.8), rgba(255,255,255,0.5)) padding-box,
        linear-gradient(90deg, var(--t1), var(--t2), var(--t3)) border-box;
      border: 1px solid transparent;
      box-shadow: 0 10px 20px rgba(18,22,38,0.10), inset 0 1px 0 rgba(255,255,255,0.9);
      color: #0f172a;
    }

    /* Stage */
    #sunlit728 .stage {
      position: relative; z-index: 1;
      margin-top: clamp(18px, 4vw, 36px);
      border-radius: 28px; overflow: hidden;
      border: 1px solid rgba(20,24,38,0.10);
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6));
      box-shadow: 0 24px 50px rgba(18,22,38,0.10), inset 0 1px 0 rgba(255,255,255,0.8);
    }
    #sunlit728 canvas {
      display: block; width: 100%; height: 62vh; min-height: 320px; max-height: 78vh;
      filter: saturate(1.06) contrast(1.02) blur(0.05px);
      cursor: pointer;
      touch-action: none;
    }
    #sunlit728 .hint {
      position: absolute; inset: auto auto 14px 14px; z-index: 3;
      font-size: 12px; color: var(--muted);
      background: var(--glass);
      border: 1px solid rgba(20,24,38,0.12);
      border-radius: 999px; padding: 6px 10px; backdrop-filter: blur(10px);
    }

    /* HUD */
    #sunlit728 .hud {
      position: absolute; inset: auto 12px 12px auto; z-index: 4;
      display: grid; gap: 10px; grid-auto-flow: column; align-items: end;
    }
    @media (max-width: 760px) {
      #sunlit728 .hud { left: 12px; right: 12px; grid-auto-flow: row; }
    }
    #sunlit728 .pill {
      background: var(--glass);
      border: 1px solid rgba(20,24,38,0.12);
      border-radius: 14px; padding: 10px 12px; min-width: 220px;
      backdrop-filter: blur(12px);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.9), 0 8px 20px rgba(18,22,38,0.08);
    }
    #sunlit728 .pill label {
      display: flex; justify-content: space-between; align-items: baseline; gap: 10px;
      font-size: 11px; color: var(--muted);
      text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 6px;
    }
    #sunlit728 .pill .val { color: var(--ink); font-variant-numeric: tabular-nums; }
    #sunlit728 input[type="range"] {
      width: 100%; -webkit-appearance: none; appearance: none;
      height: 10px; border-radius: 999px; outline: none;
      background: linear-gradient(90deg, var(--t1), var(--t2), var(--t3));
      border: 1px solid rgba(20,24,38,0.10);
    }
    #sunlit728 input[type="range"]::-webkit-slider-thumb,
    #sunlit728 input[type="range"]::-moz-range-thumb {
      -webkit-appearance: none; appearance: none;
      width: 18px; height: 18px; border-radius: 50%;
      background: #ffffff; border: 1px solid rgba(20,24,38,0.22);
      box-shadow: 0 4px 10px rgba(18,22,38,0.15), inset 0 1px 0 rgba(255,255,255,0.9);
      cursor: pointer;
    }
    #sunlit728 .round, #sunlit728 .ghost {
      -webkit-tap-highlight-color: transparent;
      appearance: none; border: 0; cursor: pointer; font-weight: 800;
      padding: 12px 16px; border-radius: 14px; color: var(--ink);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6)) padding-box,
        linear-gradient(90deg, var(--t1), var(--t2), var(--t3)) border-box;
      border: 1px solid transparent;
      box-shadow: 0 10px 26px rgba(18,22,38,0.10), inset 0 1px 0 rgba(255,255,255,0.9);
      transition: transform 140ms ease, box-shadow 200ms ease;
      white-space: nowrap;
    }
    #sunlit728 .round:hover, #sunlit728 .ghost:hover { transform: translateY(-1px); }
    #sunlit728 .ghost {
      background: var(--glass);
      border: 1px solid rgba(20,24,38,0.12);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.9);
    }

    /* Footer */
    #sunlit728 .ftr {
      position: relative; z-index: 2;
      display: flex; justify-content: space-between; align-items: center;
      gap: 12px; margin-top: 16px; color: var(--muted); font-size: 12px;
      flex-wrap: wrap;
    }
    #sunlit728 .legend { display: inline-flex; align-items: center; gap: 10px; }
    #sunlit728 .swatch {
      display: inline-grid; grid-auto-flow: column; gap: 6px; align-items: center;
      padding: 6px 8px; border-radius: 999px;
      background: rgba(255,255,255,0.8); border: 1px solid rgba(20,24,38,0.10);
      backdrop-filter: blur(8px);
    }
    #sunlit728 .dot {
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--col, var(--t1));
      border: 1px solid rgba(20,24,38,0.20);
      box-shadow: 0 0 12px color-mix(in srgb, var(--col, var(--t1)) 40%, transparent);
    }

    /* Themes */
    #sunlit728[data-theme="dawn"] {
      --paper:#f7f8fc; --ink:#202230; --muted:#6b7086; --ring: rgba(20, 24, 38, 0.08);
      --t1:#ff8aa2; --t2:#ffcf6b; --t3:#78e0c5;
    }
    #sunlit728[data-theme="meadow"] {
      --paper:#f6fbf8; --ink:#1d2a22; --muted:#5e7567; --ring: rgba(22, 34, 27, 0.09);
      --t1:#6ee7b7; --t2:#a7f3d0; --t3:#60a5fa;
    }
    #sunlit728[data-theme="citrus"] {
      --paper:#fff9f2; --ink:#2a1d18; --muted:#7a635a; --ring: rgba(42, 29, 24, 0.10);
      --t1:#ff9f1c; --t2:#ffd166; --t3:#4cc9f0;
    }
    #sunlit728[data-theme="noir"] {
      --paper:#121725; --ink:#eaf2ff; --muted:#9db1d5; --ring: rgba(255,255,255,0.16);
      --t1:#7dd3fc; --t2:#a5b4fc; --t3:#ffd56b;
      color-scheme: dark;
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #sunlit728 .chip, #sunlit728 .round, #sunlit728 .ghost { transition: none !important; }
      #sunlit728::before, #sunlit728 .sigil { animation: none !important; }
    }
  </style>

  <div class="hdr">
    <div class="brand"><span class="sigil" aria-hidden="true"></span>SUNLIT 728 • Paper Garden</div>
    <div class="chips" role="group" aria-label="Palette">
      <button class="chip" data-theme="dawn" aria-pressed="true">Dawn</button>
      <button class="chip" data-theme="meadow" aria-pressed="false">Meadow</button>
      <button class="chip" data-theme="citrus" aria-pressed="false">Citrus</button>
      <button class="chip" data-theme="noir" aria-pressed="false">Noir</button>
    </div>
    <h1 class="h1">Let light breathe.</h1>
    <p class="lede">A kinetic garden of glassy orbs drift on invisible orbits. Nudge the wind; watch threads of color bloom into quiet motion.</p>
  </div>

  <section class="stage" role="img" aria-label="Generative orbiting orbs arranged into a kinetic garden">
    <canvas id="garden"></canvas>
    <div class="hint">Move your cursor or touch to coax the bloom.</div>
    <div class="hud">
      <div class="pill">
        <label for="bloom">Bloom <span class="val" id="bloom-val">72</span></label>
        <input id="bloom" type="range" min="24" max="180" value="72" step="1" />
      </div>
      <button class="round" id="toggle" aria-pressed="true" title="Play/Pause">Pause</button>
      <button class="ghost" id="save" title="Save image">Save</button>
    </div>
  </section>

  <div class="ftr">
    <div class="legend">
      <span class="swatch" title="palette">
        <span class="dot" style="--col: var(--t1)" aria-hidden="true"></span>
        <span class="dot" style="--col: var(--t2)" aria-hidden="true"></span>
        <span class="dot" style="--col: var(--t3)" aria-hidden="true"></span>
      </span>
      <span>Orbital garden</span>
    </div>
    <span id="last-updated">Last updated: 2025-11-18 18:16:25 EST</span>
  </div>

  <script>
    (function(){
      const root = document.getElementById('sunlit728');
      const canvas = root.querySelector('#garden');
      const ctx = canvas.getContext('2d');
      const themeBtns = root.querySelectorAll('.chip');
      const bloomCtrl = root.querySelector('#bloom');
      const bloomVal = root.querySelector('#bloom-val');
      const toggleBtn = root.querySelector('#toggle');
      const saveBtn = root.querySelector('#save');
      const updated = root.querySelector('#last-updated');

      // Timestamp
      try {
        const fmt = new Intl.DateTimeFormat([], {
          year:'numeric', month:'2-digit', day:'2-digit',
          hour:'2-digit', minute:'2-digit', second:'2-digit',
          timeZoneName:'short'
        });
        const parts = Object.fromEntries(fmt.formatToParts(new Date()).map(p=>[p.type,p.value]));
        updated.textContent = `Last updated: ${parts.year}-${parts.month}-${parts.day} ${parts.hour}:${parts.minute}:${parts.second} ${parts.timeZoneName||''}`.trim();
      } catch {
        updated.textContent = `Last updated: ${new Date().toLocaleString()}`;
      }

      // Utilities
      function cssVar(name){ return getComputedStyle(root).getPropertyValue(name).trim(); }
      function hexToRgb(h) {
        const s = h.replace('#','').trim();
        const r = parseInt(s.slice(0,2),16), g = parseInt(s.slice(2,4),16), b = parseInt(s.slice(4,6),16);
        return [r,g,b];
      }
      function rgbStr([r,g,b], a=1){ return `rgba(${r|0},${g|0},${b|0},${a})`; }

      // Canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      let W = 0, H = 0, CX = 0, CY = 0;

      function size() {
        const rect = canvas.getBoundingClientRect();
        W = Math.max(320, Math.floor(rect.width));
        H = Math.max(280, Math.floor(rect.height));
        canvas.width = Math.floor(W * dpr);
        canvas.height = Math.floor(H * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        CX = W * 0.5; CY = H * 0.5;
        clear(true);
        resetOrbs(parseInt(bloomCtrl.value,10));
      }

      function clear(hard=false) {
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = hard ? 1 : 0.08;
        // Soften towards paper tone for trailing effect
        const paper = cssVar('--paper') || '#ffffff';
        ctx.fillStyle = paper;
        ctx.fillRect(0,0,W,H);
        ctx.globalAlpha = 1;
      }

      // Orbs
      let orbs = [];
      let t = 0;
      let playing = true;
      const pointer = { x: 0, y: 0, active: false };

      function palette() {
        return [cssVar('--t1'), cssVar('--t2'), cssVar('--t3')].map(hexToRgb);
      }

      function resetOrbs(n) {
        orbs = [];
        const cols = palette();
        for (let i=0;i<n;i++) {
          const rOrbit = Math.sqrt(Math.random()) * Math.min(W, H) * 0.44 + 18;
          const theta = Math.random() * Math.PI * 2;
          const speed = (0.0015 + Math.random() * 0.004) * (Math.random() < 0.5 ? -1 : 1);
          const size = 6 + Math.pow(Math.random(), 2) * 26;
          const ecc = Math.random() * 0.22;
          const hueShift = Math.random();
          const linkable = Math.random() > 0.75;
          orbs.push({ rOrbit, theta, speed, size, ecc, hueShift, linkable, cols });
        }
      }

      function lerp(a,b,k){ return a + (b-a)*k; }

      function colorAt(cols, u) {
        // Weighted triangle blend
        const [c1,c2,c3] = cols;
        const a = (Math.sin(u * Math.PI*2)*0.5 + 0.5);
        const b = (Math.cos(u * Math.PI*2)*0.5 + 0.5);
        return [
          lerp(lerp(c1[0], c2[0], a), c3[0], b*0.6),
          lerp(lerp(c1[1], c2[1], a), c3[1], b*0.6),
          lerp(lerp(c1[2], c2[2], a), c3[2], b*0.6)
        ];
      }

      function step() {
        if (!playing) return;

        clear(false);

        const cols = palette();
        const parallax = 0.08;
        const px = pointer.active ? (pointer.x - CX) * parallax : 0;
        const py = pointer.active ? (pointer.y - CY) * parallax : 0;

        // Draw links first with multiply for subtle threads
        ctx.globalCompositeOperation = 'multiply';
        for (let i=0;i<orbs.length;i++){
          const o = orbs[i];
          o.theta += o.speed;
          const a = o.theta;
          const rx = o.rOrbit * (1 + o.ecc*Math.cos(a*2));
          const x = CX + Math.cos(a)*rx + px*0.5;
          const y = CY + Math.sin(a)*rx*(1-o.ecc) + py*0.5;
          o.x = x; o.y = y;
        }
        ctx.lineWidth = 1.2;
        for (let i=0;i<orbs.length;i++){
          if (!orbs[i].linkable) continue;
          const j = (i + 7) % orbs.length;
          const dx = orbs[i].x - orbs[j].x;
          const dy = orbs[i].y - orbs[j].y;
          const d = Math.hypot(dx, dy);
          if (d < Math.min(W,H) * 0.25) {
            const u = (orbs[i].hueShift + t*0.00006) % 1;
            const c = colorAt(cols, u);
            ctx.strokeStyle = rgbStr(c, lerp(0.02, 0.12, 1 - d/(Math.min(W,H)*0.25)));
            ctx.beginPath(); ctx.moveTo(orbs[i].x, orbs[i].y); ctx.lineTo(orbs[j].x, orbs[j].y); ctx.stroke();
          }
        }

        // Draw orbs with screen for luminous blend
        ctx.globalCompositeOperation = 'screen';
        for (let i=0;i<orbs.length;i++){
          const o = orbs[i];
          const u = (o.hueShift + t*0.0001 + i*0.0003) % 1;
          const c = colorAt(o.cols, u);
          const grad = ctx.createRadialGradient(o.x, o.y, 0, o.x, o.y, o.size);
          grad.addColorStop(0, rgbStr(c, 0.35));
          grad.addColorStop(0.6, rgbStr(c, 0.12));
          grad.addColorStop(1, rgbStr(c, 0));
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(o.x, o.y, o.size, 0, Math.PI*2);
          ctx.fill();
        }

        ctx.globalCompositeOperation = 'source-over';
        t += 16.6667;
        requestAnimationFrame(step);
      }

      // Interactions
      function toLocal(e) {
        const r = canvas.getBoundingClientRect();
        const cx = (e.clientX ?? e.touches?.[0]?.clientX) - r.left;
        const cy = (e.clientY ?? e.touches?.[0]?.clientY) - r.top;
        return { x: cx, y: cy };
      }
      canvas.addEventListener('pointerdown', (e) => {
        const p = toLocal(e); pointer.x = p.x; pointer.y = p.y; pointer.active = true;
        canvas.setPointerCapture(e.pointerId || 0);
      });
      canvas.addEventListener('pointermove', (e) => {
        const p = toLocal(e); pointer.x = p.x; pointer.y = p.y; pointer.active = true;
        // parallax for the glow backdrop
        const mx = ((p.x / W) - 0.5);
        const my = ((p.y / H) - 0.5);
        root.style.setProperty('--mx', mx.toFixed(3));
        root.style.setProperty('--my', my.toFixed(3));
      });
      window.addEventListener('pointerup', () => { pointer.active = false; });

      // Theme switching
      themeBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const theme = btn.getAttribute('data-theme');
          root.setAttribute('data-theme', theme);
          themeBtns.forEach(b => b.setAttribute('aria-pressed', String(b === btn)));
          resetOrbs(parseInt(bloomCtrl.value,10));
          clear(true);
        });
      });

      // Bloom control
      function updateBloom() {
        bloomVal.textContent = `${parseInt(bloomCtrl.value,10)}`;
        resetOrbs(parseInt(bloomCtrl.value,10));
      }
      bloomCtrl.addEventListener('input', updateBloom);

      // Play/Pause
      function play() {
        if (playing) return;
        playing = true;
        toggleBtn.setAttribute('aria-pressed','true');
        toggleBtn.textContent = 'Pause';
        requestAnimationFrame(step);
      }
      function pause() {
        playing = false;
        toggleBtn.setAttribute('aria-pressed','false');
        toggleBtn.textContent = 'Play';
      }
      toggleBtn.addEventListener('click', () => playing ? pause() : play());

      // Save
      saveBtn.addEventListener('click', () => {
        try {
          const a = document.createElement('a');
          a.download = `sunlit-728-${Date.now()}.png`;
          a.href = canvas.toDataURL('image/png');
          a.click();
        } catch {}
      });

      // Init
      size();
      window.addEventListener('resize', size, { passive: true });
      updateBloom();

      // Reduced motion handling
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) {
        pause();
        clear(true);
        // Draw one still arrangement
        for (let i=0;i<orbs.length;i++){
          const o = orbs[i];
          o.theta += o.speed * (i%5);
        }
        // Render single frame
        (function renderStill(){
          const cols = palette();
          ctx.globalCompositeOperation = 'screen';
          for (let i=0;i<orbs.length;i++){
            const o = orbs[i];
            const a = o.theta;
            const rx = o.rOrbit * (1 + o.ecc*Math.cos(a*2));
            const x = CX + Math.cos(a)*rx;
            const y = CY + Math.sin(a)*rx*(1-o.ecc);
            const u = (o.hueShift + i*0.0007) % 1;
            const c = colorAt(cols, u);
            const grad = ctx.createRadialGradient(x, y, 0, x, y, o.size);
            grad.addColorStop(0, rgbStr(c, 0.35));
            grad.addColorStop(0.6, rgbStr(c, 0.12));
            grad.addColorStop(1, rgbStr(c, 0));
            ctx.fillStyle = grad;
            ctx.beginPath(); ctx.arc(x, y, o.size, 0, Math.PI*2); ctx.fill();
          }
          ctx.globalCompositeOperation = 'source-over';
        })();
      } else {
        play();
      }
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


