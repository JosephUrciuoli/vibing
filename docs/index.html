<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="vibe970" role="region" aria-label="Quiet Observatory">
  <style>
    .vibe970{
      --ink: #0e1220;
      --muted: color-mix(in oklab, var(--ink) 55%, transparent);
      --paper: #ffffff;
      --glass: color-mix(in oklab, var(--paper) 76%, transparent);
      --line: color-mix(in oklab, var(--ink) 14%, transparent);
      --acc1: hsl(210 95% 54%);
      --acc2: hsl(280 86% 62%);
      --halo: color-mix(in oklab, var(--acc2) 26%, transparent);

      position:relative;
      border-radius: 30px;
      padding: clamp(18px, 3.5vw, 36px);
      color: var(--ink);
      background:
        radial-gradient(1200px 800px at var(--mx,60%) var(--my,30%), color-mix(in oklab, var(--acc1) 12%, transparent), transparent 60%),
        conic-gradient(from 120deg at 80% 10%, color-mix(in oklab, var(--acc2) 10%, transparent), transparent 35%),
        linear-gradient(180deg, #f7fbff, #eef2f8 60%, #e9eef7);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.7),
        0 40px 110px rgba(17, 23, 40, .18);
      overflow:hidden;
      isolation:isolate;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
    }
    .vibe970[data-theme="night"]{
      --ink:#e9f0ff;
      --muted: color-mix(in oklab, var(--ink) 70%, transparent);
      --paper:#090f1a;
      --glass: color-mix(in oklab, #0c1426 82%, transparent);
      --line: color-mix(in oklab, #ffffff 16%, transparent);
      background:
        radial-gradient(1200px 800px at var(--mx,58%) var(--my,24%), color-mix(in oklab, var(--acc2) 16%, transparent), transparent 60%),
        conic-gradient(from -30deg at 15% 5%, color-mix(in oklab, var(--acc1) 12%, transparent), transparent 38%),
        linear-gradient(180deg, #0b1020, #0e1629 55%, #0c1324);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.04),
        0 50px 140px rgba(0,0,0,.65);
    }
    .vibe970::before{
      content:"";
      position:absolute; inset:-20%;
      background:
        radial-gradient(1400px 1200px at 20% 10%, color-mix(in oklab, var(--acc1) 10%, transparent), transparent 50%),
        radial-gradient(900px 900px at 90% 10%, color-mix(in oklab, var(--acc2) 10%, transparent), transparent 50%);
      opacity:.45;
      filter: blur(30px) saturate(120%);
      pointer-events:none; z-index:0;
    }
    .vibe970::after{
      content:"";
      position:absolute; inset:-1px;
      background:
        repeating-linear-gradient(90deg, var(--line) 0 1px, transparent 1px 48px),
        repeating-linear-gradient(0deg, var(--line) 0 1px, transparent 1px 48px);
      opacity:.35;
      mask: radial-gradient(150% 120% at 70% -10%, black, transparent 60%);
      pointer-events:none; z-index:1;
    }

    /* Top chrome */
    .vibe970 .chrome{
      position:relative; z-index:2;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; gap:12px;
    }
    .vibe970 .brand{
      display:inline-flex; align-items:center; gap:10px; color: var(--muted);
      font-weight:900; letter-spacing:.4px; text-transform:uppercase; font-size:12px;
    }
    .vibe970 .star{
      width:18px; height:18px; border-radius:8px; background: radial-gradient(circle at 35% 35%, var(--acc2), var(--acc1));
      box-shadow: 0 0 0 2px color-mix(in oklab, var(--acc1) 30%, transparent), 0 0 18px var(--halo);
    }
    .vibe970 .badge{
      justify-self:center;
      display:inline-flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px;
      border:1px solid var(--line); background: var(--glass); backdrop-filter: blur(10px) saturate(120%);
      font-size:12px; color: var(--muted); cursor: pointer; user-select:none;
      box-shadow: 0 6px 18px rgba(0,0,0,.06);
    }
    .vibe970 .controls{
      justify-self:end; display:flex; gap:8px; align-items:center;
      padding:6px; border-radius:999px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }
    .vibe970 .btn{
      appearance:none; border:0; cursor:pointer;
      padding:10px 12px; border-radius:12px; font-weight:800; letter-spacing:.3px; font-size:12px;
      color:#0b0f16; background: linear-gradient(135deg, var(--acc1), var(--acc2));
      box-shadow: 0 14px 30px color-mix(in oklab, var(--acc1) 26%, transparent);
      transition: transform .14s ease, filter .18s ease;
    }
    .vibe970[data-theme="night"] .btn{ color:#0b0f16; }
    .vibe970 .ghost{
      appearance:none; background:transparent; border:1px solid var(--line); color:var(--ink);
      padding:10px 12px; border-radius:12px; font-weight:800; font-size:12px; letter-spacing:.3px; cursor:pointer;
      transition: background .18s ease, transform .14s ease;
    }
    .vibe970 .btn:hover, .vibe970 .ghost:hover{ transform: translateY(-1px) scale(1.01); }

    /* Stage */
    .vibe970 .stage{
      position:relative; z-index:2;
      margin-top: clamp(14px, 4vw, 28px);
      border-radius: 24px; border:1px solid var(--line); overflow:hidden;
      min-height: clamp(420px, 56vw, 680px);
      background: linear-gradient(180deg, color-mix(in oklab, var(--paper) 86%, transparent), color-mix(in oklab, var(--paper) 68%, transparent));
      perspective: 800px;
    }
    .vibe970 .sky{
      position:absolute; inset:0; width:100%; height:100%; display:block; filter: saturate(115%) contrast(102%);
    }

    /* Hero card */
    .vibe970 .hero{
      position:relative; z-index:3; align-self:center; justify-self:center;
      max-width:min(840px, 92%); margin: clamp(16px, 4vw, 28px);
      border-radius: 22px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(14px) saturate(130%);
      box-shadow: 0 30px 70px rgba(0,0,0,.12);
      padding: clamp(16px, 4.5vw, 34px);
      transform-style: preserve-3d;
      will-change: transform;
    }
    .vibe970 h1{
      margin:0 0 8px 0;
      font-size: clamp(38px, 8.5vw, 108px);
      line-height:.9; letter-spacing:-.02em;
      background: linear-gradient(180deg, var(--ink), color-mix(in oklab, var(--ink) 70%, var(--acc2)));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-wrap: balance;
    }
    .vibe970 .lead{
      margin:6px 0 12px; color: var(--muted);
      font-size: clamp(14px, 2.1vw, 20px);
    }
    .vibe970 .cta{ display:flex; gap:10px; flex-wrap:wrap; }

    /* Dock */
    .vibe970 .dock{
      position:absolute; right: clamp(10px, 3vw, 24px); bottom: clamp(10px, 3vw, 24px);
      display:grid; gap:10px; z-index:3; justify-items:end;
    }
    .vibe970 .glass{
      display:flex; align-items:center; gap:10px; padding:10px; border-radius:16px;
      border:1px solid var(--line); background: var(--glass); backdrop-filter: blur(10px) saturate(120%);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }
    .vibe970 .range{ --track: color-mix(in oklab, var(--ink) 18%, transparent); --fill: linear-gradient(90deg, var(--acc1), var(--acc2)); }
    .vibe970 .range input{ -webkit-appearance:none; appearance:none; width: 200px; height: 28px; background: transparent; cursor: pointer; }
    .vibe970 .range input::-webkit-slider-runnable-track{ height:6px; border-radius:999px; background: var(--track); border:1px solid var(--line); }
    .vibe970 .range input::-moz-range-track{ height:6px; border-radius:999px; background: var(--track); border:1px solid var(--line); }
    .vibe970 .range input::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%; margin-top:-6px; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--acc1) 28%, transparent);
    }
    .vibe970 .range input::-moz-range-thumb{
      width:18px; height:18px; border-radius:50%; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--acc1) 28%, transparent);
    }
    .vibe970 .val{
      font-variant-numeric: tabular-nums; font-weight:800; font-size:12px; color:var(--muted);
      padding:4px 8px; border-radius:999px; border:1px solid var(--line);
      background: color-mix(in oklab, var(--paper) 70%, transparent);
    }

    .vibe970 .palettes{ display:flex; gap:8px; }
    .vibe970 .swatch{
      width:26px; height:26px; border-radius:8px; border:1px solid var(--line); cursor:pointer; position:relative;
      box-shadow: inset 0 4px 10px rgba(0,0,0,.08);
    }
    .vibe970 .swatch[aria-checked="true"]::after{
      content:""; position:absolute; inset:-3px; border-radius:10px;
      border: 2px solid color-mix(in oklab, var(--acc1) 42%, var(--acc2));
      box-shadow: 0 0 0 2px rgba(0,0,0,.04);
    }

    /* Vertical tapes */
    .vibe970 .tapes{ position:absolute; inset:0; pointer-events:none; z-index:2; }
    .vibe970 .tape{
      position:absolute; top:0; bottom:0; width: max(200px, 16vw);
      display:flex; flex-direction:column; gap:10px; padding:10px;
      border-radius: 14px; border:1px solid var(--line);
      background: color-mix(in oklab, var(--paper) 80%, transparent);
      filter: saturate(115%);
      overflow:hidden;
    }
    .vibe970 .tape.up{ left: clamp(10px, 3vw, 24px); }
    .vibe970 .tape.down{ right: clamp(10px, 3vw, 24px); }
    .vibe970 .tape .roll{
      display:flex; flex-direction:column; gap:10px;
      animation: scrollY 22s linear infinite;
      white-space:nowrap;
    }
    .vibe970 .tape.down .roll{ animation-direction: reverse; animation-duration: 28s; }
    @keyframes scrollY{ from{ transform: translateY(0);} to{ transform: translateY(-50%);} }
    .vibe970 .tag{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: linear-gradient(135deg, var(--acc1), var(--acc2)); color:#0b0f16; font-weight:900; font-size:12px;
      box-shadow: 0 10px 22px color-mix(in oklab, var(--acc1) 26%, transparent);
    }

    /* Footer */
    .vibe970 .foot{
      position:relative; z-index:2; margin-top: 14px;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; color:var(--muted); font-size:12px;
    }
    .vibe970 .foot .stamp{
      justify-self:center; display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius: 999px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(6px);
    }

    /* Motion states */
    .vibe970.alive .tape .roll{ animation-play-state: running; }
    .vibe970:not(.alive) .tape .roll{ animation-play-state: paused; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .vibe970 .tape .roll{ animation: none !important; }
    }

    /* Responsive */
    @media (max-width: 980px){
      .vibe970 .tape{ display:none; }
      .vibe970 .dock{ left: clamp(10px, 3vw, 24px); right: auto; }
      .vibe970 .hero{ max-width: 92%; }
    }
  </style>

  <div class="chrome">
    <div class="brand"><span class="star" aria-hidden="true"></span> Quiet Observatory</div>
    <div class="badge" role="button" tabindex="0" aria-pressed="false" title="Toggle day/night">Tap to switch theme</div>
    <div class="controls" aria-label="Master controls">
      <button class="btn play" aria-pressed="true" title="Play/Pause">Pause</button>
      <button class="ghost theme" title="Day/Night">Night</button>
    </div>
  </div>

  <div class="stage" aria-live="polite">
    <canvas class="sky" aria-hidden="true"></canvas>

    <div class="hero" aria-label="Statement card">
      <h1>Hold time, see rhythm</h1>
      <p class="lead">A calm instrument for watching motion behave. Color punctuates; type stays quiet.</p>
      <div class="cta">
        <button class="btn orbit">Let it orbit</button>
        <button class="ghost notes">Design notes</button>
      </div>
    </div>

    <div class="dock" aria-label="Observatory settings">
      <div class="glass range">
        <label for="orbits">Orbits</label>
        <input id="orbits" type="range" min="6" max="120" step="2" value="40" aria-valuemin="6" aria-valuemax="120" aria-valuenow="40" aria-label="Orbit count">
        <span class="val">40</span>
      </div>
      <div class="glass palettes" role="radiogroup" aria-label="Palette">
        <div class="swatch" role="radio" tabindex="0" aria-checked="true" data-p="tide" title="Tide" style="background:linear-gradient(135deg,hsl(210 95% 54%),hsl(280 86% 62%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="orchid" title="Orchid" style="background:linear-gradient(135deg,hsl(268 88% 66%),hsl(316 86% 64%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="ember" title="Ember" style="background:linear-gradient(135deg,hsl(24 92% 60%),hsl(340 80% 62%));"></div>
        <div class="swatch" role="radio" tabindex="-1" aria-checked="false" data-p="mint" title="Mint" style="background:linear-gradient(135deg,hsl(160 74% 48%),hsl(192 92% 46%));"></div>
      </div>
    </div>

    <div class="tapes" aria-hidden="true">
      <div class="tape up">
        <div class="roll">
          <span class="tag">Cadence</span>
          <span class="tag">Clarity</span>
          <span class="tag">Kindness</span>
          <span class="tag">Craft</span>
          <span class="tag">Curiosity</span>
          <span class="tag">Restraint</span>
          <span class="tag">Cadence</span>
          <span class="tag">Clarity</span>
          <span class="tag">Kindness</span>
          <span class="tag">Craft</span>
          <span class="tag">Curiosity</span>
          <span class="tag">Restraint</span>
        </div>
      </div>
      <div class="tape down">
        <div class="roll">
          <span class="tag">Readable first</span>
          <span class="tag">Manners in motion</span>
          <span class="tag">Color as punctuation</span>
          <span class="tag">Accessible contrast</span>
          <span class="tag">Tactile spacing</span>
          <span class="tag">Quiet physics</span>
          <span class="tag">Readable first</span>
          <span class="tag">Manners in motion</span>
          <span class="tag">Color as punctuation</span>
          <span class="tag">Accessible contrast</span>
          <span class="tag">Tactile spacing</span>
          <span class="tag">Quiet physics</span>
        </div>
      </div>
    </div>
  </div>

  <div class="foot">
    <div class="quote">“Simplicity is sophisticated attention.”</div>
    <div class="stamp">
      <span class="star" aria-hidden="true" style="width:10px;height:10px;box-shadow:none;"></span>
      <span id="last-updated">Last updated: 2025-11-30 00:17:46 EST</span>
    </div>
    <div class="hint">Tip: move the cursor—space toggles motion</div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.vibe970');
      const canvas = root.querySelector('.sky');
      const ctx = canvas.getContext('2d', { alpha: true });
      const playBtn = root.querySelector('.play');
      const themeBtn = root.querySelector('.theme');
      const badge = root.querySelector('.badge');
      const orbitBtn = root.querySelector('.orbit');
      const notesBtn = root.querySelector('.notes');
      const slider = root.querySelector('#orbits');
      const val = root.querySelector('.val');
      const swatches = [...root.querySelectorAll('.swatch')];
      const updated = root.querySelector('#last-updated');
      const hero = root.querySelector('.hero');
      const stage = root.querySelector('.stage');

      // timestamp
      function fmt(d){
        try{
          return new Intl.DateTimeFormat(undefined, { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:true }).format(d);
        }catch(e){ return d.toLocaleString(); }
      }
      updated.textContent = 'Last updated: ' + fmt(new Date());

      // palettes
      const palettes = {
        tide:   ['hsl(210 95% 54%)','hsl(280 86% 62%)'],
        orchid: ['hsl(268 88% 66%)','hsl(316 86% 64%)'],
        ember:  ['hsl(24 92% 60%)','hsl(340 80% 62%)'],
        mint:   ['hsl(160 74% 48%)','hsl(192 92% 46%)']
      };
      function setPalette(name){
        const [a,b] = palettes[name] || palettes.tide;
        root.style.setProperty('--acc1', a);
        root.style.setProperty('--acc2', b);
        swatches.forEach(s=>{
          const on = s.dataset.p === name;
          s.setAttribute('aria-checked', on?'true':'false');
          s.tabIndex = on? 0 : -1;
        });
      }
      swatches.forEach(s=>{
        s.addEventListener('click', ()=> setPalette(s.dataset.p));
        s.addEventListener('keydown', (e)=>{
          if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setPalette(s.dataset.p); }
          if(e.key==='ArrowRight'||e.key==='ArrowLeft'){
            const i = swatches.findIndex(x=>x.getAttribute('aria-checked')==='true');
            const dir = e.key==='ArrowRight'?1:-1;
            const next = (i+dir+swatches.length)%swatches.length;
            swatches[next].focus(); setPalette(swatches[next].dataset.p);
          }
        });
      });
      setPalette('tide');

      // theme
      let night = false;
      function applyTheme(){ root.setAttribute('data-theme', night? 'night':'day'); themeBtn.textContent = night? 'Day':'Night'; }
      const themeToggle = ()=>{ night=!night; applyTheme(); }
      themeBtn.addEventListener('click', themeToggle);
      badge.addEventListener('click', themeToggle);
      badge.addEventListener('keydown', e=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); themeToggle(); }});
      applyTheme();

      // motion state
      let running = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      function setRunning(on){
        running = on;
        root.classList.toggle('alive', on);
        playBtn.textContent = on? 'Pause':'Play';
        playBtn.setAttribute('aria-pressed', on? 'true':'false');
        if(on) raf();
      }
      playBtn.addEventListener('click', ()=> setRunning(!running));
      setRunning(running);

      // slider
      function updVal(n){ slider.setAttribute('aria-valuenow', n); val.textContent = n; rebuild(+n); }
      slider.addEventListener('input', ()=>updVal(slider.value));
      updVal(slider.value);

      // canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      function resize(){
        const r = canvas.getBoundingClientRect();
        canvas.width = Math.floor(r.width * dpr);
        canvas.height = Math.floor(r.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      const ro = new ResizeObserver(resize); ro.observe(canvas);
      resize();

      // pointer glow + parallax tilt
      const tilt = { rx: 0, ry: 0, tx: 0, ty: 0 };
      stage.addEventListener('pointermove', (e)=>{
        const rect = stage.getBoundingClientRect();
        const nx = (e.clientX - rect.left)/rect.width;   // 0..1
        const ny = (e.clientY - rect.top)/rect.height;   // 0..1
        root.style.setProperty('--mx', (nx*100).toFixed(1)+'%');
        root.style.setProperty('--my', (ny*100).toFixed(1)+'%');
        tilt.tx = (ny - 0.5) * -10; // rx
        tilt.ty = (nx - 0.5) * 12;  // ry
      }, {passive:true});
      stage.addEventListener('pointerleave', ()=>{ tilt.tx = 0; tilt.ty = 0; }, {passive:true});

      // System: orbits
      let bodies = [];
      const center = { x: 0.5, y: 0.5, tx: 0.5, ty: 0.5 };
      stage.addEventListener('pointermove', (e)=>{
        const rect = stage.getBoundingClientRect();
        center.tx = (e.clientX - rect.left)/rect.width;
        center.ty = (e.clientY - rect.top)/rect.height;
      }, {passive:true});
      stage.addEventListener('pointerleave', ()=>{ center.tx = 0.5; center.ty = 0.5; }, {passive:true});

      function rebuild(n){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        const maxR = Math.min(w, h) * 0.44;
        bodies = [];
        for(let i=0;i<n;i++){
          const r = (i/n) ** 0.7 * maxR * (0.3 + Math.random()*0.7);
          bodies.push({
            r,
            a: Math.random() * Math.PI*2,
            s: (0.2 + Math.random()*1.2) * (0.2 + r/maxR),
            j: Math.random()*Math.PI*2, // phase for wobble
            hue: i/n
          });
        }
      }

      // initial
      rebuild(+slider.value);

      // draw
      let t0 = performance.now();
      function draw(now){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        // gentle fade clear
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = `rgba(255,255,255,${root.dataset.theme==='night'?. 0.04: 0.08})`;
        if(root.dataset.theme==='night'){ ctx.fillStyle = 'rgba(10,16,28,0.08)'; }
        ctx.fillRect(0,0,w,h);

        // center drift + tilt
        center.x += (center.tx - center.x) * 0.06;
        center.y += (center.ty - center.y) * 0.06;
        tilt.rx += (tilt.tx - tilt.rx) * 0.08;
        tilt.ry += (tilt.ty - tilt.ry) * 0.08;
        hero.style.transform = `rotateX(${tilt.rx.toFixed(2)}deg) rotateY(${tilt.ry.toFixed(2)}deg) translateZ(30px)`;
        stage.style.setProperty('--tilt-x', tilt.rx.toFixed(2)+'deg');
        stage.style.setProperty('--tilt-y', tilt.ry.toFixed(2)+'deg');

        const cx = w * (0.24 + center.x*0.52);
        const cy = h * (0.24 + center.y*0.52);
        const time = (now - t0)/1000;

        // rings
        const ringCount = 6;
        const baseR = Math.min(w,h) * 0.12;
        for(let i=0;i<ringCount;i++){
          const rr = baseR + (i+1) * (Math.min(w,h)*0.055) * (1 + 0.03*Math.sin(time*0.8 + i));
          const grad = ctx.createRadialGradient(cx, cy, 0, cx, cy, rr);
          grad.addColorStop(0, getComputedStyle(root).getPropertyValue('--acc1').trim());
          grad.addColorStop(1, getComputedStyle(root).getPropertyValue('--acc2').trim());
          ctx.strokeStyle = grad;
          ctx.globalAlpha = 0.35 - i*0.04;
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.arc(cx, cy, rr, 0, Math.PI*2);
          ctx.stroke();
        }

        ctx.globalAlpha = 1;

        // orbiters
        const acc1 = getComputedStyle(root).getPropertyValue('--acc1').trim();
        const acc2 = getComputedStyle(root).getPropertyValue('--acc2').trim();

        bodies.forEach((b, i)=>{
          const wob = 0.14 * Math.sin(time*0.9 + b.j);
          const e = 0.25 + Math.hypot(center.x-0.5, center.y-0.5) * 0.9; // ellipticity
          const rx = b.r * (1 + wob);
          const ry = b.r * (1 - e*0.4);

          b.a += b.s * 0.006;
          const x = cx + Math.cos(b.a) * rx;
          const y = cy + Math.sin(b.a) * ry;

          // tail
          ctx.lineCap = 'round';
          const grad = ctx.createLinearGradient(cx, cy, x, y);
          grad.addColorStop(0, acc1);
          grad.addColorStop(1, acc2);
          ctx.strokeStyle = grad;
          ctx.lineWidth = 2;
          ctx.globalAlpha = 0.9;
          ctx.beginPath();
          ctx.moveTo(cx, cy);
          // curve toward pointer gently
          const ctrlX = (cx + x)/2 + (center.x-0.5)*80;
          const ctrlY = (cy + y)/2 + (center.y-0.5)*80;
          ctx.quadraticCurveTo(ctrlX, ctrlY, x, y);
          ctx.stroke();

          // node
          ctx.globalAlpha = 0.9;
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(x, y, 2.2 + 1.2*Math.sin(time*1.3 + i*0.7)**2, 0, Math.PI*2);
          ctx.fill();
        });

        // core glow
        const core = ctx.createRadialGradient(cx, cy, 0, cx, cy, Math.min(w,h)*0.22);
        core.addColorStop(0, 'rgba(255,255,255,.6)');
        core.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.globalAlpha = 0.9;
        ctx.fillStyle = core;
        ctx.beginPath();
        ctx.arc(cx, cy, Math.min(w,h)*0.26, 0, Math.PI*2);
        ctx.fill();
        ctx.globalAlpha = 1;
      }

      let af;
      function raf(){
        if(!running) return;
        af = requestAnimationFrame(function step(ts){
          if(!running) return;
          draw(ts);
          af = requestAnimationFrame(step);
        });
      }
      if(running) raf();

      // resize DPR
      window.addEventListener('resize', ()=>{
        const newDpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        if(newDpr !== dpr){ dpr = newDpr; }
        resize();
        rebuild(+slider.value);
      });

      // buttons
      orbitBtn.addEventListener('click', ()=>{
        // Rotate palette and randomize orbits
        const i = swatches.findIndex(x=>x.getAttribute('aria-checked')==='true');
        const next = swatches[(i+1)%swatches.length];
        next.click();
        const n = 8 + Math.floor(Math.random()*56)*2;
        slider.value = n; updVal(n);
      });
      notesBtn.addEventListener('click', ()=>{
        alert('Principles: readable first • motion with manners • color as punctuation • accessible contrast • cadence over chaos.');
      });

      // keyboard: space toggles play
      root.addEventListener('keydown', (e)=>{
        if(e.key===' ' && e.target === document.body){ e.preventDefault(); setRunning(!running); }
      });

      // initialize glow anchor
      root.style.setProperty('--mx','60%'); root.style.setProperty('--my','30%');
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


