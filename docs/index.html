<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section id="vibe2403" data-mode="sol" aria-label="Aurora Observatory">
  <style>
    /* Scoped to #vibe2403 only */
    #vibe2403 {
      --r: 22px;
      --fg: hsl(234 20% 14%);
      --muted: hsl(234 12% 40%);
      --line: hsl(234 15% 30% / 0.14);

      /* Palette — Sol (default) */
      --a1: hsl(18 92% 64%);
      --a2: hsl(44 94% 58%);
      --a3: hsl(188 76% 54%);
      --paper: hsl(40 55% 97%);

      position: relative;
      isolation: isolate;
      color: var(--fg);
      background:
        radial-gradient(1200px 800px at -20% -10%, hsl(44 80% 85% / 0.65), transparent 60%),
        radial-gradient(1000px 700px at 120% 120%, hsl(188 70% 80% / 0.55), transparent 60%),
        var(--paper);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: 0 24px 64px hsl(234 50% 10% / 0.12), inset 0 0 0 1px hsl(0 0% 100% / 0.6);
      padding: clamp(18px, 3.6vw, 46px);
      min-height: 72vh;
      font: 400 16px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      overflow: hidden;
      container-type: inline-size;
    }

    /* Luna (night) */
    #vibe2403[data-mode="luna"] {
      --fg: hsl(0 0% 96%);
      --muted: hsl(0 0% 78% / 0.85);
      --line: hsl(0 0% 100% / 0.14);
      --a1: hsl(266 86% 74%);
      --a2: hsl(205 92% 64%);
      --a3: hsl(340 86% 66%);
      --paper: hsl(243 23% 7%);
      background:
        radial-gradient(1100px 760px at -10% -20%, hsl(266 50% 30% / 0.55), transparent 60%),
        radial-gradient(900px 600px at 120% 120%, hsl(205 60% 30% / 0.5), transparent 60%),
        var(--paper);
      box-shadow: 0 30px 80px hsl(0 0% 0% / 0.48), inset 0 0 0 1px hsl(0 0% 100% / 0.08);
    }

    /* Flux (vivid) */
    #vibe2403[data-mode="flux"] {
      --a1: hsl(196 92% 52%);
      --a2: hsl(286 86% 64%);
      --a3: hsl(16 90% 62%);
      --paper: hsl(260 45% 96%);
    }

    /* Atmospheric veils */
    #vibe2403::before,
    #vibe2403::after {
      content: "";
      position: absolute;
      inset: -30%;
      pointer-events: none;
      z-index: 0;
      filter: blur(60px) saturate(130%);
      opacity: 0.7;
    }
    #vibe2403::before {
      background:
        conic-gradient(from 20deg at 30% 70%, var(--a1), transparent 60%),
        conic-gradient(from -70deg at 70% 25%, var(--a2), transparent 60%);
      animation: v2403-wash-a var(--veil, 26s) ease-in-out infinite alternate;
      mix-blend-mode: multiply;
    }
    #vibe2403::after {
      background:
        conic-gradient(from 110deg at 50% 45%, var(--a3), transparent 60%);
      animation: v2403-wash-b var(--veilb, 34s) ease-in-out infinite alternate-reverse;
      mix-blend-mode: screen;
    }
    #vibe2403[data-mode="luna"]::before,
    #vibe2403[data-mode="luna"]::after { mix-blend-mode: screen; opacity: 0.6; }

    /* Fine grain + grid */
    #vibe2403 .grain {
      position: absolute; inset: 0; z-index: 1; pointer-events: none;
      background:
        repeating-linear-gradient(0deg, hsl(0 0% 100% / 0.02) 0 1px, transparent 1px 40px),
        repeating-linear-gradient(90deg, hsl(0 0% 0% / 0.03) 0 1px, transparent 1px 40px);
      mask: radial-gradient(110% 95% at 50% 35%, black, transparent);
    }

    /* Header */
    #vibe2403 .top {
      position: relative; z-index: 3;
      display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 14px;
      margin-bottom: clamp(12px, 3vw, 28px);
    }
    #vibe2403 .brand {
      display: inline-flex; align-items: center; gap: 12px;
      padding: 10px 14px; border-radius: 999px;
      background: hsl(0 0% 100% / 0.72);
      border: 1px solid var(--line);
      backdrop-filter: blur(8px) saturate(140%);
      color: var(--fg); font-weight: 800; letter-spacing: 0.06em; text-transform: uppercase; font-size: 12px;
    }
    #vibe2403[data-mode="luna"] .brand { background: hsl(0 0% 10% / 0.48); }
    #vibe2403 .brand svg { width: 18px; height: 18px; display: block; }

    #vibe2403 .ctrls { display: inline-flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    #vibe2403 .seg {
      display: inline-flex; gap: 2px; padding: 4px; border-radius: 999px;
      background: hsl(0 0% 100% / 0.72); border: 1px solid var(--line); backdrop-filter: blur(8px) saturate(140%);
    }
    #vibe2403[data-mode="luna"] .seg { background: hsl(0 0% 10% / 0.48); }
    #vibe2403 .seg button {
      appearance: none; border: 0; background: transparent; color: var(--fg);
      padding: 8px 12px; border-radius: 999px; font-weight: 800; font-size: 12px; cursor: pointer;
      transition: background 0.2s ease, transform 0.2s ease, color 0.2s ease;
    }
    #vibe2403 .seg button[aria-pressed="true"] {
      background: linear-gradient(90deg, var(--a1), var(--a2));
      color: white; text-shadow: 0 1px 0 hsl(0 0% 0% / 0.25);
    }
    #vibe2403 .knob {
      display: inline-grid; grid-template-columns: auto 1fr; align-items: center; gap: 8px;
      padding: 8px 10px; border: 1px solid var(--line); border-radius: 12px;
      background: hsl(0 0% 100% / 0.72); font-size: 12px; color: var(--muted);
      backdrop-filter: blur(8px) saturate(140%);
    }
    #vibe2403[data-mode="luna"] .knob { background: hsl(0 0% 10% / 0.48); }
    #vibe2403 input[type="range"] {
      -webkit-appearance: none; appearance: none;
      width: 140px; height: 10px; border-radius: 999px;
      background: linear-gradient(90deg, var(--a1), var(--a2));
      border: 1px solid hsl(0 0% 100% / 0.35);
      box-shadow: inset 0 1px 0 hsl(0 0% 100% / 0.5), 0 2px 9px hsl(0 0% 0% / 0.2);
      outline: none; cursor: pointer;
    }
    #vibe2403 input[type="range"]::-webkit-slider-thumb,
    #vibe2403 input[type="range"]::-moz-range-thumb {
      -webkit-appearance: none; appearance: none;
      width: 18px; height: 18px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, hsl(0 0% 100%), hsl(0 0% 90%));
      border: 1px solid hsl(0 0% 100% / 0.65);
      box-shadow: 0 2px 8px hsl(0 0% 0% / 0.35), 0 0 0 6px color-mix(in oklab, var(--a3) 30%, transparent);
    }

    /* Observatory */
    #vibe2403 .observatory {
      --rx: 0deg; --ry: 0deg;
      position: relative; z-index: 2;
      width: min(1000px, 98cqi); aspect-ratio: 16 / 9;
      border-radius: calc(var(--r) + 8px);
      border: 1px solid var(--line);
      overflow: hidden;
      background: linear-gradient(180deg, hsl(0 0% 100% / 0.85), hsl(0 0% 100% / 0.62)) padding-box;
      backdrop-filter: blur(20px) saturate(140%);
      box-shadow: 0 28px 84px hsl(234 50% 10% / 0.18), inset 0 0 0 1px hsl(0 0% 100% / 0.6);
      transform: perspective(1000px) rotateX(var(--rx)) rotateY(var(--ry));
      display: grid; place-items: center;
    }
    #vibe2403[data-mode="luna"] .observatory {
      background: linear-gradient(180deg, hsl(0 0% 14% / 0.7), hsl(0 0% 0% / 0.35));
      box-shadow: 0 26px 78px hsl(0 0% 0% / 0.52), inset 0 0 0 1px hsl(0 0% 100% / 0.12);
    }
    #vibe2403 .sky { position: absolute; inset: 0; width: 100%; height: 100%; display: block; mix-blend-mode: plus-lighter; }
    #vibe2403[data-mode="luna"] .sky { mix-blend-mode: screen; }

    #vibe2403 .overlay {
      position: relative; z-index: 1; text-align: center; padding: clamp(10px, 5vw, 40px);
      display: grid; gap: 10px; place-items: center;
    }
    #vibe2403 .t {
      margin: 0;
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      font-size: clamp(34px, 9cqi, 96px);
      line-height: 0.98; letter-spacing: -0.02em; font-weight: 900;
      background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 1px 0 hsl(0 0% 100% / 0.28);
    }
    #vibe2403[data-mode="luna"] .t { text-shadow: 0 1px 0 hsl(0 0% 0% / 0.42); }
    #vibe2403 .s { margin: 0; font-size: clamp(13px, 2.6cqi, 22px); color: var(--muted); text-wrap: pretty; }

    /* Beads */
    #vibe2403 .beads {
      list-style: none; padding: 0; margin: clamp(10px, 3.4vw, 24px) 0 0;
      display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;
    }
    #vibe2403 .bead {
      display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px;
      border-radius: 999px; border: 1px solid var(--line);
      background: hsl(0 0% 100% / 0.72); color: var(--fg);
      font-weight: 700; font-size: 12px; transition: transform 0.2s ease, background 0.2s ease;
    }
    #vibe2403[data-mode="luna"] .bead { background: hsl(0 0% 12% / 0.5); }
    #vibe2403 .bead::before {
      content: ""; width: 8px; height: 8px; border-radius: 50%;
      background: radial-gradient(circle at 40% 40%, var(--a1), var(--a2));
      box-shadow: 0 0 10px color-mix(in oklab, var(--a2) 70%, transparent);
    }
    #vibe2403 .bead:hover { transform: translateY(-1px) scale(1.02); background: hsl(0 0% 100% / 0.9); }

    /* Panels */
    #vibe2403 .panes {
      position: relative; z-index: 2;
      display: grid; grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: clamp(12px, 2.6vw, 22px);
      width: min(1000px, 98cqi);
    }
    @container (max-width: 780px) { #vibe2403 .panes { grid-template-columns: 1fr; } }
    #vibe2403 .pane {
      --crx: 0deg; --cry: 0deg;
      position: relative; overflow: hidden;
      border-radius: calc(var(--r) - 6px);
      border: 1px solid var(--line);
      background: linear-gradient(180deg, hsl(0 0% 100% / 0.8), hsl(0 0% 100% / 0.62));
      padding: 16px; min-height: 120px; display: grid; align-content: space-between;
      box-shadow: 0 12px 30px hsl(0 0% 0% / 0.1), inset 0 0 0 1px hsl(0 0% 100% / 0.55);
      transform: perspective(600px) rotateX(var(--crx)) rotateY(var(--cry));
      transition: transform 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
    }
    #vibe2403[data-mode="luna"] .pane { background: linear-gradient(180deg, hsl(0 0% 12% / 0.7), hsl(0 0% 0% / 0.32)); }
    #vibe2403 .pane h3 { margin: 0 0 8px; font-size: 16px; letter-spacing: 0.02em; }
    #vibe2403 .pane p { margin: 0; font-size: 13px; color: var(--muted); }
    #vibe2403 .spray {
      position: absolute; inset: -30% -10% auto auto; height: 140%;
      background: conic-gradient(from 70deg, var(--a1), var(--a2), var(--a3), transparent 70%);
      filter: blur(30px) saturate(130%); opacity: 0.35; mix-blend-mode: plus-lighter; pointer-events: none;
      transform: translateZ(0);
    }
    #vibe2403 .pane:hover { box-shadow: 0 18px 40px color-mix(in oklab, var(--a3) 28%, hsl(0 0% 0% / 0.28)); }

    /* Footer */
    #vibe2403 .foot {
      position: relative; z-index: 2; display: grid; place-items: center; text-align: center;
      margin-top: clamp(16px, 4vw, 36px); gap: 10px; color: var(--muted);
    }
    #vibe2403 .foot small {
      font-size: 12px; letter-spacing: 0.06em; text-transform: uppercase;
      border: 1px solid var(--line); padding: 8px 12px; border-radius: 10px; background: hsl(0 0% 100% / 0.64);
    }
    #vibe2403[data-mode="luna"] .foot small { background: hsl(0 0% 12% / 0.5); }

    /* Keyframes */
    @keyframes v2403-wash-a {
      0% { transform: translate3d(-1%, -2%, 0) rotate(0deg) scale(1); }
      50% { transform: translate3d(1%, 2%, 0) rotate(14deg) scale(1.06); }
      100% { transform: translate3d(-2%, 2%, 0) rotate(22deg) scale(1.01); }
    }
    @keyframes v2403-wash-b {
      0% { transform: translate3d(2%, 1%, 0) rotate(0deg) scale(1.02); }
      50% { transform: translate3d(-2%, -1%, 0) rotate(-10deg) scale(1.09); }
      100% { transform: translate3d(1%, -2%, 0) rotate(-22deg) scale(1.02); }
    }

    /* Reduced motion */
    #vibe2403.reduce-motion::before,
    #vibe2403.reduce-motion::after { animation: none !important; }
    #vibe2403.reduce-motion .sky { opacity: 0.7; }
  </style>

  <div class="grain" aria-hidden="true"></div>

  <div class="top">
    <div class="brand" aria-label="Aurora Observatory">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <defs>
          <linearGradient id="v2403-g" x1="0" x2="1" y1="0" y2="1">
            <stop offset="0" stop-color="currentColor" stop-opacity="0.6"/>
            <stop offset="1" stop-color="currentColor"/>
          </linearGradient>
        </defs>
        <path d="M12 3v18M3 12h18M5 5l14 14M19 5L5 19" stroke="url(#v2403-g)" stroke-width="1.5" stroke-linecap="round" fill="none"/>
        <circle cx="12" cy="12" r="2" fill="currentColor"/>
      </svg>
      <span>Harmonic Atlas</span>
    </div>

    <div class="ctrls" role="group" aria-label="Appearance and motion controls">
      <div class="seg" role="tablist" aria-label="Modes">
        <button class="mode" data-mode="sol" aria-pressed="true" role="tab">Sol</button>
        <button class="mode" data-mode="luna" aria-pressed="false" role="tab">Luna</button>
        <button class="mode" data-mode="flux" aria-pressed="false" role="tab">Flux</button>
      </div>

      <label class="knob" for="tempo">
        Tempo
        <input id="tempo" type="range" min="0.3" max="2.5" step="0.1" value="1.0" aria-label="Adjust animation speed">
      </label>

      <label class="knob" for="bodies">
        Bodies
        <input id="bodies" type="range" min="40" max="220" step="10" value="120" aria-label="Adjust particle count">
      </label>

      <label class="knob" for="bloom">
        Bloom
        <input id="bloom" type="range" min="0.2" max="1.6" step="0.1" value="0.9" aria-label="Adjust glow intensity">
      </label>
    </div>
  </div>

  <div class="observatory" tabindex="0" aria-label="Interactive orbital sketch">
    <canvas class="sky" aria-hidden="true"></canvas>
    <div class="overlay" aria-hidden="true">
      <h1 class="t">Orbital Poetry</h1>
      <p class="s">Motion that murmurs. Color that carries.</p>
    </div>
  </div>

  <ul class="beads" aria-label="Principles">
    <li class="bead">Sense</li>
    <li class="bead">Shape</li>
    <li class="bead">Sustain</li>
    <li class="bead">Savor</li>
  </ul>

  <div class="panes" aria-label="Notes">
    <article class="pane" tabindex="0" aria-label="Pane — Silence">
      <div class="spray" aria-hidden="true"></div>
      <h3>Silence</h3>
      <p>Let the interface rest between gestures so intent can surface.</p>
    </article>
    <article class="pane" tabindex="0" aria-label="Pane — Gravity">
      <div class="spray" aria-hidden="true"></div>
      <h3>Gravity</h3>
      <p>Weight invites care. Use mass and easing to honor attention.</p>
    </article>
    <article class="pane" tabindex="0" aria-label="Pane — Wit">
      <div class="spray" aria-hidden="true"></div>
      <h3>Wit</h3>
      <p>Offer small bright moments—discovered, not declared.</p>
    </article>
  </div>

  <div class="foot">
    <small>Steady hands. Gentle gradients. Brave reductions.</small>
    <span id="last-updated">Last updated: 2026-02-05 03:40:01 EST</span>
  </div>

  <script>
    (function () {
      const root = document.getElementById('vibe2403');
      const sky = root.querySelector('.sky');
      const obs = root.querySelector('.observatory');
      const modes = Array.from(root.querySelectorAll('.mode'));
      const tempo = root.querySelector('#tempo');
      const bodies = root.querySelector('#bodies');
      const bloom = root.querySelector('#bloom');
      const panes = Array.from(root.querySelectorAll('.pane'));
      const stamp = root.querySelector('#last-updated');

      // Stamp
      try {
        const now = new Date();
        const fmt = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'medium' });
        stamp.textContent = 'Last updated: ' + fmt.format(now);
      } catch {
        stamp.textContent = 'Last updated: just now';
      }

      // Reduced motion
      const prefersReduce = matchMedia && matchMedia('(prefers-reduced-motion: reduce)');
      const applyReduce = on => root.classList.toggle('reduce-motion', !!on);
      if (prefersReduce) {
        applyReduce(prefersReduce.matches);
        prefersReduce.addEventListener('change', e => applyReduce(e.matches));
      }

      // Theme
      const applyMode = (m) => {
        root.setAttribute('data-mode', m);
        modes.forEach(b => b.setAttribute('aria-pressed', b.dataset.mode === m ? 'true' : 'false'));
        readPalette();
        resize();
        start();
      };
      modes.forEach(btn => btn.addEventListener('click', () => applyMode(btn.dataset.mode)));

      // Tilt
      const tilt = (el, x, y) => {
        const r = el.getBoundingClientRect();
        const mx = (x - r.left) / r.width;
        const my = (y - r.top) / r.height;
        el.style.setProperty('--rx', ((0.5 - my) * 8).toFixed(2) + 'deg');
        el.style.setProperty('--ry', ((mx - 0.5) * 10).toFixed(2) + 'deg');
      };
      root.addEventListener('pointermove', (e) => tilt(obs, e.clientX, e.clientY));
      root.addEventListener('pointerleave', () => { obs.style.setProperty('--rx', '0deg'); obs.style.setProperty('--ry', '0deg'); });
      obs.addEventListener('focus', () => { obs.style.setProperty('--rx', '-2deg'); obs.style.setProperty('--ry', '2deg'); });
      obs.addEventListener('blur', () => { obs.style.setProperty('--rx', '0deg'); obs.style.setProperty('--ry', '0deg'); });

      // Pane micro tilt
      const micro = (pane, e) => {
        const r = pane.getBoundingClientRect();
        const mx = (e.clientX - r.left) / r.width;
        const my = (e.clientY - r.top) / r.height;
        pane.style.setProperty('--crx', ((0.5 - my) * 6).toFixed(2) + 'deg');
        pane.style.setProperty('--cry', ((mx - 0.5) * 8).toFixed(2) + 'deg');
      };
      panes.forEach(p => {
        p.addEventListener('pointermove', (e) => micro(p, e));
        p.addEventListener('pointerleave', () => { p.style.setProperty('--crx', '0deg'); p.style.setProperty('--cry', '0deg'); });
        p.addEventListener('focus', () => { p.style.setProperty('--crx', '-2deg'); p.style.setProperty('--cry', '2deg'); });
        p.addEventListener('blur', () => { p.style.setProperty('--crx', '0deg'); p.style.setProperty('--cry', '0deg'); });
      });

      // Canvas orbital system
      const ctx = sky.getContext('2d', { alpha: true });
      const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      let raf, W = 0, H = 0;
      const state = {
        t: 0,
        tempo: parseFloat(tempo.value),
        count: parseInt(bodies.value, 10),
        bloom: parseFloat(bloom.value),
      };
      const palette = { a1: '#fff', a2: '#fff', a3: '#fff', fg: '#000' };

      const readPalette = () => {
        const s = getComputedStyle(root);
        palette.a1 = s.getPropertyValue('--a1').trim();
        palette.a2 = s.getPropertyValue('--a2').trim();
        palette.a3 = s.getPropertyValue('--a3').trim();
        palette.fg = s.getPropertyValue('--fg').trim();
      };

      const resize = () => {
        const r = obs.getBoundingClientRect();
        W = Math.floor(r.width);
        H = Math.floor(r.height);
        sky.width = Math.floor(W * DPR);
        sky.height = Math.floor(H * DPR);
        sky.style.width = W + 'px';
        sky.style.height = H + 'px';
        ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
      };

      // Golden-angle phyllotaxis orbit seeds
      const seeds = [];
      const regenerate = () => {
        seeds.length = 0;
        const n = state.count;
        const phi = Math.PI * (3 - Math.sqrt(5));
        const radius = Math.min(W, H) * 0.46;
        for (let i = 0; i < n; i++) {
          const r = Math.sqrt(i / n) * radius;
          const ang = i * phi;
          const wobble = 0.4 + 0.6 * (i / n);
          seeds.push({ baseR: r, baseA: ang, wobble, hue: i / n });
        }
      };

      const gradient = () => {
        const g = ctx.createLinearGradient(0, 0, W, H);
        g.addColorStop(0, palette.a1);
        g.addColorStop(0.5, palette.a2);
        g.addColorStop(1, palette.a3);
        return g;
      };

      const drawStatic = () => {
        ctx.clearRect(0, 0, W, H);
        const g = gradient();
        ctx.save();
        ctx.globalAlpha = 0.9;
        ctx.strokeStyle = g;
        for (let r = Math.min(W, H) * 0.1; r < Math.min(W, H) * 0.48; r += 16) {
          ctx.beginPath();
          ctx.arc(W / 2, H / 2, r, 0, Math.PI * 2);
          ctx.globalAlpha = 0.04 + 0.25 * Math.pow(1 - r / (Math.min(W, H) * 0.48), 1.6);
          ctx.lineWidth = 1 + (r % 32 === 0 ? 0.6 : 0.2);
          ctx.stroke();
        }
        ctx.restore();
      };

      const draw = (t) => {
        if (root.classList.contains('reduce-motion')) {
          drawStatic();
          return;
        }

        state.t = t * 0.001 * state.tempo;
        ctx.clearRect(0, 0, W, H);

        // Trails glow
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';
        const g = gradient();

        // Orbits
        const cx = W / 2, cy = H / 2;
        const n = seeds.length;
        for (let i = 0; i < n; i++) {
          const s = seeds[i];
          const a = s.baseA + state.t * (0.6 + s.wobble * 0.9);
          const r = s.baseR * (0.92 + 0.08 * Math.sin(state.t * 0.9 + i * 0.07));
          const x = cx + Math.cos(a) * r;
          const y = cy + Math.sin(a * 1.03) * r * (0.86 + 0.12 * Math.sin(i));

          // trail segment
          const prevA = a - 0.12;
          const px = cx + Math.cos(prevA) * r;
          const py = cy + Math.sin(prevA * 1.03) * r * (0.86 + 0.12 * Math.sin(i));

          ctx.beginPath();
          ctx.moveTo(px, py);
          ctx.lineTo(x, y);
          ctx.strokeStyle = g;
          ctx.globalAlpha = 0.10 + 0.65 * state.bloom * Math.pow(1 - s.baseR / (Math.min(W, H) * 0.46), 1.3);
          ctx.lineWidth = 0.8 + 1.4 * Math.sin(i * 0.23 + state.t);
          ctx.stroke();

          // node
          if ((i % 12) === 0) {
            ctx.beginPath();
            ctx.arc(x, y, 1.4 + 1.2 * state.bloom, 0, Math.PI * 2);
            ctx.fillStyle = g;
            ctx.globalAlpha = 0.35;
            ctx.fill();
          }
        }
        ctx.restore();

        raf = requestAnimationFrame(draw);
      };

      const start = () => {
        cancelAnimationFrame(raf);
        draw(performance.now());
      };

      tempo.addEventListener('input', e => { state.tempo = parseFloat(e.target.value); });
      bodies.addEventListener('input', e => {
        state.count = parseInt(e.target.value, 10);
        regenerate();
      });
      bloom.addEventListener('input', e => { state.bloom = parseFloat(e.target.value); });

      const ro = new ResizeObserver(() => { resize(); regenerate(); start(); });
      ro.observe(obs);

      readPalette();
      resize();
      regenerate();
      start();

      // Cleanup if removed
      root.addEventListener('DOMNodeRemoved', () => { cancelAnimationFrame(raf); ro.disconnect(); });

    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


