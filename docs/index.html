<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="vibe1171" class="observatory theme-nocturne" role="region" aria-label="Kinetic Observatory · Build 1171">
  <style>
    /* KINETIC OBSERVATORY — Build 1171 */
    #vibe1171 {
      --ink: hsl(0 0% 98%);
      --muted: hsl(220 14% 72%);
      --edge: hsl(230 20% 50% / .25);
      --glass: hsl(0 0% 100% / .08);
      --bg0: hsl(242 33% 6%);
      --bg1: hsl(246 26% 12%);
      --accentA: hsl(192 92% 56%);
      --accentB: hsl(306 88% 62%);
      --accentC: hsl(48 92% 58%);
      --radius: 26px;
      --tilt: 10deg;
      --spd: 1;
      position: relative;
      border-radius: var(--radius);
      padding: clamp(22px, 4.8vw, 58px);
      font: 600 16px/1.55 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "SF Pro Display", "Helvetica Neue", Arial, ui-rounded, "SF Pro Rounded";
      color: var(--ink);
      background:
        radial-gradient(1200px 900px at 20% -10%, color-mix(in oklab, var(--accentA) 24%, transparent), #0000 60%),
        radial-gradient(1100px 800px at 120% 110%, color-mix(in oklab, var(--accentB) 20%, transparent), #0000 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      box-shadow: 0 56px 140px hsl(240 80% 4% / .6), inset 0 1px 0 hsl(0 0% 100% / .06);
      overflow: clip;
      isolation: isolate;
    }
    #vibe1171 * { box-sizing: border-box; }

    /* Daybreak / Flora themes */
    #vibe1171.theme-daybreak {
      --ink: hsl(230 15% 12%);
      --muted: hsl(230 12% 40%);
      --edge: hsl(220 20% 40% / .22);
      --glass: hsl(0 0% 100% / .65);
      --bg0: hsl(208 96% 98%);
      --bg1: hsl(208 70% 93%);
      --accentA: hsl(202 92% 52%);
      --accentB: hsl(326 90% 56%);
      --accentC: hsl(38 96% 56%);
      box-shadow: 0 48px 120px hsl(220 60% 10% / .18), inset 0 1px 0 hsl(0 0% 100% / .85);
    }
    #vibe1171.theme-flora {
      --ink: hsl(322 16% 12%);
      --muted: hsl(320 14% 36%);
      --edge: hsl(320 30% 50% / .25);
      --glass: hsl(0 0% 100% / .7);
      --bg0: hsl(326 92% 98%);
      --bg1: hsl(322 72% 93%);
      --accentA: hsl(344 90% 58%);
      --accentB: hsl(264 85% 58%);
      --accentC: hsl(40 92% 58%);
    }

    /* Ambient halo + grain */
    #vibe1171::before {
      content: "";
      position: absolute; inset: -20% -20%;
      background:
        conic-gradient(from 60deg at 40% 20%,
          color-mix(in oklab, var(--accentA) 22%, transparent) 0 28%,
          transparent 28% 52%,
          color-mix(in oklab, var(--accentB) 18%, transparent) 52% 78%,
          transparent 78% 86%,
          color-mix(in oklab, var(--accentC) 18%, transparent) 86% 100%);
      filter: blur(120px) saturate(120%);
      opacity: .55;
      mix-blend-mode: screen;
      animation: v1171-slowspin calc(90s / var(--spd)) linear infinite;
      pointer-events: none;
      z-index: 0;
    }
    #vibe1171::after {
      content: "";
      position: absolute; inset: 0;
      background:
        radial-gradient(1px 1px at 14% 22%, hsl(0 0% 100% / .07) 0 1px, transparent 1px),
        radial-gradient(1px 1px at 82% 68%, hsl(0 0% 100% / .06) 0 1px, transparent 1px),
        radial-gradient(1px 1px at 42% 84%, hsl(0 0% 100% / .06) 0 1px, transparent 1px);
      background-size: 1200px 1200px, 900px 900px, 700px 700px;
      mix-blend-mode: overlay; opacity: .12; pointer-events: none; z-index: 1;
    }
    #vibe1171.theme-daybreak::after { opacity: .10; mix-blend-mode: multiply; }

    /* Masthead */
    #vibe1171 .mast {
      position: relative; z-index: 2;
      display: grid; grid-template-columns: 1fr auto; gap: 16px; align-items: end;
    }
    #vibe1171 .brand {
      display: grid; grid-template-columns: auto 1fr; gap: 14px; align-items: center;
    }
    #vibe1171 .orb {
      width: 48px; height: 48px; border-radius: 14px;
      background:
        radial-gradient(60% 60% at 30% 30%, hsl(0 0% 100% / .9), hsl(0 0% 100% / .2) 40%, transparent 60%),
        conic-gradient(from 0deg, var(--accentA), var(--accentB), var(--accentC), var(--accentA));
      box-shadow: inset 0 1px 0 hsl(0 0% 100% / .5), 0 14px 36px hsl(230 40% 6% / .36);
      position: relative; overflow: hidden;
    }
    #vibe1171 .orb::after {
      content:""; position:absolute; inset:-8px; border-radius:18px;
      border:2px dashed color-mix(in oklab, var(--accentA) 60%, white);
      opacity:.7; animation:v1171-slowspin calc(12s/var(--spd)) linear infinite;
    }
    #vibe1171 .title {
      margin: 0;
      letter-spacing: -0.03em;
      font-size: clamp(40px, 9.5vw, 108px);
      line-height: .88; font-weight: 900;
      background: linear-gradient(100deg, var(--ink), var(--accentA), var(--accentB), var(--accentC));
      background-size: 220% 100%;
      -webkit-background-clip: text; background-clip: text; color: transparent;
      animation: v1171-shimmer calc(16s / var(--spd)) ease-in-out infinite;
      filter: drop-shadow(0 18px 46px hsl(0 0% 0% / .16));
    }
    #vibe1171 .lede {
      margin-top: 6px; color: var(--muted); font-weight: 600; max-width: 70ch;
      font-size: clamp(13px, 2.1vw, 18px);
    }
    #vibe1171 .themechips {
      display: flex; gap: 10px; flex-wrap: wrap; justify-content: end; align-items: center;
    }
    #vibe1171 .chip {
      width: 38px; height: 38px; border-radius: 12px; border: 1px solid var(--edge);
      background: linear-gradient(180deg, var(--glass), hsl(0 0% 100% / .06));
      color: var(--ink); font-weight: 900; font-size: 10px; letter-spacing: .06em;
      display: grid; place-items: center; cursor: pointer;
      box-shadow: 0 18px 40px hsl(230 30% 10% / .3), inset 0 1px 0 hsl(0 0% 100% / .15);
      transition: transform .12s ease, filter .2s ease, outline-color .2s ease, background .2s ease;
    }
    #vibe1171.theme-daybreak .chip { background: linear-gradient(180deg, hsl(0 0% 100% / .7), hsl(0 0% 100% / .55)); }
    #vibe1171 .chip:hover { transform: translateY(-1px) scale(1.03); filter: saturate(1.06); }
    #vibe1171 .chip[data-active] { outline: 2px solid var(--accentA); outline-offset: 2px; }

    /* Stage */
    #vibe1171 .stage {
      position: relative; z-index: 2;
      margin-top: clamp(14px, 4.6vh, 32px);
      height: clamp(420px, 60vh, 820px);
      border-radius: 22px; border: 1px solid var(--edge);
      background: linear-gradient(180deg, var(--glass), hsl(0 0% 100% / .06));
      -webkit-backdrop-filter: blur(10px) saturate(150%);
      backdrop-filter: blur(10px) saturate(150%);
      box-shadow: 0 28px 90px hsl(230 40% 6% / .40), inset 0 1px 0 hsl(0 0% 100% / .06);
      transform-style: preserve-3d;
      transform: perspective(900px) rotateX(calc((var(--ty, .5) - .5) * var(--tilt))) rotateY(calc((.5 - var(--tx, .5)) * var(--tilt)));
      transition: transform .25s ease;
      overflow: hidden;
    }
    #vibe1171 .sky { position: absolute; inset: 0; width: 100%; height: 100%; display: block; }
    #vibe1171 .halo {
      position: absolute; inset: -20% -10%;
      background: radial-gradient(600px 400px at 60% 40%, color-mix(in oklab, var(--accentA) 25%, transparent), transparent 60%),
                  radial-gradient(500px 350px at 40% 70%, color-mix(in oklab, var(--accentB) 20%, transparent), transparent 60%);
      filter: blur(60px) saturate(120%); opacity: .55; mix-blend-mode: screen; pointer-events: none;
      animation: v1171-slowspin calc(80s / var(--spd)) linear infinite;
    }

    /* Glass panel */
    #vibe1171 .panel {
      position: absolute; right: clamp(10px, 3%, 18px); bottom: clamp(10px, 3%, 18px);
      padding: 12px 14px;
      border-radius: 16px; border: 1px solid var(--edge);
      background: linear-gradient(180deg, var(--glass), hsl(0 0% 100% / .08));
      -webkit-backdrop-filter: blur(10px) saturate(150%); backdrop-filter: blur(10px) saturate(150%);
      color: var(--ink); max-width: min(520px, 84%);
      box-shadow: 0 18px 46px hsl(230 30% 10% / .36), inset 0 1px 0 hsl(0 0% 100% / .08);
    }
    #vibe1171 .panel h2 {
      margin: 0 0 6px; font-size: clamp(16px, 2.2vw, 20px);
      background: linear-gradient(90deg, var(--ink), color-mix(in oklab, var(--accentA) 50%, var(--ink)));
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }
    #vibe1171 .panel p { margin: 0 0 10px; color: var(--muted); font-size: 13px; }

    /* Dock */
    #vibe1171 .dock {
      position: relative; z-index: 2;
      margin-top: clamp(18px, 6vh, 32px);
      display: grid; gap: 12px;
      grid-template-columns: 1fr auto; align-items: center;
      color: var(--muted); font-size: 12px;
    }
    #vibe1171 .controls { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; justify-content: end; }

    /* Inputs */
    #vibe1171 .btn, #vibe1171 .pill, #vibe1171 .range {
      appearance: none; border-radius: 12px; cursor: pointer; border: 1px solid var(--edge);
      background: linear-gradient(180deg, var(--glass), hsl(0 0% 100% / .08));
      color: var(--ink); padding: 9px 12px; font-weight: 900; letter-spacing: .02em;
      box-shadow: 0 12px 28px hsl(230 30% 10% / .26), inset 0 1px 0 hsl(0 0% 100% / .08);
      transition: transform .12s ease, filter .2s ease, color .2s ease, background .2s ease, box-shadow .2s ease;
    }
    #vibe1171.theme-daybreak .btn, #vibe1171.theme-daybreak .pill, #vibe1171.theme-daybreak .range {
      background: linear-gradient(180deg, hsl(0 0% 100% / .7), hsl(0 0% 100% / .55));
      box-shadow: 0 12px 28px hsl(220 30% 20% / .16), inset 0 1px 0 hsl(0 0% 100% / .85);
    }
    #vibe1171 .pill { border-radius: 999px; }
    #vibe1171 .btn:hover, #vibe1171 .pill:hover { transform: translateY(-1px) scale(1.02); filter: saturate(1.08); }

    #vibe1171 .range { display: inline-flex; align-items: center; gap: 10px; cursor: default; }
    #vibe1171 .range label { font-weight: 800; font-size: 12px; color: var(--muted); letter-spacing: .02em; }
    #vibe1171 input[type="range"] {
      -webkit-appearance: none; appearance: none; width: 160px; height: 6px; border-radius: 999px;
      background: linear-gradient(90deg, var(--accentA), var(--accentB));
      outline: none; border: none;
    }
    #vibe1171 input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none; width: 16px; height: 16px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white, var(--accentA));
      border: 1px solid hsl(0 0% 100% / .8);
      box-shadow: 0 8px 16px hsl(230 30% 16% / .28);
      cursor: grab;
    }
    #vibe1171 input[type="range"]::-moz-range-thumb {
      width: 16px; height: 16px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white, var(--accentA));
      border: 1px solid hsl(0 0% 100% / .8);
      box-shadow: 0 8px 16px hsl(230 30% 16% / .28);
      cursor: grab;
    }

    /* Focus */
    #vibe1171 .btn:focus-visible,
    #vibe1171 .pill:focus-visible,
    #vibe1171 .chip:focus-visible,
    #vibe1171 input[type="range"]:focus-visible {
      outline: 2px solid var(--accentA); outline-offset: 3px;
    }

    /* Pause motion */
    #vibe1171.paused * { animation-play-state: paused !important; }

    /* Keyframes */
    @keyframes v1171-slowspin { to { transform: rotate(1turn); } }
    @keyframes v1171-shimmer {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #vibe1171, #vibe1171 * { animation: none !important; transition: none !important; }
    }
  </style>

  <!-- Mast -->
  <div class="mast">
    <div class="brand">
      <span class="orb" aria-hidden="true"></span>
      <div>
        <h1 class="title">Kinetic Observatory</h1>
        <p class="lede">
          A meditative orrery of light and time—tilt to guide the cosmos, tune the harmony, save a still.
          <br><small>Refreshed <span id="last-updated">Last updated: 2025-12-09 06:17:44 EST</span></small>
        </p>
      </div>
    </div>
    <div class="themechips" role="group" aria-label="Theme">
      <button class="chip" type="button" data-theme="theme-nocturne" aria-label="Nocturne" title="Nocturne">NT</button>
      <button class="chip" type="button" data-theme="theme-daybreak" aria-label="Daybreak" title="Daybreak">DY</button>
      <button class="chip" type="button" data-theme="theme-flora" aria-label="Flora" title="Flora">FL</button>
    </div>
  </div>

  <!-- Stage -->
  <section class="stage" aria-label="Orrery Canvas">
    <canvas class="sky" aria-hidden="true"></canvas>
    <div class="halo" aria-hidden="true"></div>
    <aside class="panel" role="note" aria-label="Caption">
      <h2>Orbital Poetry</h2>
      <p>Each ring is a phrase; each body a syllable. Drag your pointer to lean the universe. Increase tempo for pulse; bloom to soften; rings for complexity.</p>
      <button class="pill" type="button" id="pulse">Pulse</button>
      <button class="btn" type="button" id="snapshot">Snapshot</button>
    </aside>
  </section>

  <!-- Dock -->
  <div class="dock">
    <div class="hint" aria-hidden="true">Tip: Move across the stage — parallax tilt and gravity respond to your motion.</div>
    <div class="controls">
      <div class="range" role="group" aria-label="Tempo">
        <label for="tempo">Tempo</label>
        <input id="tempo" type="range" min="0.4" max="3.0" step="0.1" value="1.0" aria-valuemin="0.4" aria-valuemax="3.0" aria-valuenow="1.0" aria-label="Tempo">
      </div>
      <div class="range" role="group" aria-label="Rings">
        <label for="rings">Rings</label>
        <input id="rings" type="range" min="3" max="24" step="1" value="10" aria-valuemin="3" aria-valuemax="24" aria-valuenow="10" aria-label="Ring count">
      </div>
      <div class="range" role="group" aria-label="Bloom">
        <label for="bloom">Bloom</label>
        <input id="bloom" type="range" min="0" max="16" step="1" value="6" aria-valuemin="0" aria-valuemax="16" aria-valuenow="6" aria-label="Bloom amount">
      </div>
      <button class="btn" type="button" id="pause" aria-pressed="false" aria-label="Toggle Motion">Pause</button>
      <button class="btn" type="button" id="shuffle" aria-label="Randomize Palette">Palette</button>
    </div>
  </div>

  <script>
    (function(){
      const root = document.getElementById('vibe1171');
      const canvas = root.querySelector('.sky');
      const ctx = canvas.getContext('2d', { alpha: true });

      // Timestamp
      const ts = root.querySelector('#last-updated');
      try {
        const d = new Date();
        const fmt = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        ts.textContent = d.toLocaleString(undefined, fmt);
      } catch(e) { ts.textContent = 'just now'; }

      // Theme switching
      const chips = root.querySelectorAll('.chip');
      function setTheme(theme){
        root.classList.remove('theme-nocturne','theme-daybreak','theme-flora');
        root.classList.add(theme);
        chips.forEach(c => c.removeAttribute('data-active'));
        const active = Array.from(chips).find(c => c.dataset.theme === theme);
        if (active) active.setAttribute('data-active','');
        sampleAccents();
        primeCanvas();
      }
      chips.forEach(c => c.addEventListener('click', () => setTheme(c.dataset.theme)));
      setTheme('theme-nocturne');

      // CSS accents
      let ACCENTS = [];
      function cssVar(v){ return getComputedStyle(root).getPropertyValue(v).trim(); }
      function sampleAccents(){
        ACCENTS = [cssVar('--accentA'), cssVar('--accentB'), cssVar('--accentC')].map(c => c || '#fff');
      }
      function shufflePalette(){
        const base = Math.floor(Math.random() * 360);
        const d1 = 110 + (Math.random()*20-10);
        const d2 = 220 + (Math.random()*20-10);
        root.style.setProperty('--accentA', `hsl(${base} 92% 56%)`);
        root.style.setProperty('--accentB', `hsl(${(base + d1) % 360} 90% 60%)`);
        root.style.setProperty('--accentC', `hsl(${(base + d2) % 360} 92% 58%)`);
        sampleAccents();
      }
      root.querySelector('#shuffle').addEventListener('click', shufflePalette);

      // Controls
      const tempo = root.querySelector('#tempo');
      const rings = root.querySelector('#rings');
      const bloom = root.querySelector('#bloom');
      const pauseBtn = root.querySelector('#pause');
      const pulseBtn = root.querySelector('#pulse');
      const shotBtn = root.querySelector('#snapshot');

      let SPD = parseFloat(tempo.value);
      let COUNT = parseInt(rings.value, 10);
      let BLOOM = parseFloat(bloom.value);

      tempo.addEventListener('input', () => { SPD = parseFloat(tempo.value); tempo.setAttribute('aria-valuenow', String(SPD)); root.style.setProperty('--spd', SPD); });
      rings.addEventListener('input', () => { COUNT = parseInt(rings.value, 10); rings.setAttribute('aria-valuenow', String(COUNT)); rebuild(); });
      bloom.addEventListener('input', () => { BLOOM = parseFloat(bloom.value); bloom.setAttribute('aria-valuenow', String(BLOOM)); });

      // Pointer tilt
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const pointer = { x: .5, y: .5 };
      function onPointer(e){
        const rect = canvas.getBoundingClientRect();
        pointer.x = (e.clientX - rect.left) / rect.width;
        pointer.y = (e.clientY - rect.top) / rect.height;
        root.style.setProperty('--tx', pointer.x.toFixed(3));
        root.style.setProperty('--ty', pointer.y.toFixed(3));
      }
      if (!reduce) {
        canvas.addEventListener('pointermove', onPointer, { passive: true });
        canvas.addEventListener('pointerleave', () => {
          pointer.x = .5; pointer.y = .5;
          root.style.removeProperty('--tx'); root.style.removeProperty('--ty');
        }, { passive: true });
      }

      // Sizing
      function resize(){
        const r = canvas.getBoundingClientRect();
        const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        canvas.width = Math.floor(r.width * dpr);
        canvas.height = Math.floor(r.height * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        rebuild();
      }
      window.addEventListener('resize', resize);

      // Orrery
      let bodies = [];
      let t = 0;
      function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

      function rebuild(){
        const { width: Wcss, height: Hcss } = canvas.getBoundingClientRect();
        const cx = Wcss / 2, cy = Hcss / 2;
        const maxR = Math.min(Wcss, Hcss) * 0.46;
        const minR = maxR * 0.08;
        bodies = [];
        for (let i=0; i<COUNT; i++){
          const ratio = (i+1) / (COUNT+1);
          const r = minR + ratio * (maxR - minR);
          const ang = Math.random() * Math.PI * 2;
          const hue = pick(ACCENTS);
          const speed = (0.06 + ratio * 0.24) * (Math.random() > 0.5 ? 1 : 0.7);
          bodies.push({ r, ang, hue, speed });
        }
        primeCanvas();
        // draw a faint static ring scaffold
        ctx.save();
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = 0.12;
        ctx.strokeStyle = 'currentColor';
        ctx.lineWidth = 1;
        for (let i=0; i<bodies.length; i++){
          const R = bodies[i].r;
          ctx.beginPath();
          ctx.arc(cx, cy, R, 0, Math.PI*2);
          ctx.stroke();
        }
        ctx.restore();
      }

      function primeCanvas(){
        const { width: Wcss, height: Hcss } = canvas.getBoundingClientRect();
        ctx.globalCompositeOperation = 'source-over';
        const light = root.classList.contains('theme-daybreak') ? 'white' : 'black';
        ctx.fillStyle = light;
        ctx.fillRect(0,0,Wcss,Hcss);
      }

      // Pulse
      let pulse = 0;
      pulseBtn.addEventListener('click', () => {
        pulse = 1;
        pulseBtn.animate([{ transform:'scale(1)' }, { transform:'scale(1.07)' }, { transform:'scale(1)' }], { duration: 260, easing: 'ease-out' });
        if (!running) toggleRun(true);
      });

      // Snapshot
      shotBtn.addEventListener('click', () => {
        try {
          const a = document.createElement('a');
          a.download = 'kinetic-observatory-1171.png';
          a.href = canvas.toDataURL('image/png');
          a.click();
        } catch(e){}
      });

      // Pause
      let running = true;
      pauseBtn.addEventListener('click', () => toggleRun(!running));
      function toggleRun(state){
        running = state;
        pauseBtn.textContent = running ? 'Pause' : 'Resume';
        pauseBtn.setAttribute('aria-pressed', String(!running));
        root.classList.toggle('paused', !running);
        if (running) raf();
      }

      // Draw loop
      function draw(){
        const { width: Wcss, height: Hcss } = canvas.getBoundingClientRect();
        const cx = Wcss/2, cy = Hcss/2;

        // Trails fade
        ctx.globalCompositeOperation = 'source-over';
        const fade = root.classList.contains('theme-daybreak') ? 0.08 : 0.12;
        ctx.fillStyle = `rgba(${root.classList.contains('theme-daybreak') ? '255,255,255' : '0,0,0'},${fade})`;
        ctx.fillRect(0,0,Wcss,Hcss);

        // Lighter for glow
        ctx.globalCompositeOperation = 'lighter';

        // Center wobble toward pointer
        const wobbleX = (pointer.x - 0.5) * 24;
        const wobbleY = (pointer.y - 0.5) * 18;

        // Central star
        const coreGrad = ctx.createRadialGradient(cx + wobbleX, cy + wobbleY, 0, cx + wobbleX, cy + wobbleY, 70 + 30*pulse);
        coreGrad.addColorStop(0, 'white');
        coreGrad.addColorStop(0.3, ACCENTS[0] || '#fff');
        coreGrad.addColorStop(1, 'rgba(0,0,0,0)');
        ctx.globalAlpha = 0.9;
        ctx.filter = BLOOM ? `blur(${BLOOM}px) saturate(1.2)` : 'none';
        ctx.fillStyle = coreGrad;
        ctx.beginPath();
        ctx.arc(cx + wobbleX, cy + wobbleY, 16 + 8*pulse, 0, Math.PI*2);
        ctx.fill();

        // Bodies
        for (let i=0; i<bodies.length; i++){
          const b = bodies[i];
          b.ang += (b.speed * 0.8 + 0.6 * Math.sin(t*0.5 + i)*0.01 + pulse*0.08) * SPD * 0.016;
          const angle = b.ang;
          const px = cx + wobbleX + Math.cos(angle) * b.r;
          const py = cy + wobbleY + Math.sin(angle) * b.r;

          // Orbit hint
          if (i % 3 === 0) {
            ctx.globalAlpha = 0.05 + 0.03*Math.sin(t + i);
            ctx.filter = 'none';
            ctx.strokeStyle = b.hue;
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(cx + wobbleX, cy + wobbleY, b.r, 0, Math.PI*2);
            ctx.stroke();
          }

          // Body glow
          ctx.globalAlpha = 0.85;
          ctx.filter = BLOOM ? `blur(${BLOOM}px) saturate(1.25)` : 'none';
          const g = ctx.createRadialGradient(px-1, py-1, 0, px, py, 20 + 8*pulse);
          g.addColorStop(0, 'white');
          g.addColorStop(0.25, b.hue);
          g.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.fillStyle = g;
          ctx.beginPath();
          ctx.arc(px, py, 3.6 + 1.2*Math.sin(t*1.3 + i) + 1.2*pulse, 0, Math.PI*2);
          ctx.fill();

          // Connect occasional chords
          if ((i + Math.floor(t*3)) % 7 === 0 && i < bodies.length - 1) {
            ctx.globalAlpha = 0.08;
            ctx.filter = 'none';
            ctx.strokeStyle = ACCENTS[(i % ACCENTS.length)];
            ctx.lineWidth = 1.4;
            ctx.beginPath();
            ctx.moveTo(px, py);
            const nb = bodies[(i + 3) % bodies.length];
            const nx = cx + wobbleX + Math.cos(nb.ang) * nb.r;
            const ny = cy + wobbleY + Math.sin(nb.ang) * nb.r;
            ctx.lineTo(nx, ny);
            ctx.stroke();
          }
        }

        // Pulse decay
        if (pulse > 0) pulse = Math.max(0, pulse - 0.035 * SPD);

        // time tick
        t += 1;
      }

      let rafId = 0;
      function raf(){
        if (!running || reduce) return;
        cancelAnimationFrame(rafId);
        const step = () => { draw(); rafId = requestAnimationFrame(step); };
        rafId = requestAnimationFrame(step);
      }

      // Init
      resize();
      sampleAccents();
      primeCanvas();
      rebuild();

      if (!reduce) {
        raf();
      } else {
        // One frame sample
        draw();
      }
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


