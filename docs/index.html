<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="atelier481" data-theme="aurora" data-motion="on" aria-label="The Orrery of Quiet — Iteration 481">
  <style>
    .atelier481 {
      --bg: #0b1220;
      --ink: #eaf0ff;
      --muted:#a7b3c7;
      --line: color-mix(in oklab, var(--ink) 16%, transparent);
      --glass: rgba(255,255,255,.06);
      --a1:#4ade80; --a2:#22d3ee; --a3:#a78bfa; --a4:#f59e0b;
      --tempo: 1;
      position: relative;
      padding: 28px;
      border-radius: 28px;
      color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 120% -20%, color-mix(in srgb, var(--a2) 18%, transparent), transparent 60%),
        radial-gradient(1000px 900px at -20% 120%, color-mix(in srgb, var(--a1) 16%, transparent), transparent 60%),
        linear-gradient(180deg, #070a13, #0b1220 55%, #0a0f1a);
      box-shadow:
        inset 0 0 0 1px var(--line),
        0 40px 100px rgba(0,0,0,.45);
      overflow: clip;
      isolation: isolate;
    }

    /* Themes */
    .atelier481[data-theme="aurora"] {
      --bg:#0b1220; --ink:#eaf0ff; --muted:#a7b3c7; --glass: rgba(13,16,28,.5);
      --a1:#4ade80; --a2:#22d3ee; --a3:#a78bfa; --a4:#f59e0b;
    }
    .atelier481[data-theme="ink"] {
      --bg:#0d0d0f; --ink:#f6f7fb; --muted:#b9c0cb; --glass: rgba(16,16,20,.45);
      --a1:#60a5fa; --a2:#94a3b8; --a3:#38bdf8; --a4:#f472b6;
      background:
        radial-gradient(1200px 700px at 50% -10%, color-mix(in srgb, var(--a3) 18%, transparent), transparent 60%),
        radial-gradient(900px 900px at 120% 120%, color-mix(in srgb, var(--a1) 16%, transparent), transparent 60%),
        linear-gradient(180deg, #0a0a0c, #0d0d0f 60%, #08080a);
    }
    .atelier481[data-theme="dusk"] {
      --bg:#110d16; --ink:#f9f7ff; --muted:#cdbfe2; --glass: rgba(26,20,36,.45);
      --a1:#f59e0b; --a2:#ef4444; --a3:#8b5cf6; --a4:#22d3ee;
      background:
        radial-gradient(1200px 700px at -10% 20%, color-mix(in srgb, var(--a1) 18%, transparent), transparent 60%),
        radial-gradient(1000px 900px at 110% 110%, color-mix(in srgb, var(--a3) 16%, transparent), transparent 60%),
        linear-gradient(180deg, #0d0a13, #110d16 60%, #0a0810);
    }

    /* Ambient aurora wisps */
    .atelier481 .wisp {
      position:absolute; inset:auto; filter: blur(70px) saturate(140%);
      pointer-events:none; opacity:.55; z-index:0; mix-blend-mode:screen;
      transform: translateZ(0);
    }
    .atelier481 .w1 { width:60vmax; aspect-ratio:2/1; left:-20vmax; top:-14vmax; background: conic-gradient(from 0deg, var(--a3), transparent 60%); animation: wDrift calc(38s/var(--tempo)) ease-in-out infinite alternate; }
    .atelier481 .w2 { width:44vmax; aspect-ratio:2/1; right:-16vmax; bottom:-12vmax; background: conic-gradient(from 180deg, var(--a2), transparent 58%); animation: wDrift2 calc(44s/var(--tempo)) ease-in-out infinite alternate; opacity:.6; }
    .atelier481 .w3 { width:36vmax; aspect-ratio:2/1; left:5vmax; bottom:-16vmax; background: conic-gradient(from 90deg, var(--a1), transparent 60%); animation: wDrift3 calc(50s/var(--tempo)) ease-in-out infinite alternate; opacity:.5; }
    @keyframes wDrift   { 0%{ transform:translateY(0) rotate(0deg) scale(1);} 100%{ transform:translateY(10px) rotate(12deg) scale(1.06);} }
    @keyframes wDrift2  { 0%{ transform:translateY(0) rotate(0deg) scale(1);} 100%{ transform:translateY(-10px) rotate(-10deg) scale(1.05);} }
    @keyframes wDrift3  { 0%{ transform:translateY(0) rotate(0deg) scale(1);} 100%{ transform:translateY(8px) rotate(8deg) scale(1.04);} }

    /* Header */
    .atelier481 .chrome {
      position:relative; z-index:2; display:flex; align-items:center; justify-content:space-between; gap:14px;
      padding:12px; border-radius:20px; border:1px solid var(--line);
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 95%, transparent), color-mix(in srgb, var(--glass) 75%, transparent));
      backdrop-filter: blur(10px) saturate(140%); box-shadow: 0 24px 80px rgba(0,0,0,.18);
    }
    .atelier481 .brand { display:flex; align-items:center; gap:10px; letter-spacing:.1em; text-transform:uppercase; font-size:12px; font-weight:800; }
    .atelier481 .brand svg { width:22px; height:22px; }
    .atelier481 .controls { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .atelier481 .swatch {
      width:28px; height:28px; border-radius:999px; border:1px solid var(--line); cursor:pointer; padding:0;
      background: conic-gradient(var(--a1), var(--a2), var(--a3), var(--a4), var(--a1));
      box-shadow: inset 0 0 0 3px color-mix(in srgb, #fff 10%, transparent);
      transition: transform .16s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .atelier481 .swatch[data-theme="ink"] { background: conic-gradient(var(--a1), var(--a2), var(--a3), var(--a4)); }
    .atelier481 .swatch[data-theme="dusk"] { background: conic-gradient(var(--a1), var(--a3), var(--a4), var(--a2)); }
    .atelier481 .swatch[aria-pressed="true"] { transform: translateY(-1px) scale(1.04); box-shadow: inset 0 0 0 3px color-mix(in srgb, var(--ink) 12%, transparent), 0 6px 18px rgba(0,0,0,.25); }
    .atelier481 .chip {
      appearance:none; border:1px solid var(--line); border-radius:999px; padding:8px 12px; font-size:12px; cursor:pointer;
      color: var(--ink);
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 96%, transparent), color-mix(in srgb, var(--glass) 76%, transparent));
      transition: transform .16s ease, border-color .18s ease, background .18s ease;
    }
    .atelier481 .chip:hover { transform: translateY(-1px); border-color: color-mix(in srgb, var(--ink) 20%, transparent); }
    .atelier481 .slider {
      display:flex; align-items:center; gap:8px; color: var(--muted); font-size:12px;
      padding:8px 12px; border-radius:999px; border:1px solid var(--line);
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 92%, transparent), color-mix(in srgb, var(--glass) 70%, transparent));
    }
    .atelier481 input[type="range"] { width:140px; height:26px; appearance:none; background:transparent; }
    .atelier481 input[type="range"]::-webkit-slider-runnable-track { height:6px; border-radius:999px; background: linear-gradient(90deg, var(--a1), var(--a2)); }
    .atelier481 input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance:none; width:18px; height:18px; margin-top:-6px; border-radius:50%;
      background: radial-gradient(circle at 35% 35%, #fff, #e7eef8);
      border:1px solid var(--line); box-shadow: 0 6px 14px rgba(15,23,42,.18);
    }
    .atelier481 input[type="range"]::-moz-range-track { height:6px; border-radius:999px; background: linear-gradient(90deg, var(--a1), var(--a2)); }
    .atelier481 input[type="range"]::-moz-range-thumb {
      width:18px; height:18px; border-radius:50%; background: radial-gradient(circle at 35% 35%, #fff, #e7eef8);
      border:1px solid var(--line); box-shadow: 0 6px 14px rgba(15,23,42,.18);
    }

    /* Hero */
    .atelier481 .hero {
      position:relative; z-index:2; margin:22px 0 16px; padding:26px 22px; gap:18px;
      border:1px solid var(--line); border-radius:22px;
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 95%, transparent), color-mix(in srgb, var(--glass) 72%, transparent));
      backdrop-filter: blur(12px) saturate(120%); box-shadow: 0 30px 80px rgba(0,0,0,.22);
      display:grid; grid-template-columns: 1.05fr .95fr; align-items:center;
    }
    @media (max-width: 900px) { .atelier481 .hero { grid-template-columns: 1fr; } }
    .atelier481 .eyebrow { color: var(--muted); font-size:12px; letter-spacing:.14em; text-transform:uppercase; display:flex; gap:10px; align-items:center; }
    .atelier481 .eyebrow::before {
      content:""; width:9px; height:9px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--a1), var(--a2));
      box-shadow:0 0 18px color-mix(in srgb, var(--a2) 70%, transparent);
    }
    .atelier481 .title {
      margin:8px 0 10px; line-height:1.02; font-size: clamp(38px, 7.5vw, 80px); letter-spacing:-.02em; font-weight:900;
      background: linear-gradient(90deg, var(--ink), color-mix(in srgb, var(--ink) 70%, var(--a2) 30%) 50%, var(--a2) 85%);
      -webkit-background-clip:text; background-clip:text; color: transparent;
    }
    .atelier481 .sub { margin:0; color: var(--muted); font-size: clamp(14px, 2vw, 18px); line-height:1.55; max-width: 72ch; }
    .atelier481 .actions { margin-top:14px; display:flex; gap:10px; flex-wrap:wrap; }
    .atelier481 .btn {
      border:1px solid var(--line); border-radius:14px; padding:10px 14px; font-size:14px; cursor:pointer;
      background: linear-gradient(90deg, rgba(255,255,255,.08), rgba(255,255,255,.06)); color: var(--ink);
      box-shadow: 0 20px 60px rgba(0,0,0,.2); transition: transform .16s ease, border-color .18s ease, background .18s ease;
    }
    .atelier481 .btn:hover { transform: translateY(-1px); border-color: color-mix(in srgb, var(--ink) 18%, transparent); }
    .atelier481 .btn.primary { background: linear-gradient(90deg, var(--a1), var(--a2)); color:#041e1f; font-weight:900; border-color: transparent; }

    /* Orrery */
    .atelier481 .orrery {
      position:relative; width:100%; aspect-ratio:1/1; border-radius:20px; overflow:hidden;
      border:1px solid var(--line);
      background:
        radial-gradient(120% 120% at 50% 40%, color-mix(in srgb, var(--a2) 10%, transparent), transparent 50%),
        linear-gradient(180deg, color-mix(in srgb, var(--glass) 92%, transparent), color-mix(in srgb, var(--glass) 65%, transparent));
      box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--ink) 8%, transparent), 0 30px 90px rgba(0,0,0,.28);
      transform-style: preserve-3d; perspective: 900px;
    }
    .atelier481 .stars { position:absolute; inset:0; width:100%; height:100%; display:block; }
    .atelier481 svg.rings { position:absolute; inset:0; width:100%; height:100%; display:block; overflow:visible; }
    .atelier481 .glow {
      position:absolute; inset:-1px; border-radius:inherit; pointer-events:none; z-index:2; opacity:.85;
      background:
        radial-gradient(220px 160px at var(--mx,50%) var(--my,50%), color-mix(in srgb, var(--a3) 38%, transparent), transparent 60%),
        radial-gradient(200px 140px at calc(100% - var(--mx,50%)) var(--my,50%), color-mix(in srgb, var(--a2) 28%, transparent), transparent 60%);
      mix-blend-mode: screen;
      transition: opacity .2s ease;
    }

    /* Principles */
    .atelier481 .grid { position:relative; z-index:2; margin-top:14px; display:grid; gap:12px; grid-template-columns: repeat(12, 1fr); }
    .atelier481 .card {
      grid-column: span 4; min-height: 140px; border-radius:18px; padding:16px; overflow:hidden;
      border:1px solid var(--line);
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 94%, transparent), color-mix(in srgb, var(--glass) 68%, transparent));
      box-shadow: 0 24px 70px rgba(0,0,0,.22); position:relative;
      transition: border-color .18s ease, transform .18s ease;
    }
    @media (max-width: 960px) { .atelier481 .card { grid-column: span 6; } }
    @media (max-width: 700px) { .atelier481 .card { grid-column: span 12; } }
    .atelier481 .card:hover { border-color: color-mix(in srgb, var(--ink) 18%, transparent); transform: translateY(-2px); }
    .atelier481 .card h3 { margin:4px 0 6px; font-size:18px; letter-spacing:-.01em; }
    .atelier481 .card p { margin:0; color: var(--muted); font-size:14px; line-height:1.45; }
    .atelier481 .badge {
      position:absolute; top:10px; right:10px; font-size:11px; letter-spacing:.06em; text-transform:uppercase;
      padding:6px 8px; border-radius:999px; border:1px solid var(--line);
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 94%, transparent), color-mix(in srgb, var(--glass) 70%, transparent));
      color: var(--muted);
    }

    /* Footer */
    .atelier481 .foot {
      position:relative; z-index:2; display:flex; align-items:center; justify-content:space-between; gap:12px;
      margin-top:12px; padding:10px 12px; border-radius:16px; border:1px solid var(--line);
      background: linear-gradient(180deg, color-mix(in srgb, var(--glass) 92%, transparent), color-mix(in srgb, var(--glass) 70%, transparent));
      backdrop-filter: blur(8px);
    }
    .atelier481 .foot small { color: var(--muted); }

    /* Motion control */
    .atelier481[data-motion="off"] { --tempo:.0001; }
    .atelier481[data-motion="off"] .wisp,
    .atelier481[data-motion="off"] .glow { animation-play-state: paused; }
    @media (prefers-reduced-motion: reduce) {
      .atelier481 { --tempo:.0001; }
      .atelier481 * { animation: none !important; transition: none !important; }
    }
  </style>

  <!-- Ambient wisps -->
  <div class="wisp w1" aria-hidden="true"></div>
  <div class="wisp w2" aria-hidden="true"></div>
  <div class="wisp w3" aria-hidden="true"></div>

  <!-- Header -->
  <div class="chrome">
    <div class="brand">
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <defs>
          <linearGradient id="ring481" x1="0" y1="0" x2="24" y2="24">
            <stop offset="0" stop-color="var(--a1)"/>
            <stop offset="1" stop-color="var(--a2)"/>
          </linearGradient>
        </defs>
        <circle cx="12" cy="12" r="8" stroke="url(#ring481)" stroke-width="1.6"/>
        <circle cx="12" cy="12" r="2" fill="url(#ring481)"/>
      </svg>
      Quiet Orrery
    </div>
    <div class="controls" role="group" aria-label="Theme & Motion">
      <button class="swatch" data-theme="aurora" aria-pressed="true" aria-label="Aurora theme"></button>
      <button class="swatch" data-theme="ink" aria-pressed="false" aria-label="Ink theme"></button>
      <button class="swatch" data-theme="dusk" aria-pressed="false" aria-label="Dusk theme"></button>
      <button class="chip" data-motion="toggle" aria-pressed="true">Motion: On</button>
      <div class="slider" aria-live="polite">
        Tempo
        <input type="range" min="0.5" max="2.0" step="0.05" value="1.00" aria-label="Tempo">
      </div>
    </div>
  </div>

  <!-- Hero -->
  <div class="hero">
    <div class="copy">
      <div class="eyebrow">Iteration 481 · The Quiet Orrery</div>
      <h1 class="title">A clock for the feeling of now.</h1>
      <p class="sub">Orbits that breathe, stars that listen. Change the sky, steer the drift, and let calm mechanics make attention tangible.</p>
      <div class="actions">
        <button class="btn primary" data-action="breathe">Breathe</button>
        <button class="btn" data-action="freeze">Freeze</button>
      </div>
    </div>

    <div class="orrery" data-orrery aria-label="Generative orrery">
      <canvas class="stars" aria-hidden="true"></canvas>
      <svg class="rings" viewBox="0 0 100 100" aria-hidden="true"></svg>
      <div class="glow" aria-hidden="true"></div>
    </div>
  </div>

  <!-- Principles -->
  <div class="grid" aria-label="Principles">
    <article class="card">
      <span class="badge">Timing</span>
      <h3>Ease before speed</h3>
      <p>Motion eases in and eases out—no whiplash, no rush. The eye can breathe here.</p>
    </article>
    <article class="card">
      <span class="badge">Geometry</span>
      <h3>Fewer shapes, richer meaning</h3>
      <p>Rings, points, and gaps. A vocabulary small enough to stay memorable, wide enough to sing.</p>
    </article>
    <article class="card">
      <span class="badge">Atmosphere</span>
      <h3>Three skies, same voice</h3>
      <p>Aurora, Ink, Dusk—distinct mood, one typographic cadence.</p>
    </article>
  </div>

  <!-- Footer -->
  <div class="foot">
    <small>Tip: Move across the orrery—gravity leans your way.</small>
    <small><span id="last-updated">Last updated: 2025-11-07 09:17:45 EST</span></small>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.atelier481');

      // Last updated
      const lu = root.querySelector('#last-updated');
      try {
        const now = new Date();
        const fmt = new Intl.DateTimeFormat(navigator.language || 'en-US', {
          year:'numeric', month:'short', day:'2-digit',
          hour:'2-digit', minute:'2-digit', hour12:true
        });
        lu.textContent = 'Updated ' + fmt.format(now);
      } catch(e) {
        lu.textContent = 'Updated ' + new Date().toLocaleString();
      }

      // Elements
      const swatches = root.querySelectorAll('.swatch[data-theme]');
      const motionBtn = root.querySelector('.chip[data-motion]');
      const slider = root.querySelector('input[type="range"]');
      const wrap = root.querySelector('[data-orrery]');
      const stars = wrap.querySelector('canvas.stars');
      const svg = wrap.querySelector('svg.rings');
      const glow = wrap.querySelector('.glow');

      // Theme switching
      const setTheme = (t)=>{
        root.setAttribute('data-theme', t);
        swatches.forEach(b=>{
          const on = b.getAttribute('data-theme') === t;
          b.setAttribute('aria-pressed', String(on));
        });
        pulse(8);
      };
      swatches.forEach(b=> b.addEventListener('click', ()=> setTheme(b.getAttribute('data-theme'))));

      // Motion toggle
      let running = true, raf = null;
      const setMotion = (on)=>{
        root.setAttribute('data-motion', on ? 'on' : 'off');
        motionBtn.textContent = 'Motion: ' + (on ? 'On' : 'Off');
        motionBtn.setAttribute('aria-pressed', String(on));
        running = on;
        if (on) loop(); else cancelAnimationFrame(raf);
      };
      motionBtn.addEventListener('click', ()=>{
        const on = root.getAttribute('data-motion') !== 'on';
        setMotion(on);
      });

      // Actions
      root.querySelector('[data-action="freeze"]')?.addEventListener('click', ()=> setMotion(false));
      root.querySelector('[data-action="breathe"]')?.addEventListener('click', ()=> { setMotion(true); pulse(12); });

      // Tempo
      let speed = parseFloat(slider.value);
      const applyTempo = (v)=> root.style.setProperty('--tempo', v);
      slider.addEventListener('input', (e)=> { speed = parseFloat(e.target.value); applyTempo(speed); });
      applyTempo(speed);

      // SVG build
      const NS = 'http://www.w3.org/2000/svg';
      const defs = document.createElementNS(NS, 'defs');
      const g1 = document.createElementNS(NS, 'linearGradient'); g1.id = 'g481a';
      g1.innerHTML = '<stop offset="0" stop-color="var(--a1)"/><stop offset="1" stop-color="var(--a2)"/>';
      const g2 = document.createElementNS(NS, 'linearGradient'); g2.id = 'g481b';
      g2.innerHTML = '<stop offset="0" stop-color="var(--a3)"/><stop offset="1" stop-color="var(--a4)"/>';
      defs.appendChild(g1); defs.appendChild(g2);
      svg.appendChild(defs);
      const rings = [];
      const ringSpecs = [
        { r: 18, count: 6, stroke: 'url(#g481a)', w: 0.70, dir: 1, jitter: 0.02 },
        { r: 28, count: 9, stroke: 'url(#g481b)', w: 0.6, dir: -1, jitter: 0.04 },
        { r: 40, count: 14, stroke: 'url(#g481a)', w: 0.55, dir: 1, jitter: 0.05 },
        { r: 50, count: 20, stroke: 'url(#g481b)', w: 0.5, dir: -1, jitter: 0.06 }
      ];
      ringSpecs.forEach((spec, idx)=>{
        const ringG = document.createElementNS(NS, 'g');
        const orbit = document.createElementNS(NS, 'circle');
        orbit.setAttribute('cx', '50'); orbit.setAttribute('cy', '50'); orbit.setAttribute('r', String(spec.r));
        orbit.setAttribute('fill', 'none'); orbit.setAttribute('stroke', spec.stroke); orbit.setAttribute('stroke-opacity', '0.35');
        orbit.setAttribute('stroke-width', String(spec.w));
        ringG.appendChild(orbit);
        const sats = [];
        for (let i=0;i<spec.count;i++){
          const theta = (i/spec.count)*Math.PI*2;
          const satG = document.createElementNS(NS, 'g');
          const x = 50 + Math.cos(theta)*spec.r;
          const y = 50 + Math.sin(theta)*spec.r;
          satG.setAttribute('transform', `translate(${x},${y})`);
          const dot = document.createElementNS(NS, 'circle');
          dot.setAttribute('r', String(0.9 + (i%3)*0.25));
          dot.setAttribute('fill', idx%2===0 ? 'var(--a2)' : 'var(--a3)');
          dot.setAttribute('fill-opacity', String(0.8 - i/spec.count*0.25));
          satG.appendChild(dot);
          ringG.appendChild(satG);
          sats.push({g: satG, baseTheta: theta});
        }
        svg.appendChild(ringG);
        rings.push({ g: ringG, orbit, sats, angle: Math.random()*360, spec });
      });

      // Stars canvas
      const ctx = stars.getContext('2d', { alpha: true });
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      const starCount = 180;
      let starField = [];
      function buildStars() {
        const r = wrap.getBoundingClientRect();
        stars.width = Math.floor(r.width * dpr);
        stars.height = Math.floor(r.height * dpr);
        stars.style.width = r.width + 'px';
        stars.style.height = r.height + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        starField = Array.from({length: starCount}, ()=>({
          x: Math.random()*r.width,
          y: Math.random()*r.height,
          z: 0.4 + Math.random()*0.6,
          tw: Math.random()*Math.PI*2
        }));
      }
      new ResizeObserver(buildStars).observe(wrap);
      buildStars();

      // Pointer gravity
      let tx = 0.5, ty = 0.45;
      let gx = 0.5, gy = 0.45;
      const lerp = (a,b,u)=> a+(b-a)*u;
      function onMove(e){
        const r = wrap.getBoundingClientRect();
        const x = (e.clientX - r.left) / r.width;
        const y = (e.clientY - r.top) / r.height;
        tx = x; ty = y;
        glow.style.setProperty('--mx', (x*100).toFixed(2)+'%');
        glow.style.setProperty('--my', (y*100).toFixed(2)+'%');
        glow.style.opacity = 0.98;
      }
      wrap.addEventListener('pointerenter', onMove);
      wrap.addEventListener('pointermove', onMove);
      wrap.addEventListener('pointerleave', ()=>{ tx = 0.5; ty = 0.45; glow.style.opacity = 0.82; });

      // Comets (click)
      const comets = [];
      wrap.addEventListener('click', (e)=>{
        const r = wrap.getBoundingClientRect();
        const x = (e.clientX - r.left);
        const y = (e.clientY - r.top);
        const ang = Math.random()*Math.PI*2;
        comets.push({ x, y, vx: Math.cos(ang)*2, vy: Math.sin(ang)*2, life: 1 });
      });

      // Pulse effect
      function pulse(n=8){
        rings.forEach((ring,i)=>{
          ring.orbit.setAttribute('stroke-opacity', '0.9');
          setTimeout(()=> ring.orbit.setAttribute('stroke-opacity', '0.35'), 220 + i*30);
        });
        // paint a few bright star pings
        const r = wrap.getBoundingClientRect();
        for (let i=0;i<n;i++){
          setTimeout(()=>{
            ctx.save();
            ctx.globalCompositeOperation = 'lighter';
            ctx.globalAlpha = 0.6;
            ctx.fillStyle = getPalette()[i % 4];
            ctx.beginPath();
            ctx.arc(Math.random()*r.width, Math.random()*r.height, 1.4, 0, Math.PI*2);
            ctx.fill();
            ctx.restore();
          }, i*28);
        }
      }

      function getPalette(){
        const t = root.getAttribute('data-theme');
        if (t === 'ink') return ['#60a5fa', '#94a3b8', '#38bdf8', '#f472b6'];
        if (t === 'dusk') return ['#f59e0b', '#ef4444', '#8b5cf6', '#22d3ee'];
        return ['#4ade80', '#22d3ee', '#a78bfa', '#f59e0b'];
      }

      // Draw loops
      let t = 0;
      function drawStars() {
        const r = wrap.getBoundingClientRect();
        ctx.clearRect(0,0,r.width,r.height);
        // faint veil
        ctx.fillStyle = root.matches('[data-theme="aurora"]') ? 'rgba(11,18,32,0.22)' :
                        root.matches('[data-theme="ink"]')    ? 'rgba(13,13,15,0.22)' :
                                                                'rgba(17,13,22,0.22)';
        ctx.fillRect(0,0,r.width,r.height);

        // parallax drift target
        gx = lerp(gx, tx, 0.06);
        gy = lerp(gy, ty, 0.06);

        starField.forEach((s, i)=>{
          const px = s.x + (gx-0.5)*12*s.z;
          const py = s.y + (gy-0.5)*12*s.z;
          const a = 0.35 + 0.35*Math.sin(t*1.6 + s.tw + i*0.13);
          ctx.globalAlpha = a;
          ctx.fillStyle = getPalette()[i % 4];
          ctx.beginPath();
          ctx.arc(px, py, 0.6 + s.z*0.9, 0, Math.PI*2);
          ctx.fill();
        });

        // comets
        for (let i=comets.length-1;i>=0;i--){
          const c = comets[i];
          c.x += c.vx; c.y += c.vy; c.life -= 0.015;
          ctx.globalAlpha = Math.max(0, c.life);
          ctx.strokeStyle = 'white';
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(c.x, c.y);
          ctx.lineTo(c.x - c.vx*6, c.y - c.vy*6);
          ctx.stroke();
          if (c.life <= 0) comets.splice(i,1);
        }
        ctx.globalAlpha = 1;
      }

      function drawRings() {
        const center = {x:50, y:50};
        rings.forEach((ring, idx)=>{
          ring.angle += (0.18 + 0.04*idx) * ring.spec.dir * speed;
          ring.g.setAttribute('transform', `rotate(${ring.angle} ${center.x} ${center.y})`);
          const attractX = (gx-0.5) * 4;
          const attractY = (gy-0.5) * 4;
          ring.sats.forEach((s, i)=>{
            // small radial jitter towards pointer
            const j = ring.spec.jitter;
            const rx = Math.cos(s.baseTheta) * ring.spec.r + attractX * (i%3+1)*j;
            const ry = Math.sin(s.baseTheta) * ring.spec.r + attractY * (i%3+1)*j;
            s.g.setAttribute('transform', `translate(${50+rx},${50+ry})`);
          });
        });
      }

      function loop(){
        if (!running) return;
        t += 0.0085 * speed;
        drawStars();
        drawRings();
        raf = requestAnimationFrame(loop);
      }

      // Start/Reduce motion
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) setMotion(false); else loop();

      // Keyboard focus pulse
      wrap.setAttribute('tabindex','0');
      wrap.addEventListener('focus', ()=> pulse(6));

      // Initial pulse for delight
      setTimeout(()=> pulse(10), 400);
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


