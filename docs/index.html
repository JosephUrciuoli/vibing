<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="halo997" data-theme="noir" data-floaters="on" tabindex="0" role="region" aria-label="Luma Halo — a circular, luminous time sculpture you can tilt and tune">
  <style>
    /* Tokens */
    #halo997{
      --ink:#eaf1ff;
      --muted: color-mix(in oklab, var(--ink) 68%, #b6c3ff 32%);
      --edge: rgba(255,255,255,.14);
      --glass: rgba(255,255,255,.08);
      --bg1:#050914; --bg2:#0b1631;
      --c1:#7aa6ff; --c2:#4ff3d4; --c3:#ff99e7;
      --rx:0deg; --ry:0deg;
      --sat:1.10;
      --bloom:1; /* 0..1 */
      --haloBlur: 14px;
      --depth: 1200px;
      position:relative; isolation:isolate;
      min-height:76vh;
      padding: clamp(14px, 3.2vw, 28px);
      border-radius:36px;
      overflow:hidden;
      color:var(--ink);
      font-family: ui-sans-serif, -apple-system, Inter, "SF Pro", Segoe UI, Roboto, "Noto Sans", Arial, sans-serif;
      background: radial-gradient(1200px 900px at 60% 30%, color-mix(in oklab, var(--c3) 10%, transparent), transparent 60%), linear-gradient(180deg, var(--bg1), var(--bg2));
      box-shadow:
        0 1px 0 rgba(255,255,255,.05) inset,
        0 0 0 1px rgba(255,255,255,.08) inset,
        0 70px 240px rgba(0,0,0,.60);
    }
    /* Themes */
    #halo997[data-theme="noir"]{
      --ink:#eaf1ff; --muted:#9fb0ff;
      --bg1:#060a16; --bg2:#0c122a;
      --c1:#7aa6ff; --c2:#4ff3d4; --c3:#ff99e7;
      --glass: rgba(255,255,255,.08);
    }
    #halo997[data-theme="daylight"]{
      --ink:#0e1323; --muted: color-mix(in oklab, var(--ink) 68%, #6b768f 32%);
      --bg1:#f6fbff; --bg2:#e9f3ff;
      --c1:#6fb8ff; --c2:#9ff3ce; --c3:#caa9ff;
      --glass: rgba(255,255,255,.62);
      --edge: rgba(0,0,0,.12);
      box-shadow:
        0 1px 0 rgba(0,0,0,.06) inset,
        0 0 0 1px rgba(0,0,0,.08) inset,
        0 70px 180px rgba(40,56,120,.18);
    }
    #halo997[data-theme="dawn"]{
      --ink:#1c0f17; --muted:#9d7186;
      --bg1:#fff7f3; --bg2:#ffe7ee;
      --c1:#ff8aa3; --c2:#ffd36f; --c3:#9ea6ff;
      --glass: rgba(255,255,255,.58);
      --edge: rgba(0,0,0,.12);
    }
    #halo997[data-theme="marine"]{
      --ink:#0b1411; --muted:#3a6b60;
      --bg1:#eafff8; --bg2:#d8f3e9;
      --c1:#20c7a6; --c2:#5be3c3; --c3:#9ae2ff;
      --glass: rgba(255,255,255,.62);
      --edge: rgba(0,0,0,.10);
    }
    #halo997[data-theme="violet"]{
      --ink:#ece6ff; --muted:#bfaeff;
      --bg1:#14081f; --bg2:#241046;
      --c1:#bb86ff; --c2:#7ad5ff; --c3:#ff7ad5;
      --glass: rgba(255,255,255,.10);
      --edge: rgba(255,255,255,.12);
    }

    /* Ambient layers */
    #halo997 .bg { position:absolute; inset:-10%; z-index:0; pointer-events:none; filter: saturate(var(--sat)); }
    #halo997 .aurora{
      position:absolute; inset:-25%;
      border-radius:50%;
      filter: blur(100px) saturate(130%);
      mix-blend-mode: soft-light;
      opacity:.55;
      animation: auroraSpin 120s linear infinite;
    }
    #halo997 .aurora.a1{
      background:
        radial-gradient(35% 30% at 22% 18%, color-mix(in oklab, var(--c1) 34%, transparent), transparent 70%),
        radial-gradient(32% 28% at 79% 63%, color-mix(in oklab, var(--c3) 28%, transparent), transparent 70%);
    }
    #halo997 .aurora.a2{
      opacity:.40;
      background:
        radial-gradient(40% 30% at 76% 22%, color-mix(in oklab, var(--c2) 28%, transparent), transparent 70%),
        radial-gradient(36% 30% at 28% 80%, color-mix(in oklab, var(--c1) 20%, transparent), transparent 70%);
      animation-direction: reverse; animation-duration: 160s;
    }
    @keyframes auroraSpin { to { transform: rotate(360deg); } }
    #halo997 .grain{
      position:absolute; inset:-2px; opacity:.10; mix-blend-mode: overlay;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='120' height='120' filter='url(%23n)' opacity='.55'/%3E%3C/svg%3E");
    }

    /* Top chrome */
    #halo997 .chrome{
      position:relative; z-index:2;
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      border:1px solid var(--edge); border-radius:22px; padding:10px 12px;
      background: color-mix(in oklab, var(--glass) 70%, transparent);
      backdrop-filter: blur(14px) saturate(120%);
      box-shadow: 0 12px 36px rgba(0,0,0,.28);
    }
    #halo997 .brand{
      display:flex; align-items:center; gap:10px; text-transform:uppercase; letter-spacing:.18em; font-weight:900; font-size:12px; color:var(--muted);
    }
    #halo997 .gem{
      width:22px; height:22px; border-radius:6px; position:relative; overflow:hidden; display:grid; place-items:center;
      background: conic-gradient(from 0deg, var(--c1), var(--c2), var(--c3), var(--c1));
      box-shadow: inset 0 0 0 1px var(--edge), 0 4px 12px rgba(0,0,0,.28);
      animation: gemspin997 10s linear infinite;
    }
    @keyframes gemspin997{ to{ transform: rotate(360deg); } }

    #halo997 .actions{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    #halo997 button, #halo997 .toggle, #halo997 .slider{
      appearance:none; border:1px solid var(--edge); color:var(--ink);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer;
      transition: transform 120ms ease, box-shadow 220ms ease, background 240ms ease, color .2s ease;
      box-shadow: 0 2px 0 rgba(0,0,0,.28); user-select:none; font-size:12px;
    }
    #halo997[data-theme="daylight"] :is(button,.toggle,.slider){
      background: linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,255,255,.72));
      box-shadow: 0 2px 0 rgba(0,0,0,.06);
    }
    #halo997 button:hover{ transform: translateY(-1px); box-shadow: 0 12px 28px rgba(0,0,0,.24); }
    #halo997 .toggle{ display:inline-flex; align-items:center; gap:10px; color:var(--muted); }
    #halo997 .toggle input{
      appearance:none; width:44px; height:24px; border-radius:999px; background: rgba(255,255,255,.12); position:relative; border:1px solid var(--edge);
    }
    #halo997[data-theme="daylight"] .toggle input{ background: rgba(0,0,0,.08); }
    #halo997 .toggle input::after{
      content:""; position:absolute; top:3px; left:3px; width:18px; height:18px; border-radius:50%; background:#fff; border:1px solid var(--edge);
      box-shadow:0 2px 6px rgba(0,0,0,.18); transition: transform 160ms ease;
    }
    #halo997 .toggle input:checked{ background: linear-gradient(90deg, var(--c1), var(--c2)); }
    #halo997 .toggle input:checked::after{ transform: translateX(18px); }
    #halo997 .slider{ display:inline-flex; align-items:center; gap:10px; color:var(--muted); }
    #halo997 .slider input[type="range"]{ width:160px; height:18px; background:transparent; -webkit-appearance:none; }
    #halo997 .slider input[type="range"]::-webkit-slider-runnable-track{ height:6px; border-radius:999px; background: linear-gradient(90deg, var(--c2), var(--c3)); opacity:.9; }
    #halo997 .slider input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; width:18px; height:18px; border-radius:50%; background:#fff; border:1px solid var(--edge); margin-top:-6px;
      box-shadow:0 2px 6px rgba(0,0,0,.18);
    }
    #halo997 .slider input[type="range"]::-moz-range-track{ height:6px; border-radius:999px; background: linear-gradient(90deg, var(--c2), var(--c3)); opacity:.9; }
    #halo997 .slider input[type="range"]::-moz-range-thumb{
      width:18px; height:18px; border-radius:50%; background:#fff; border:1px solid var(--edge); box-shadow:0 2px 6px rgba(0,0,0,.18);
    }

    /* Stage */
    #halo997 .stage{
      position:relative; z-index:1; margin-top:16px;
      border:1px solid var(--edge); border-radius:28px; overflow:hidden;
      background: linear-gradient(180deg, color-mix(in oklab, var(--glass) 64%, transparent), color-mix(in oklab, var(--glass) 30%, transparent));
      backdrop-filter: blur(12px) saturate(130%);
      box-shadow: 0 22px 70px rgba(0,0,0,.34);
      min-height: clamp(460px, 62vh, 740px);
      transform-style: preserve-3d;
      transform: perspective(var(--depth)) rotateX(var(--rx)) rotateY(var(--ry));
      transition: transform .2s ease;
      display:grid; place-items:center;
      filter: saturate(var(--sat));
    }

    /* Floaters */
    #halo997 .floaters{ position:absolute; inset:0; pointer-events:none; z-index:0; }
    #halo997 .floater{
      position:absolute; width: clamp(14px, 1.6vw, 24px); height: clamp(14px, 1.6vw, 24px);
      border-radius: 6px;
      background: linear-gradient(135deg, color-mix(in oklab, var(--c1) 50%, transparent), color-mix(in oklab, var(--c3) 40%, transparent));
      border:1px solid color-mix(in oklab, var(--c2) 50%, rgba(255,255,255,.4));
      backdrop-filter: blur(6px);
      opacity:.6;
      animation: drift997 var(--d, 22s) linear infinite;
      filter: drop-shadow(0 6px 18px color-mix(in oklab, var(--c2) 40%, transparent));
    }
    @keyframes drift997{
      0%{ transform: translate3d(var(--x, 0px), var(--y, 0px), 0) rotate(0deg); }
      50%{ transform: translate3d(calc(var(--x, 0px) + 40px), calc(var(--y, 0px) - 60px), 0) rotate(140deg); }
      100%{ transform: translate3d(calc(var(--x, 0px) + 0px), calc(var(--y, 0px) - 120px), 0) rotate(360deg); }
    }
    #halo997[data-floaters="off"] .floater{ display:none; }

    /* Halo */
    #halo997 .haloWrap{
      position:relative; width:min(86vmin, 780px); aspect-ratio:1/1; display:grid; place-items:center;
      filter: drop-shadow(0 12px 40px rgba(0,0,0,.30));
    }
    #halo997 svg{ width:100%; height:auto; display:block; }
    #halo997 .haloGlow{
      filter: drop-shadow(0 0 calc(var(--haloBlur)*2) color-mix(in oklab, var(--c1) 24%, transparent))
              drop-shadow(0 0 calc(var(--haloBlur)*1.2) color-mix(in oklab, var(--c2) 24%, transparent))
              drop-shadow(0 0 calc(var(--haloBlur)*1.6) color-mix(in oklab, var(--c3) 18%, transparent));
      opacity: calc(.65 * var(--bloom));
      transition: opacity .2s ease;
    }
    #halo997 .track{ opacity:.16; }
    #halo997 .ring{ stroke-linecap:round; }
    #halo997 .dot{ stroke:none; }

    /* Readout */
    #halo997 .readout{
      position:absolute; inset:0; display:grid; place-items:center; pointer-events:none;
    }
    #halo997 .time{
      margin:0; line-height:.9; letter-spacing:-0.02em; font-weight:900;
      font-size: clamp(48px, 10vw, 132px);
      color: transparent;
      background: linear-gradient(90deg, var(--c1), var(--c2), var(--c3), var(--c1));
      background-size: 220% 100%;
      -webkit-background-clip: text; background-clip: text;
      animation: sheen997 16s linear infinite;
      filter: drop-shadow(0 6px 18px color-mix(in oklab, var(--c1) 24%, transparent));
      text-align:center;
    }
    @keyframes sheen997{ 0%{ background-position: 0% 0; } 100%{ background-position: 200% 0; } }
    #halo997 .lede{
      margin-top:6px; color:var(--muted); font-size: clamp(13px, 1.5vw, 18px); line-height:1.7; text-wrap:balance; text-align:center; max-width: 70ch;
    }

    /* Meta */
    #halo997 .meta{
      margin-top:14px; color:var(--muted); font-size:12px; display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }

    /* Focus */
    #halo997 :is(button, input, [tabindex]):focus-visible{
      outline: 2px solid color-mix(in oklab, var(--c1) 55%, #fff);
      outline-offset: 2px;
    }

    @media (max-width: 880px){
      #halo997 .slider input[type="range"]{ width:130px; }
      #halo997 .time{ font-size: clamp(42px, 12vw, 112px); }
    }
    @media (prefers-reduced-motion: reduce){
      #halo997 .aurora, #halo997 .time, #halo997 .gem, #halo997 .floater{ animation: none !important; }
    }
  </style>

  <div class="bg" aria-hidden="true">
    <div class="aurora a1"></div>
    <div class="aurora a2"></div>
    <div class="grain"></div>
  </div>

  <div class="chrome">
    <div class="brand">
      <span class="gem" aria-hidden="true"></span>
      <span>Luma Halo • 997</span>
    </div>
    <div class="actions">
      <button id="theme997" title="Cycle theme">Theme</button>
      <label class="slider" title="Prism (saturation)">
        Prism
        <input type="range" id="prism997" min="0.80" max="1.80" step="0.01" value="1.10">
      </label>
      <label class="toggle" title="Floaters">
        Floaters
        <input type="checkbox" id="floaters997" checked>
      </label>
      <label class="toggle" title="Bloom glow">
        Bloom
        <input type="checkbox" id="bloom997" checked>
      </label>
    </div>
  </div>

  <div class="stage" role="img" aria-label="Circular luminous clock composed of three rings; pointer tilt changes perspective">
    <div class="floaters" aria-hidden="true"></div>
    <div class="haloWrap">
      <svg id="clock997" viewBox="0 0 600 600" aria-hidden="true">
        <defs>
          <linearGradient id="gSec" x1="0" y1="0" x2="600" y2="600" gradientUnits="userSpaceOnUse">
            <stop offset="0%" stop-color="var(--c1)"/>
            <stop offset="50%" stop-color="var(--c2)"/>
            <stop offset="100%" stop-color="var(--c3)"/>
          </linearGradient>
          <linearGradient id="gMin" x1="600" y1="0" x2="0" y2="600" gradientUnits="userSpaceOnUse">
            <stop offset="0%" stop-color="var(--c2)"/>
            <stop offset="50%" stop-color="var(--c3)"/>
            <stop offset="100%" stop-color="var(--c1)"/>
          </linearGradient>
          <linearGradient id="gHr" x1="0" y1="600" x2="600" y2="0" gradientUnits="userSpaceOnUse">
            <stop offset="0%" stop-color="var(--c3)"/>
            <stop offset="50%" stop-color="var(--c1)"/>
            <stop offset="100%" stop-color="var(--c2)"/>
          </linearGradient>
        </defs>

        <!-- Soft center pulse -->
        <circle cx="300" cy="300" r="120" fill="url(#gMin)" opacity=".08"/>

        <g class="rot" transform="rotate(-90 300 300)">
          <!-- Tracks -->
          <circle class="track" cx="300" cy="300" r="260" fill="none" stroke="currentColor" stroke-opacity=".18" stroke-width="18"/>
          <circle class="track" cx="300" cy="300" r="220" fill="none" stroke="currentColor" stroke-opacity=".18" stroke-width="18"/>
          <circle class="track" cx="300" cy="300" r="180" fill="none" stroke="currentColor" stroke-opacity=".18" stroke-width="18"/>

          <!-- Rings -->
          <circle id="secRing" class="ring haloGlow" cx="300" cy="300" r="260" fill="none" stroke="url(#gSec)" stroke-width="18" pathLength="1" stroke-dasharray="0 1"/>
          <circle id="minRing" class="ring haloGlow" cx="300" cy="300" r="220" fill="none" stroke="url(#gMin)" stroke-width="18" pathLength="1" stroke-dasharray="0 1"/>
          <circle id="hrRing"  class="ring haloGlow" cx="300" cy="300" r="180" fill="none" stroke="url(#gHr)"  stroke-width="18" pathLength="1" stroke-dasharray="0 1"/>

          <!-- Dots -->
          <circle id="secDot" class="dot haloGlow" r="6" cx="300" cy="40"  fill="var(--c1)"/>
          <circle id="minDot" class="dot haloGlow" r="7" cx="300" cy="80"  fill="var(--c2)"/>
          <circle id="hrDot"  class="dot haloGlow" r="8" cx="300" cy="120" fill="var(--c3)"/>
        </g>
      </svg>

      <div class="readout">
        <div class="time" aria-live="polite"><span id="h997">12</span><span>:</span><span id="m997">00</span><span>:</span><span id="s997">00</span></div>
        <p class="lede">Time as light. Tilt with your pointer; tune the prism, bloom, and floaters.</p>
      </div>
    </div>
  </div>

  <div class="meta">
    <span id="last-updated">Last updated: 2025-12-01 06:16:48 EST</span>
    <span class="keys">Keys: T theme • Space pause • Drag to tilt</span>
  </div>

  <script>
    (function(){
      const root = document.getElementById('halo997');
      const stage = root.querySelector('.stage');
      const floatWrap = root.querySelector('.floaters');

      // Timestamp
      try{
        const d = new Date();
        const fmt = new Intl.DateTimeFormat([], { month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' });
        root.querySelector('#last-updated').textContent = 'Last updated: ' + fmt.format(d);
      }catch{}

      // Theme cycle
      const themeBtn = root.querySelector('#theme997');
      const themes = ['noir','daylight','dawn','marine','violet'];
      function cycleTheme(){
        const cur = root.getAttribute('data-theme') || themes[0];
        const idx = themes.indexOf(cur);
        const next = themes[(idx+1)%themes.length];
        root.setAttribute('data-theme', next);
        themeBtn.textContent = 'Theme • ' + next;
      }
      themeBtn.addEventListener('click', cycleTheme);
      themeBtn.textContent = 'Theme • ' + (root.getAttribute('data-theme') || themes[0]);

      // Prism (saturation)
      const prism = root.querySelector('#prism997');
      prism.addEventListener('input', ()=>{
        root.style.setProperty('--sat', (parseFloat(prism.value)||1).toFixed(2));
      });

      // Floaters & Bloom toggles
      const floatersToggle = root.querySelector('#floaters997');
      const bloomToggle = root.querySelector('#bloom997');
      function syncToggles(){
        root.setAttribute('data-floaters', floatersToggle.checked ? 'on' : 'off');
        root.style.setProperty('--bloom', bloomToggle.checked ? '1' : '0');
        root.style.setProperty('--haloBlur', bloomToggle.checked ? '14px' : '4px');
      }
      floatersToggle.addEventListener('change', syncToggles);
      bloomToggle.addEventListener('change', syncToggles);
      syncToggles();

      // Pointer tilt
      let tx=.5, ty=.5, mx=.5, my=.5;
      function setTilt(){
        root.style.setProperty('--rx', ((.5 - my)*10).toFixed(3) + 'deg');
        root.style.setProperty('--ry', ((mx - .5)*12).toFixed(3) + 'deg');
      }
      stage.addEventListener('pointermove', (e)=>{
        const r = stage.getBoundingClientRect();
        tx = Math.max(0, Math.min(1, (e.clientX - r.left)/r.width));
        ty = Math.max(0, Math.min(1, (e.clientY - r.top)/r.height));
      }, {passive:true});
      stage.addEventListener('pointerleave', ()=>{ tx=.5; ty=.5; }, {passive:true});
      setTilt();

      // Build floaters
      function seedFloaters(n=12){
        floatWrap.innerHTML='';
        for(let i=0;i<n;i++){
          const s = document.createElement('span');
          s.className='floater';
          const x = Math.random()*window.innerWidth*0.5 - 40;
          const y = Math.random()*window.innerHeight*0.3 + 40;
          const d = 18 + Math.random()*18;
          s.style.setProperty('--x', x.toFixed(0)+'px');
          s.style.setProperty('--y', y.toFixed(0)+'px');
          s.style.setProperty('--d', d.toFixed(2)+'s');
          s.style.left = (5 + Math.random()*90)+'%';
          s.style.top = (10 + Math.random()*70)+'%';
          floatWrap.appendChild(s);
        }
      }
      seedFloaters();

      // Reduced motion
      let REDUCE=false;
      try{ REDUCE = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches; }catch{}
      if(REDUCE){
        prism.value = '1.0';
        root.style.setProperty('--sat','1.0');
        root.setAttribute('data-floaters','off');
        root.style.setProperty('--bloom','0.8');
      }

      // Halo clock
      const svg = root.querySelector('#clock997');
      const rings = {
        sec: svg.querySelector('#secRing'),
        min: svg.querySelector('#minRing'),
        hr:  svg.querySelector('#hrRing')
      };
      const dots = {
        sec: svg.querySelector('#secDot'),
        min: svg.querySelector('#minDot'),
        hr:  svg.querySelector('#hrDot')
      };
      const radii = { sec:260, min:220, hr:180 };
      const center = { x:300, y:300 };

      const hEl = root.querySelector('#h997');
      const mEl = root.querySelector('#m997');
      const sEl = root.querySelector('#s997');
      function pad(n){ return String(n).padStart(2,'0'); }

      let paused=false;
      let t0 = performance.now();
      function render(now){
        if(paused){ requestAnimationFrame(render); return; }
        const dt = Math.min(0.04, (now-(t0||now))/1000); t0=now;

        // ease pointer
        const ease = 0.12;
        mx += (tx - mx)*ease; my += (ty - my)*ease; setTilt();

        const d = new Date();
        const ms = d.getMilliseconds()/1000;
        const s = d.getSeconds() + ms;
        const m = d.getMinutes() + s/60;
        const h = (d.getHours()%12) + m/60;

        const pfSec = s/60;
        const pfMin = m/60;
        const pfHr  = h/12;

        // update arcs (pathLength=1 -> dasharray uses 0..1)
        rings.sec.setAttribute('stroke-dasharray', `${pfSec} ${1-pfSec}`);
        rings.min.setAttribute('stroke-dasharray', `${pfMin} ${1-pfMin}`);
        rings.hr.setAttribute('stroke-dasharray',  `${pfHr} ${1-pfHr}`);

        // update dots
        function placeDot(dot, r, frac){
          const ang = (frac*2*Math.PI) - Math.PI/2;
          const x = center.x + Math.cos(ang)*r;
          const y = center.y + Math.sin(ang)*r;
          dot.setAttribute('cx', x.toFixed(2));
          dot.setAttribute('cy', y.toFixed(2));
        }
        placeDot(dots.sec, radii.sec, pfSec);
        placeDot(dots.min, radii.min, pfMin);
        placeDot(dots.hr,  radii.hr,  pfHr);

        // update readout
        hEl.textContent = pad(d.getHours());
        mEl.textContent = pad(d.getMinutes());
        sEl.textContent = pad(Math.floor(s));

        requestAnimationFrame(render);
      }
      requestAnimationFrame(render);

      // Keyboard: T theme, Space pause
      root.addEventListener('keydown', (e)=>{
        if(e.key==='t' || e.key==='T'){ e.preventDefault(); cycleTheme(); }
        if(e.key===' '){
          e.preventDefault();
          paused = !paused;
          if(!paused){ t0 = performance.now(); }
        }
      }, {passive:false});

      // Resize re-seed floaters occasionally
      let seedTO;
      window.addEventListener('resize', ()=>{
        clearTimeout(seedTO);
        seedTO = setTimeout(()=>{ if(root.getAttribute('data-floaters')==='on' && !REDUCE) seedFloaters(); }, 200);
      });
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


