<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="v1095" data-theme="ink" data-motion="on" data-mode="orbits" role="region" aria-label="Aether Observatory">
  <style>
    /* Aether Observatory â€” v1095 (aggressive shift) */
    #v1095 {
      --r: 28px;

      /* Ink (default) */
      --bg0: #06080f;
      --bg1: #0b1022;
      --fg: #eff6ff;
      --muted: rgba(239,246,255,0.78);
      --line: rgba(255,255,255,0.12);

      /* Lumen palette */
      --c1: #79ffe1;
      --c2: #6d84ff;
      --c3: #ff8fc7;
      --c4: #ffd36e;

      position: relative;
      color: var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro Text", Segoe UI, Roboto, Inter, "Helvetica Neue", Arial;
      min-height: 760px;
      border-radius: var(--r);
      overflow: hidden;
      background:
        radial-gradient(1200px 900px at 20% 15%, color-mix(in oklab, var(--c1), transparent 92%), transparent 60%),
        radial-gradient(1200px 900px at 85% 85%, color-mix(in oklab, var(--c3), transparent 92%), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      box-shadow: 0 42px 120px rgba(0,0,0,0.65), inset 0 0 0 1px rgba(255,255,255,0.06);
      isolation: isolate;
    }
    #v1095[data-theme="pearl"] {
      --bg0: #f7fbff;
      --bg1: #edf3ff;
      --fg: #0b1021;
      --muted: rgba(11,16,33,0.72);
      --line: rgba(11,16,33,0.12);
      --c1: #28d6be;
      --c2: #4a77ff;
      --c3: #ff76a9;
      --c4: #ffc857;
      background:
        radial-gradient(1000px 800px at 20% 20%, color-mix(in oklab, var(--c1), transparent 90%), transparent 60%),
        radial-gradient(1000px 800px at 80% 80%, color-mix(in oklab, var(--c3), transparent 90%), transparent 60%),
        linear-gradient(180deg, #ffffff, var(--bg1) 40%, var(--bg0));
      box-shadow: 0 28px 60px rgba(11,16,33,0.15), inset 0 0 0 1px rgba(11,16,33,0.08);
    }

    #v1095 .scene {
      position: relative;
      min-height: 760px;
      border-radius: inherit;
      overflow: hidden;
    }
    #v1095 canvas.canvas {
      position: absolute; inset: 0;
      width: 100%; height: 100%;
      display: block;
      filter: saturate(120%) contrast(105%);
      z-index: 1;
    }

    /* Revolving halo */
    #v1095 .halo {
      position: absolute; inset: -25% -25%;
      background:
        conic-gradient(from 0deg at 50% 50%, color-mix(in oklab, var(--c2), transparent 88%), transparent 35% 65%, color-mix(in oklab, var(--c3), transparent 88%));
      mix-blend-mode: screen;
      opacity: 0.35;
      filter: blur(28px);
      animation: v1095-spin 48s linear infinite;
      z-index: 2;
      pointer-events: none;
    }
    #v1095[data-theme="pearl"] .halo { mix-blend-mode: multiply; opacity: 0.32; }

    /* Grain for tactile depth */
    #v1095 .grain {
      position: absolute; inset: 0; pointer-events: none;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.02) 0 1px, transparent 1px 2px),
        repeating-linear-gradient(90deg, rgba(0,0,0,0.02) 0 1px, transparent 1px 2px);
      mix-blend-mode: overlay; opacity: 0.25;
      z-index: 3;
    }
    #v1095[data-theme="pearl"] .grain { mix-blend-mode: multiply; opacity: 0.18; }

    /* Cursor comet */
    #v1095 .cursor {
      position: absolute; width: 18px; height: 18px;
      border-radius: 50%;
      background:
        radial-gradient(circle at 30% 30%, #fff 0 30%, color-mix(in oklab, var(--c4), transparent 20%) 30% 70%, transparent 70%),
        radial-gradient(circle at 50% 50%, color-mix(in oklab, var(--c4), white 10%), color-mix(in oklab, var(--c2), black 8%));
      box-shadow: 0 12px 30px rgba(0,0,0,0.28), 0 0 0 1px rgba(255,255,255,0.35), 0 0 60px color-mix(in oklab, var(--c2), transparent 60%);
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 6;
      mix-blend-mode: screen;
      opacity: 0.9;
    }
    #v1095[data-theme="pearl"] .cursor { mix-blend-mode: multiply; opacity: 0.85; }

    /* Panel */
    #v1095 .panel {
      position: relative;
      z-index: 5;
      width: min(720px, calc(100% - 32px));
      margin: 28px;
      margin-top: 42px;
      padding: 24px;
      border-radius: calc(var(--r) - 8px);
      background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));
      backdrop-filter: blur(16px) saturate(120%);
      -webkit-backdrop-filter: blur(16px) saturate(120%);
      box-shadow: inset 0 0 0 1px var(--line), 0 22px 48px rgba(0,0,0,0.28);
    }
    #v1095[data-theme="pearl"] .panel {
      background: linear-gradient(180deg, rgba(0,0,0,0.06), rgba(0,0,0,0.03));
      box-shadow: inset 0 0 0 1px var(--line), 0 18px 32px rgba(11,16,33,0.12);
    }

    #v1095 h1 {
      margin: 0 0 8px 0;
      font-size: clamp(36px, 6.8vw, 72px);
      line-height: 0.96;
      letter-spacing: -0.03em;
      background: conic-gradient(from 0deg at 0% 50%, var(--c1), var(--c2), var(--c3), var(--c1));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      filter: drop-shadow(0 14px 28px rgba(0,0,0,0.26));
      animation: v1095-hue 28s linear infinite;
    }
    #v1095 .lede {
      margin: 6px 0 16px 0;
      color: var(--muted);
      font-size: clamp(14px, 2vw, 18px);
      letter-spacing: 0.01em;
    }

    /* Controls */
    #v1095 .controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-bottom: 12px; }
    #v1095 .btn {
      appearance: none; border: 0; cursor: pointer;
      border-radius: 14px; padding: 10px 14px;
      font-size: 13px; font-weight: 700; letter-spacing: 0.02em;
      color: #0a1222;
      background: linear-gradient(180deg, color-mix(in oklab, var(--c1), white 44%), color-mix(in oklab, var(--c2), white 30%));
      box-shadow: 0 10px 18px rgba(0,0,0,0.18), inset 0 0 0 1px rgba(255,255,255,0.58);
      transition: transform 120ms ease, filter 220ms ease;
    }
    #v1095 .btn.ghost {
      color: var(--fg);
      background: linear-gradient(180deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06));
      box-shadow: inset 0 0 0 1px var(--line);
    }
    #v1095 .btn:hover { filter: brightness(1.06) saturate(1.08); }
    #v1095 .btn:active { transform: translateY(1px) scale(0.99); }

    #v1095 .range, #v1095 .select {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 8px 12px; border-radius: 999px;
      background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.05));
      box-shadow: inset 0 0 0 1px var(--line);
      color: var(--fg);
      font-size: 12px;
    }
    #v1095[data-theme="pearl"] .range, #v1095[data-theme="pearl"] .select { background: linear-gradient(180deg, rgba(0,0,0,0.05), rgba(0,0,0,0.03)); }

    #v1095 input[type="range"] {
      -webkit-appearance: none; appearance: none; width: 200px; height: 4px;
      background: linear-gradient(90deg, var(--c1), var(--c2), var(--c3));
      border-radius: 999px; outline: none; cursor: pointer;
    }
    #v1095 input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none; width: 16px; height: 16px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 35%, color-mix(in oklab, var(--c2), transparent 15%) 35% 70%, transparent 70%);
      border: 1px solid rgba(255,255,255,0.6);
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
    }
    #v1095 input[type="range"]::-moz-range-thumb {
      width: 16px; height: 16px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 35%, color-mix(in oklab, var(--c2), transparent 15%) 35% 70%, transparent 70%);
      border: 1px solid rgba(255,255,255,0.6);
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
    }

    #v1095 .meta {
      display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center;
      margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--line);
      color: var(--muted); font-size: 12.5px;
    }
    #v1095 .live { display: inline-flex; align-items: center; gap: 8px; }
    #v1095 .pulse {
      width: 10px; height: 10px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 25%, color-mix(in oklab, var(--c1), transparent 25%) 25% 70%, transparent 70%);
      box-shadow: 0 0 12px color-mix(in oklab, var(--c1), transparent 55%);
      animation: v1095-breathe 3s ease-in-out infinite;
    }

    /* Corner badge */
    #v1095 .badge {
      position: absolute; right: 16px; top: 16px; z-index: 5;
      padding: 8px 10px; border-radius: 999px;
      font-size: 11px; letter-spacing: 0.06em; text-transform: uppercase; font-weight: 700;
      color: var(--fg);
      background: linear-gradient(180deg, rgba(255,255,255,0.14), rgba(255,255,255,0.06));
      box-shadow: inset 0 0 0 1px var(--line);
      backdrop-filter: blur(8px);
    }

    /* Keyframes */
    @keyframes v1095-hue { to { filter: hue-rotate(360deg) drop-shadow(0 14px 28px rgba(0,0,0,0.26)); } }
    @keyframes v1095-spin { to { transform: rotate(360deg); } }
    @keyframes v1095-breathe { 0%,100% { transform: scale(1); filter: saturate(1); } 50% { transform: scale(1.2); filter: saturate(1.2); } }

    /* Motion respect */
    @media (prefers-reduced-motion: reduce) {
      #v1095 * { animation: none !important; transition: none !important; }
    }
    #v1095[data-motion="off"] * { animation-play-state: paused !important; transition: none !important; }
  </style>

  <div class="scene" id="v1095-scene">
    <canvas id="v1095-canvas" class="canvas" aria-label="Aether field"></canvas>
    <div class="halo" aria-hidden="true"></div>
    <div class="grain" aria-hidden="true"></div>

    <section class="panel" aria-label="Controls and description">
      <h1>Aether Observatory</h1>
      <p class="lede" id="v1095-lede">Orbits and ribbons of light. Touch the field to stir it.</p>

      <div class="controls" aria-label="Controls">
        <button class="btn" id="v1095-theme" aria-pressed="false" title="Toggle theme">Switch to Pearl</button>
        <button class="btn ghost" id="v1095-motion" aria-pressed="true" title="Toggle motion">Motion: On</button>
        <button class="btn ghost" id="v1095-mode" title="Switch visual mode">Mode: Orbits</button>
        <button class="btn" id="v1095-recolor" title="Recolor the field">Recolor</button>
        <div class="range" title="Intensity">
          Intensity
          <input id="v1095-intensity" type="range" min="0" max="2" step="0.02" value="1" aria-label="Intensity">
        </div>
      </div>

      <div class="meta">
        <div class="live"><span class="pulse" aria-hidden="true"></span>Live rendering</div>
        <span id="last-updated">Last updated: 2025-12-05 16:17:06 EST</span>
      </div>
    </section>

    <div class="badge" aria-hidden="true">v1095</div>
    <div class="cursor" id="v1095-cursor" aria-hidden="true"></div>
  </div>

  <script>
    (function(){
      const root = document.getElementById('v1095');
      const scene = document.getElementById('v1095-scene');
      const canvas = document.getElementById('v1095-canvas');
      const ctx = canvas.getContext('2d');

      const themeBtn = document.getElementById('v1095-theme');
      const motionBtn = document.getElementById('v1095-motion');
      const modeBtn = document.getElementById('v1095-mode');
      const recolorBtn = document.getElementById('v1095-recolor');
      const intensityInput = document.getElementById('v1095-intensity');
      const cursor = document.getElementById('v1095-cursor');
      const lede = document.getElementById('v1095-lede');
      const updated = document.getElementById('last-updated');

      // Last updated (viewer locale)
      try {
        const dtf = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'medium', timeZoneName: 'short' });
        updated.textContent = 'Last updated: ' + dtf.format(new Date());
      } catch {
        updated.textContent = 'Last updated: ' + new Date().toLocaleString();
      }

      // Daylight hint
      const hour = new Date().getHours();
      if (hour >= 7 && hour < 18) {
        root.dataset.theme = 'pearl';
        themeBtn.textContent = 'Switch to Ink';
        themeBtn.setAttribute('aria-pressed','true');
        lede.textContent = 'Daylight mode engaged. Touch the field to stir it.';
      }

      // Palettes (c1..c4)
      const palettes = [
        ['#79ffe1','#6d84ff','#ff8fc7','#ffd36e'],
        ['#31dfc5','#4b79ff','#ff77a7','#ffc857'],
        ['#86ffc9','#a7b2ff','#ff9ecf','#ffe07a'],
        ['#9ef3a1','#63d5ff','#a887ff','#ffbd6e'],
        ['#ffc3a0','#a7f0ff','#c8ffa8','#ff92c2']
      ];
      function setPalette([a,b,c,d]){
        root.style.setProperty('--c1', a);
        root.style.setProperty('--c2', b);
        root.style.setProperty('--c3', c);
        root.style.setProperty('--c4', d);
        makeGradients();
      }

      // Size
      let w=0,h=0,dpr=1;
      function resize(){
        dpr = Math.min(2, window.devicePixelRatio || 1);
        w = scene.clientWidth|0;
        h = scene.clientHeight|0;
        canvas.width = Math.max(1, Math.floor(w*dpr));
        canvas.height = Math.max(1, Math.floor(h*dpr));
        ctx.setTransform(dpr,0,0,dpr,0,0);
        makeGradients();
        seed();
      }
      window.addEventListener('resize', resize, { passive:true });

      // Gradients
      let gLine=null, gRad=null;
      function makeGradients(){
        if (!w || !h) return;
        gLine = ctx.createLinearGradient(0,0,w,0);
        const s = getComputedStyle(root);
        const c1 = s.getPropertyValue('--c1').trim();
        const c2 = s.getPropertyValue('--c2').trim();
        const c3 = s.getPropertyValue('--c3').trim();
        const c4 = s.getPropertyValue('--c4').trim();
        gLine.addColorStop(0, c1);
        gLine.addColorStop(0.33, c2);
        gLine.addColorStop(0.66, c3);
        gLine.addColorStop(1, c4);
        gRad = ctx.createRadialGradient(w*0.5,h*0.5,0,w*0.5,h*0.5,Math.hypot(w,h)*0.5);
        gRad.addColorStop(0, c1);
        gRad.addColorStop(0.6, c2);
        gRad.addColorStop(1, c3);
      }

      // Pointer
      const pointer = { x: w*0.5, y: h*0.5, tx: w*0.5, ty: h*0.5 };
      scene.addEventListener('pointermove', (e)=>{
        const r = scene.getBoundingClientRect();
        pointer.tx = e.clientX - r.left;
        pointer.ty = e.clientY - r.top;
        ripple(pointer.tx, pointer.ty, 0.8);
      });
      scene.addEventListener('pointerdown', (e)=>{
        const r = scene.getBoundingClientRect();
        const x = e.clientX - r.left, y = e.clientY - r.top;
        ripple(x, y, 1.6);
        linesBlink();
      });
      scene.addEventListener('pointerleave', ()=>{
        pointer.tx = w*0.5; pointer.ty = h*0.5;
      });

      // Controls
      if ((typeof matchMedia!=='undefined') && matchMedia('(prefers-reduced-motion: reduce)').matches) {
        root.dataset.motion = 'off';
        motionBtn.textContent = 'Motion: Off';
        motionBtn.setAttribute('aria-pressed','false');
      }
      motionBtn.addEventListener('click', ()=>{
        const on = root.dataset.motion !== 'off';
        root.dataset.motion = on ? 'off' : 'on';
        motionBtn.textContent = 'Motion: ' + (on ? 'Off' : 'On');
        motionBtn.setAttribute('aria-pressed', String(!on));
      });

      themeBtn.addEventListener('click', ()=>{
        const pearl = root.dataset.theme === 'pearl';
        root.dataset.theme = pearl ? 'ink' : 'pearl';
        themeBtn.textContent = pearl ? 'Switch to Pearl' : 'Switch to Ink';
        makeGradients();
      });

      modeBtn.addEventListener('click', ()=>{
        const mode = root.dataset.mode === 'orbits' ? 'aurora' : 'orbits';
        root.dataset.mode = mode;
        modeBtn.textContent = 'Mode: ' + (mode.charAt(0).toUpperCase() + mode.slice(1));
        seed();
      });

      recolorBtn.addEventListener('click', ()=>{
        setPalette(palettes[Math.floor(Math.random()*palettes.length)]);
        seed();
        ripple(pointer.x, pointer.y, 1.2);
      });

      let intensity = parseFloat(intensityInput.value || '1');
      intensityInput.addEventListener('input', ()=> intensity = parseFloat(intensityInput.value || '1'));

      window.addEventListener('keydown', (e)=>{
        if (e.code === 'Space') { e.preventDefault(); ripple(pointer.x, pointer.y, 2); }
        if (e.code === 'ArrowRight') intensityInput.value = Math.min(2, (+intensityInput.value + 0.1)).toFixed(2), intensity = parseFloat(intensityInput.value);
        if (e.code === 'ArrowLeft') intensityInput.value = Math.max(0, (+intensityInput.value - 0.1)).toFixed(2), intensity = parseFloat(intensityInput.value);
        if (e.code === 'KeyM') modeBtn.click();
        if (e.code === 'KeyT') themeBtn.click();
      });

      // Model
      let orbits = [], ribbons = [];
      function seed(){
        orbits = [];
        const cx = w*0.5, cy = h*0.5;
        const count = Math.max(8, Math.min(28, Math.floor(Math.hypot(w,h)/120)));
        for (let i=0;i<count;i++){
          const t = i/(count-1 || 1);
          orbits.push({
            a: 40 + t * Math.min(w,h)*0.45,
            b: 30 + t * Math.min(w,h)*0.35,
            rot: Math.random()*Math.PI,
            speed: (0.2 + t*0.8) * (Math.random()*0.6 + 0.7),
            phase: Math.random()*Math.PI*2,
            glow: 0.2 + t*0.8
          });
        }

        ribbons = [];
        const strips = 6;
        for (let i=0;i<strips;i++){
          const base = (i+1)/(strips+1) * h;
          ribbons.push({
            y0: base,
            a1: 24 + Math.random()*28,
            a2: 14 + Math.random()*18,
            f1: 0.0025 + Math.random()*0.0025,
            f2: 0.009 + Math.random()*0.0035,
            ph: Math.random()*Math.PI*2,
            w: 8 + Math.random()*22
          });
        }
      }

      // Ripples
      const ripples = [];
      function ripple(x,y,amp){
        ripples.push({ x, y, t: 0, amp: amp, life: 1.0 });
        if (ripples.length > 18) ripples.shift();
        const lines = [
          'Gravity is a gentle suggestion.',
          'Light prefers curves.',
          'Orbits whisper when you listen.',
          'Touch makes the cosmos curious.',
          'Patterns bloom where patience is.'
        ];
        lede.textContent = lines[Math.floor(Math.random()*lines.length)];
      }

      // Occasional line blink accent
      let blinkT = 0;
      function linesBlink(){ blinkT = 1; }

      // Draw
      function draw(ts){
        ctx.clearRect(0,0,w,h);
        // cursor easing
        pointer.x += (pointer.tx - pointer.x)*0.12;
        pointer.y += (pointer.ty - pointer.y)*0.12;
        cursor.style.left = pointer.x + 'px';
        cursor.style.top = pointer.y + 'px';

        // ripples advance
        for (let i = ripples.length-1; i >= 0; i--){
          const r = ripples[i];
          r.t += 0.02 * intensity;
          r.life *= 0.986;
          r.amp *= 0.985;
          if (r.life < 0.05) ripples.splice(i,1);
        }
        if (blinkT > 0) blinkT *= 0.92;

        if (root.dataset.mode === 'orbits') {
          const cx = w*0.5, cy = h*0.5;
          const comp = root.dataset.theme === 'pearl' ? 'multiply' : 'lighter';
          ctx.globalCompositeOperation = comp;

          // Soft background glow
          ctx.globalAlpha = 0.30;
          ctx.fillStyle = gRad;
          ctx.beginPath();
          ctx.arc(cx, cy, Math.min(w,h)*0.42, 0, Math.PI*2);
          ctx.fill();

          // Orbits
          ctx.lineWidth = 1.1;
          for (let i=0;i<orbits.length;i++){
            const o = orbits[i];
            const t = ts*0.001 * o.speed * intensity;
            const rot = o.rot + Math.sin(t*0.2)*0.15;

            // path
            ctx.save();
            ctx.translate(cx, cy);
            ctx.rotate(rot);
            ctx.strokeStyle = gLine;
            ctx.globalAlpha = 0.55;
            ctx.beginPath();
            for (let a=0; a<=Math.PI*2; a += 0.02){
              // Ripple influence
              let rr = 0;
              for (const r of ripples){
                const px = cx + Math.cos(a)*(o.a);
                const py = cy + Math.sin(a)*(o.b);
                const d = Math.hypot(px - r.x, py - r.y);
                rr += Math.sin(d*0.06 - r.t*10) * Math.exp(-d*0.012) * r.amp * 6;
              }
              const x = (o.a + rr*0.2) * Math.cos(a);
              const y = (o.b + rr*0.1) * Math.sin(a);
              if (a===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
            }
            ctx.closePath();
            ctx.stroke();

            // Node
            const angle = t + o.phase;
            const nx = Math.cos(angle)*o.a;
            const ny = Math.sin(angle)*o.b;
            const dx = (cx + nx) - pointer.x;
            const dy = (cy + ny) - pointer.y;
            const pd = Math.hypot(dx,dy)+0.0001;
            const pull = 8 * Math.exp(-pd*0.01);

            ctx.globalAlpha = 0.9;
            const dotX = nx - dx/pd*pull;
            const dotY = ny - dy/pd*pull;

            // glow trail
            ctx.strokeStyle = getComputedStyle(root).getPropertyValue('--c4').trim();
            ctx.lineWidth = 2.2;
            ctx.globalAlpha = 0.18 + o.glow*0.08 + (blinkT*0.2);
            ctx.beginPath();
            ctx.arc(0,0,o.a, angle-0.2, angle);
            ctx.stroke();

            // dot
            ctx.globalAlpha = 0.85;
            ctx.fillStyle = getComputedStyle(root).getPropertyValue('--c4').trim();
            ctx.beginPath();
            ctx.arc(dotX, dotY, 2.2 + o.glow*0.8, 0, Math.PI*2);
            ctx.fill();

            ctx.restore();
          }

          // Attraction lines to pointer (subtle)
          ctx.globalAlpha = 0.12 + blinkT*0.3;
          ctx.strokeStyle = gLine;
          ctx.lineWidth = 1.0;
          ctx.beginPath();
          ctx.moveTo(cx, cy);
          ctx.lineTo(pointer.x, pointer.y);
          ctx.stroke();

          ctx.globalAlpha = 1;
          ctx.globalCompositeOperation = 'source-over';
        } else {
          // Aurora mode
          const comp = root.dataset.theme === 'pearl' ? 'multiply' : 'lighter';
          ctx.globalCompositeOperation = comp;
          const time = ts*0.001;

          for (let i=0;i<ribbons.length;i++){
            const rb = ribbons[i];
            const wStroke = rb.w + Math.sin(time*1.2 + i)*4 + intensity*4;
            ctx.lineWidth = wStroke;
            ctx.globalAlpha = 0.45;
            ctx.strokeStyle = gLine;

            ctx.beginPath();
            let first = true;
            const stepX = Math.max(6, Math.min(14, Math.floor(w/90)));
            for (let x=0; x<=w; x+= stepX){
              const base = rb.y0
                + rb.a1 * Math.sin(x*rb.f1 + time*1.6*intensity + rb.ph)
                + rb.a2 * Math.sin(x*rb.f2 - time*2.2*intensity);

              // pointer field
              const dx = x - pointer.x;
              const dy = rb.y0 - pointer.y;
              const dist = Math.hypot(dx,dy) + 0.0001;
              const pull = 22 * Math.exp(-dist*0.006);

              // ripples
              let ry = 0;
              for (const r of ripples){
                const ddx = x - r.x;
                const ddy = rb.y0 - r.y;
                const d = Math.hypot(ddx, ddy);
                const wave = Math.sin(d*0.06 - r.t*10) * Math.exp(-d*0.013) * r.amp * 7;
                ry += wave;
              }

              const y = base + ry + pull * Math.sign(dy);
              if (first) { ctx.moveTo(x, y); first=false; } else { ctx.lineTo(x, y); }
            }
            ctx.stroke();

            // soft highlight sweep
            ctx.globalAlpha = 0.16 + blinkT*0.1;
            ctx.lineWidth = Math.max(2, wStroke*0.35);
            ctx.strokeStyle = getComputedStyle(root).getPropertyValue('--c4').trim();
            const phase = (Math.sin((i*0.41) + time*0.8*intensity) * 0.5 + 0.5) * w;
            ctx.beginPath();
            ctx.moveTo(Math.max(0, phase-60), rb.y0);
            ctx.lineTo(Math.min(w, phase+120), rb.y0);
            ctx.stroke();
          }

          ctx.globalAlpha = 1;
          ctx.globalCompositeOperation = 'source-over';
        }
      }

      // RAF
      let raf=0;
      function frame(ts){
        if (root.dataset.motion !== 'off') draw(ts);
        raf = requestAnimationFrame(frame);
      }

      // Init
      resize();
      setPalette([getComputedStyle(root).getPropertyValue('--c1').trim(), getComputedStyle(root).getPropertyValue('--c2').trim(), getComputedStyle(root).getPropertyValue('--c3').trim(), getComputedStyle(root).getPropertyValue('--c4').trim()]);
      seed();
      raf = requestAnimationFrame(frame);
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


