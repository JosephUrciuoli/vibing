<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="vibe65" data-theme="night" data-palette="aurora" aria-label="Hologram Atrium">
  <style>
    .vibe65 {
      /* Theme tokens */
      --ink: #eaf0ff;
      --muted: #a9b4cf;
      --line: rgba(255,255,255,0.14);

      /* Accent set (palette-switched) */
      --a1: #22d3ee; /* aurora cyan */
      --a2: #60a5fa; /* aurora blue */
      --a3: #a78bfa; /* aurora violet */
      --glow-a: #94e7ff;
      --glow-b: #c4b8ff;

      /* Surface */
      --bg0: #05070c;
      --bg1: #0b1020;

      /* Motion */
      --mx: 50%;
      --my: 50%;

      position: relative;
      border-radius: 36px;
      overflow: hidden;
      min-height: 680px;
      display: grid;
      place-items: center;
      color: var(--ink);
      background:
        radial-gradient(1400px 1000px at var(--mx) var(--my), rgba(96,165,250,0.18), transparent 60%),
        radial-gradient(1000px 800px at 0% 100%, rgba(34,211,238,0.10), transparent 70%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      box-shadow: 0 40px 100px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.06);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
      isolation: isolate;
    }

    /* Light theme */
    .vibe65[data-theme="day"] {
      --ink: #0c0f14;
      --muted: #4d566b;
      --line: rgba(12,15,20,0.14);
      --bg0: #f7f9ff;
      --bg1: #eef2ff;
      background:
        radial-gradient(1200px 900px at var(--mx) var(--my), rgba(99,102,241,0.18), transparent 60%),
        radial-gradient(900px 700px at 100% 0%, rgba(16,185,129,0.10), transparent 70%),
        linear-gradient(180deg, #ffffff, var(--bg1));
      box-shadow: 0 30px 80px rgba(0,0,0,0.18), inset 0 1px 0 rgba(255,255,255,0.6);
    }

    /* Palettes */
    .vibe65[data-palette="aurora"] { --a1:#22d3ee; --a2:#60a5fa; --a3:#a78bfa; --glow-a:#9bf3ff; --glow-b:#d2c7ff; }
    .vibe65[data-palette="citrus"] { --a1:#f59e0b; --a2:#ef4444; --a3:#84cc16; --glow-a:#ffd4a3; --glow-b:#ffcaca; }
    .vibe65[data-palette="iris"]   { --a1:#8b5cf6; --a2:#ec4899; --a3:#22d3ee; --glow-a:#cbbcff; --glow-b:#ffb3df; }

    /* Atmospheric veil */
    .vibe65::before {
      content: "";
      position: absolute; inset: -30%;
      background:
        conic-gradient(from 0deg at 50% 50%, color-mix(in srgb, var(--a1), transparent 85%), color-mix(in srgb, var(--a2), transparent 85%), color-mix(in srgb, var(--a3), transparent 85%), color-mix(in srgb, var(--a1), transparent 85%));
      filter: blur(80px) saturate(140%);
      opacity: .22;
      mix-blend-mode: screen;
      animation: v65_drift 60s linear infinite;
      pointer-events: none;
    }
    .vibe65::after {
      content: "";
      position: absolute; inset: 0;
      background:
        repeating-linear-gradient(90deg, rgba(255,255,255,0.03) 0 1px, transparent 1px 72px),
        repeating-linear-gradient(0deg, rgba(255,255,255,0.02) 0 1px, transparent 1px 72px);
      opacity: .25;
      mix-blend-mode: overlay;
      pointer-events: none;
    }

    /* Canvas sky */
    .vibe65 .sky {
      position: absolute; inset: 0;
      z-index: 0; pointer-events: none;
      filter: blur(0.2px) saturate(120%);
      opacity: .9;
      mix-blend-mode: screen;
    }
    .vibe65[data-theme="day"] .sky { mix-blend-mode: multiply; opacity: .7; }

    .vibe65 .frame { position: relative; z-index: 2; width: min(1080px, 92vw); padding: clamp(22px, 4vw, 44px); }

    /* Header */
    .vibe65 .mast .badge {
      display: inline-flex; gap: 10px; align-items: center;
      padding: 8px 12px; border-radius: 999px; font-weight: 700; letter-spacing: .02em;
      color: var(--muted);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border: 1px solid var(--line);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.12);
    }
    .vibe65[data-theme="day"] .mast .badge {
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .vibe65 .mast .badge::before {
      content: "";
      width: 9px; height: 9px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--a1), transparent 60%);
      box-shadow: 0 0 14px var(--a1);
    }
    .vibe65 h1 {
      margin: 14px 0 8px;
      font: 900 clamp(46px, 10vw, 120px)/1.02 ui-serif, Georgia, Cambria, "Times New Roman", Times, serif;
      letter-spacing: -0.02em;
      position: relative;
      color: transparent;
      background: linear-gradient(120deg, var(--a1), var(--a2), var(--a3), var(--a1));
      background-size: 200% 200%;
      -webkit-background-clip: text; background-clip: text;
      animation: v65_shimmer 8s ease-in-out infinite;
      filter: drop-shadow(0 6px 28px color-mix(in srgb, var(--glow-a), #ffffff 8%));
    }
    .vibe65 .sub {
      margin: 0 0 20px 0; max-width: 68ch;
      font-size: clamp(14px, 2.1vw, 20px); color: color-mix(in srgb, var(--ink), #000 25%);
    }

    /* Stage */
    .vibe65 .stage {
      position: relative; margin-top: 10px;
      display: grid; place-items: center;
      perspective: 1200px; transform-style: preserve-3d;
    }
    .vibe65 .halo {
      --size: min(74vmin, 720px);
      width: var(--size); aspect-ratio: 1 / 1; border-radius: 50%;
      position: relative;
      background:
        radial-gradient(closest-side, rgba(255,255,255,0.08), rgba(255,255,255,0.02) 60%, transparent 61%),
        radial-gradient(circle at var(--mx) var(--my), color-mix(in srgb, var(--a1), transparent 80%), transparent 60%);
      border: 1px solid var(--line);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.04),
        0 28px 80px rgba(0,0,0,0.55);
      overflow: hidden;
      transform: rotateX(calc((50% - var(--my)) * 0.12)) rotateY(calc((var(--mx) - 50%) * 0.12));
      transition: box-shadow .3s ease;
    }

    /* Tick ring */
    .vibe65 .halo .ticks, .vibe65 .halo .sweep {
      position: absolute; inset: 0; border-radius: 50%;
      -webkit-mask: radial-gradient(closest-side, transparent calc(100% - 14px), #000 0);
              mask: radial-gradient(closest-side, transparent calc(100% - 14px), #000 0);
      pointer-events: none;
    }
    .vibe65 .halo .ticks {
      background:
        conic-gradient(from 0deg,
          rgba(255,255,255,0.16) 0 2deg, transparent 2deg 6deg);
      background-size: 100% 100%;
      filter: drop-shadow(0 0 6px rgba(255,255,255,0.08));
      opacity: .6;
    }
    .vibe65 .halo .sweep {
      background:
        conic-gradient(from 0deg at 50% 50%,
          color-mix(in srgb, var(--a2), transparent 70%) 0deg,
          color-mix(in srgb, var(--a3), transparent 98%) 70deg,
          transparent 90deg 360deg);
      animation: v65_sweep 9s linear infinite;
      opacity: .9;
      mix-blend-mode: screen;
      filter: blur(1px);
    }
    .vibe65[data-theme="day"] .halo .sweep { mix-blend-mode: multiply; }

    /* Orbs */
    .vibe65 .orb {
      position: absolute; left: 50%; top: 50%;
      transform: translate(-50%, -50%);
      width: clamp(26px, 3.8vmin, 42px); height: clamp(26px, 3.8vmin, 42px);
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.35);
      box-shadow:
        0 10px 30px rgba(0,0,0,0.35),
        0 0 0 6px color-mix(in srgb, var(--a1), transparent 92%);
      background: radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,0.6) 30%, transparent 60%),
                  linear-gradient(135deg, var(--a1), var(--a2));
      color: #0c0f14;
      display: grid; place-items: center;
      font-weight: 800; font-size: 10px; letter-spacing: .06em; text-transform: uppercase;
      cursor: pointer;
      transition: transform .15s ease, box-shadow .25s ease, background .25s ease;
    }
    .vibe65[data-theme="day"] .orb { border-color: rgba(0,0,0,0.2); }
    .vibe65 .orb:focus-visible { outline: 2px solid color-mix(in srgb, var(--a2), #fff 30%); outline-offset: 2px; }
    .vibe65 .orb:hover { box-shadow: 0 14px 38px rgba(0,0,0,0.4), 0 0 0 10px color-mix(in srgb, var(--a2), transparent 90%); }

    /* Readouts */
    .vibe65 .readouts {
      position: absolute; bottom: 8%; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;
      width: 100%; padding: 0 20px;
    }
    .vibe65 .chip {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border-radius: 999px; font-size: 12px; color: var(--muted);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      border: 1px solid var(--line);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.12);
    }
    .vibe65[data-theme="day"] .chip {
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .vibe65 .chip .dot {
      width: 8px; height: 8px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--a1), transparent 60%);
      box-shadow: 0 0 10px var(--a1);
    }

    /* Controls */
    .vibe65 .controls {
      margin-top: 18px;
      display: flex; flex-wrap: wrap; gap: 12px; align-items: center;
    }
    .vibe65 .btn {
      appearance: none; border: 0; cursor: pointer; font-weight: 900; letter-spacing: .02em;
      border-radius: 14px; padding: 12px 16px; color: #0c0f14;
      background: linear-gradient(135deg, var(--a1), var(--a2));
      box-shadow: 0 14px 36px color-mix(in srgb, var(--a1), #000 60%);
      transition: transform .15s ease, box-shadow .25s ease, filter .25s ease;
    }
    .vibe65 .btn:hover { transform: translateY(-2px); }
    .vibe65 .btn.ghost {
      color: var(--ink); background: linear-gradient(180deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      border: 1px solid var(--line); box-shadow: 0 10px 22px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.12);
    }
    .vibe65[data-theme="day"] .btn.ghost {
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      box-shadow: 0 10px 22px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .vibe65 .btn:focus-visible { outline: 2px solid color-mix(in srgb, var(--a2), #fff 40%); outline-offset: 2px; }

    /* Slider */
    .vibe65 .slider {
      --track: rgba(255,255,255,0.25);
      display: inline-flex; align-items: center; gap: 10px;
      padding: 8px 12px; border-radius: 14px; color: var(--muted);
      border: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
      position: relative;
    }
    .vibe65[data-theme="day"] .slider { --track: rgba(12,15,20,0.18); background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6)); }
    .vibe65 .slider input[type="range"] {
      -webkit-appearance: none; appearance: none; width: 200px; height: 26px; background: transparent;
    }
    .vibe65 .slider input[type="range"]::-webkit-slider-runnable-track,
    .vibe65 .slider input[type="range"]::-moz-range-track {
      height: 6px; border-radius: 999px; background: var(--track);
    }
    .vibe65 .slider input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none; width: 18px; height: 18px; margin-top: -6px;
      border-radius: 50%; background: var(--a1);
      border: 2px solid rgba(255,255,255,0.85);
      box-shadow: 0 3px 10px color-mix(in srgb, var(--a1), #000 40%);
    }
    .vibe65 .slider .bar {
      position: absolute; left: 86px; width: 0; height: 6px; border-radius: 999px;
      background: linear-gradient(90deg, var(--a1), var(--a2));
      transform: translateY(-15px);
      mix-blend-mode: screen; opacity: .95; pointer-events: none;
    }
    .vibe65[data-theme="day"] .slider .bar { mix-blend-mode: multiply; }

    /* Swatches */
    .vibe65 .swatches { display: inline-flex; gap: 8px; align-items: center; margin-left: 6px; }
    .vibe65 .swatch {
      width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.35);
      box-shadow: 0 6px 14px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.12);
      cursor: pointer; transition: transform .12s ease;
    }
    .vibe65[data-theme="day"] .swatch { border-color: rgba(0,0,0,0.2); box-shadow: 0 6px 14px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.7); }
    .vibe65 .swatch:hover { transform: translateY(-2px); }
    .vibe65 .swatch.aurora { background: linear-gradient(135deg, #22d3ee, #60a5fa, #a78bfa); }
    .vibe65 .swatch.citrus { background: linear-gradient(135deg, #f59e0b, #ef4444, #84cc16); }
    .vibe65 .swatch.iris   { background: linear-gradient(135deg, #8b5cf6, #ec4899, #22d3ee); }

    /* Meta */
    .vibe65 .meta {
      margin-top: 18px; display: flex; justify-content: space-between; align-items: center;
      gap: 12px; font-size: 12px; color: color-mix(in srgb, var(--ink), #000 30%);
      padding: 10px 14px; border-radius: 12px; border: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
    }
    .vibe65[data-theme="day"] .meta {
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
      color: color-mix(in srgb, var(--ink), #fff 6%);
    }

    /* Paused state pauses CSS animations */
    .vibe65[data-paused="true"] .sweep,
    .vibe65[data-paused="true"]::before { animation-play-state: paused; }

    /* Motion reduce */
    @media (prefers-reduced-motion: reduce) {
      .vibe65::before, .vibe65 .sweep { animation: none; }
      .vibe65 .sky { display: none; }
    }

    @keyframes v65_drift { to { transform: rotate(1turn); } }
    @keyframes v65_sweep { to { transform: rotate(1turn); } }
    @keyframes v65_shimmer { 0%,100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }

    @media (max-width: 780px) {
      .vibe65 .halo { --size: min(86vmin, 620px); }
      .vibe65 h1 { line-height: 1.04; }
      .vibe65 .readouts { bottom: 6%; }
    }
  </style>

  <canvas class="sky" aria-hidden="true"></canvas>

  <div class="frame">
    <div class="mast">
      <span class="badge">Iteration 65 â€¢ Hologram Atrium</span>
      <h1>Breathe in the Orbit</h1>
      <p class="sub">Velvet darks, iridescent lines, and calm mechanics that answer your touch.</p>
    </div>

    <div class="stage" role="region" aria-label="Orbital stage">
      <div class="halo" aria-hidden="false">
        <div class="ticks" aria-hidden="true"></div>
        <div class="sweep" aria-hidden="true"></div>

        <button class="orb" data-orb="0" aria-label="Focus"><span>F</span></button>
        <button class="orb" data-orb="1" aria-label="Flow"><span>Fl</span></button>
        <button class="orb" data-orb="2" aria-label="Play"><span>P</span></button>

        <div class="readouts" aria-hidden="false">
          <span class="chip"><span class="dot" aria-hidden="true"></span> Stable orbit</span>
          <span class="chip"><span class="dot" aria-hidden="true" style="background: radial-gradient(circle at 30% 30%, var(--a2), transparent 60%); box-shadow: 0 0 10px var(--a2);"></span> Pointer gravity</span>
          <span class="chip"><span class="dot" aria-hidden="true" style="background: radial-gradient(circle at 30% 30%, var(--a3), transparent 60%); box-shadow: 0 0 10px var(--a3);"></span> Palette morphs</span>
        </div>
      </div>
    </div>

    <div class="controls" role="group" aria-label="Controls">
      <button id="pause65" class="btn" type="button" aria-pressed="true">Pause Orbits</button>
      <button id="theme65" class="btn ghost" type="button" aria-pressed="true">Daybreak</button>

      <label class="slider" for="vel65">
        <span style="font-weight:800;color:var(--a1);">Velocity</span>
        <input id="vel65" type="range" min="0" max="100" value="60" aria-label="Orbital velocity">
        <span class="bar" aria-hidden="true"></span>

        <div class="swatches" role="group" aria-label="Palette">
          <span class="swatch aurora" title="Aurora" data-palette="aurora" tabindex="0" aria-label="Aurora palette"></span>
          <span class="swatch citrus" title="Citrus" data-palette="citrus" tabindex="0" aria-label="Citrus palette"></span>
          <span class="swatch iris" title="Iris" data-palette="iris" tabindex="0" aria-label="Iris palette"></span>
        </div>
      </label>
    </div>

    <div class="meta">
      <span class="tip">Tip: move your cursor to tilt the halo and tug the orbits. Switch palettes; try Daybreak.</span>
      <span id="last-updated">Last updated: 2025-10-19 14:22:27 EST</span>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.vibe65');
      const canvas = root.querySelector('.sky');
      const ctx = canvas.getContext('2d');
      const halo = root.querySelector('.halo');
      const orbs = Array.from(root.querySelectorAll('.orb'));
      const pauseBtn = root.querySelector('#pause65');
      const themeBtn = root.querySelector('#theme65');
      const vel = root.querySelector('#vel65');
      const bar = root.querySelector('.slider .bar');
      const swatches = Array.from(root.querySelectorAll('.swatch'));
      const updated = root.querySelector('#last-updated');

      // Update timestamp
      try {
        const d = new Date();
        const fmt = new Intl.DateTimeFormat([], { year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:false, timeZoneName:'short' });
        updated.textContent = 'Last updated: ' + fmt.format(d);
      } catch(e) {
        updated.textContent = 'Last updated: ' + new Date().toLocaleString();
      }

      // Canvas fit
      function fit(){
        const dpr = Math.min(2, window.devicePixelRatio || 1);
        const rect = root.getBoundingClientRect();
        canvas.width = Math.max(1, rect.width * dpr);
        canvas.height = Math.max(1, rect.height * dpr);
        canvas.style.width = rect.width + 'px';
        canvas.style.height = rect.height + 'px';
        ctx.setTransform(1,0,0,1,0,0);
        ctx.scale(dpr, dpr);
      }
      fit();
      window.addEventListener('resize', fit);

      // Pointer gravity + tilt
      let mx = 0.5, my = 0.5;
      function onMove(e){
        const rect = root.getBoundingClientRect();
        mx = Math.min(1, Math.max(0, (e.clientX - rect.left) / rect.width));
        my = Math.min(1, Math.max(0, (e.clientY - rect.top) / rect.height));
        root.style.setProperty('--mx', (mx*100).toFixed(2) + '%');
        root.style.setProperty('--my', (my*100).toFixed(2) + '%');
      }
      root.addEventListener('pointermove', onMove, {passive:true});
      root.addEventListener('pointerleave', () => {
        mx = 0.5; my = 0.5;
        root.style.setProperty('--mx', '50%');
        root.style.setProperty('--my', '50%');
      });

      // Orbits model
      const state = {
        t: 0,
        running: true,
        speed: +vel.value / 100
      };
      const O = [
        { r: 0.28, a: Math.random()*Math.PI*2, k: 0.8, hue: 0 }, // inner
        { r: 0.38, a: Math.random()*Math.PI*2, k: 0.55, hue: 0 }, // mid
        { r: 0.48, a: Math.random()*Math.PI*2, k: 0.35, hue: 0 }, // outer
      ];

      // Particles for the nebula
      const P = Array.from({length: 90}).map((_,i)=>({
        a: Math.random()*Math.PI*2,
        r: 40 + Math.random()*240,
        amp: 10 + Math.random()*60,
        speed: 0.004 + Math.random()*0.006,
        hue: (i*4 + 200) % 360,
        life: 0.6 + Math.random()*0.6
      }));

      function center(){
        const rect = root.getBoundingClientRect();
        return { x: rect.width * mx, y: rect.height * my };
      }

      function drawSky(){
        const w = canvas.width / (window.devicePixelRatio || 1);
        const h = canvas.height / (window.devicePixelRatio || 1);
        ctx.clearRect(0,0,w,h);
        const c = center();

        const themeNight = root.getAttribute('data-theme') !== 'day';
        ctx.globalCompositeOperation = themeNight ? 'lighter' : 'multiply';

        // Soft field glow
        const g = ctx.createRadialGradient(c.x, c.y, 10, c.x, c.y, Math.max(w,h)*0.6);
        const pal = root.getAttribute('data-palette') || 'aurora';
        const shift = pal === 'aurora' ? 60 : pal === 'citrus' ? -30 : 120;
        g.addColorStop(0, `hsla(${(220+shift)%360}, 85%, ${themeNight?65:55}%, 0.10)`);
        g.addColorStop(1, 'rgba(0,0,0,0)');
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        // Nebula particles
        for (let i=0;i<P.length;i++){
          const p = P[i];
          const k = state.t * (p.speed + state.speed*0.02);
          const rr = p.r + Math.sin(k + p.a) * p.amp;
          const ang = p.a + k*0.8;
          const x = c.x + Math.cos(ang) * rr;
          const y = c.y + Math.sin(ang) * rr;

          const grad = ctx.createRadialGradient(x, y, 0, x, y, 28);
          grad.addColorStop(0, `hsla(${(p.hue+shift)%360}, 95%, ${themeNight?70:50}%, ${0.18*p.life})`);
          grad.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.fillStyle = grad;
          ctx.beginPath();
          ctx.arc(x, y, 28, 0, Math.PI*2);
          ctx.fill();

          // subtle trails
          ctx.beginPath();
          ctx.strokeStyle = `hsla(${(p.hue+shift)%360}, 80%, ${themeNight?72:45}%, ${0.12*p.life})`;
          ctx.lineWidth = 1;
          ctx.moveTo(x, y);
          ctx.lineTo(c.x + Math.cos(ang-0.15)*rr*0.96, c.y + Math.sin(ang-0.15)*rr*0.96);
          ctx.stroke();
        }
      }

      function placeOrbs(){
        const rect = halo.getBoundingClientRect();
        const cx = rect.width/2;
        const cy = rect.height/2;
        const gravX = (mx - 0.5) * 0.6;
        const gravY = (my - 0.5) * 0.6;

        orbs.forEach((el, i) => {
          const o = O[i];
          // Spin
          o.a += (o.k + state.speed*0.8) * 0.006;
          // Radius in px relative to halo
          const R = Math.min(cx, cy) * o.r * (1 + Math.sin(state.t*0.002 + i)*0.02);
          const wobble = Math.sin(state.t*0.01 + i*1.7) * 4;

          const x = cx + Math.cos(o.a) * (R + wobble) + gravX * (40 + i*14);
          const y = cy + Math.sin(o.a) * (R + wobble) + gravY * (40 + i*14);

          const dep = 0.92 + (Math.sin(o.a) * 0.08); // fake depth scale
          el.style.transform = `translate(${x - 0.5*el.offsetWidth}px, ${y - 0.5*el.offsetHeight}px) scale(${dep.toFixed(3)})`;
        });
      }

      // Velocity bar UI
      function updateBar(){
        const pct = (+vel.value - +vel.min) / (+vel.max - +vel.min);
        bar.style.width = Math.round(pct * 200) + 'px';
      }
      vel.addEventListener('input', () => { state.speed = +vel.value / 100; updateBar(); });
      updateBar();

      // Palette switching
      function setPalette(p){ root.setAttribute('data-palette', p); }
      swatches.forEach(sw => {
        const p = sw.getAttribute('data-palette');
        const apply = () => setPalette(p);
        sw.addEventListener('click', apply);
        sw.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); apply(); } });
      });

      // Theme toggle
      themeBtn.addEventListener('click', () => {
        const isDay = root.getAttribute('data-theme') === 'day';
        if (isDay) {
          root.setAttribute('data-theme', 'night');
          themeBtn.textContent = 'Daybreak';
          themeBtn.setAttribute('aria-pressed','true');
        } else {
          root.setAttribute('data-theme', 'day');
          themeBtn.textContent = 'Nightfall';
          themeBtn.setAttribute('aria-pressed','false');
        }
      });

      // Pause
      let raf = null;
      function loop(){
        if (!state.running || window.matchMedia('(prefers-reduced-motion: reduce)').matches) { raf = null; return; }
        state.t += 0.8 + state.speed*2.2;
        drawSky();
        placeOrbs();
        raf = requestAnimationFrame(loop);
      }
      function start(){ if (!raf) raf = requestAnimationFrame(loop); }
      function stop(){ if (raf) cancelAnimationFrame(raf); raf = null; }

      pauseBtn.addEventListener('click', () => {
        state.running = !state.running;
        pauseBtn.textContent = state.running ? 'Pause Orbits' : 'Resume Orbits';
        pauseBtn.setAttribute('aria-pressed', String(state.running));
        root.setAttribute('data-paused', state.running ? 'false' : 'true');
        state.running ? start() : stop();
      });

      // Orb tap feedback
      orbs.forEach((o, i) => {
        o.addEventListener('click', () => {
          o.animate([{ boxShadow: o.style.boxShadow }, { boxShadow: '0 0 0 16px color-mix(in srgb, var(--a3), transparent 85%)' }, { boxShadow: o.style.boxShadow }], { duration: 600, easing: 'ease-out' });
        });
      });

      // Respect reduced motion
      const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
      function sync(){ if (mq.matches) stop(); else if (state.running) start(); }
      try { mq.addEventListener('change', sync); } catch(_) {}
      sync();
      if (!mq.matches) start();
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


