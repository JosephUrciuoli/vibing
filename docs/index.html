<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v1461 fountain" data-mode="serene" aria-label="LUMEN FOUNTAIN — generative aurora">
  <style>
    .v1461.fountain{
      --r: 28px;
      --ink:#0b1324;
      --muted:#5f6b86;
      --hi:#6b7cff;
      --bg1:#f7fbff;
      --bg2:#fff7ef;
      --glass: rgba(255,255,255,0.55);
      position: relative; display:grid; gap:clamp(16px,3.6vw,28px);
      grid-template-rows:auto 1fr auto;
      padding: clamp(18px,6vw,46px);
      border-radius: var(--r);
      overflow: hidden; isolation:isolate;
      color: var(--ink);
      font-family: ui-sans-serif, -apple-system, "SF Pro Display", Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(180% 120% at 100% -20%, rgba(255,180,160,0.20), transparent 60%),
        radial-gradient(140% 120% at -20% 120%, rgba(160,210,255,0.22), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.75),
        0 50px 160px rgba(0,0,0,0.14);
    }
    .v1461.fountain[data-mode="vivid"]{
      --ink:#eaf2ff;
      --muted:#a9b6d8;
      --hi:#86e7ff;
      --bg1:#0a0f1a;
      --bg2:#182036;
      --glass: rgba(16,20,36,0.6);
      color-scheme: dark;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.05),
        0 60px 180px rgba(0,0,0,0.55);
    }
    .v1461.fountain::before{
      content:""; position:absolute; inset:-30% -40% -30% -40%; z-index:0; pointer-events:none;
      background:
        conic-gradient(from 0deg, rgba(255,255,255,0.08), transparent 14% 16%, rgba(255,255,255,0.06) 17% 22%, transparent 23% 100%);
      filter: blur(80px) saturate(120%);
      animation: v1461-sweep 40s linear infinite;
      mix-blend-mode: soft-light;
    }
    @keyframes v1461-sweep{ to{ transform: rotate(360deg) } }

    /* Mast */
    .v1461 .mast{ position:relative; z-index:2; display:grid; grid-template-columns: 1fr auto; gap:clamp(12px,3vw,22px); align-items:end; }
    .v1461 .brand{ display:flex; align-items:center; gap:14px; min-width:0; }
    .v1461 .glyph{
      width:74px; height:74px; border-radius:22px; position:relative; overflow:hidden; display:grid; place-items:center;
      background: linear-gradient(135deg, rgba(255,255,255,0.65), rgba(255,255,255,0.10));
      border:1px solid rgba(0,0,0,0.08);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.85),
        inset 0 -40px 60px rgba(255,255,255,0.35),
        0 18px 48px rgba(0,0,0,0.10);
    }
    .v1461[data-mode="vivid"] .glyph{
      background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.04));
      border-color: rgba(255,255,255,0.12);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.06),
        0 18px 48px rgba(0,0,0,0.35);
    }
    .v1461 .glyph::before, .v1461 .glyph::after{
      content:""; position:absolute; inset:18% 18%; border-radius:50%;
      background: conic-gradient(from 0deg, #8fd7ff, #c49bff, #ffc39a, #8fd7ff);
      filter: blur(8px) saturate(140%); mix-blend-mode: screen; animation: v1461-gyro 7s linear infinite;
    }
    .v1461 .glyph::after{ inset:28% 24%; filter: blur(12px) saturate(160%); animation-direction: reverse; opacity:.9; }
    @keyframes v1461-gyro{ to{ transform: rotate(360deg) } }

    .v1461 .title{
      margin:0; font-weight:900; letter-spacing:-0.02em; line-height:.9;
      font-size: clamp(34px, 9vw, 100px);
      background: linear-gradient(100deg, currentColor, color-mix(in oklab, var(--hi) 85%, currentColor 15%) 55%, #ffb6e3);
      -webkit-background-clip: text; background-clip:text; color:transparent;
      text-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }
    .v1461 .sub{ margin:.4rem 0 0; font-size:13px; letter-spacing:.25px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    /* Controls */
    .v1461 .controls{ display:flex; flex-wrap:wrap; justify-content:flex-end; align-items:center; gap:10px; }
    .v1461 .chip, .v1461 .slider{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:18px;
      background: var(--glass);
      border:1px solid rgba(0,0,0,0.08);
      color:var(--ink); font-weight:800; font-size:12px; letter-spacing:.25px;
      user-select:none; cursor:pointer; -webkit-tap-highlight-color: transparent;
      transition: transform .2s ease, box-shadow .25s ease, background .25s ease, border-color .25s ease, color .25s ease;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.9), 0 10px 24px rgba(0,0,0,0.10);
      backdrop-filter: blur(10px) saturate(130%);
    }
    .v1461[data-mode="vivid"] .chip, .v1461[data-mode="vivid"] .slider{
      background: var(--glass);
      border-color: rgba(255,255,255,0.12);
      color:var(--ink);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), 0 12px 30px rgba(0,0,0,0.35);
    }
    .v1461 .chip:hover{ transform: translateY(-1px) }
    .v1461 .chip[aria-pressed="true"]{
      background: linear-gradient(180deg, color-mix(in oklab, var(--hi) 35%, transparent) 0%, transparent 100%), var(--glass);
      border-color: color-mix(in oklab, var(--hi) 60%, transparent);
      box-shadow: 0 16px 36px color-mix(in oklab, var(--hi) 25%, transparent), inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .v1461 .slider{ padding:8px 12px; }
    .v1461 input[type="range"]{
      -webkit-appearance:none; appearance:none; width:140px; height:24px; background:transparent;
    }
    .v1461 input[type="range"]::-webkit-slider-runnable-track{
      height:8px; border-radius:999px;
      background: linear-gradient(90deg, rgba(0,0,0,0.12), var(--hi));
      border:1px solid rgba(0,0,0,0.08);
    }
    .v1461[data-mode="vivid"] input[type="range"]::-webkit-slider-runnable-track{
      background: linear-gradient(90deg, rgba(255,255,255,0.15), var(--hi));
      border-color: rgba(255,255,255,0.15);
    }
    .v1461 input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; margin-top:-6px; width:20px; height:20px; border-radius:50%;
      border:1px solid rgba(0,0,0,0.10);
      background: radial-gradient(circle at 30% 30%, #fff, #eef2ff);
      box-shadow: 0 8px 18px rgba(13,20,41,0.15);
      cursor:pointer;
    }
    .v1461[data-mode="vivid"] input[type="range"]::-webkit-slider-thumb{
      border-color: rgba(255,255,255,0.25);
      background: radial-gradient(circle at 30% 30%, #eef4ff, #cfd9ff);
    }
    .v1461 input[type="range"]::-moz-range-track{
      height:8px; border-radius:999px; background: linear-gradient(90deg, rgba(0,0,0,0.10), var(--hi));
      border:1px solid rgba(0,0,0,0.08);
    }
    .v1461[data-mode="vivid"] input[type="range"]::-moz-range-track{
      background: linear-gradient(90deg, rgba(255,255,255,0.15), var(--hi));
      border-color: rgba(255,255,255,0.15);
    }
    .v1461 input[type="range"]::-moz-range-thumb{
      width:20px; height:20px; border-radius:50%; border:1px solid rgba(0,0,0,0.10);
      background: radial-gradient(circle at 30% 30%, #fff, #eef2ff);
      box-shadow: 0 8px 18px rgba(13,20,41,0.15); cursor:pointer;
    }
    .v1461[data-mode="vivid"] input[type="range"]::-moz-range-thumb{
      border-color: rgba(255,255,255,0.25);
      background: radial-gradient(circle at 30% 30%, #eef4ff, #cfd9ff);
    }

    /* Stage */
    .v1461 .stage{
      position:relative; z-index:1; min-height:min(72vh, 780px);
      border-radius: calc(var(--r) - 2px);
      border:1px solid rgba(0,0,0,0.06);
      background:
        radial-gradient(120% 120% at 50% 20%, rgba(255,255,255,0.65), rgba(255,255,255,0.0)),
        linear-gradient(180deg, rgba(255,255,255,0.5), rgba(255,255,255,0.25));
      overflow:hidden;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6), 0 30px 110px rgba(0,0,0,0.10);
      mask-image: radial-gradient(110% 90% at 50% 50%, black 60%, transparent 130%);
      perspective: 1200px;
    }
    .v1461[data-mode="vivid"] .stage{
      border-color: rgba(255,255,255,0.10);
      background:
        radial-gradient(140% 140% at 50% 8%, rgba(255,255,255,0.06), rgba(255,255,255,0.00)),
        linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.05), 0 30px 120px rgba(0,0,0,0.38);
    }
    .v1461 canvas.field{ position:absolute; inset:0; width:100%; height:100%; display:block; z-index:0; }
    .v1461 .hint{
      position:absolute; left:50%; bottom:10%; transform:translate(-50%,0);
      color:var(--muted); font-size:12px; background: var(--glass);
      border:1px solid rgba(0,0,0,0.08); padding:8px 12px; border-radius:999px;
      backdrop-filter: blur(6px);
      animation: v1461-hint 8s ease forwards;
      pointer-events:none;
    }
    .v1461[data-mode="vivid"] .hint{ border-color: rgba(255,255,255,0.12); }
    @keyframes v1461-hint{ 0%{ opacity:0; transform:translate(-50%,6px)} 15%,45%{opacity:1; transform:translate(-50%,0)} 100%{ opacity:0 } }

    /* Footer */
    .v1461 .foot{ position:relative; z-index:2; display:grid; grid-template-columns:1fr auto; gap:10px; align-items:center; color:var(--muted); font-size:12px; }
    .v1461 .meta{ display:inline-flex; gap:10px; align-items:center; white-space:nowrap; }
    .v1461 .pulse{ width:9px; height:9px; border-radius:50%; background: var(--hi); box-shadow:0 0 0 6px color-mix(in oklab, var(--hi) 30%, transparent); animation: v1461-pulse 2.2s ease-in-out infinite; }
    @keyframes v1461-pulse{ 0%,100%{ transform: scale(1); opacity:1 } 50%{ transform: scale(1.12); opacity:.95 } }

    /* Accessibility & hidden chrome */
    .v1461 .chip:focus-visible, .v1461 input[type="range"]:focus-visible{
      outline: 2px solid color-mix(in oklab, var(--hi) 60%, transparent);
      outline-offset: 2px;
    }
    .v1461.chrome-hidden .controls, .v1461.chrome-hidden .hint{ opacity:0; pointer-events:none; transition: opacity .3s ease; }
    .v1461.chrome-hidden .foot{ opacity:.7; }

    @media (max-width: 900px){
      .v1461 .mast{ grid-template-columns:1fr; }
      .v1461 .foot{ grid-template-columns:1fr; gap:8px; }
      .v1461 .title{ font-size: clamp(30px, 12vw, 92px); }
      .v1461 input[type="range"]{ width:120px; }
    }
    @media (prefers-reduced-motion: reduce){
      .v1461, .v1461 *{ animation:none !important; transition:none !important; }
    }
  </style>

  <div class="mast">
    <div class="brand">
      <div class="glyph" aria-hidden="true"></div>
      <div>
        <h2 class="title">LUMEN FOUNTAIN</h2>
        <p class="sub">A living aurora you can sculpt. Drag to bend light, scroll to change depth, press H to hide UI.</p>
      </div>
    </div>
    <div class="controls" role="group" aria-label="Fountain controls">
      <button class="chip play" type="button" aria-pressed="true" title="Toggle motion">Play</button>
      <button class="chip mode" type="button" aria-pressed="false" title="Toggle mode">Serene</button>
      <label class="slider" title="Speed">
        Speed <input class="speed" type="range" min="0.25" max="2.5" step="0.05" value="1.00" aria-label="Speed">
      </label>
    </div>
  </div>

  <div class="stage" aria-live="polite">
    <canvas class="field" aria-hidden="true"></canvas>
    <div class="hint" aria-hidden="true">Drag to sculpt • Scroll to adjust depth • M toggles mode • +/- adjusts speed</div>
  </div>

  <div class="foot">
    <div class="meta">
      <span class="pulse" aria-hidden="true"></span>
      Mode: <span class="m-mode">Serene</span> • Motion: <span class="m-play">On</span> • Speed: <span class="m-speed">1.00×</span> • Depth: <span class="m-depth">0%</span>
    </div>
    <div class="meta">
      Local: <span class="m-clock">--:--</span> • <span id="last-updated">Last updated: 2025-12-22 18:18:12 EST</span>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.v1461.fountain');
      const stage = root.querySelector('.stage');
      const canvas = root.querySelector('canvas.field');
      const ctx = canvas.getContext('2d', { alpha: true });

      const btnPlay = root.querySelector('.play');
      const btnMode = root.querySelector('.mode');
      const elSpeed = root.querySelector('.speed');

      const mPlay = root.querySelector('.m-play');
      const mMode = root.querySelector('.m-mode');
      const mSpeed = root.querySelector('.m-speed');
      const mDepth = root.querySelector('.m-depth');
      const mClock = root.querySelector('.m-clock');
      const updated = root.querySelector('#last-updated');

      // Timestamp
      try{
        const now = new Date();
        const opts = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || '';
        updated.textContent = 'Updated ' + new Intl.DateTimeFormat([], opts).format(now) + ' ' + tz.replaceAll('_',' ');
      }catch(e){
        updated.textContent = 'Updated ' + new Date().toLocaleString();
      }

      // State
      const state = {
        playing: true,
        speed: Number(elSpeed.value),
        depth: 0, // affects amplitude + blur
        pointer: { x: 0.5, y: 0.5, active: false },
        dpr: 1,
        t: 0,
        ribbons: [],
        orbs: [],
        raf: 0
      };

      const palettes = {
        serene: ['#86e7ff','#b8ffcb','#ffd1f3','#fff4b3','#b7c3ff'],
        vivid:  ['#4bc1ff','#9d7bff','#ff7aa8','#ffcf66','#6bffda']
      };

      function size(){
        const rect = stage.getBoundingClientRect();
        const dpr = Math.min(2.5, window.devicePixelRatio || 1);
        canvas.width = Math.max(2, Math.floor(rect.width * dpr));
        canvas.height = Math.max(2, Math.floor(rect.height * dpr));
        canvas.style.width = rect.width + 'px';
        canvas.style.height = rect.height + 'px';
        state.dpr = dpr;
        seed();
        draw(true);
      }

      function seed(){
        const cols = currentPalette();
        const w = canvas.width, h = canvas.height;
        // Ribbons
        state.ribbons = Array.from({length: 5}).map((_,i)=>({
          amp: (h*0.10) + i*8,
          base: (h*0.25) + i*(h*0.12),
          freq: 0.0018 + i*0.00035,
          phase: Math.random()*Math.PI*2,
          speed: (0.4 + i*0.12) * (Math.random()>0.5?1:-1),
          width: 60 + i*14,
          colorA: cols[i%cols.length],
          colorB: cols[(i+2)%cols.length]
        }));
        // Orbs
        const count = Math.floor((w*h)/70000)+18;
        state.orbs = Array.from({length: count}).map(()=>({
          x: Math.random()*w, y: Math.random()*h,
          r: Math.random()*Math.min(w,h)*0.015 + 8,
          vx: (Math.random()*0.6 - 0.3), vy: (Math.random()*0.6 - 0.3),
          hue: cols[Math.floor(Math.random()*cols.length)]
        }));
      }

      function currentPalette(){
        return root.getAttribute('data-mode') === 'vivid' ? palettes.vivid : palettes.serene;
      }

      function setPlay(on){
        state.playing = on;
        btnPlay.setAttribute('aria-pressed', String(on));
        mPlay.textContent = on ? 'On' : 'Off';
        if (on){ cancelAnimationFrame(state.raf); state.raf = requestAnimationFrame(step); }
      }
      function setSpeed(v){
        state.speed = Math.max(0.25, Math.min(2.5, Number(v)));
        mSpeed.textContent = state.speed.toFixed(2) + '×';
      }
      function setDepth(v){
        state.depth = Math.max(-100, Math.min(100, Math.round(v)));
        mDepth.textContent = state.depth + '%';
      }
      function toggleMode(){
        const vivid = root.getAttribute('data-mode') !== 'vivid';
        root.setAttribute('data-mode', vivid ? 'vivid' : 'serene');
        btnMode.textContent = vivid ? 'Vivid' : 'Serene';
        btnMode.setAttribute('aria-pressed', String(vivid));
        mMode.textContent = vivid ? 'Vivid' : 'Serene';
        seed();
      }

      function draw(skipMotion=false){
        const { width:w, height:h } = canvas;
        ctx.setTransform(1,0,0,1,0,0);
        ctx.clearRect(0,0,w,h);

        // Subtle film
        ctx.globalCompositeOperation = 'source-over';
        const gradBg = ctx.createLinearGradient(0,0,0,h);
        const isVivid = root.getAttribute('data-mode') === 'vivid';
        gradBg.addColorStop(0, isVivid ? 'rgba(14,18,30,0.35)' : 'rgba(255,255,255,0.35)');
        gradBg.addColorStop(1, 'transparent');
        ctx.fillStyle = gradBg;
        ctx.fillRect(0,0,w,h);

        // Ribbons
        for(const r of state.ribbons){
          const amp = r.amp * (1 + state.depth*0.003);
          const width = (r.width + state.depth*0.25);
          ctx.lineWidth = Math.max(10, width);
          const lg = ctx.createLinearGradient(0,0,w,0);
          lg.addColorStop(0, r.colorA);
          lg.addColorStop(1, r.colorB);
          ctx.strokeStyle = lg;
          ctx.lineCap = 'round';
          ctx.shadowColor = r.colorA;
          ctx.shadowBlur = isVivid ? 40 : 22;

          ctx.beginPath();
          let first = true;
          const influence = 120 * (state.pointer.active ? 1 : 0.35);
          const px = state.pointer.x * w, py = state.pointer.y * h;
          for(let x= -50; x<= w+50; x+= 8){
            const k = (x * r.freq) + r.phase + state.t * r.speed * state.speed * 0.015;
            const ySine = r.base + Math.sin(k) * amp;
            const dist = Math.hypot(x - px, ySine - py);
            const pull = influence * Math.exp(-dist / (220 + Math.abs(state.depth)*2));
            const dir = ySine < py ? -1 : 1;
            const y = ySine + dir * pull;
            if (first){ ctx.moveTo(x,y); first=false; } else { ctx.lineTo(x,y); }
          }
          ctx.stroke();
        }

        // Orbs
        ctx.globalCompositeOperation = 'lighter';
        for(const o of state.orbs){
          const g = ctx.createRadialGradient(o.x,o.y,0,o.x,o.y,o.r*1.6);
          g.addColorStop(0, o.hue);
          g.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.fillStyle = g;
          ctx.beginPath(); ctx.arc(o.x,o.y,o.r,0,Math.PI*2); ctx.fill();

          if (!skipMotion){
            // gentle motion + pointer wake
            const towardX = (state.pointer.x*canvas.width - o.x) * 0.00008 * (state.pointer.active? 3:1);
            const towardY = (state.pointer.y*canvas.height - o.y) * 0.00008 * (state.pointer.active? 3:1);
            o.vx += towardX; o.vy += towardY;
            o.x += o.vx * (0.6 + state.speed*0.4);
            o.y += o.vy * (0.6 + state.speed*0.4);
            o.vx *= 0.985; o.vy *= 0.985;
            if (o.x < -40) o.x = canvas.width+40;
            if (o.x > canvas.width+40) o.x = -40;
            if (o.y < -40) o.y = canvas.height+40;
            if (o.y > canvas.height+40) o.y = -40;
          }
        }
        ctx.globalCompositeOperation = 'source-over';
      }

      function step(){
        if (!state.playing){ return; }
        state.t += 16;
        draw(false);

        try{
          const now = new Date();
          mClock.textContent = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'});
        }catch(e){}

        state.raf = requestAnimationFrame(step);
      }

      // Pointer interactions
      let dragging = false;
      stage.addEventListener('pointerdown', (e)=>{ dragging = true; state.pointer.active = true; stage.setPointerCapture(e.pointerId); move(e); });
      stage.addEventListener('pointerup', ()=>{ dragging = false; state.pointer.active = false; });
      stage.addEventListener('pointerleave', ()=>{ dragging = false; state.pointer.active = false; });
      function move(e){
        const rect = stage.getBoundingClientRect();
        state.pointer.x = (e.clientX - rect.left) / rect.width;
        state.pointer.y = (e.clientY - rect.top) / rect.height;
      }
      stage.addEventListener('pointermove', move);

      // Wheel: depth
      stage.addEventListener('wheel', (e)=>{
        e.preventDefault();
        setDepth(state.depth + (e.deltaY>0? -4 : 4));
      }, {passive:false});

      // Controls
      btnPlay.addEventListener('click', ()=> setPlay(btnPlay.getAttribute('aria-pressed') !== 'true'));
      btnMode.addEventListener('click', toggleMode);
      elSpeed.addEventListener('input', ()=> setSpeed(elSpeed.value));

      // Keyboard
      window.addEventListener('keydown', (e)=>{
        const k = (e.key||'').toLowerCase();
        if (e.code === 'Space'){ e.preventDefault(); setPlay(btnPlay.getAttribute('aria-pressed') !== 'true'); }
        if (k === 'm'){ toggleMode(); }
        if (k === '+'){ const v = Math.min(2.5, state.speed+0.05); elSpeed.value = String(v); setSpeed(v); }
        if (k === '-'){ const v = Math.max(0.25, state.speed-0.05); elSpeed.value = String(v); setSpeed(v); }
        if (k === 'h'){ root.classList.toggle('chrome-hidden'); }
      });

      // Boot
      const ro = new ResizeObserver(size);
      ro.observe(stage);
      window.addEventListener('orientationchange', size);
      size();
      setSpeed(state.speed);
      setDepth(state.depth);
      setPlay(true);

      // Reduced motion
      const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)');
      if (prefersReduce.matches){
        setPlay(false);
        draw(true);
      }

      document.addEventListener('visibilitychange', ()=>{
        if (document.hidden){ setPlay(false); }
        else if (btnPlay.getAttribute('aria-pressed') === 'true'){ setPlay(true); }
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


