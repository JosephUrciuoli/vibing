<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div class="vibe-1041" data-theme="noct" data-run="on" role="region" aria-label="Aurora Loom — live light sculpture">
  <style>
    .vibe-1041 {
      /* base palette */
      --bg: #0b1020;
      --ink: #e7edf7;
      --muted: #9fb0c6;
      --edge: rgba(255,255,255,.10);

      /* theme accents */
      --a1: #7aa2ff;
      --a2: #67ffd8;
      --a3: #a78bfa;

      --radius: 28px;
      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, Segoe UI, Inter, Roboto;
      color: var(--ink);
      position: relative;
      border-radius: var(--radius);
      padding: clamp(20px, 4vw, 44px);
      background:
        radial-gradient(1200px 800px at 20% -10%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(1200px 800px at 100% 95%, rgba(42,76,255,.12), transparent 60%),
        linear-gradient(180deg, color-mix(in oklab, var(--bg) 90%, black 10%), var(--bg));
      box-shadow: 0 32px 80px rgba(0,0,0,.45), inset 0 0 0 1px var(--edge);
      overflow: clip;
      isolation: isolate;
    }
    .vibe-1041::after{
      content:"";
      position:absolute; inset:-2px; border-radius: inherit; pointer-events:none;
      background:
        linear-gradient(0deg, transparent 0 49%, rgba(255,255,255,.03) 50%, transparent 51%) 0 0/100% 4px,
        radial-gradient(80% 140% at 80% -10%, rgba(255,255,255,.05), transparent 60%),
        radial-gradient(70% 120% at 0% 100%, rgba(255,255,255,.04), transparent 60%);
      mix-blend-mode: overlay;
    }

    /* THEMES */
    .vibe-1041[data-theme="noct"]  { --bg:#0b1020; --ink:#e7edf7; --muted:#9fb0c6; --edge:rgba(255,255,255,.12); --a1:#7aa2ff; --a2:#67ffd8; --a3:#a78bfa; }
    .vibe-1041[data-theme="polar"] { --bg:#06151a; --ink:#e7fbff; --muted:#a7c9d1; --edge:rgba(187,228,255,.18); --a1:#5fe0c0; --a2:#7cc6ff; --a3:#c9ffd9; }
    .vibe-1041[data-theme="solar"] { --bg:#1c0e03; --ink:#fff3e6; --muted:#d7bfa6; --edge:rgba(255,200,130,.18); --a1:#ffb056; --a2:#ff7aa2; --a3:#ffd27a; }
    .vibe-1041[data-theme="mirage"]{ --bg:#170b1e; --ink:#ffeefe; --muted:#cdb7d6; --edge:rgba(255,190,255,.16); --a1:#ff8ad6; --a2:#b69cff; --a3:#ffe3f9; }

    /* Header */
    .vibe-1041 .mast { max-width: 1200px; margin: 0 auto 16px; }
    .vibe-1041 .badge {
      display:inline-flex; align-items:center; gap:10px; color:var(--muted);
      font-size: 12px; letter-spacing:.16em; text-transform: uppercase;
    }
    .vibe-1041 .badge .dot { width:10px; height:10px; border-radius:50%;
      background: radial-gradient(circle at 35% 35%, var(--a2), var(--a3));
      box-shadow: 0 0 0 6px rgba(255,255,255,.03), 0 0 18px var(--a2);
    }
    .vibe-1041 h1 {
      margin: 10px 0 6px;
      font-size: clamp(40px, 8vw, 108px);
      line-height: .88;
      letter-spacing: -0.02em;
      font-weight: 900;
      color: transparent;
      background:
        conic-gradient(from 200deg, var(--a1), var(--a2), var(--a3), var(--a1));
      -webkit-background-clip:text; background-clip:text;
      filter: drop-shadow(0 10px 30px color-mix(in oklab, var(--a2) 30%, black));
    }
    .vibe-1041 .lead {
      color: var(--muted);
      font-size: clamp(14px, 2vw, 18px);
      max-width: 74ch;
    }

    /* Stage */
    .vibe-1041 .stage {
      position: relative; max-width: 1200px; margin: clamp(16px, 3.8vw, 28px) auto 10px; border-radius: 26px;
      background:
        radial-gradient(160% 140% at 50% -20%, rgba(255,255,255,.10), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow: inset 0 0 0 1px var(--edge), 0 28px 70px rgba(0,0,0,.38);
      overflow: clip;
    }
    .vibe-1041 .frame { position:relative; width:100%; aspect-ratio: 16/10; }
    .vibe-1041 canvas.loom { position:absolute; inset:0; width:100%; height:100%; display:block; }
    .vibe-1041 .grain {
      position:absolute; inset:-2px; pointer-events:none;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,.05), transparent 40%),
        radial-gradient(circle at 80% 80%, rgba(255,255,255,.03), transparent 50%),
        repeating-conic-gradient(from 0deg, rgba(255,255,255,.012) 0 6deg, transparent 6deg 12deg);
      mix-blend-mode: soft-light; opacity:.7;
    }
    .vibe-1041 .wand {
      position:absolute; width:16px; height:16px; border-radius:50%;
      transform: translate(-50%, -50%);
      background:
        radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,.4) 40%, transparent 60%);
      box-shadow: 0 0 0 1px rgba(255,255,255,.3), 0 12px 26px rgba(0,0,0,.35);
      opacity: .85; pointer-events:none;
      transition: opacity .25s ease;
    }
    .vibe-1041[data-run="off"] .wand { opacity:.25; }

    /* Controls Panel */
    .vibe-1041 .panel {
      display:flex; align-items:center; justify-content: space-between; gap: 14px;
      flex-wrap: wrap;
      max-width: 1200px; margin: 12px auto 0;
      padding: 12px; border-radius: 18px;
      background: color-mix(in oklab, var(--bg) 70%, #ffffff 30%);
      box-shadow: inset 0 0 0 1px var(--edge), 0 10px 24px rgba(0,0,0,.22);
      backdrop-filter: saturate(160%) blur(10px);
    }
    .vibe-1041 .seg {
      display:inline-flex; border-radius: 999px; overflow:hidden; border:1px solid var(--edge);
      box-shadow: 0 6px 16px rgba(0,0,0,.2), inset 0 1px 0 rgba(255,255,255,.4);
    }
    .vibe-1041 .seg-btn {
      appearance:none; border:0; background: transparent; color: var(--muted);
      padding: 10px 14px; font-weight: 800; letter-spacing: .02em; cursor:pointer; font-size:13px;
      transition: background .18s ease, color .18s ease, transform .12s ease;
    }
    .vibe-1041 .seg-btn:hover { transform: translateY(-1px); }
    .vibe-1041 .seg-btn.active { background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3)); color: #0b0d14; }

    .vibe-1041 .rows { display:flex; align-items:center; gap: 16px 22px; flex-wrap:wrap; }
    .vibe-1041 .slider { display:inline-flex; align-items:center; gap:10px; color:var(--muted); font-size:13px; user-select:none; }
    .vibe-1041 .slider input[type="range"] { appearance:none; width: 170px; height: 26px; background: transparent; cursor:pointer; }
    .vibe-1041 .slider input[type="range"]::-webkit-slider-runnable-track {
      height: 8px; border-radius: 999px;
      background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3)); opacity:.7;
    }
    .vibe-1041 .slider input[type="range"]::-webkit-slider-thumb {
      appearance:none; width:20px; height:20px; border-radius:50%;
      margin-top:-6px;
      background:#fff; border:1px solid var(--edge); box-shadow: 0 6px 12px rgba(0,0,0,.18);
    }
    .vibe-1041[data-theme="noct"] .slider input[type="range"]::-webkit-slider-thumb { background:#e6edf7; }

    .vibe-1041 .switch { display:inline-flex; align-items:center; gap:10px; color:var(--muted); font-size:13px; user-select:none; }
    .vibe-1041 .track {
      --w: 54px; --h: 28px; position:relative; width:var(--w); height:var(--h);
      border-radius:999px; background: rgba(255,255,255,.12); border: 1px solid var(--edge);
      box-shadow: inset 0 2px 12px rgba(0,0,0,.18); cursor:pointer;
    }
    .vibe-1041 .thumb {
      position:absolute; top:3px; left:3px; width:22px; height:22px; border-radius:50%;
      background: linear-gradient(135deg, #fff, #e8f0ff); box-shadow: 0 6px 12px rgba(0,0,0,.28);
      transition: left 220ms cubic-bezier(.2,.8,.2,1);
    }
    .vibe-1041[data-run="on"] .thumb { left:29px; }
    .vibe-1041[data-theme="solar"] .thumb { background: linear-gradient(135deg, #fff6ea, #ffe1c2); }

    .vibe-1041 .actions { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .vibe-1041 .btn {
      display:inline-flex; align-items:center; gap:10px;
      padding: 12px 16px; border-radius: 14px; border:0; cursor:pointer;
      font-weight: 900; letter-spacing: .02em; color: #0b0d14;
      background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3));
      box-shadow: 0 16px 32px rgba(0,0,0,.22), inset 0 1px 0 rgba(255,255,255,.6);
      transition: transform .14s ease, box-shadow .18s ease, filter .18s ease;
      position: relative; overflow:hidden;
    }
    .vibe-1041 .btn::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(115deg, transparent 0 55%, rgba(255,255,255,.45) 60%, transparent 65%);
      transform: translateX(-120%); transition: transform 900ms ease;
    }
    .vibe-1041 .btn:hover { transform: translateY(-1px); box-shadow: 0 22px 44px rgba(0,0,0,.28); }
    .vibe-1041 .btn:hover::after{ transform: translateX(0); }

    /* Meta */
    .vibe-1041 .meta {
      display:flex; align-items:center; justify-content: space-between; flex-wrap:wrap; gap: 10px 12px;
      max-width: 1200px; margin: 14px auto 0; color: var(--muted); font-size: 12px;
    }
    .vibe-1041 #last-updated {
      padding: 6px 10px; border-radius: 999px; border: 1px solid var(--edge);
      background: color-mix(in oklab, var(--bg) 85%, white);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.5);
      white-space: nowrap;
    }

    @media (prefers-reduced-motion: reduce) {
      .vibe-1041 .wand, .vibe-1041 .btn::after { transition: none !important; }
    }
  </style>

  <div class="mast">
    <div class="badge"><span class="dot" aria-hidden="true"></span> Edition 1041 · Aurora Loom</div>
    <h1>Weave the sky</h1>
    <p class="lead">Drag to sculpt light. Tune the flow. Save a moment you like.</p>
  </div>

  <div class="stage" role="img" aria-label="Flowing aurora bands">
    <div class="frame">
      <canvas class="loom"></canvas>
      <div class="grain" aria-hidden="true"></div>
      <div class="wand" aria-hidden="true"></div>
    </div>
  </div>

  <div class="panel" aria-label="Controls">
    <div class="seg" role="tablist" aria-label="Theme">
      <button class="seg-btn active" data-theme="noct" role="tab" aria-selected="true">Nocturne</button>
      <button class="seg-btn" data-theme="polar" role="tab" aria-selected="false">Polar</button>
      <button class="seg-btn" data-theme="solar" role="tab" aria-selected="false">Solar</button>
      <button class="seg-btn" data-theme="mirage" role="tab" aria-selected="false">Mirage</button>
    </div>
    <div class="rows">
      <label class="slider" for="speed-1041">
        Speed
        <input id="speed-1041" type="range" min="0" max="100" value="55" aria-label="Animation speed">
      </label>
      <label class="slider" for="glow-1041">
        Glow
        <input id="glow-1041" type="range" min="0" max="100" value="65" aria-label="Glow intensity">
      </label>
      <label class="switch" for="run-1041">
        Motion
        <span class="track">
          <span class="thumb"></span>
          <input id="run-1041" type="checkbox" checked aria-label="Toggle motion" style="position:absolute; inset:0; opacity:0; cursor:pointer;">
        </span>
      </label>
    </div>
    <div class="actions">
      <button class="btn reseed" type="button" title="Weave a new pattern">Weave</button>
      <button class="btn save" type="button" title="Save a still">Save</button>
    </div>
  </div>

  <div class="meta">
    <span class="quote">“Light remembers the hand that guides it.”</span>
    <span id="last-updated">Last updated: 2025-12-03 07:39:56 EST</span>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.vibe-1041');
      if(!root) return;

      const canvas = root.querySelector('canvas.loom');
      const ctx = canvas.getContext('2d');
      const wand = root.querySelector('.wand');

      const segBtns = [...root.querySelectorAll('.seg-btn[data-theme]')];
      const speed = root.querySelector('#speed-1041');
      const glow = root.querySelector('#glow-1041');
      const runToggle = root.querySelector('#run-1041');
      const reseedBtn = root.querySelector('.reseed');
      const saveBtn = root.querySelector('.save');

      // Last updated
      try {
        const dt = new Date();
        const fmt = new Intl.DateTimeFormat([], { year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit' });
        root.querySelector('#last-updated').textContent = 'Last updated: ' + fmt.format(dt);
      } catch {
        root.querySelector('#last-updated').textContent = 'Last updated: ' + new Date().toLocaleString();
      }

      // Canvas sizing
      let w=0, h=0, dpr=1;
      function resize(){
        const rect = canvas.getBoundingClientRect();
        dpr = Math.min(window.devicePixelRatio || 1, 2);
        canvas.width = Math.max(2, Math.floor(rect.width * dpr));
        canvas.height = Math.max(2, Math.floor(rect.height * dpr));
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        w = Math.floor(rect.width);
        h = Math.floor(rect.height);
        wash(); // hard repaint
      }
      const ro = new ResizeObserver(resize);
      ro.observe(canvas);

      // Palette from CSS
      function cssVar(name){ return getComputedStyle(root).getPropertyValue(name).trim(); }

      // State
      const pointer = { x: 0.5, y: 0.5, down: false };
      let bands = [];
      let t = 0;
      let raf;

      function seedBands(N=6){
        bands = [];
        const mid = h*0.5;
        for(let i=0;i<N;i++){
          const base = mid + (i - (N-1)/2) * (h/(N+2)) * (0.6 + Math.random()*0.8);
          bands.push({
            base,
            amp1: (0.06 + Math.random()*0.14) * h,
            amp2: (0.02 + Math.random()*0.10) * h,
            f1: (0.002 + Math.random()*0.0045),
            f2: (0.004 + Math.random()*0.006),
            phase1: Math.random()*Math.PI*2,
            phase2: Math.random()*Math.PI*2,
            thick: (28 + Math.random()*60),
            drift: (Math.random()*2-1) * 0.25
          });
        }
      }

      function wash(){
        ctx.save();
        ctx.globalCompositeOperation = 'source-over';
        // soft background wash to match card
        const bg = cssVar('--bg') || '#0b1020';
        ctx.fillStyle = bg;
        ctx.fillRect(0,0,w,h);
        // vignette
        const g = ctx.createRadialGradient(w*0.5, h*0.4, Math.min(w,h)*0.2, w*0.5, h*0.5, Math.max(w,h)*0.9);
        const tint = 'rgba(0,0,0,'+(root.dataset.theme==='solar'?0.35:0.55)+')';
        g.addColorStop(0, 'rgba(0,0,0,0)');
        g.addColorStop(1, tint);
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);
        ctx.restore();
      }

      function draw(now){
        wash();

        const A1 = cssVar('--a1'), A2 = cssVar('--a2'), A3 = cssVar('--a3');
        const glowAmt = Number(glow.value)/100; // 0..1
        const spd = (Number(speed.value)/100); // 0..1

        ctx.save();
        ctx.globalCompositeOperation = 'screen';

        for(const b of bands){
          const grad = ctx.createLinearGradient(0, b.base - b.thick, 0, b.base + b.thick);
          grad.addColorStop(0, A1);
          grad.addColorStop(0.5, A2);
          grad.addColorStop(1, A3);
          ctx.fillStyle = grad;

          ctx.shadowColor = A2;
          ctx.shadowBlur = 10 + glowAmt * 60;

          ctx.beginPath();
          const px = pointer.x * w;
          const py = pointer.y * h;
          const sigma = w * 0.18; // influence width

          let x= -20;
          const step = Math.max(2, w/140);
          const t1 = t * (0.6 + b.drift) + b.phase1;
          const t2 = t * (1.1 - b.drift) + b.phase2;
          for(; x <= w+20; x += step){
            const wave = Math.sin(x*b.f1 + t1) * b.amp1 + Math.sin(x*b.f2 + t2) * b.amp2;
            const dx = x - px;
            const influence = Math.exp(-(dx*dx)/(2*sigma*sigma));
            const pull = (py - b.base) * 0.9 * influence * (pointer.down ? 1.6 : 0.8);
            const y = b.base + wave + pull;
            if(x===-20) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
          }
          // close shape
          ctx.lineTo(w+40, h+40);
          ctx.lineTo(-40, h+40);
          ctx.closePath();
          ctx.fill();

          // Highlight stroke along crest
          ctx.save();
          ctx.globalAlpha = 0.12 + glowAmt*0.12;
          ctx.shadowBlur = 0;
          ctx.strokeStyle = A3;
          ctx.lineWidth = 1.4;
          ctx.beginPath();
          x = -20;
          for(; x <= w+20; x += step){
            const wave = Math.sin(x*b.f1 + t1) * b.amp1 + Math.sin(x*b.f2 + t2) * b.amp2;
            const dx = x - px;
            const influence = Math.exp(-(dx*dx)/(2*sigma*sigma));
            const pull = (py - b.base) * 0.9 * influence * (pointer.down ? 1.6 : 0.8);
            const y = b.base + wave + pull;
            if(x===-20) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
          }
          ctx.stroke();
          ctx.restore();
        }

        ctx.restore();

        // subtle twinkles
        ctx.save();
        ctx.globalCompositeOperation = 'lighter';
        ctx.fillStyle = 'rgba(255,255,255,0.8)';
        for(let s=0; s<18; s++){
          const x = (Math.sin(now*0.00035 + s*1.9) * 0.5 + 0.5) * w;
          const y = (Math.cos(now*0.00027 + s*1.3) * 0.5 + 0.5) * h;
          const r = ((s % 5) + 1) * 0.25;
          ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI*2); ctx.fill();
        }
        ctx.restore();
      }

      function tick(now){
        if(root.dataset.run !== 'on') return;
        const spd = (Number(speed.value)/100);
        t += (0.004 + spd*0.024) * (1 + (pointer.down?0.5:0));
        draw(now || performance.now());
        raf = requestAnimationFrame(tick);
      }

      // Pointer interactions
      const frame = root.querySelector('.frame');
      function movePointer(e){
        const r = frame.getBoundingClientRect();
        pointer.x = Math.min(1, Math.max(0, (e.clientX - r.left) / r.width));
        pointer.y = Math.min(1, Math.max(0, (e.clientY - r.top) / r.height));
        wand.style.left = (pointer.x*100)+'%';
        wand.style.top  = (pointer.y*100)+'%';
      }
      frame.addEventListener('pointermove', movePointer);
      frame.addEventListener('pointerdown', (e)=>{ pointer.down = true; movePointer(e); });
      window.addEventListener('pointerup', ()=> pointer.down = false);
      frame.addEventListener('pointerleave', ()=>{ pointer.x=.5; pointer.y=.5; });

      // Theme switch
      function applyTheme(name){
        root.dataset.theme = name;
        segBtns.forEach(b => {
          const on = b.getAttribute('data-theme')===name;
          b.classList.toggle('active', on);
          b.setAttribute('aria-selected', on ? 'true' : 'false');
        });
        draw(performance.now());
      }
      segBtns.forEach(b => b.addEventListener('click', ()=> applyTheme(b.getAttribute('data-theme'))));

      // Motion toggle respects reduced motion
      const reduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if(reduced){ root.dataset.run = 'off'; runToggle.checked = false; }
      runToggle.addEventListener('change', ()=>{
        root.dataset.run = runToggle.checked ? 'on' : 'off';
        if(runToggle.checked) raf = requestAnimationFrame(tick);
      });

      // Reseed & Save
      reseedBtn.addEventListener('click', ()=>{
        seedBands(5 + Math.floor(Math.random()*3));
        draw(performance.now());
      });
      saveBtn.addEventListener('click', ()=>{
        // render a crisp still before saving
        draw(performance.now());
        try {
          const link = document.createElement('a');
          link.download = 'aurora-loom.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        } catch {
          window.open(canvas.toDataURL('image/png'), '_blank');
        }
      });

      // Start
      resize();
      seedBands(6);
      draw(performance.now());
      if(root.dataset.run === 'on') raf = requestAnimationFrame(tick);
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


