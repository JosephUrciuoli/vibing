<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v1457 aurora" data-theme="frost" aria-label="Aurora Atelier — a living fabric of light">
  <style>
    .v1457.aurora{
      --r: 28px;
      --ink:#0e1220; --muted:#5f6a86; --bg-1:#f7fbff; --bg-2:#edf4ff; --accent:#7dd3fc; --glass: rgba(255,255,255,0.55);
      --line: color-mix(in oklab, var(--ink) 14%, transparent);
      position:relative; display:grid; gap: clamp(14px,4vw,28px);
      grid-template-rows:auto 1fr auto;
      padding: clamp(18px,5vw,42px);
      border-radius: var(--r);
      color: var(--ink);
      background:
        radial-gradient(140% 140% at 110% -20%, color-mix(in oklab, var(--accent) 24%, transparent), transparent 60%),
        radial-gradient(120% 120% at -20% 120%, rgba(99,102,241,0.18), transparent 60%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.75), 0 40px 140px rgba(0,0,0,0.25);
      overflow:hidden; isolation:isolate;
      font-family: ui-sans-serif, -apple-system, "SF Pro Display", Segoe UI, Roboto, Helvetica, Arial;
    }
    .v1457.aurora::before{
      content:""; position:absolute; inset:-25%;
      background:
        conic-gradient(from 0deg, rgba(255,255,255,0.0) 0 60%, color-mix(in oklab, var(--accent) 20%, transparent) 70%, transparent 90% 100%),
        radial-gradient(60% 60% at 50% 50%, rgba(255,255,255,0.25), transparent 60%);
      mix-blend-mode: overlay; filter: blur(50px) saturate(120%);
      animation: v1457-sweep 56s linear infinite;
      pointer-events:none; z-index:0;
    }
    @keyframes v1457-sweep{ to{ transform: rotate(360deg) } }

    /* Themes */
    .v1457.aurora[data-theme="frost"]{ --ink:#0c1322; --muted:#5e6c84; --bg-1:#f6fbff; --bg-2:#eef6ff; --accent:#7dd3fc; --glass: rgba(255,255,255,0.55); }
    .v1457.aurora[data-theme="bloom"]{ --ink:#101018; --muted:#6b6480; --bg-1:#fff1f7; --bg-2:#f7ecff; --accent:#f472b6; --glass: rgba(255,255,255,0.55); }
    .v1457.aurora[data-theme="ember"]{ --ink:#130f0a; --muted:#7a665a; --bg-1:#fff7ef; --bg-2:#fff1e7; --accent:#fb923c; --glass: rgba(255,255,255,0.55); }
    .v1457.aurora[data-theme="noir"]{ --ink:#f5f8ff; --muted:#a8b6cf; --bg-1:#0b0f1a; --bg-2:#0d1220; --accent:#60a5fa; --glass: rgba(255,255,255,0.09); }

    /* Header */
    .v1457 .head{ position:relative; z-index:2; display:grid; grid-template-columns: 1fr auto; gap: clamp(14px,3vw,22px); align-items:end; }
    .v1457 .brand{ display:flex; align-items:center; gap:16px; }
    .v1457 .sigil{
      width:74px; height:74px; border-radius:20px; position:relative; overflow:hidden;
      background:
        radial-gradient(70% 70% at 30% 25%, rgba(255,255,255,0.9), rgba(255,255,255,0) 55%),
        conic-gradient(from 210deg, color-mix(in oklab, var(--accent) 70%, #fff), transparent 60%);
      box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--ink) 16%, transparent), 0 18px 48px rgba(0,0,0,0.24);
      transform: rotate(-6deg);
    }
    .v1457 .sigil::after{
      content:""; position:absolute; inset:18%; border-radius:16px; border:1px solid rgba(255,255,255,0.6);
      background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0) 60%); mix-blend-mode: overlay;
    }
    .v1457 .title{
      margin:0; font-weight:900; line-height:.9; letter-spacing:-0.02em;
      font-size: clamp(40px, 9vw, 114px);
      background: linear-gradient(90deg, var(--ink), color-mix(in oklab, var(--accent) 60%, var(--ink)) 60%, var(--accent));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      filter: drop-shadow(0 14px 36px color-mix(in oklab, var(--accent) 22%, transparent));
    }
    .v1457 .sub{ margin:.35rem 0 0; font-size:13px; letter-spacing:.3px; color:var(--muted); }

    /* Tools */
    .v1457 .tools{ display:flex; flex-wrap:wrap; gap:10px; justify-content:flex-end; align-items:center; }
    .v1457 .chip, .v1457 .slider{
      -webkit-tap-highlight-color: transparent;
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:16px; border:1px solid var(--line);
      background: var(--glass); color: var(--ink);
      font-weight:800; font-size:12px; letter-spacing:.25px; line-height:1;
      cursor:pointer; user-select:none; white-space:nowrap;
      transition: transform .2s ease, box-shadow .25s ease, background .25s ease, border-color .25s ease, color .25s ease;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.75), 0 12px 28px rgba(0,0,0,0.14);
      backdrop-filter: blur(10px) saturate(150%);
    }
    .v1457 .chip:hover{ transform: translateY(-1px); }
    .v1457 .chip[aria-pressed="true"]{
      background: color-mix(in oklab, var(--accent) 22%, var(--glass));
      border-color: color-mix(in oklab, var(--accent) 48%, transparent);
      box-shadow: 0 16px 36px color-mix(in oklab, var(--accent) 22%, transparent), inset 0 1px 0 rgba(255,255,255,0.7);
    }
    .v1457 .slider{ padding:8px 12px; }
    .v1457 input[type="range"]{ -webkit-appearance:none; appearance:none; width:140px; height:24px; background:transparent; }
    .v1457 input[type="range"]::-webkit-slider-runnable-track{
      height:8px; border-radius:999px; background: linear-gradient(90deg, color-mix(in oklab, var(--ink) 20%, var(--bg-2)), var(--accent));
      border:1px solid var(--line); box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .v1457 input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; margin-top:-6px; width:20px; height:20px; border-radius:50%;
      border:1px solid color-mix(in oklab, var(--ink) 30%, transparent);
      background: radial-gradient(circle at 30% 30%, #fff, #eef2ff);
      box-shadow: 0 8px 18px rgba(13,20,41,0.12); cursor:pointer;
    }
    .v1457 input[type="range"]::-moz-range-track{
      height:8px; border-radius:999px; background: linear-gradient(90deg, color-mix(in oklab, var(--ink) 20%, var(--bg-2)), var(--accent));
      border:1px solid var(--line);
    }
    .v1457 input[type="range"]::-moz-range-thumb{
      width:20px; height:20px; border-radius:50%;
      border:1px solid color-mix(in oklab, var(--ink) 30%, transparent);
      background: radial-gradient(circle at 30% 30%, #fff, #eef2ff);
      box-shadow: 0 8px 18px rgba(13,20,41,0.12); cursor:pointer;
    }

    /* Stage */
    .v1457 .stage{
      position:relative; z-index:1;
      border-radius: calc(var(--r) - 2px);
      border:1px solid var(--line);
      min-height: min(72vh, 760px);
      background: linear-gradient(180deg, rgba(255,255,255,0.65), rgba(255,255,255,0.3));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.7), 0 30px 100px rgba(0,0,0,0.12);
      overflow:hidden;
    }
    .v1457 canvas.fabric, .v1457 canvas.bokeh{ position:absolute; inset:0; width:100%; height:100%; display:block; }
    .v1457 .grain{
      position:absolute; inset:-15%; pointer-events:none; mix-blend-mode: overlay; opacity:.08;
      background:
        radial-gradient(1px 1px at 10% 20%, rgba(0,0,0,0.5) 40%, transparent 41%) repeat,
        radial-gradient(1px 1px at 70% 80%, rgba(0,0,0,0.5) 40%, transparent 41%) repeat,
        radial-gradient(1px 1px at 40% 50%, rgba(0,0,0,0.5) 40%, transparent 41%) repeat;
      background-size: 11px 11px, 13px 13px, 17px 17px;
      animation: v1457-dust 10s linear infinite;
    }
    @keyframes v1457-dust{ 0%{ transform:translate3d(0,0,0) } 50%{ transform:translate3d(-1.5%,1%,0) } 100%{ transform:translate3d(0,0,0) } }
    .v1457 .glow-on canvas.fabric{ filter: saturate(115%) drop-shadow(0 0 22px color-mix(in oklab, var(--accent) 28%, transparent)); }
    .v1457 .glow-on .bokeh{ filter: blur(1px) saturate(120%); }

    /* Notes + Footer */
    .v1457 .notes{ position:relative; z-index:2; display:grid; gap:8px; padding: clamp(8px,3vw,14px); }
    .v1457 .lead{ margin:0; color:var(--muted); font-size:14px; line-height:1.7; }
    .v1457 .foot{ position:relative; z-index:2; display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:center; color:var(--muted); font-size:12px; }
    .v1457 .meta{ display:inline-flex; gap:10px; align-items:center; white-space:nowrap; }
    .v1457 .pulse{ width:9px; height:9px; border-radius:50%; background: var(--accent); box-shadow:0 0 0 6px color-mix(in srgb, var(--accent) 22%, transparent); animation: v1457-pulse 2.6s ease-in-out infinite; }
    @keyframes v1457-pulse{ 0%,100%{ transform: scale(1); opacity:1 } 50%{ transform: scale(1.16); opacity:.95 } }

    @media (max-width: 900px){
      .v1457 .head{ grid-template-columns:1fr; }
      .v1457 .foot{ grid-template-columns:1fr; gap:6px; }
      .v1457 input[type="range"]{ width:120px; }
      .v1457 .title{ font-size: clamp(36px, 12vw, 92px); }
    }
    @media (prefers-reduced-motion: reduce){
      .v1457, .v1457 *{ animation:none !important; transition:none !important; }
    }
  </style>

  <div class="head">
    <div class="brand">
      <div class="sigil" aria-hidden="true"></div>
      <div>
        <h2 class="title">AURORA ATELIER</h2>
        <p class="sub">A living fabric of light. Drag to bend the wind; hold to quicken it.</p>
      </div>
    </div>
    <div class="tools" role="group" aria-label="Aurora controls">
      <button class="chip play" type="button" aria-pressed="true" title="Toggle motion">Play</button>
      <button class="chip theme" type="button" aria-pressed="false" title="Cycle palette">Frost</button>
      <button class="chip glow" type="button" aria-pressed="true" title="Toggle glow">Glow</button>
      <label class="slider" title="Wind">
        Wind <input class="wind" type="range" min="0.4" max="3.0" step="0.1" value="1.2" aria-label="Wind">
      </label>
      <label class="slider" title="Threads">
        Threads <input class="threads" type="range" min="6" max="48" step="1" value="18" aria-label="Threads">
      </label>
    </div>
  </div>

  <div class="stage" aria-live="polite">
    <canvas class="bokeh"></canvas>
    <canvas class="fabric"></canvas>
    <div class="grain" aria-hidden="true"></div>
  </div>

  <div class="notes">
    <p class="lead">Space toggles motion. T cycles palettes. G toggles glow. The cursor is a soft magnet for the light.</p>
  </div>

  <div class="foot">
    <div class="meta">
      <span class="pulse" aria-hidden="true"></span>
      Palette: <span class="m-theme">Frost</span> • Motion: <span class="m-play">On</span> • Glow: <span class="m-glow">On</span> • Wind: <span class="m-wind">1.2×</span> • Threads: <span class="m-threads">18</span>
    </div>
    <div class="meta">
      Local: <span class="m-clock">--:--</span> • <span id="last-updated">Last updated: 2025-12-22 14:16:09 EST</span>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.v1457.aurora');
      const stage = root.querySelector('.stage');
      const fabric = root.querySelector('canvas.fabric');
      const bokeh = root.querySelector('canvas.bokeh');
      const ctx = fabric.getContext('2d', {alpha:true});
      const btx = bokeh.getContext('2d', {alpha:true});

      const btnPlay = root.querySelector('.play');
      const btnTheme = root.querySelector('.theme');
      const btnGlow = root.querySelector('.glow');
      const elWind = root.querySelector('.wind');
      const elThreads = root.querySelector('.threads');

      const mPlay = root.querySelector('.m-play');
      const mTheme = root.querySelector('.m-theme');
      const mGlow = root.querySelector('.m-glow');
      const mWind = root.querySelector('.m-wind');
      const mThreads = root.querySelector('.m-threads');
      const mClock = root.querySelector('.m-clock');
      const updated = root.querySelector('#last-updated');

      // Updated stamp
      try{
        const now = new Date();
        const opts = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || '';
        updated.textContent = 'Updated ' + new Intl.DateTimeFormat([], opts).format(now) + ' ' + tz.replaceAll('_',' ');
      }catch(e){
        updated.textContent = 'Updated ' + new Date().toLocaleString();
      }

      // Palettes
      const PALETTES = {
        frost: ['#7dd3fc','#60a5fa','#a78bfa','#22d3ee','#c084fc'],
        bloom: ['#f472b6','#fb7185','#f59e0b','#a78bfa','#60a5fa'],
        ember: ['#fb923c','#f97316','#ef4444','#f59e0b','#fde047'],
        noir:  ['#60a5fa','#38bdf8','#a78bfa','#22d3ee','#c084fc']
      };
      const THEMES = ['frost','bloom','ember','noir'];

      const state = {
        playing: true,
        glow: true,
        theme: root.getAttribute('data-theme') || 'frost',
        time: 0,
        raf: 0,
        wind: Number(elWind.value),
        threads: Number(elThreads.value),
        size: {w:0,h:0,dpr:1},
        pointer: {x:0.5, y:0.46, tx:0.5, ty:0.46, down:false},
        strands: [],
        sparks: []
      };

      function setTheme(t){
        state.theme = t;
        root.setAttribute('data-theme', t);
        btnTheme.textContent = t.charAt(0).toUpperCase() + t.slice(1);
        mTheme.textContent = btnTheme.textContent;
        seedSparks();
      }

      // Auto theme by time
      try{
        const hr = new Date().getHours();
        let t = 'frost';
        if (hr >= 6 && hr < 12) t = 'frost';
        else if (hr >= 12 && hr < 18) t = 'bloom';
        else if (hr >= 18 && hr < 22) t = 'ember';
        else t = 'noir';
        setTheme(t);
      }catch(e){}

      function resize(){
        const dpr = Math.min(2.5, window.devicePixelRatio || 1);
        const rect = fabric.getBoundingClientRect();
        fabric.width = Math.max(2, Math.floor(rect.width * dpr));
        fabric.height = Math.max(2, Math.floor(rect.height * dpr));
        bokeh.width = fabric.width;
        bokeh.height = fabric.height;
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        btx.setTransform(dpr, 0, 0, dpr, 0, 0);
        state.size = { w: rect.width, h: rect.height, dpr };
        buildStrands();
        seedSparks();
        draw(0);
      }

      function buildStrands(){
        const {w,h} = state.size;
        state.strands = [];
        const pal = PALETTES[state.theme] || PALETTES.frost;
        for(let i=0;i<state.threads;i++){
          const baseY = (i+0.5)/(state.threads+1) * h;
          const amp = (0.12 + (1 - i/state.threads)*0.25) * h * 0.25;
          const freq = 0.002 + i*0.0006;
          const color = pal[i % pal.length];
          state.strands.push({
            baseY, amp, freq,
            phase: Math.random()*Math.PI*2,
            width: 0.8 + Math.pow(1 - i/state.threads, 1.2)*3.2,
            color
          });
        }
        root.classList.toggle('glow-on', state.glow);
      }

      function seedSparks(){
        const {w,h} = state.size;
        const count = 18;
        state.sparks = [];
        const pal = PALETTES[state.theme] || PALETTES.frost;
        for(let i=0;i<count;i++){
          state.sparks.push({
            x: Math.random()*w, y: Math.random()*h,
            r: 6 + Math.random()*18,
            hue: pal[i % pal.length],
            vx: (Math.random()-0.5)*0.2,
            vy: -0.15 - Math.random()*0.25,
            a: 0.08 + Math.random()*0.09
          });
        }
      }

      function clearFabric(){
        const {w,h} = state.size;
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = 'rgba(255,255,255,0.05)';
        if (root.getAttribute('data-theme') === 'noir'){
          ctx.fillStyle = 'rgba(0,0,0,0.08)';
        }
        ctx.fillRect(0,0,w,h);
      }

      function drawBokeh(t){
        const {w,h} = state.size;
        btx.clearRect(0,0,w,h);
        btx.globalCompositeOperation = 'lighter';
        for(const s of state.sparks){
          s.x += s.vx * state.wind;
          s.y += s.vy * state.wind;
          if (s.y < -40 || s.x < -40 || s.x > w+40){
            s.x = Math.random()*w;
            s.y = h + 20 + Math.random()*80;
          }
          const g = btx.createRadialGradient(s.x, s.y, 0, s.x, s.y, s.r);
          g.addColorStop(0, s.hue + 'cc');
          g.addColorStop(1, s.hue + '00');
          btx.fillStyle = g;
          btx.beginPath();
          btx.arc(s.x, s.y, s.r, 0, Math.PI*2);
          btx.fill();
        }
        // subtle moving vignette
        const gx = (state.pointer.x*0.3 + Math.sin(t*0.0002)*0.05) * w;
        const gy = (state.pointer.y*0.3 + Math.cos(t*0.0002)*0.05) * h;
        const v = btx.createRadialGradient(gx, gy, Math.min(w,h)*0.2, w*0.5, h*0.5, Math.max(w,h)*0.9);
        v.addColorStop(0, 'rgba(255,255,255,0.04)');
        v.addColorStop(1, 'rgba(255,255,255,0)');
        btx.fillStyle = v; btx.fillRect(0,0,w,h);
      }

      function draw(ts){
        state.time = ts;
        // Ease pointer magnet
        state.pointer.x += (state.pointer.tx - state.pointer.x) * 0.08;
        state.pointer.y += (state.pointer.ty - state.pointer.y) * 0.08;

        clearFabric();

        const {w,h} = state.size;
        const t = ts * 0.0015 * state.wind;

        ctx.globalCompositeOperation = 'lighter';
        for(const s of state.strands){
          ctx.lineWidth = s.width;
          ctx.strokeStyle = s.color;
          ctx.beginPath();
          const step = 12;
          let first = true;
          for(let x=0; x<=w+step; x+=step){
            const nx = x / w;
            const pullX = (state.pointer.x - 0.5) * 2.0;
            const pullY = (state.pointer.y - 0.5) * 2.0;
            const wob = Math.sin(x*s.freq + t*3 + s.phase) * s.amp;
            const wob2 = Math.sin(x*s.freq*0.6 + t*2 + s.phase*1.7) * s.amp*0.6;
            const bend = pullX * (nx-0.5) * h * 0.6 + pullY * h * 0.12;
            const y = s.baseY + wob + wob2 + bend;
            const yy = y + Math.sin(nx*Math.PI)*8*Math.cos(t+ s.phase);
            if (first){ ctx.moveTo(x, yy); first=false; } else { ctx.lineTo(x, yy); }
          }
          ctx.stroke();
        }

        drawBokeh(ts);

        // Clock
        try{
          const now = new Date();
          mClock.textContent = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'});
        }catch(e){}
      }

      function step(ts){
        if (!state.playing) return;
        draw(ts);
        state.raf = requestAnimationFrame(step);
      }

      function setPlay(on){
        state.playing = on;
        btnPlay.setAttribute('aria-pressed', String(on));
        mPlay.textContent = on ? 'On' : 'Off';
        if (on){
          cancelAnimationFrame(state.raf);
          state.raf = requestAnimationFrame(step);
        }
      }
      function setGlow(on){
        state.glow = on;
        btnGlow.setAttribute('aria-pressed', String(on));
        mGlow.textContent = on ? 'On' : 'Off';
        stage.classList.toggle('glow-on', on);
      }
      function setWind(v){
        state.wind = Number(v);
        mWind.textContent = state.wind.toFixed(1) + '×';
      }
      function setThreads(v){
        state.threads = Number(v);
        mThreads.textContent = String(state.threads);
        buildStrands();
      }
      function cycleTheme(){
        const i = THEMES.indexOf(state.theme);
        const t = THEMES[(i+1) % THEMES.length];
        setTheme(t);
        buildStrands();
      }

      function pointer(e){
        const r = fabric.getBoundingClientRect();
        const x = (e.clientX - r.left) / r.width;
        const y = (e.clientY - r.top) / r.height;
        state.pointer.tx = Math.max(0.05, Math.min(0.95, x));
        state.pointer.ty = Math.max(0.05, Math.min(0.95, y));
      }
      root.addEventListener('pointermove', pointer);
      root.addEventListener('pointerenter', pointer);
      root.addEventListener('pointerleave', ()=>{ state.pointer.down=false; });
      root.addEventListener('pointerdown', (e)=>{ state.pointer.down=true; setWind(Math.min(3.0, Number(elWind.value)*1.6)); pointer(e); });
      root.addEventListener('pointerup', ()=>{ state.pointer.down=false; setWind(Number(elWind.value)); });

      // Events
      btnPlay.addEventListener('click', ()=> setPlay(btnPlay.getAttribute('aria-pressed') !== 'true'));
      btnTheme.addEventListener('click', cycleTheme);
      btnGlow.addEventListener('click', ()=> setGlow(btnGlow.getAttribute('aria-pressed') !== 'true'));
      elWind.addEventListener('input', ()=> setWind(elWind.value));
      elThreads.addEventListener('input', ()=> setThreads(elThreads.value));

      // Keyboard
      window.addEventListener('keydown', (e)=>{
        if (e.code === 'Space'){ e.preventDefault(); setPlay(btnPlay.getAttribute('aria-pressed') !== 'true'); }
        if ((e.key || '').toLowerCase() === 't'){ cycleTheme(); }
        if ((e.key || '').toLowerCase() === 'g'){ setGlow(btnGlow.getAttribute('aria-pressed') !== 'true'); }
      });

      // Reduced motion
      const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)');
      if (prefersReduce.matches) setPlay(false);

      // Fit + start
      const ro = new ResizeObserver(resize);
      ro.observe(fabric);
      window.addEventListener('orientationchange', resize);
      resize();
      setWind(state.wind);
      setThreads(state.threads);
      setGlow(true);
      if (!prefersReduce.matches) setPlay(true);

      document.addEventListener('visibilitychange', ()=>{
        if (document.hidden){ setPlay(false); }
        else if (btnPlay.getAttribute('aria-pressed') === 'true'){ setPlay(true); }
      });
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


