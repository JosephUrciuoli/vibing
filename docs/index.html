<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<style>
  .vibe-2122 {
    --bg: #f7f7f4;
    --paper: #ffffff;
    --ink: #0e1220;
    --muted: #5d6473;
    --edge: rgba(14,18,32,0.08);
    --a: #ff7a7a;   /* coral */
    --b: #7acbff;   /* sky */
    --c: #9aff8a;   /* mint */
    --grain: 0.12;
    --shift: 0%;
    --rx: 0deg;
    --ry: 0deg;

    position: relative;
    border-radius: 32px;
    padding: 30px 22px 24px;
    color: var(--ink);
    background:
      radial-gradient(1200px 800px at 20% -10%, rgba(255,255,255,0.9), transparent 60%),
      radial-gradient(800px 680px at 110% 120%, rgba(255,204,0,0.08), transparent 60%),
      linear-gradient(180deg, var(--bg), #eeefe9 90%, #e9ebe4);
    box-shadow:
      0 50px 120px rgba(15,23,42,0.18),
      0 0 0 1px rgba(14,18,32,0.05) inset;
    overflow: hidden;
    isolation: isolate;
  }
  .vibe-2122.night {
    --bg: #0e1422;
    --paper: #101827;
    --ink: #e9eef8;
    --muted: #9aa3b2;
    --edge: rgba(255,255,255,0.12);
    background:
      radial-gradient(1200px 800px at 15% 20%, rgba(100,200,255,0.08), transparent 60%),
      radial-gradient(900px 700px at 100% 120%, rgba(255,120,120,0.08), transparent 60%),
      linear-gradient(180deg, #0b1020, #0e1422 60%, #0a111e);
    box-shadow:
      0 60px 140px rgba(0,0,0,0.5),
      0 0 0 1px rgba(255,255,255,0.06) inset;
  }
  .vibe-2122 .wrap { max-width: 1120px; margin: 0 auto; position: relative; z-index: 1; }

  .vibe-2122::after {
    content: "";
    position: absolute; inset: -60px;
    background:
      radial-gradient(600px 600px at var(--mx,70%) var(--my,40%), color-mix(in oklab, var(--b), transparent 92%), transparent 70%),
      conic-gradient(from 200deg at 10% 10%, color-mix(in oklab, var(--a), transparent 94%), transparent 20% 100%);
    filter: blur(12px);
    mix-blend-mode: color-dodge;
    opacity: 0.7;
    pointer-events: none;
  }

  .vibe-2122 .topline {
    display: flex; align-items: center; justify-content: space-between; gap: 12px;
  }
  .vibe-2122 .tag {
    display: inline-flex; align-items: center; gap: 10px;
    padding: 10px 14px; border-radius: 999px;
    border: 1px solid var(--edge);
    background: linear-gradient(180deg, rgba(255,255,255,0.7), rgba(255,255,255,0.4));
    color: var(--muted);
    font-size: 11px; letter-spacing: 0.22em; text-transform: uppercase;
    backdrop-filter: blur(10px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.06) inset, 0 10px 30px rgba(0,0,0,0.06);
  }
  .vibe-2122.night .tag { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); }
  .vibe-2122 .tag .pulse {
    width: 10px; height: 10px; border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #fff, color-mix(in srgb, var(--b), white 10%));
    box-shadow: 0 0 0 5px color-mix(in srgb, var(--b), transparent 90%), 0 0 18px color-mix(in srgb, var(--b), transparent 70%);
    animation: v2122-pulse 2.4s ease-in-out infinite;
  }
  @keyframes v2122-pulse { 0%,100% { transform: scale(1); opacity: 1 } 50% { transform: scale(1.2); opacity: 0.8 } }

  .vibe-2122 .actions { display: inline-flex; gap: 8px; }
  .vibe-2122 .chip {
    appearance: none; border: 1px solid var(--edge); background: rgba(255,255,255,0.6);
    color: var(--ink); border-radius: 12px; padding: 8px 10px; cursor: pointer;
    font-size: 14px; line-height: 1; transition: transform 0.12s ease, background 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    backdrop-filter: blur(8px);
  }
  .vibe-2122.night .chip { background: rgba(255,255,255,0.08); color: var(--ink); }
  .vibe-2122 .chip:hover { transform: translateY(-1px); background: rgba(255,255,255,0.85); }
  .vibe-2122.night .chip:hover { background: rgba(255,255,255,0.14); }

  .vibe-2122 h1 {
    margin: 18px 0 8px;
    font-size: clamp(44px, 9.8vw, 110px);
    line-height: 0.9;
    letter-spacing: -0.04em;
    font-weight: 900;
    font-style: italic;
    text-wrap: balance;
    background:
      linear-gradient(120deg, var(--a), var(--b) 40%, var(--c) 85%) 0 / 200% 200%;
    -webkit-background-clip: text; background-clip: text; color: transparent;
    filter: drop-shadow(0 16px 50px color-mix(in srgb, var(--b), transparent 80%));
    animation: v2122-shift 12s ease-in-out infinite;
  }
  @keyframes v2122-shift { 0%,100% { background-position: 0% 50% } 50% { background-position: 100% 50% } }
  .vibe-2122 .lead {
    margin: 10px 0 14px;
    max-width: 68ch;
    font-size: clamp(15px, 2.2vw, 20px);
    color: var(--muted);
  }

  /* Dock */
  .vibe-2122 .dock {
    display: flex; flex-wrap: wrap; align-items: center; gap: 10px 14px; margin: 12px 0 18px;
  }
  .vibe-2122 .pill, .vibe-2122 .range, .vibe-2122 .switch, .vibe-2122 .palette {
    display: inline-flex; align-items: center; gap: 10px;
    padding: 8px 10px; border-radius: 14px; border: 1px solid var(--edge);
    background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.5));
    color: var(--muted); font-size: 11px; letter-spacing: 0.15em; text-transform: uppercase;
    backdrop-filter: blur(10px);
    box-shadow: 0 1px 0 rgba(255,255,255,0.6) inset;
  }
  .vibe-2122.night .pill, .vibe-2122.night .range, .vibe-2122.night .switch, .vibe-2122.night .palette {
    background: rgba(255,255,255,0.07);
    box-shadow: 0 1px 0 rgba(255,255,255,0.08) inset;
  }
  .vibe-2122 .pill { gap: 6px; padding: 6px; }
  .vibe-2122 .pill button {
    appearance: none; border: 0; cursor: pointer;
    padding: 9px 13px; border-radius: 12px;
    font-size: 12px; font-weight: 900; letter-spacing: 0.08em; text-transform: uppercase;
    color: var(--muted); background: transparent;
    transition: transform 0.12s ease, background 0.18s ease, color 0.2s ease, box-shadow 0.18s ease;
  }
  .vibe-2122 .pill button[aria-pressed="true"] {
    color: var(--ink);
    background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.8));
    box-shadow: 0 0 0 1px rgba(10,16,28,0.08) inset, 0 8px 16px rgba(10,16,28,0.12);
  }
  .vibe-2122.night .pill button[aria-pressed="true"] {
    color: #0e1220; background: rgba(255,255,255,0.92);
  }
  .vibe-2122 .pill button:hover { transform: translateY(-1px); }

  .vibe-2122 .range { gap: 10px; }
  .vibe-2122 .range output { font-variant-numeric: tabular-nums; min-width: 5ch; text-align: right; }
  .vibe-2122 .range input[type="range"] { appearance: none; width: 180px; height: 22px; background: transparent; }
  .vibe-2122 .range input[type="range"]::-webkit-slider-runnable-track {
    height: 6px; border-radius: 999px; background: linear-gradient(90deg, var(--a), var(--b), var(--c));
    box-shadow: 0 0 0 1px rgba(0,0,0,0.08) inset;
  }
  .vibe-2122 .range input[type="range"]::-webkit-slider-thumb {
    appearance: none; margin-top: -6px; width: 18px; height: 18px; border-radius: 50%;
    background: #ffffff; border: 1px solid rgba(14,18,32,0.22);
    box-shadow: 0 0 0 3px rgba(14,18,32,0.06), 0 6px 16px rgba(10,16,28,0.16);
  }
  .vibe-2122 .range input[type="range"]::-moz-range-track {
    height: 6px; border-radius: 999px; background: linear-gradient(90deg, var(--a), var(--b), var(--c));
    box-shadow: 0 0 0 1px rgba(0,0,0,0.08) inset;
  }
  .vibe-2122 .range input[type="range"]::-moz-range-thumb {
    width: 18px; height: 18px; border-radius: 50%;
    background: #ffffff; border: 1px solid rgba(14,18,32,0.22);
    box-shadow: 0 0 0 3px rgba(14,18,32,0.06), 0 6px 16px rgba(10,16,28,0.16);
  }

  .vibe-2122 .switch button {
    appearance: none; border: 0; cursor: pointer;
    width: 46px; height: 24px; border-radius: 999px; position: relative;
    background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6));
    box-shadow: 0 0 0 1px rgba(14,18,32,0.12) inset, 0 6px 14px rgba(0,0,0,0.08);
  }
  .vibe-2122.night .switch button { background: linear-gradient(180deg, rgba(255,255,255,0.24), rgba(255,255,255,0.1)); }
  .vibe-2122 .switch button::after {
    content: ""; position: absolute; top: 3px; left: 3px; width: 18px; height: 18px; border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #ffffff, #e6ebf5);
    border: 1px solid rgba(10,16,28,0.22);
    box-shadow: 0 2px 10px rgba(10,16,28,0.18);
    transition: transform 0.18s ease;
  }
  .vibe-2122 .switch button[aria-pressed="true"]::after { transform: translateX(22px); }

  .vibe-2122 .palette { gap: 8px; padding: 8px 10px; }
  .vibe-2122 .sw {
    width: 26px; height: 26px; border-radius: 7px;
    border: 1px solid var(--edge);
    background: var(--preview, linear-gradient(90deg, var(--a), var(--b), var(--c)));
    transform: rotate(6deg);
    cursor: pointer; transition: transform 0.18s ease, box-shadow 0.22s ease, filter 0.22s ease;
    box-shadow: 0 14px 22px rgba(0,0,0,0.16);
  }
  .vibe-2122 .sw:hover { transform: rotate(6deg) translateY(-2px) scale(1.06); filter: saturate(1.1); }
  .vibe-2122 .sw.active { box-shadow: 0 0 0 3px rgba(255,255,255,0.9), 0 0 0 8px color-mix(in srgb, var(--b), transparent 86%); }
  .vibe-2122.night .sw.active { box-shadow: 0 0 0 3px rgba(255,255,255,0.2), 0 0 0 8px color-mix(in srgb, var(--b), transparent 86%); }

  /* Poster */
  .vibe-2122 .poster {
    position: relative; margin: 12px 0 18px;
    width: 100%; aspect-ratio: 3 / 4;
    border-radius: 28px; overflow: hidden;
    border: 1px solid var(--edge);
    background: var(--paper);
    box-shadow:
      0 60px 140px rgba(0,0,0,0.18),
      0 12px 30px rgba(0,0,0,0.06),
      0 0 0 1px rgba(255,255,255,0.6) inset;
    transform: perspective(1400px) rotateX(var(--rx)) rotateY(var(--ry));
    transition: box-shadow 0.25s ease, transform 0.12s ease;
  }
  .vibe-2122.night .poster { box-shadow: 0 60px 140px rgba(0,0,0,0.5), 0 18px 40px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.06) inset; }

  .vibe-2122 canvas.aurora {
    position: absolute; inset: 0; width: 100%; height: 100%;
    filter: saturate(120%) contrast(105%);
  }

  .vibe-2122 .foil {
    position: absolute; inset: 0; pointer-events: none; z-index: 2;
    background:
      linear-gradient(120deg,
        color-mix(in oklab, var(--a), transparent 90%) 0%,
        color-mix(in oklab, var(--b), transparent 90%) 50%,
        color-mix(in oklab, var(--c), transparent 90%) 100%) 0/220% 220%;
    mix-blend-mode: overlay;
    animation: v2122-foil 16s ease-in-out infinite;
    opacity: 0.9;
  }
  @keyframes v2122-foil { 0%,100% { background-position: 0% 50% } 50% { background-position: 100% 50% } }

  .vibe-2122 .grid-overlay {
    position: absolute; inset: 0; pointer-events: none; z-index: 3;
    background:
      linear-gradient(to right, rgba(14,18,32,0.06) 1px, transparent 1px) 0 0 / 40px 40px,
      linear-gradient(to bottom, rgba(14,18,32,0.06) 1px, transparent 1px) 0 0 / 40px 40px;
    opacity: 0; transition: opacity 0.2s ease;
  }
  .vibe-2122.night .grid-overlay {
    background:
      linear-gradient(to right, rgba(255,255,255,0.08) 1px, transparent 1px) 0 0 / 40px 40px,
      linear-gradient(to bottom, rgba(255,255,255,0.08) 1px, transparent 1px) 0 0 / 40px 40px;
  }
  .vibe-2122 .poster.grid-on .grid-overlay { opacity: 1; }

  .vibe-2122 .grain {
    position: absolute; inset: 0; pointer-events: none; z-index: 1;
    opacity: var(--grain);
    background:
      radial-gradient(120px 120px at 30% 20%, rgba(0,0,0,0.04), transparent 60%),
      conic-gradient(from 0deg at 50% 50%, rgba(0,0,0,0.06), transparent 25% 50%, rgba(0,0,0,0.06) 50% 75%, transparent 75% 100%);
    mix-blend-mode: multiply;
    filter: contrast(130%) saturate(110%);
  }
  .vibe-2122.night .grain { filter: contrast(120%) saturate(130%); }

  .vibe-2122 .title {
    position: absolute; inset: 0; z-index: 4;
    display: grid; grid-template-rows: 1fr auto auto 1fr;
    padding: clamp(16px, 4.5vw, 38px);
  }
  .vibe-2122 .stamp {
    place-self: start;
    display: inline-flex; align-items: center; gap: 8px;
    padding: 8px 12px; border-radius: 999px;
    font-size: 11px; letter-spacing: 0.18em; text-transform: uppercase;
    background: rgba(255,255,255,0.85);
    border: 1px solid var(--edge);
    color: var(--muted);
    box-shadow: 0 0 0 1px rgba(255,255,255,0.8) inset;
  }
  .vibe-2122.night .stamp { background: rgba(0,0,0,0.3); box-shadow: 0 0 0 1px rgba(255,255,255,0.12) inset; color: var(--ink); }

  .vibe-2122 .big {
    align-self: end;
    font-size: clamp(42px, 8.5vw, 100px);
    line-height: 0.9; letter-spacing: -0.03em;
    font-weight: 900; font-style: italic;
    background: linear-gradient(100deg, var(--a), var(--b) 45%, var(--c)) 0/200% 200%;
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 2px 0 rgba(255,255,255,0.6);
    animation: v2122-shift 14s ease-in-out infinite reverse;
  }
  .vibe-2122.night .big { text-shadow: none; }

  .vibe-2122 .sub {
    align-self: start; margin-top: 10px;
    font-size: clamp(14px, 2.2vw, 18px);
    color: color-mix(in srgb, var(--ink), var(--muted) 42%);
    opacity: 0.9;
  }

  .vibe-2122 .meta {
    display: flex; gap: 12px; align-items: center; flex-wrap: wrap;
    font-size: 12px; color: var(--muted); margin-top: 16px;
  }
  .vibe-2122 .sep { width: 4px; height: 4px; border-radius: 50%; background: var(--edge); }

  /* Typography face toggle */
  .vibe-2122.serif h1, .vibe-2122.serif .big { font-family: ui-serif, Georgia, "Times New Roman", serif; }
  .vibe-2122.serif .lead, .vibe-2122.serif .sub { font-family: ui-serif, Georgia, "Times New Roman", serif; }
  .vibe-2122:not(.serif) h1, .vibe-2122:not(.serif) .big { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji"; }
  .vibe-2122:not(.serif) .lead, .vibe-2122:not(.serif) .sub { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }

  @media (prefers-reduced-motion: reduce) {
    .vibe-2122 h1, .vibe-2122 .big, .vibe-2122 .foil { animation: none; }
    .vibe-2122 .poster { transform: none; }
  }

  @media (max-width: 900px) {
    .vibe-2122 { border-radius: 28px; padding: 22px 16px; }
    .vibe-2122 h1 { font-size: clamp(34px, 11vw, 86px); }
    .vibe-2122 .range input[type="range"] { width: 150px; }
    .vibe-2122 .poster { aspect-ratio: 1 / 1.2; }
  }
</style>

<div class="vibe-2122 serif" role="region" aria-label="Daylight Poster Lab â€” living print composer">
  <div class="wrap">
    <div class="topline">
      <div class="tag"><span class="pulse" aria-hidden="true"></span> Poster&nbsp;Lab Â· 2122</div>
      <div class="actions">
        <button class="chip dice" title="Remix palette" aria-label="Remix">ðŸŽ²</button>
        <button class="chip theme" title="Toggle theme" aria-pressed="false" aria-label="Theme">â˜€ï¸Ž</button>
      </div>
    </div>

    <h1>Daylight Poster Lab</h1>
    <p class="lead">Compose a living printâ€”auroras, grids, and type that breathe. Tilt with your cursor; tune the canvas below.</p>

    <div class="dock" role="group" aria-label="Controls">
      <div class="pill" role="group" aria-label="Type">
        <button class="face" data-face="serif" aria-pressed="true" title="Serif">Serif</button>
        <button class="face" data-face="sans" aria-pressed="false" title="Sans">Sans</button>
      </div>

      <label class="range" title="Intensity">
        <span>Intensity</span>
        <input class="intensity" type="range" min="0" max="100" value="60" step="1" aria-label="Intensity">
        <output class="out out-int">0.60</output>
      </label>

      <label class="range" title="Grain">
        <span>Grain</span>
        <input class="grain-slider" type="range" min="0" max="100" value="12" step="1" aria-label="Grain">
        <output class="out out-grain">0.12</output>
      </label>

      <div class="switch grid" title="Grid">
        <span>Grid</span>
        <button class="gridbtn" aria-pressed="false" aria-label="Toggle grid"></button>
      </div>

      <div class="switch live" title="Live">
        <span>Live</span>
        <button class="livebtn" aria-pressed="true" aria-label="Toggle live"></button>
      </div>

      <div class="palette" aria-label="Palette">
        <button class="sw" data-colors="#ff7a7a|#7acbff|#9aff8a" style="--preview:linear-gradient(90deg,#ff7a7a,#7acbff,#9aff8a)" aria-label="Aurora Day"></button>
        <button class="sw" data-colors="#8a5cf6|#06b6d4|#f59e0b" style="--preview:linear-gradient(90deg,#8a5cf6,#06b6d4,#f59e0b)" aria-label="Violet Tide"></button>
        <button class="sw" data-colors="#22d3ee|#a78bfa|#34d399" style="--preview:linear-gradient(90deg,#22d3ee,#a78bfa,#34d399)" aria-label="Lagoon"></button>
        <button class="sw" data-colors="#f97316|#06b6d4|#84cc16" style="--preview:linear-gradient(90deg,#f97316,#06b6d4,#84cc16)" aria-label="Citrus Sea"></button>
        <button class="sw" data-colors="#111827|#6b7280|#60a5fa" style="--preview:linear-gradient(90deg,#111827,#6b7280,#60a5fa)" aria-label="Ink Frost"></button>
      </div>
    </div>

    <div class="poster" aria-hidden="true">
      <canvas class="aurora"></canvas>
      <div class="grain" aria-hidden="true"></div>
      <div class="foil" aria-hidden="true"></div>
      <div class="grid-overlay" aria-hidden="true"></div>

      <div class="title" aria-hidden="true">
        <div class="stamp">Edition&nbsp;2122</div>
        <div class="big">Bright&nbsp;Ideas</div>
        <div class="sub">Built in your browser.</div>
      </div>
    </div>

    <div class="meta">
      <span id="last-updated">Last updated: 2026-01-22 11:33:29 EST</span>
      <span class="sep" aria-hidden="true"></span>
      <span>Drag to tilt Â· sliders to tune Â· dice to remix</span>
    </div>
  </div>
</div>

<script>
(function () {
  const root = document.currentScript.previousElementSibling;
  const updatedEl = root.querySelector('#last-updated');

  // Timestamp
  try {
    const now = new Date();
    const fmt = new Intl.DateTimeFormat([], {
      year: 'numeric', month: '2-digit', day: '2-digit',
      hour: '2-digit', minute: '2-digit', second: '2-digit',
      hour12: false, timeZoneName: 'short'
    });
    updatedEl.textContent = 'Last updated: ' + fmt.format(now);
  } catch (_) {
    updatedEl.textContent = 'Last updated: ' + new Date().toLocaleString();
  }

  // Elements
  const poster = root.querySelector('.poster');
  const canvas = root.querySelector('canvas.aurora');
  const ctx = canvas.getContext('2d', { alpha: true });
  const faceBtns = Array.from(root.querySelectorAll('.face'));
  const themeBtn = root.querySelector('.theme');
  const dice = root.querySelector('.dice');
  const swatches = Array.from(root.querySelectorAll('.sw'));
  const gridBtn = root.querySelector('.gridbtn');
  const liveBtn = root.querySelector('.livebtn');
  const intEl = root.querySelector('.intensity');
  const grainEl = root.querySelector('.grain-slider');
  const outInt = root.querySelector('.out-int');
  const outGrain = root.querySelector('.out-grain');

  // Theme
  let night = false;
  function applyTheme(setNight) {
    night = setNight ?? !night;
    root.classList.toggle('night', night);
    themeBtn.setAttribute('aria-pressed', String(night));
    themeBtn.textContent = night ? 'â˜¾' : 'â˜€ï¸Ž';
  }
  themeBtn.addEventListener('click', () => applyTheme());
  applyTheme(false);

  // Font face
  faceBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const face = btn.getAttribute('data-face');
      faceBtns.forEach(b => b.setAttribute('aria-pressed', String(b === btn)));
      root.classList.toggle('serif', face === 'serif');
    });
  });

  // Palette
  function applyPalette(c1, c2, c3) {
    root.style.setProperty('--a', c1);
    root.style.setProperty('--b', c2);
    root.style.setProperty('--c', c3);
  }
  swatches.forEach((b, i) => {
    b.addEventListener('click', () => {
      swatches.forEach(x => x.classList.toggle('active', x === b));
      const colors = (b.getAttribute('data-colors') || '').split('|');
      if (colors.length === 3) applyPalette(colors[0], colors[1], colors[2]);
      root.animate({ transform: ['scale(0.995)', 'scale(1)'] }, { duration: 160, easing: 'ease-out' });
    });
    if (i === 0) b.classList.add('active');
  });
  {
    const init = swatches[0].getAttribute('data-colors').split('|');
    applyPalette(init[0], init[1], init[2]);
  }
  dice.addEventListener('click', () => {
    const picks = [
      ['#ff7a7a','#7acbff','#9aff8a'],
      ['#8a5cf6','#06b6d4','#f59e0b'],
      ['#22d3ee','#a78bfa','#34d399'],
      ['#f97316','#06b6d4','#84cc16'],
      ['#60a5fa','#f472b6','#a3e635'],
      ['#ff8ab3','#7dd3fc','#ffd166'],
      ['#0ea5e9','#a3e635','#f59e0b']
    ];
    const pick = picks[Math.floor(Math.random() * picks.length)];
    applyPalette(pick[0], pick[1], pick[2]);
  });

  // Grid + live
  let gridOn = false;
  let live = true;
  gridBtn.addEventListener('click', () => {
    gridOn = !gridOn;
    gridBtn.setAttribute('aria-pressed', String(gridOn));
    poster.classList.toggle('grid-on', gridOn);
  });
  liveBtn.addEventListener('click', () => {
    live = !live;
    liveBtn.setAttribute('aria-pressed', String(live));
    if (live) raf();
  });

  // Sliders
  let intensity = (parseInt(intEl.value, 10) || 60) / 100; // 0..1
  let grain = (parseInt(grainEl.value, 10) || 12) / 100; // 0..1
  function updateOut() {
    outInt.textContent = intensity.toFixed(2);
    outGrain.textContent = grain.toFixed(2);
    root.style.setProperty('--grain', grain.toFixed(2));
  }
  updateOut();
  intEl.addEventListener('input', (e) => { intensity = Math.max(0, Math.min(1, e.target.value/100)); updateOut(); });
  grainEl.addEventListener('input', (e) => { grain = Math.max(0, Math.min(1, e.target.value/100)); updateOut(); });

  // Pointer tilt
  const tilt = { tx: 0, ty: 0, x: 0, y: 0 };
  poster.addEventListener('pointermove', (e) => {
    const r = poster.getBoundingClientRect();
    const nx = ((e.clientX - r.left) / r.width - 0.5) * 2; // -1..1
    const ny = ((e.clientY - r.top) / r.height - 0.5) * 2;
    tilt.tx = nx; tilt.ty = ny;
    // Move ambient glow
    root.style.setProperty('--mx', (e.clientX / window.innerWidth) * 100 + '%');
    root.style.setProperty('--my', (e.clientY / window.innerHeight) * 100 + '%');
  }, { passive: true });
  poster.addEventListener('pointerleave', () => { tilt.tx = 0; tilt.ty = 0; });

  // Resize
  let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
  let W = 0, H = 0, lowW = 0, lowH = 0;
  const buf = document.createElement('canvas');
  const bctx = buf.getContext('2d', { alpha: true });
  function resize() {
    const rect = poster.getBoundingClientRect();
    W = Math.max(2, Math.floor(rect.width));
    H = Math.max(2, Math.floor(rect.height));
    const scale = 0.42; // render at lower resolution for performance
    lowW = Math.max(2, Math.floor(W * scale));
    lowH = Math.max(2, Math.floor(H * scale));
    canvas.width = Math.floor(W * dpr);
    canvas.height = Math.floor(H * dpr);
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    buf.width = lowW;
    buf.height = lowH;
    bctx.setTransform(1, 0, 0, 1, 0, 0);
    bctx.imageSmoothingEnabled = true;
    bctx.imageSmoothingQuality = 'high';
  }
  resize();
  new ResizeObserver(resize).observe(poster);

  // Color helpers
  function hexToRgb(hex) {
    const m = hex.trim().replace('#','');
    const p = m.length === 3 ? m.split('').map(ch => ch+ch).join('') : m;
    const n = parseInt(p, 16);
    return { r: (n>>16)&255, g: (n>>8)&255, b: n&255 };
  }
  function mix(a, b, t) {
    return {
      r: Math.round(a.r + (b.r - a.r) * t),
      g: Math.round(a.g + (b.g - a.g) * t),
      b: Math.round(a.b + (b.b - a.b) * t)
    };
  }
  function paletteSample(tmix) {
    const style = getComputedStyle(root);
    const c1 = hexToRgb((style.getPropertyValue('--a') || '#ff7a7a').trim());
    const c2 = hexToRgb((style.getPropertyValue('--b') || '#7acbff').trim());
    const c3 = hexToRgb((style.getPropertyValue('--c') || '#9aff8a').trim());
    if (tmix < 0.5) return mix(c1, c2, tmix * 2);
    return mix(c2, c3, (tmix - 0.5) * 2);
  }

  // Aurora renderer (plasma-style)
  let t = 0;
  const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (reduce) { live = false; liveBtn.setAttribute('aria-pressed', 'false'); }

  function drawAurora(dt) {
    // low-res plasma into buffer
    const img = bctx.createImageData(lowW, lowH);
    const data = img.data;
    const style = getComputedStyle(root);
    const soft = night ? 0.75 : 0.9;
    const speed = 0.6 + intensity * 1.6;
    const freq = 2.0 + intensity * 3.0;
    let i = 0;
    for (let y = 0; y < lowH; y++) {
      const ny = y / lowH;
      for (let x = 0; x < lowW; x++) {
        const nx = x / lowW;
        const v =
          Math.sin((nx * Math.PI * freq) + t * speed) * 0.5 +
          Math.cos((ny * Math.PI * (freq * 0.8)) - t * (speed * 1.1)) * 0.3 +
          Math.sin(((nx + ny) * Math.PI * (freq * 0.6)) + t * (speed * 0.7)) * 0.2;
        const u = (v * 0.5 + 0.5) * soft;
        const col = paletteSample(u);
        data[i++] = col.r;
        data[i++] = col.g;
        data[i++] = col.b;
        data[i++] = 255;
      }
    }
    bctx.putImageData(img, 0, 0);

    // draw to main canvas with vignette
    ctx.clearRect(0, 0, W, H);
    ctx.globalCompositeOperation = 'source-over';
    ctx.drawImage(buf, 0, 0, lowW, lowH, 0, 0, W, H);

    // subtle radial mask
    const g = ctx.createRadialGradient(W*0.5, H*0.5, Math.min(W,H)*0.1, W*0.5, H*0.5, Math.min(W,H)*0.8);
    g.addColorStop(0, night ? 'rgba(0,0,0,0)' : 'rgba(255,255,255,0)');
    g.addColorStop(1, night ? 'rgba(0,0,0,0.32)' : 'rgba(255,255,255,0.22)');
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, W, H);
  }

  function raf() {
    if (!live) return;
    // ease tilt
    tilt.x += (tilt.tx - tilt.x) * 0.08;
    tilt.y += (tilt.ty - tilt.y) * 0.08;
    const maxDeg = 6;
    root.style.setProperty('--ry', (tilt.x * maxDeg).toFixed(3) + 'deg');
    root.style.setProperty('--rx', (-tilt.y * maxDeg).toFixed(3) + 'deg');

    const dt = 0.016;
    t += dt;
    drawAurora(dt);
    requestAnimationFrame(raf);
  }

  // Initial paint
  drawAurora(0);
  if (!reduce) raf();

  // Keep transform responsive when not animating
  let idleRAF;
  function idleTilt() {
    tilt.x += (tilt.tx - tilt.x) * 0.12;
    tilt.y += (tilt.ty - tilt.y) * 0.12;
    const maxDeg = 6;
    root.style.setProperty('--ry', (tilt.x * maxDeg).toFixed(3) + 'deg');
    root.style.setProperty('--rx', (-tilt.y * maxDeg).toFixed(3) + 'deg');
    if (!live) idleRAF = requestAnimationFrame(idleTilt);
  }
  poster.addEventListener('pointermove', () => {
    if (!live && !idleRAF) idleTilt();
  });
  poster.addEventListener('pointerleave', () => {
    if (!live && !idleRAF) idleTilt();
  });

})();
</script>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


