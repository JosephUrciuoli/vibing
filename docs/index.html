<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div class="v101" data-theme="mist" aria-live="polite">
  <style>
    .v101 {
      --radius: 28px;
      --pad: clamp(18px, 3.2vw, 42px);
      --shadow: 0 40px 120px rgba(0,0,0,0.20), inset 0 1px 0 rgba(255,255,255,0.5);
      --ink: #0b1020; --muted:#56607a;
      --a1:#7aa5ff; --a2:#ff9fbd; --a3:#7ef7d1; --a4:#ffd66e;
      --bg-1: #f7f8ff; --bg-2:#ffffff;
      position: relative;
      border-radius: var(--radius);
      padding: var(--pad);
      min-height: 760px;
      color: var(--ink);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background:
        radial-gradient(1100px 700px at 15% -10%, color-mix(in oklab, var(--a1) 16%, transparent), transparent 62%),
        radial-gradient(900px 700px at 110% 120%, color-mix(in oklab, var(--a2) 14%, transparent), transparent 70%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      box-shadow: var(--shadow);
      overflow: hidden;
      isolation: isolate;
    }
    .v101[data-theme="dusk"]{
      --ink:#eaf2ff; --muted:#a9b6cc;
      --a1:#61e9ff; --a2:#ff6ac1; --a3:#a4ff6a; --a4:#ffe36a;
      --bg-1:#0b0f19; --bg-2:#080a12;
      background:
        radial-gradient(1100px 700px at 75% -10%, rgba(97,233,255,0.18), transparent 62%),
        radial-gradient(900px 700px at -10% 120%, rgba(255,106,193,0.14), transparent 70%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), 0 80px 220px rgba(0,0,0,0.65);
    }
    .v101[data-theme="prism"]{
      --ink:#061016; --muted:#2a4b58;
      --a1:#5df0ff; --a2:#ffd36e; --a3:#b483ff; --a4:#62ff9b;
      --bg-1:#f6fffb; --bg-2:#f8f0ff;
      background:
        radial-gradient(900px 600px at 40% -10%, color-mix(in oklab, var(--a3) 18%, transparent), transparent 64%),
        radial-gradient(900px 700px at 120% 120%, color-mix(in oklab, var(--a4) 16%, transparent), transparent 72%),
        linear-gradient(180deg, var(--bg-1), var(--bg-2));
    }

    .v101 *{ box-sizing: border-box; }
    .v101 .grain{
      position:absolute; inset:-30% -10%;
      background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Cfilter id='n'%3E%3CfeTurbulence baseFrequency='0.85' numOctaves='2'/%3E%3C/filter%3E%3Crect width='140' height='140' filter='url(%23n)' opacity='0.5'/%3E%3C/svg%3E") center/220px 220px repeat;
      opacity:.06; mix-blend-mode:multiply; pointer-events:none; z-index:0;
      animation: v101-noise 16s steps(12) infinite;
    }
    @keyframes v101-noise { to { transform: translate3d(2%, -1%, 0); } }

    .v101 .chrome{
      position: relative; z-index:2;
      display:grid; grid-template-columns: 1fr auto; gap: 14px; align-items:center;
    }
    .v101 .brand{
      display:inline-flex; align-items:center; gap: 12px; user-select:none;
      color: var(--muted); font-weight:800; letter-spacing:.02em;
    }
    .v101 .logo{
      width: 36px; height: 36px; border-radius: 12px;
      background:
        radial-gradient(circle at 28% 30%, #fff, rgba(255,255,255,0.18) 42%, transparent 60%),
        conic-gradient(from 140deg, var(--a1), var(--a2), var(--a3), var(--a4), var(--a1) 96%);
      box-shadow: inset 0 0 0 7px rgba(255,255,255,0.55), 0 18px 40px rgba(0,0,0,0.18);
    }

    .v101 .controls{ display:flex; gap: 10px; flex-wrap:wrap; justify-content:flex-end; align-items:center; }
    .v101 .seg{
      display:flex; gap:0; border-radius:999px; overflow:hidden; border:1px solid rgba(12,18,28,0.12);
      background: rgba(255,255,255,0.75); backdrop-filter: blur(8px);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.85), 0 12px 26px rgba(0,0,0,0.1);
    }
    .v101[data-theme="dusk"] .seg, .v101[data-theme="prism"] .seg{
      background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.10);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), 0 12px 26px rgba(0,0,0,0.4);
    }
    .v101 .seg button{
      appearance:none; border:0; background:transparent; color: var(--muted); font-weight:800; font-size:12px; padding: 8px 12px; cursor:pointer;
      transition: background 160ms ease, color 160ms ease, transform 120ms ease;
    }
    .v101 .seg button[aria-pressed="true"]{
      color:#06121f; background: linear-gradient(135deg, var(--a1), var(--a2));
    }
    .v101[data-theme="dusk"] .seg button[aria-pressed="true"], .v101[data-theme="prism"] .seg button[aria-pressed="true"]{
      color:#051014;
    }

    .v101 .slider{
      display:inline-grid; grid-auto-flow:column; align-items:center; gap:10px; padding:7px 10px;
      border-radius:12px; border:1px solid rgba(12,18,28,0.12); background: rgba(255,255,255,0.72);
      color: var(--muted); font-size:12px; backdrop-filter: blur(8px);
    }
    .v101[data-theme="dusk"] .slider, .v101[data-theme="prism"] .slider{
      background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.10);
    }
    .v101 input[type="range"]{
      -webkit-appearance:none; appearance:none; width: 120px; height: 6px; border-radius:999px; background: rgba(12,18,28,0.16); outline:none;
    }
    .v101[data-theme="dusk"] input[type="range"], .v101[data-theme="prism"] input[type="range"]{
      background: rgba(255,255,255,0.25);
    }
    .v101 input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:18px; height:18px; border-radius:50%; border:1px solid rgba(12,18,28,0.18);
      background: linear-gradient(180deg, #ffffff, #e9eef9); box-shadow: 0 6px 14px rgba(0,0,0,0.15); cursor: grab;
    }

    .v101 .hero{
      position: relative; z-index:2;
      display:grid; grid-template-columns: 1.02fr 1fr; gap: clamp(18px, 4.2vw, 48px); align-items:center; margin-top: 8px;
    }
    @media (max-width: 980px){ .v101 .hero{ grid-template-columns: 1fr; } .v101 .controls{ justify-content:flex-start; } }
    .v101 h1{
      margin: 6px 0 8px;
      font-family: ui-serif, "Iowan Old Style", Georgia, serif;
      font-weight:900; letter-spacing:-0.02em; line-height:.92;
      font-size: clamp(54px, 9.4vw, 120px);
      background: linear-gradient(180deg, var(--ink), color-mix(in oklab, var(--a1) 38%, var(--ink)));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow: 0 18px 70px rgba(12,17,22,0.16);
    }
    .v101[data-theme="dusk"] h1, .v101[data-theme="prism"] h1{
      background: linear-gradient(180deg, #ffffff, color-mix(in srgb, var(--a1) 35%, #cfe7ff));
      -webkit-background-clip:text; color:transparent;
      text-shadow: 0 20px 80px rgba(147,190,255,0.28);
    }
    .v101 .lede{ color: var(--muted); font-size: clamp(16px, 2.2vw, 21px); max-width: 62ch; text-wrap: pretty; margin: 6px 0 16px; }
    .v101 .cta-row{ display:flex; gap:10px; flex-wrap:wrap; }
    .v101 .cta{
      display:inline-flex; align-items:center; gap:10px; padding: 12px 16px; border-radius:14px; font-weight:900; letter-spacing:.2px;
      color:#06121f; background: linear-gradient(135deg, var(--a1), var(--a2));
      text-decoration:none; border:1px solid rgba(12,18,28,0.12); box-shadow: 0 22px 55px rgba(12,17,22,0.14);
      transition: transform 160ms ease, filter 220ms ease;
    }
    .v101 .cta:hover{ transform: translateY(-2px); filter:saturate(112%); }
    .v101 .ghost{
      color: var(--muted); background: rgba(255,255,255,0.7); border:1px solid rgba(12,18,28,0.12);
      box-shadow: 0 14px 36px rgba(12,17,22,0.10);
    }
    .v101[data-theme="dusk"] .ghost, .v101[data-theme="prism"] .ghost{
      background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.10); color: var(--muted);
    }

    .v101 .well{
      position: relative; border-radius: 30px; overflow: hidden;
      border: 1px solid rgba(12,18,28,0.12);
      background: linear-gradient(180deg, rgba(255,255,255,0.84), rgba(255,255,255,0.55));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.82), 0 34px 120px rgba(12,17,22,0.16);
      min-height: clamp(380px, 52vh, 640px);
    }
    .v101[data-theme="dusk"] .well, .v101[data-theme="prism"] .well{
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border-color: rgba(255,255,255,0.10);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08), 0 38px 130px rgba(0,0,0,0.65);
    }
    .v101 canvas{ display:block; width:100%; height:100%; }

    .v101 .cap{
      position:absolute; top:14px; left:14px; padding:6px 10px; font-size:11px; letter-spacing:.2em; text-transform:uppercase;
      color: var(--muted); background: rgba(255,255,255,0.6); border:1px solid rgba(12,18,28,0.12); border-radius:999px; backdrop-filter: blur(4px);
    }
    .v101[data-theme="dusk"] .cap, .v101[data-theme="prism"] .cap{ background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.10); }

    .v101 .chips{ position:absolute; bottom:14px; right:14px; display:flex; gap:8px; flex-wrap:wrap; }
    .v101 .chip{
      padding:6px 10px; font-size:11px; color: var(--muted);
      background: rgba(255,255,255,0.6); border:1px solid rgba(12,18,28,0.12); border-radius:999px; backdrop-filter: blur(4px);
    }
    .v101[data-theme="dusk"] .chip, .v101[data-theme="prism"] .chip{ background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.10); }

    .v101 .halo{
      pointer-events:none; position:absolute; inset:0;
      background:
        radial-gradient(480px 380px at var(--mx,50%) var(--my,40%), rgba(255,255,255,0.18), transparent 62%);
      mix-blend-mode: screen;
    }

    .v101 .foot{
      position:relative; z-index:2; margin-top: 18px; padding-top: 12px; border-top: 1px dashed rgba(12,18,28,0.16);
      display:flex; align-items:center; justify-content:space-between; gap:10px; color: var(--muted); font-size:12px; flex-wrap:wrap;
    }
    .v101[data-theme="dusk"] .foot{ border-top-color: rgba(255,255,255,0.10); }

    @media (prefers-reduced-motion: reduce){
      .v101 .grain{ animation: none; }
      .v101 canvas{ filter: none !important; }
    }
  </style>

  <div class="grain" aria-hidden="true"></div>

  <div class="chrome">
    <div class="brand"><i class="logo" aria-hidden="true"></i> Studio 101 · Lumen Atelier</div>
    <div class="controls" role="toolbar" aria-label="Controls">
      <div class="seg" role="group" aria-label="Theme">
        <button type="button" class="t" data-theme="mist" aria-pressed="true" title="Mist">Mist</button>
        <button type="button" class="t" data-theme="dusk" aria-pressed="false" title="Dusk">Dusk</button>
        <button type="button" class="t" data-theme="prism" aria-pressed="false" title="Prism">Prism</button>
      </div>
      <label class="slider" for="v101Density">Density
        <input id="v101Density" type="range" min="1" max="8" step="1" value="3" aria-label="Adjust ribbon density">
      </label>
      <label class="slider" for="v101Sym">Symmetry
        <input id="v101Sym" type="range" min="3" max="16" step="1" value="8" aria-label="Adjust symmetry">
      </label>
      <label class="slider" for="v101Glow">Glow
        <input id="v101Glow" type="range" min="0" max="1" step="0.01" value="0.55" aria-label="Adjust glow">
      </label>
    </div>
  </div>

  <section class="hero" aria-label="Hero">
    <div>
      <h1>Bend light. Shape time.</h1>
      <p class="lede">Kaleidoscopic ribbons breathe with your cursor. Tune symmetry, invite bloom, and let color find its own rhythm.</p>
      <div class="cta-row">
        <a class="cta" href="#" role="button" aria-label="Bloom now" id="bloomBtn">Bloom now →</a>
        <a class="cta ghost" href="#" role="button" aria-label="Shuffle palette" id="shuffleBtn">Shuffle palette</a>
      </div>
    </div>

    <figure class="well" aria-label="Kaleidoscope">
      <canvas id="bloom" aria-hidden="true"></canvas>
      <div class="halo" aria-hidden="true"></div>
      <div class="cap" aria-hidden="true">kaleidoscope · live</div>
      <div class="chips" aria-hidden="true">
        <div class="chip">Symmetric ribbons</div>
        <div class="chip">Cursor gravity</div>
        <div class="chip">Bloom bursts</div>
      </div>
    </figure>
  </section>

  <div class="foot">
    <span id="last-updated">Last updated: 2025-10-21 07:14:37 EST</span>
    <div>Tips: 1–3 theme • B bloom • S symmetry • Space pause • Move to steer</div>
  </div>

  <script>
    (function(){
      const root = document.querySelector('.v101');
      const updated = root.querySelector('#last-updated');
      const canvas = root.querySelector('#bloom');
      const ctx = canvas.getContext('2d', { alpha: true });
      const themeBtns = [...root.querySelectorAll('.t')];
      const densityEl = root.querySelector('#v101Density');
      const symEl = root.querySelector('#v101Sym');
      const glowEl = root.querySelector('#v101Glow');
      const bloomBtn = root.querySelector('#bloomBtn');
      const shuffleBtn = root.querySelector('#shuffleBtn');
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      // Last updated
      try {
        const now = new Date();
        updated.textContent = 'Last updated: ' + now.toLocaleString(undefined, {
          year:'numeric', month:'2-digit', day:'2-digit',
          hour:'2-digit', minute:'2-digit'
        });
      } catch(e) {
        updated.textContent = 'Last updated: ' + new Date().toString();
      }

      // Fit canvas
      let dpr = Math.min(2, window.devicePixelRatio || 1);
      function fit(){
        const r = canvas.parentElement.getBoundingClientRect();
        canvas.width = Math.max(1, Math.floor(r.width * dpr));
        canvas.height = Math.max(1, Math.floor(r.height * dpr));
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }
      fit();
      window.addEventListener('resize', fit, { passive: true });

      // State
      let running = !prefersReduced;
      let t = 0;
      let density = parseInt(densityEl.value, 10);
      let symmetry = parseInt(symEl.value, 10);
      let glow = parseFloat(glowEl.value);
      let energy = 0; // decays over time; increases on bloom
      const pointer = { x: 0.5, y: 0.4, vx: 0, vy: 0 };

      // Theme/palette
      function palette(){
        const cs = getComputedStyle(root);
        const cols = [
          cs.getPropertyValue('--a1').trim(),
          cs.getPropertyValue('--a2').trim(),
          cs.getPropertyValue('--a3').trim(),
          cs.getPropertyValue('--a4').trim()
        ];
        return cols;
      }
      function isDark(){ return root.getAttribute('data-theme') === 'dusk'; }

      // Utils
      function hex2rgb(hex){
        const h = hex.replace('#','').trim();
        const b = h.length===3 ? [h[0]+h[0], h[1]+h[1], h[2]+h[2]] : [h.slice(0,2),h.slice(2,4),h.slice(4,6)];
        return b.map(v=>parseInt(v,16)).join(',');
      }
      const TAU = Math.PI*2;
      function lerp(a,b,u){ return a + (b-a)*u; }
      function clamp(v,lo,hi){ return Math.max(lo, Math.min(hi, v)); }
      function easeOutCubic(x){ return 1 - Math.pow(1 - x, 3); }
      function rand(min, max){ return min + Math.random()*(max-min); }

      // Drawing
      function clearWithTrails(){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        const alpha = isDark() ? 0.07 : 0.12;
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = isDark() ? `rgba(0,0,0,${alpha})` : `rgba(255,255,255,${alpha})`;
        ctx.fillRect(0,0,w,h);
      }

      function drawRibbons(dt){
        const w = canvas.clientWidth, h = canvas.clientHeight;
        const cx = lerp(w*0.5, w*pointer.x, 0.18);
        const cy = lerp(h*0.5, h*pointer.y, 0.18);
        const cols = palette();

        // subtle vignette later
        const baseR = Math.min(w,h)*0.42;
        const baseThick = lerp(10, 22, glow);

        ctx.save();
        ctx.translate(cx, cy);
        ctx.globalCompositeOperation = 'lighter';
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        ctx.filter = `blur(${lerp(0, 8, glow)}px)`;

        const layers = density + Math.round(energy*3);
        for(let i=0;i<layers;i++){
          const k = (i + t*0.12) % 4;
          const col = cols[i % cols.length];
          const alpha = clamp(0.22 + glow*0.25 + energy*0.25, 0.15, 0.8);
          ctx.strokeStyle = `rgba(${hex2rgb(col)},${alpha})`;
          ctx.lineWidth = baseThick * (0.6 + (i/layers)*0.9);

          const wobble = 0.8 + Math.sin(t*0.6 + i)*0.4 + energy*0.6;
          const reach = baseR * (0.45 + (i/layers)*0.5 + energy*0.2);

          // Draw one ribbon and then rotate/mirror around
          const segs = 7;
          for(let s=0; s<symmetry; s++){
            const baseAng = t*0.18 + (s/symmetry)*TAU;
            ctx.save();
            ctx.rotate(baseAng);
            // top ribbon
            ctx.beginPath();
            ctx.moveTo(0, 0);
            for(let p=1;p<=segs;p++){
              const u = p/segs;
              const r = reach * (0.15 + u*0.95) * (1 + Math.sin(t*0.9 + u*3 + i)*0.08*wobble);
              const y = Math.sin(t*0.8 + u*3 + i)* (12 + 46*u*wobble);
              ctx.lineTo(r, y);
            }
            ctx.stroke();

            // mirrored ribbon
            ctx.scale(1,-1);
            ctx.beginPath();
            ctx.moveTo(0, 0);
            for(let p=1;p<=segs;p++){
              const u = p/segs;
              const r = reach * (0.15 + u*0.95) * (1 + Math.sin(t*1.05 + u*3.2 + i)*0.08*wobble);
              const y = Math.sin(t*0.7 + u*2.8 + i)* (10 + 42*u*wobble);
              ctx.lineTo(r, y);
            }
            ctx.stroke();
            ctx.restore();
          }
        }

        ctx.restore();

        // soft vignette
        const vg = ctx.createRadialGradient(cx, cy, Math.min(w,h)*0.1, cx, cy, Math.max(w,h)*0.9);
        vg.addColorStop(0, 'rgba(0,0,0,0)');
        vg.addColorStop(1, isDark() ? 'rgba(0,0,0,0.25)' : 'rgba(0,0,0,0.10)');
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = vg;
        ctx.fillRect(0,0,w,h);
      }

      function draw(dt){
        clearWithTrails();
        drawRibbons(dt);
        // halo for CSS overlay
        root.style.setProperty('--mx', Math.round(pointer.x*100) + '%');
        root.style.setProperty('--my', Math.round(pointer.y*100) + '%');
      }

      // Animation loop
      let last = performance.now();
      function frame(now){
        if (!running) return;
        const dt = Math.min(64, now - last);
        last = now;
        t += dt/1000;
        energy *= 0.965;
        draw(dt);
        requestAnimationFrame(frame);
      }
      if (!prefersReduced){ requestAnimationFrame(frame); } else { draw(0); }

      // Interactions
      densityEl.addEventListener('input', ()=> density = parseInt(densityEl.value, 10));
      symEl.addEventListener('input', ()=> symmetry = parseInt(symEl.value, 10));
      glowEl.addEventListener('input', ()=> glow = parseFloat(glowEl.value));

      function setTheme(mode){
        root.setAttribute('data-theme', mode);
        themeBtns.forEach(b => b.setAttribute('aria-pressed', String(b.dataset.theme === mode)));
        // gentle flash
        const well = root.querySelector('.well');
        well.style.transition = 'filter 240ms ease';
        well.style.filter = 'brightness(1.08)';
        setTimeout(()=> well.style.filter = '', 240);
      }
      themeBtns.forEach(btn => btn.addEventListener('click', ()=> setTheme(btn.dataset.theme)));

      // Time-based default
      const hour = new Date().getHours();
      setTheme(hour < 7 ? 'dusk' : hour < 17 ? 'mist' : 'prism');

      // Pointer steering (with inertia)
      function updatePointer(e){
        const r = canvas.getBoundingClientRect();
        const nx = (e.clientX - r.left) / r.width;
        const ny = (e.clientY - r.top) / r.height;
        pointer.vx = nx - pointer.x;
        pointer.vy = ny - pointer.y;
        pointer.x = nx; pointer.y = ny;
      }
      root.addEventListener('pointermove', updatePointer, { passive: true });
      root.addEventListener('pointerleave', ()=> { pointer.x = 0.5; pointer.y = 0.4; }, { passive: true });

      // Bloom and shuffle
      function bloom(intensity=1){
        energy = clamp(energy + intensity, 0, 2.5);
        // quick pulse
        const well = root.querySelector('.well');
        well.animate([{ transform:'scale(1)' }, { transform:'scale(1.02)' }, { transform:'scale(1)' }], { duration: 360, easing:'ease-out' });
      }
      bloomBtn.addEventListener('click', (e)=> { e.preventDefault(); bloom(1.2); });

      function shufflePalette(){
        // rotate accents cyclically for a fun shift
        const styles = getComputedStyle(root);
        const a1 = styles.getPropertyValue('--a1').trim();
        const a2 = styles.getPropertyValue('--a2').trim();
        const a3 = styles.getPropertyValue('--a3').trim();
        const a4 = styles.getPropertyValue('--a4').trim();
        root.style.setProperty('--a1', a2);
        root.style.setProperty('--a2', a3);
        root.style.setProperty('--a3', a4);
        root.style.setProperty('--a4', a1);
        bloom(0.8);
      }
      shuffleBtn.addEventListener('click', (e)=> { e.preventDefault(); shufflePalette(); });

      // Keyboard
      document.addEventListener('keydown', (e)=>{
        if (e.target && /input|textarea|select/i.test(e.target.tagName)) return;
        if (e.key === '1') setTheme('mist');
        if (e.key === '2') setTheme('dusk');
        if (e.key === '3') setTheme('prism');
        if (e.key.toLowerCase() === 'b'){ bloom(1.1); }
        if (e.key.toLowerCase() === 's'){
          symmetry = symmetry % 16 + 1;
          symEl.value = symmetry;
          bloom(0.4);
        }
        if (e.code === 'Space'){
          e.preventDefault();
          running = !running;
          if (running){ last = performance.now(); requestAnimationFrame(frame); }
        }
      });

      // Pause on tab hide
      document.addEventListener('visibilitychange', ()=> {
        running = document.visibilityState === 'visible' && !prefersReduced;
        if (running){ last = performance.now(); requestAnimationFrame(frame); }
      });
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


