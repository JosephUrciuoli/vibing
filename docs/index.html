<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="loom" aria-label="Nebula Loom">
  <style>
    /* Scope to #loom */
    #loom {
      --h: 288;
      --fg: hsl(0 0% 98%);
      --muted: hsl(0 0% 85% / 0.8);
      --bg1: hsl(248 50% 7%);
      --bg2: hsl(220 50% 4%);
      --card: hsl(0 0% 100% / 0.06);
      --stroke: hsl(0 0% 100% / 0.12);
      --glow: hsl(var(--h) 100% 70% / 0.7);
      position: relative;
      border-radius: 22px;
      overflow: hidden;
      padding: clamp(18px, 4vw, 32px);
      min-height: 70vh;
      color: var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, "Helvetica Neue", Arial;
      letter-spacing: 0.2px;
      background:
        radial-gradient(1200px 800px at 85% -20%, hsl(calc(var(--h) + 80) 60% 18% / 0.25), transparent 60%),
        radial-gradient(900px 700px at -10% 120%, hsl(calc(var(--h) - 40) 60% 18% / 0.22), transparent 65%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      isolation: isolate;
    }

    #loom .field {
      position: absolute; inset: 0; z-index: 0; pointer-events: none;
      filter: saturate(120%) brightness(110%);
    }

    /* Rotating sheen layer */
    #loom .sheen {
      position: absolute; inset: -30%; pointer-events: none; z-index: 0; mix-blend-mode: screen; opacity: 0.25;
      background:
        conic-gradient(from var(--rot,0deg),
          transparent 0 20%,
          hsl(var(--h) 90% 55% / 0.15) 25%,
          transparent 30% 55%,
          hsl(calc(var(--h) + 60) 90% 60% / 0.12) 60%,
          transparent 70% 100%);
      animation: spinSheen 32s linear infinite;
      filter: blur(24px);
    }
    @keyframes spinSheen { to { --rot: 360deg; } }

    /* Tactile grain */
    #loom .grain { position: absolute; inset: 0; z-index: 0; pointer-events: none; opacity: 0.08;
      background-image:
        radial-gradient(circle at 30% 20%, rgba(255,255,255,0.05) 0 2px, transparent 3px),
        radial-gradient(circle at 70% 80%, rgba(255,255,255,0.05) 0 2px, transparent 3px);
      background-size: 6px 6px, 5px 5px;
      mix-blend-mode: overlay;
    }

    /* Top area */
    #loom .top {
      position: relative; z-index: 2;
      display: flex; justify-content: space-between; align-items: center; gap: 16px;
      margin-bottom: clamp(12px, 3vw, 24px);
    }
    #loom .mark {
      display: inline-flex; align-items: center; gap: 12px; user-select: none;
    }
    #loom .glyph {
      width: 20px; height: 20px; border-radius: 50%;
      background:
        radial-gradient(closest-side, var(--glow), transparent 70%),
        conic-gradient(from 0deg, hsl(var(--h) 90% 70%), hsl(calc(var(--h)+40) 90% 70%), hsl(calc(var(--h)+80) 90% 70%), hsl(var(--h) 90% 70%));
      filter: drop-shadow(0 0 6px var(--glow));
      animation: slowSpin 18s linear infinite;
    }
    @keyframes slowSpin { to { transform: rotate(360deg); } }
    #loom .brand { font-weight: 700; letter-spacing: 1px; text-transform: uppercase; font-size: 12px; opacity: 0.9; }

    #loom .ctrls {
      display: inline-flex; align-items: center; gap: 12px; padding: 10px 12px;
      background: var(--card); border: 1px solid var(--stroke); border-radius: 14px;
      backdrop-filter: blur(10px) saturate(140%); box-shadow: 0 10px 24px hsl(0 0% 0% / 0.25), inset 0 1px 0 hsl(0 0% 100% / 0.06);
    }
    #loom .ctrls label { display: inline-flex; align-items: center; gap: 8px; font-size: 12px; color: var(--muted); }
    #loom input[type="range"] {
      appearance: none; width: 160px; height: 4px; border-radius: 999px; background: hsl(0 0% 100% / 0.18); outline: none;
    }
    #loom input[type="range"]::-webkit-slider-thumb {
      appearance: none; width: 18px; height: 18px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, white 0 15%, hsl(var(--h) 90% 70%) 55%, hsl(var(--h) 90% 60%));
      border: 1px solid hsl(0 0% 100% / 0.35); box-shadow: 0 6px 16px hsl(var(--h) 70% 50% / 0.35);
      cursor: pointer;
    }

    /* Hero copy */
    #loom .hero {
      position: relative; z-index: 2;
      display: grid; gap: 12px; justify-items: start;
      margin: clamp(6px, 3vw, 18px) 0;
    }
    #loom .title {
      margin: 0;
      font-size: clamp(30px, 6.6vw, 64px);
      line-height: 1.02; letter-spacing: 0.3px;
      background: linear-gradient(90deg, hsl(var(--h) 80% 85%), hsl(calc(var(--h)+50) 80% 75%) 60%, hsl(var(--h) 30% 98%));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(0 6px 18px hsl(var(--h) 70% 52% / 0.22));
    }
    #loom .subtitle {
      margin: 0; color: var(--muted); font-size: clamp(14px, 2.4vw, 18px); max-width: 62ch;
    }

    /* Actions */
    #loom .actions { display: flex; gap: 10px; flex-wrap: wrap; margin-top: clamp(12px, 3vw, 18px); }
    #loom .btn {
      position: relative; overflow: hidden; border-radius: 12px; border: 1px solid var(--stroke);
      padding: 10px 14px; font-weight: 700; letter-spacing: 0.2px; cursor: pointer;
      background: hsl(0 0% 100% / 0.08); color: var(--fg);
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease, filter 0.2s ease;
      user-select: none;
    }
    #loom .btn.primary {
      background: linear-gradient(180deg, hsl(var(--h) 85% 57%), hsl(var(--h) 85% 52%));
      box-shadow: 0 10px 26px hsl(var(--h) 80% 50% / 0.35), inset 0 1px 0 hsl(0 0% 100% / 0.3);
    }
    #loom .btn:hover { transform: translateY(-1px); box-shadow: 0 10px 24px hsl(0 0% 0% / 0.25); }
    #loom .btn:active { transform: translateY(0); }

    /* Chips */
    #loom .chips { position: relative; z-index: 2; display: flex; gap: 8px; flex-wrap: wrap; margin-top: 12px; }
    #loom .chip {
      display: inline-flex; align-items: center; gap: 8px; padding: 8px 10px;
      border: 1px solid var(--stroke); border-radius: 999px; background: var(--card); color: var(--muted);
      backdrop-filter: blur(8px); font-size: 12px;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    #loom .chip:hover { transform: translateY(-2px); background: hsl(0 0% 100% / 0.10); }

    /* Footer stamp */
    #loom .foot {
      position: relative; z-index: 2; margin-top: 12px; color: hsl(0 0% 82% / 0.8);
      display: flex; align-items: center; gap: 10px; font-size: 12px;
    }

    /* Theme inversion (day mode) */
    #loom.light {
      --fg: hsl(240 20% 12%);
      --muted: hsl(240 12% 30% / 0.85);
      --bg1: hsl(210 30% 96%);
      --bg2: hsl(210 30% 98%);
      --card: hsl(0 0% 0% / 0.06);
      --stroke: hsl(0 0% 0% / 0.12);
    }
    #loom.light .sheen { mix-blend-mode: multiply; opacity: 0.35; }
    #loom.light .btn { background: hsl(0 0% 0% / 0.06); }

    /* Responsive */
    @media (max-width: 720px) {
      #loom .ctrls { width: 100%; justify-content: space-between; }
      #loom input[type="range"] { width: 120px; }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #loom .glyph, #loom .sheen { animation: none !important; }
    }
  </style>

  <canvas class="field" aria-hidden="true"></canvas>
  <div class="sheen" aria-hidden="true"></div>
  <div class="grain" aria-hidden="true"></div>

  <div class="top">
    <div class="mark">
      <span class="glyph" aria-hidden="true"></span>
      <span class="brand">Nebula Loom</span>
    </div>
    <div class="ctrls" role="group" aria-label="Weave Controls">
      <label for="tone">Tone
        <input id="tone" type="range" min="0" max="360" value="288" aria-label="Hue">
      </label>
      <label for="flow">Flow
        <input id="flow" type="range" min="20" max="180" value="100" aria-label="Speed">
      </label>
      <button class="btn" id="invert" title="Toggle light/dark">Invert</button>
    </div>
  </div>

  <section class="hero" aria-label="Intro">
    <h1 class="title">Weaving light in real time</h1>
    <p class="subtitle">A living field of particles sketches filaments between momentsâ€”delicate, generative, and responsive to your touch.</p>
    <div class="actions">
      <button class="btn primary" id="freeze" data-ripple>Freeze frame</button>
      <button class="btn" id="pulse" data-ripple>Pulse</button>
      <button class="btn" id="shuffle" data-ripple>Shuffle</button>
    </div>
  </section>

  <div class="chips" aria-label="Highlights">
    <span class="chip">Generative Canvas</span>
    <span class="chip">Zero Libraries</span>
    <span class="chip">Pointerâ€‘Reactive</span>
    <span class="chip">Accessible Contrast</span>
  </div>

  <div class="foot">
    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.6" opacity="0.6"/>
      <path d="M12 7v6l4 3" stroke="currentColor" stroke-width="1.6" opacity="0.6" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span id="last-updated">Last updated: 2025-10-31 23:10:14 EST</span>
  </div>

  <script>
    (() => {
      const root = document.getElementById('loom');
      const canvas = root.querySelector('.field');
      const ctx = canvas.getContext('2d', { alpha: true });
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));

      // Controls
      const tone = root.querySelector('#tone');
      const flow = root.querySelector('#flow');
      const invert = root.querySelector('#invert');
      const freezeBtn = root.querySelector('#freeze');
      const pulseBtn = root.querySelector('#pulse');
      const shuffleBtn = root.querySelector('#shuffle');

      // Stamp
      const stamp = root.querySelector('#last-updated');
      try {
        const now = new Date();
        stamp.textContent = new Intl.DateTimeFormat(undefined, {
          year: 'numeric', month: 'short', day: '2-digit',
          hour: '2-digit', minute: '2-digit', second: '2-digit',
          hour12: false, timeZoneName: 'short'
        }).format(now);
      } catch (e) {
        stamp.textContent = 'Last updated: ' + new Date().toLocaleString();
      }

      // State
      let W = 0, H = 0, running = true;
      let hue = +tone.value || 288;
      let speedScalar = (+flow.value || 100) / 100;
      let particles = [];
      let mouse = { x: -1e6, y: -1e6, down: false };
      const prefersReduced = window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches;

      function resize() {
        const rect = root.getBoundingClientRect();
        W = Math.max(320, rect.width);
        H = Math.max(320, rect.height);
        canvas.width = Math.floor(W * dpr);
        canvas.height = Math.floor(H * dpr);
        canvas.style.width = W + 'px';
        canvas.style.height = H + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        seed();
      }

      function seed() {
        const target = Math.max(60, Math.min(160, Math.floor((W * H) / 16000)));
        particles = new Array(target).fill(0).map(() => ({
          x: Math.random() * W,
          y: Math.random() * H,
          vx: (Math.random() - 0.5) * 0.8,
          vy: (Math.random() - 0.5) * 0.8,
          r: 1 + Math.random() * 1.4
        }));
      }

      // Draw
      function frame() {
        if (!running) return;
        ctx.clearRect(0, 0, W, H);

        const D = 120; // link distance
        const mx = mouse.x, my = mouse.y;
        const attract = mouse.down ? 0.12 : 0.05;

        // Move + draw points
        ctx.lineCap = 'round';
        for (let i = 0; i < particles.length; i++) {
          const p = particles[i];

          // Gentle attraction toward mouse
          if (mx > -1e5) {
            const dx = mx - p.x;
            const dy = my - p.y;
            const dist = Math.hypot(dx, dy) + 0.001;
            const f = (mouse.down ? 1.6 : 1) * attract / dist;
            p.vx += dx * f;
            p.vy += dy * f;
          }

          p.x += p.vx * speedScalar * (prefersReduced ? 0 : 1);
          p.y += p.vy * speedScalar * (prefersReduced ? 0 : 1);

          // Soft wrap
          if (p.x < -10) p.x = W + 10;
          if (p.x > W + 10) p.x = -10;
          if (p.y < -10) p.y = H + 10;
          if (p.y > H + 10) p.y = -10;

          // Subtle friction
          p.vx *= 0.996;
          p.vy *= 0.996;

          // Node
          ctx.beginPath();
          const g = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, 8);
          g.addColorStop(0, `hsla(${hue}, 95%, 72%, 0.35)`);
          g.addColorStop(1, `hsla(${hue}, 95%, 72%, 0)`);
          ctx.fillStyle = g;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();
        }

        // Links (O(n^2) but small n)
        for (let i = 0; i < particles.length; i++) {
          const p = particles[i];
          for (let j = i + 1; j < particles.length; j++) {
            const q = particles[j];
            const dx = q.x - p.x, dy = q.y - p.y;
            const d = Math.hypot(dx, dy);
            if (d < D) {
              const t = 1 - d / D;
              ctx.strokeStyle = `hsla(${hue + t * 50}, 90%, ${60 + t * 20}%, ${0.08 + t * 0.22})`;
              ctx.lineWidth = 1 + t * 1.5;
              ctx.beginPath();
              ctx.moveTo(p.x, p.y);
              ctx.lineTo(q.x, q.y);
              ctx.stroke();
            }
          }
        }

        requestAnimationFrame(frame);
      }

      // Events
      function onMove(e) {
        const rect = root.getBoundingClientRect();
        mouse.x = e.clientX - rect.left;
        mouse.y = e.clientY - rect.top;
      }
      function onLeave() { mouse.x = -1e6; mouse.y = -1e6; mouse.down = false; }
      root.addEventListener('pointermove', onMove, { passive: true });
      root.addEventListener('pointerdown', (e) => { mouse.down = true; onMove(e); });
      root.addEventListener('pointerup', () => { mouse.down = false; });
      root.addEventListener('pointerleave', onLeave);

      // Controls wiring
      tone.addEventListener('input', (e) => {
        hue = +e.target.value;
        root.style.setProperty('--h', hue);
      });
      flow.addEventListener('input', (e) => {
        speedScalar = (+e.target.value) / 100;
      });
      invert.addEventListener('click', () => {
        root.classList.toggle('light');
      });
      freezeBtn.addEventListener('click', () => {
        running = !running;
        freezeBtn.textContent = running ? 'Freeze frame' : 'Resume';
        if (running) requestAnimationFrame(frame);
      });
      pulseBtn.addEventListener('click', () => {
        particles.forEach(p => {
          p.vx += (Math.random() - 0.5) * 2.2;
          p.vy += (Math.random() - 0.5) * 2.2;
        });
      });
      shuffleBtn.addEventListener('click', () => seed());

      // Ripples
      root.querySelectorAll('[data-ripple]').forEach(btn => {
        btn.addEventListener('pointerdown', (e) => {
          const rect = btn.getBoundingClientRect();
          const r = Math.max(rect.width, rect.height);
          const ripple = document.createElement('span');
          Object.assign(ripple.style, {
            position: 'absolute',
            left: (e.clientX - rect.left - r/2) + 'px',
            top: (e.clientY - rect.top - r/2) + 'px',
            width: r + 'px',
            height: r + 'px',
            borderRadius: '50%',
            background: 'radial-gradient(circle, rgba(255,255,255,0.7) 0, rgba(255,255,255,0.3) 35%, rgba(255,255,255,0) 70%)',
            transform: 'scale(0.2)',
            opacity: '0.9',
            pointerEvents: 'none',
            transition: 'transform 520ms ease, opacity 640ms ease'
          });
          btn.appendChild(ripple);
          requestAnimationFrame(() => { ripple.style.transform = 'scale(1.6)'; ripple.style.opacity = '0'; });
          setTimeout(() => ripple.remove(), 700);
        });
      });

      // Init
      window.addEventListener('resize', resize, { passive: true });
      resize();
      if (!prefersReduced) requestAnimationFrame(frame);
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


