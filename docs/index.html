<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="vibe969" role="region" aria-label="Kinetic Garden">
  <style>
    .vibe969 {
      --ink: #0f1320;
      --muted: color-mix(in oklab, var(--ink) 60%, transparent);
      --paper: #ffffff;
      --glass: color-mix(in oklab, var(--paper) 75%, transparent);
      --line: color-mix(in oklab, var(--ink) 12%, transparent);
      --acc1: hsl(195 95% 50%);
      --acc2: hsl(265 88% 62%);
      --halo: color-mix(in oklab, var(--acc1) 20%, transparent);

      position: relative;
      border-radius: 28px;
      color: var(--ink);
      background:
        radial-gradient(1200px 800px at var(--gx, 60%) var(--gy, 24%), color-mix(in oklab, var(--acc1) 12%, transparent), transparent 60%),
        conic-gradient(from 200deg at 70% 10%, color-mix(in oklab, var(--acc2) 9%, transparent), transparent 30%),
        linear-gradient(180deg, #f7faff, #eef2f8);
      box-shadow:
        0 1px 0 rgba(255,255,255,.7) inset,
        0 30px 90px rgba(16, 22, 40, .18);
      padding: clamp(18px, 3.8vw, 34px);
      overflow: hidden;
      isolation: isolate;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans";
    }
    .vibe969[data-theme="night"]{
      --ink:#eaf0ff;
      --muted: color-mix(in oklab, var(--ink) 70%, transparent);
      --paper:#0a0f1a;
      --glass: color-mix(in oklab, #0d1424 78%, transparent);
      --line: color-mix(in oklab, #ffffff 16%, transparent);
      background:
        radial-gradient(1100px 760px at var(--gx, 58%) var(--gy, 22%), color-mix(in oklab, var(--acc2) 16%, transparent), transparent 60%),
        conic-gradient(from 120deg at 40% 0%, color-mix(in oklab, var(--acc1) 10%, transparent), transparent 32%),
        linear-gradient(180deg, #0b101b, #101725);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.03),
        0 38px 100px rgba(0,0,0,.6);
    }
    .vibe969::after{
      content:"";
      position:absolute; inset:-1px;
      background:
        repeating-linear-gradient(90deg, var(--line) 0 1px, transparent 1px 44px),
        repeating-linear-gradient(0deg, var(--line) 0 1px, transparent 1px 44px);
      opacity:.5;
      mask: radial-gradient(140% 100% at 70% -10%, black, transparent 55%);
      pointer-events:none;
      z-index:1;
    }

    /* Top bar */
    .vibe969 .top{
      position:relative; z-index:2;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center;
      gap:12px;
    }
    .vibe969 .brand{
      display:inline-flex; align-items:center; gap:10px;
      font-weight:900; letter-spacing:.4px; text-transform:uppercase; font-size:12px; color:var(--muted);
    }
    .vibe969 .seed{
      width:18px; height:18px; border-radius:8px; position:relative; overflow:hidden;
      background: radial-gradient(circle at 30% 30%, var(--acc2), var(--acc1));
      box-shadow: 0 0 0 2px color-mix(in oklab, var(--acc1) 30%, transparent), 0 0 18px var(--halo);
    }
    .vibe969 .titlechip{
      justify-self:center;
      display:inline-flex; align-items:center; gap:10px;
      padding:8px 12px; border-radius:999px;
      border:1px solid var(--line);
      background: var(--glass);
      backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 6px 18px rgba(0,0,0,.06);
      color: var(--muted);
      font-size:12px;
      cursor: pointer;
    }
    .vibe969 .k-controls{
      justify-self:end;
      display:inline-flex; gap:8px; align-items:center;
      padding:6px; border-radius:999px; border:1px solid var(--line);
      background: var(--glass);
      backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 8px 20px rgba(0,0,0,.08);
    }
    .vibe969 .btn{
      appearance:none; border:0; cursor:pointer;
      padding:10px 12px; border-radius:12px; font-weight:800; letter-spacing:.3px; font-size:12px;
      color:#0b0f16;
      background: linear-gradient(135deg, var(--acc1), var(--acc2));
      box-shadow: 0 12px 28px color-mix(in oklab, var(--acc1) 26%, transparent);
      transition: transform .14s ease, filter .18s ease;
    }
    .vibe969[data-theme="night"] .btn{ color:#0b0f16; }
    .vibe969 .btn:hover{ transform: translateY(-1px) scale(1.01); }

    /* Canvas field and panels */
    .vibe969 .wrap{
      position:relative; z-index:2;
      margin-top: clamp(14px, 4vw, 26px);
      border-radius: 22px;
      border: 1px solid var(--line);
      overflow:hidden;
      background: linear-gradient(180deg, color-mix(in oklab, var(--paper) 90%, transparent), color-mix(in oklab, var(--paper) 70%, transparent));
      min-height: clamp(360px, 52vw, 580px);
      display:grid;
    }
    .vibe969 .field{
      position:absolute; inset:0; width:100%; height:100%;
      display:block; filter: saturate(115%) contrast(102%);
    }
    .vibe969 .panel{
      align-self:start; justify-self:start;
      margin: clamp(14px, 3vw, 28px);
      max-width: min(660px, 80%);
      background: var(--glass);
      backdrop-filter: blur(10px) saturate(120%);
      border:1px solid var(--line);
      border-radius: 20px;
      padding: clamp(14px, 3vw, 26px);
      box-shadow: 0 14px 38px rgba(0,0,0,.10);
    }
    .vibe969 h1{
      margin:0 0 8px 0;
      font-size: clamp(36px, 7.5vw, 92px);
      line-height:.92; letter-spacing:-.02em;
      background: linear-gradient(180deg, var(--ink), color-mix(in oklab, var(--ink) 70%, var(--acc2)));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-wrap: balance;
    }
    .vibe969 .sub{
      margin:6px 0 10px; color:var(--muted);
      font-size: clamp(14px, 2vw, 18px);
    }
    .vibe969 .actions{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 8px; }
    .vibe969 .ghost{
      appearance:none; border:1px solid var(--line); background:transparent; color:var(--ink);
      border-radius:12px; font-weight:800; letter-spacing:.3px; font-size:12px; padding:10px 12px; cursor:pointer;
      transition: background .18s ease, transform .14s ease;
    }
    .vibe969 .ghost:hover{ background: color-mix(in oklab, var(--paper) 70%, transparent); transform: translateY(-1px); }

    /* Dock controls */
    .vibe969 .dock{
      position:absolute; right: clamp(10px, 3vw, 24px); bottom: clamp(10px, 2.8vw, 20px);
      display:grid; gap:10px; justify-items:end;
    }
    .vibe969 .glass{
      display:flex; align-items:center; gap:10px;
      padding:10px; border-radius:16px; border:1px solid var(--line);
      background: var(--glass);
      backdrop-filter: blur(10px) saturate(120%);
      box-shadow: 0 10px 26px rgba(0,0,0,.10);
    }
    .vibe969 .range{
      --track: color-mix(in oklab, var(--ink) 18%, transparent);
      --fill: linear-gradient(90deg, var(--acc1), var(--acc2));
      display:flex; align-items:center; gap:10px;
    }
    .vibe969 input[type="range"]{
      -webkit-appearance:none; appearance:none; width: 180px; height: 28px; background: transparent; cursor: pointer;
    }
    .vibe969 input[type="range"]::-webkit-slider-runnable-track{
      height: 6px; border-radius: 999px; background: var(--track); border:1px solid var(--line);
    }
    .vibe969 input[type="range"]::-moz-range-track{
      height: 6px; border-radius: 999px; background: var(--track); border:1px solid var(--line);
    }
    .vibe969 input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width: 18px; height: 18px; border-radius: 50%;
      margin-top: -6px;
      background: var(--fill);
      border: 0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--acc1) 28%, transparent);
    }
    .vibe969 input[type="range"]::-moz-range-thumb{
      width: 18px; height: 18px; border-radius:50%; background: var(--fill); border:0;
      box-shadow: 0 6px 16px color-mix(in oklab, var(--acc1) 28%, transparent);
    }
    .vibe969 .val{
      font-variant-numeric: tabular-nums; font-weight:800; font-size:12px; color:var(--muted);
      padding:4px 8px; border-radius: 999px; border:1px solid var(--line); background: color-mix(in oklab, var(--paper) 70%, transparent);
    }

    .vibe969 .tones{ display:flex; gap:8px; }
    .vibe969 .tone{
      width: 26px; height: 26px; border-radius: 8px; border:1px solid var(--line); cursor:pointer; position:relative;
      box-shadow: inset 0 4px 10px rgba(0,0,0,.08);
    }
    .vibe969 .tone[aria-checked="true"]::after{
      content:""; position:absolute; inset:-3px; border-radius:10px;
      border: 2px solid color-mix(in oklab, var(--acc1) 42%, var(--acc2));
      box-shadow: 0 0 0 2px rgba(0,0,0,.04);
    }

    /* Ticker */
    .vibe969 .ticker{
      position:relative; z-index:2;
      margin-top: 12px;
      overflow:hidden; border-radius: 16px; border:1px solid var(--line);
      background: color-mix(in oklab, var(--paper) 84%, transparent);
    }
    .vibe969 .row{
      display:flex; gap:10px; padding:10px; white-space:nowrap;
      animation: slide 28s linear infinite;
    }
    .vibe969[data-theme="night"] .row{ animation-duration: 34s; }
    @keyframes slide{ from{ transform: translateX(0);} to{ transform: translateX(-50%);} }
    .vibe969 .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: linear-gradient(135deg, var(--acc1), var(--acc2));
      color:#0b0f16; font-weight:900; font-size:12px;
      box-shadow: 0 10px 22px color-mix(in oklab, var(--acc1) 26%, transparent);
    }
    .vibe969[data-theme="night"] .chip{ color:#0b0f16; }

    /* Footer */
    .vibe969 .foot{
      position:relative; z-index:2; margin-top: 14px;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; color:var(--muted); font-size:12px;
    }
    .vibe969 .foot .stamp{
      justify-self:center; display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius: 999px; border:1px solid var(--line);
      background: var(--glass); backdrop-filter: blur(6px);
    }
    .vibe969 .hint{ justify-self:end; }

    /* Motion states */
    .vibe969.alive .row{ animation-play-state: running; }
    .vibe969:not(.alive) .row{ animation-play-state: paused; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .vibe969 .row{ animation: none !important; }
    }

    /* Responsive */
    @media (max-width: 980px){
      .vibe969 .panel{ max-width: 92%; }
      .vibe969 .k-controls{ justify-self: stretch; }
      .vibe969 .dock{ left: clamp(10px, 3vw, 24px); right: auto; }
    }
  </style>

  <div class="top">
    <div class="brand"><span class="seed" aria-hidden="true"></span> Bloom Engine</div>
    <div class="titlechip" role="button" tabindex="0" aria-pressed="false" title="Toggle day/night">Kinetic Garden • Tap to switch theme</div>
    <div class="k-controls" aria-label="Master controls">
      <button class="btn play" aria-pressed="true" title="Play/Pause">Play</button>
      <button class="ghost theme" title="Day/Night">Night</button>
    </div>
  </div>

  <div class="wrap">
    <canvas class="field" aria-hidden="true"></canvas>

    <div class="panel">
      <h1>Make time feel softer</h1>
      <p class="sub">A generative garden that breathes with your cursor. Type stays calm. Color earns its moments.</p>
      <div class="actions">
        <button class="btn sow">Plant a seed</button>
        <button class="ghost rationale">Why it feels gentle</button>
      </div>
    </div>

    <div class="dock" aria-label="Garden settings">
      <div class="glass range">
        <label for="density">Petals</label>
        <input id="density" type="range" min="6" max="96" step="2" value="32" aria-valuemin="6" aria-valuemax="96" aria-valuenow="32" aria-label="Petal count">
        <span class="val">32</span>
      </div>
      <div class="glass tones" role="radiogroup" aria-label="Palette">
        <div class="tone" role="radio" tabindex="0" aria-checked="true" data-p="breeze" title="Breeze" style="background: linear-gradient(135deg, hsl(192 92% 46%), hsl(160 74% 48%));"></div>
        <div class="tone" role="radio" tabindex="-1" aria-checked="false" data-p="orchid" title="Orchid" style="background: linear-gradient(135deg, hsl(268 88% 66%), hsl(316 86% 64%));"></div>
        <div class="tone" role="radio" tabindex="-1" aria-checked="false" data-p="ember" title="Ember" style="background: linear-gradient(135deg, hsl(24 92% 60%), hsl(340 80% 62%));"></div>
        <div class="tone" role="radio" tabindex="-1" aria-checked="false" data-p="glacier" title="Glacier" style="background: linear-gradient(135deg, hsl(205 92% 56%), hsl(228 85% 66%));"></div>
      </div>
    </div>
  </div>

  <div class="ticker" aria-live="polite" aria-label="Principles marquee">
    <div class="row">
      <span class="chip">Quiet physics</span>
      <span class="chip">Readable first</span>
      <span class="chip">Color as punctuation</span>
      <span class="chip">Manners in motion</span>
      <span class="chip">Glass, not glare</span>
      <span class="chip">Accessible contrast</span>
      <span class="chip">Delight, not overload</span>
      <span class="chip">Tactile spacing</span>
      <!-- repeat for seamless loop -->
      <span class="chip">Quiet physics</span>
      <span class="chip">Readable first</span>
      <span class="chip">Color as punctuation</span>
      <span class="chip">Manners in motion</span>
      <span class="chip">Glass, not glare</span>
      <span class="chip">Accessible contrast</span>
      <span class="chip">Delight, not overload</span>
      <span class="chip">Tactile spacing</span>
    </div>
  </div>

  <div class="foot">
    <div class="quote">“Grace is energy with boundaries.”</div>
    <div class="stamp">
      <span class="seed" aria-hidden="true" style="width:10px;height:10px;box-shadow:none;"></span>
      <span id="last-updated">Last updated: 2025-11-29 23:32:16 EST</span>
    </div>
    <div class="hint">Tip: move across the canvas to steer the bloom</div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.vibe969');
      const canvas = root.querySelector('.field');
      const ctx = canvas.getContext('2d', { alpha: true });
      const playBtn = root.querySelector('.play');
      const themeBtn = root.querySelector('.theme');
      const titleChip = root.querySelector('.titlechip');
      const slider = root.querySelector('#density');
      const val = root.querySelector('.val');
      const tones = [...root.querySelectorAll('.tone')];
      const updated = root.querySelector('#last-updated');

      // timestamp
      function fmt(d){
        try{
          return new Intl.DateTimeFormat(undefined, { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:true }).format(d);
        }catch(e){ return d.toLocaleString(); }
      }
      updated.textContent = 'Last updated: ' + fmt(new Date());

      // palettes
      const palettes = {
        breeze: ['hsl(192 92% 46%)','hsl(160 74% 48%)'],
        orchid: ['hsl(268 88% 66%)','hsl(316 86% 64%)'],
        ember:  ['hsl(24 92% 60%)','hsl(340 80% 62%)'],
        glacier:['hsl(205 92% 56%)','hsl(228 85% 66%)']
      };
      function setPalette(name){
        const [a1,a2] = palettes[name] || palettes.breeze;
        root.style.setProperty('--acc1', a1);
        root.style.setProperty('--acc2', a2);
        tones.forEach(t=>{
          const on = t.dataset.p === name;
          t.setAttribute('aria-checked', on? 'true':'false');
          t.tabIndex = on? 0 : -1;
        });
      }
      tones.forEach(t=>{
        t.addEventListener('click', ()=>setPalette(t.dataset.p));
        t.addEventListener('keydown', (e)=>{
          if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setPalette(t.dataset.p); }
          if(e.key==='ArrowRight'||e.key==='ArrowLeft'){
            const i = tones.findIndex(x=>x.getAttribute('aria-checked')==='true');
            const dir = e.key==='ArrowRight'?1:-1;
            const next = (i+dir+tones.length)%tones.length;
            tones[next].focus(); setPalette(tones[next].dataset.p);
          }
        });
      });
      setPalette('breeze');

      // theme
      let night = false;
      function applyTheme(){ root.setAttribute('data-theme', night? 'night':'day'); themeBtn.textContent = night? 'Day':'Night'; }
      themeBtn.addEventListener('click', ()=>{ night=!night; applyTheme(); });
      titleChip.addEventListener('click', ()=>{ night=!night; applyTheme(); });
      titleChip.addEventListener('keydown', (e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); night=!night; applyTheme(); } });
      applyTheme();

      // motion
      let running = !window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      function setRunning(on){
        running = on;
        root.classList.toggle('alive', on);
        playBtn.textContent = on? 'Pause':'Play';
        playBtn.setAttribute('aria-pressed', on? 'true':'false');
        if(on) raf(); // kick
      }
      playBtn.addEventListener('click', ()=> setRunning(!running));
      setRunning(running);

      // slider
      function updVal(n){ slider.setAttribute('aria-valuenow', n); val.textContent = n; }
      slider.addEventListener('input', ()=>updVal(slider.value));
      updVal(slider.value);

      // canvas sizing
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      function resize(){
        const r = canvas.getBoundingClientRect();
        canvas.width = Math.floor(r.width * dpr);
        canvas.height = Math.floor(r.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      const ro = new ResizeObserver(resize); ro.observe(canvas);
      resize();

      // interaction
      const attract = { x: 0.5, y: 0.5, tx: 0.5, ty: 0.5 };
      function lerp(a,b,t){ return a+(b-a)*t; }
      function polar(cx, cy, r, ang){ return [cx + Math.cos(ang)*r, cy + Math.sin(ang)*r]; }
      function easeOutQuad(x){ return 1 - (1-x)*(1-x); }

      root.addEventListener('pointermove', (e)=>{
        const rect = canvas.getBoundingClientRect();
        attract.tx = (e.clientX - rect.left)/rect.width;
        attract.ty = (e.clientY - rect.top)/rect.height;
        // glow anchor
        root.style.setProperty('--gx', (attract.tx*100).toFixed(1)+'%');
        root.style.setProperty('--gy', (attract.ty*100).toFixed(1)+'%');
      }, {passive:true});
      root.addEventListener('pointerleave', ()=>{
        attract.tx = 0.6; attract.ty = 0.24;
      }, {passive:true});

      // garden draw
      let t0 = performance.now();
      function draw(now){
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;
        // subtle drift towards target
        attract.x = lerp(attract.x, attract.tx, 0.06);
        attract.y = lerp(attract.y, attract.ty, 0.06);

        // clear with soft fade to avoid harsh redraw
        ctx.clearRect(0,0,w,h);

        const cx = w*0.5, cy = h*0.5;
        const maxR = Math.min(w, h)*0.42;
        const petals = parseInt(slider.value, 10);
        const time = (now - t0)/1000;
        const drift = Math.sin(time*0.5)*0.5 + 0.5;
        const attractStrength = Math.hypot(attract.x-0.5, attract.y-0.5);
        const pulse = easeOutQuad((Math.sin(time*0.9)+1)/2);

        // rings
        for(let ring=0; ring<3; ring++){
          const frac = (ring+1)/3;
          const r = maxR * (0.25 + frac*0.7) * (0.94 + 0.06*Math.sin(time*0.7 + ring));
          const hueGrad = ctx.createRadialGradient(cx, cy, 0, cx, cy, r);
          hueGrad.addColorStop(0, getComputedStyle(root).getPropertyValue('--acc1').trim());
          hueGrad.addColorStop(1, getComputedStyle(root).getPropertyValue('--acc2').trim());
          ctx.strokeStyle = hueGrad;
          ctx.lineWidth = 1;
          ctx.globalAlpha = 0.35 - ring*0.08;
          ctx.beginPath();
          ctx.arc(cx, cy, r, 0, Math.PI*2);
          ctx.stroke();
        }

        ctx.globalAlpha = 1;
        // petals
        for(let i=0;i<petals;i++){
          const a = (i/petals)*Math.PI*2 + time*0.25;
          const wob = Math.sin(time*1.4 + i*0.8)*0.08;
          const dir = a + wob;
          const base = maxR * (0.35 + 0.12*Math.sin(i*1.3 + time));
          const reach = base + (maxR*0.25 + maxR*attractStrength*0.6) * (0.4 + 0.6*pulse);
          const [x1,y1] = polar(cx, cy, base, dir);
          const [x2,y2] = polar(cx, cy, reach, dir);

          // gradient stem
          const grad = ctx.createLinearGradient(x1,y1,x2,y2);
          grad.addColorStop(0, getComputedStyle(root).getPropertyValue('--acc1').trim());
          grad.addColorStop(1, getComputedStyle(root).getPropertyValue('--acc2').trim());
          ctx.strokeStyle = grad;
          ctx.lineWidth = 2;
          ctx.lineCap = 'round';

          // curve control towards pointer
          const ctrlX = lerp(cx, w*attract.x, 0.18 + 0.32*drift);
          const ctrlY = lerp(cy, h*attract.y, 0.18 + 0.32*drift);

          ctx.beginPath();
          ctx.moveTo(cx, cy);
          ctx.quadraticCurveTo(ctrlX, ctrlY, x2, y2);
          ctx.stroke();

          // petal tip
          ctx.fillStyle = grad;
          ctx.globalAlpha = 0.8;
          ctx.beginPath();
          ctx.arc(x2, y2, 2.2 + 1.3*pulse, 0, Math.PI*2);
          ctx.fill();
          ctx.globalAlpha = 1;
        }

        // core glow
        const core = ctx.createRadialGradient(cx, cy, 0, cx, cy, maxR*0.32);
        core.addColorStop(0, 'rgba(255,255,255,.6)');
        core.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = core;
        ctx.beginPath();
        ctx.arc(cx, cy, maxR*0.36, 0, Math.PI*2);
        ctx.fill();
      }

      let af;
      function raf(){
        if(!running) return;
        af = requestAnimationFrame(function step(ts){
          if(!running) return;
          draw(ts);
          af = requestAnimationFrame(step);
        });
      }
      if(running) raf();

      // resize debounce for DPR change
      window.addEventListener('resize', ()=>{
        const newDpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        if(newDpr !== dpr){ dpr = newDpr; }
        resize();
      });

      // Buttons actions
      root.querySelector('.sow').addEventListener('click', ()=>{
        // Shuffle: pick next palette and nudge petals
        const i = tones.findIndex(x=>x.getAttribute('aria-checked')==='true');
        const next = tones[(i+1) % tones.length];
        next.click();
        const n = 8 + Math.floor(Math.random()*44)*2;
        slider.value = n; updVal(n);
      });
      root.querySelector('.rationale').addEventListener('click', ()=>{
        alert('Principles: readable first • motion with manners • color as punctuation • accessible contrast.');
      });

      // keyboard: space toggles play
      root.addEventListener('keydown', (e)=>{
        if(e.key===' ' && e.target === document.body){ e.preventDefault(); setRunning(!running); }
      });

      // initialize subtle glow anchor
      root.style.setProperty('--gx','60%'); root.style.setProperty('--gy','24%');
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


