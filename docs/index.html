<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="v161" aria-label="Æther Bloom — resonant light">
  <style>
    .v161 {
      --ink: hsl(230 21% 12%);
      --muted: hsl(230 10% 45%);
      --paper-0: hsl(44 55% 98%);
      --paper-1: hsl(38 60% 96%);
      --ring: hsl(230 25% 20% / 0.12);

      --g1: hsl(12 88% 64%);
      --g2: hsl(208 92% 60%);
      --g3: hsl(268 76% 62%);
      --g4: hsl(48 95% 62%);

      color: var(--ink);
      font-family: ui-sans-serif, -apple-system, system-ui, "SF Pro Display", Segoe UI, Roboto, Helvetica, Arial;
      border-radius: 34px;
      background:
        radial-gradient(160% 120% at -10% -20%, hsl(12 90% 60% / 0.18), transparent 60%),
        radial-gradient(140% 120% at 110% 0%, hsl(205 85% 60% / 0.16), transparent 65%),
        linear-gradient(180deg, var(--paper-1), var(--paper-0));
      box-shadow:
        inset 0 1px 0 hsl(0 0% 100% / 0.65),
        0 40px 120px hsl(35 60% 40% / 0.15);
      overflow: clip;
      position: relative;
      isolation: isolate;
    }
    .v161::after {
      content: "";
      position: absolute; inset: 0;
      pointer-events: none;
      background:
        repeating-linear-gradient(120deg, hsl(0 0% 100% / 0.07) 0 2px, transparent 2px 10px);
      mix-blend-mode: overlay;
      opacity: 0.45;
    }

    .v161 .chrome {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      padding: clamp(18px, 5.5vw, 50px) clamp(18px, 7vw, 60px) 0;
    }
    .v161 .brand {
      display: inline-flex; align-items: center; gap: 12px;
      letter-spacing: 0.24em; text-transform: uppercase;
      color: var(--muted); font-size: 11.5px; font-weight: 900;
    }
    .v161 .sig {
      width: 22px; height: 22px; border-radius: 9px;
      background: conic-gradient(from var(--spin, 0deg), var(--g1), var(--g2), var(--g3), var(--g4), var(--g1));
      box-shadow: inset 0 1px 0 hsl(0 0% 100% / 0.75), 0 10px 18px hsl(35 60% 40% / 0.25);
    }
    .v161 .controls { display: inline-flex; gap: 10px; flex-wrap: wrap; }
    .v161 .chip {
      appearance: none; border: 1px solid var(--ring); border-radius: 999px;
      padding: 8px 12px; font-size: 12px; font-weight: 800; letter-spacing: 0.02em;
      color: var(--ink);
      background: linear-gradient(180deg, hsl(0 0% 100% / 0.7), hsl(0 0% 100% / 0.35));
      box-shadow: inset 0 1px 0 hsl(0 0% 100% / 0.9), 0 8px 18px hsl(35 60% 40% / 0.12);
      cursor: pointer; user-select: none;
      transition: transform 160ms ease, box-shadow 220ms ease, background 220ms ease, color 220ms ease;
      backdrop-filter: blur(6px) saturate(120%);
    }
    .v161 .chip:hover { transform: translateY(-1px); }
    .v161 .chip.primary {
      color: white;
      background: linear-gradient(92deg, var(--g1), var(--g3));
      border-color: transparent;
      box-shadow: 0 18px 36px hsl(12 88% 50% / 0.25), inset 0 1px 0 hsl(0 0% 100% / 0.55);
    }

    .v161 .wrap { padding: clamp(8px, 2.5vw, 20px) clamp(18px, 7vw, 60px) clamp(18px, 6vw, 48px); }
    .v161 .title {
      margin: 6px 0 6px;
      font-size: clamp(42px, 9.4vw, 118px);
      letter-spacing: -0.02em; line-height: 0.9; font-weight: 1000;
      background: linear-gradient(110deg, hsl(230 25% 12%), var(--g3) 55%, var(--g2));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      position: relative;
      filter: drop-shadow(0 10px 24px hsl(35 60% 45% / 0.18));
    }
    .v161 .title::after {
      content: "";
      position: absolute; inset: 0;
      background: linear-gradient(90deg, transparent, hsl(0 0% 100% / 0.65) 40%, transparent 62%);
      mix-blend-mode: overlay; filter: blur(6px);
      transform: translateX(-70%);
      animation: v161-sheen 6s ease-in-out infinite;
      pointer-events: none;
    }
    @keyframes v161-sheen { 0%{transform:translateX(-70%)} 55%{transform:translateX(120%)} 100%{transform:translateX(120%)} }
    .v161 .subtitle {
      margin: 0 0 clamp(16px, 4vw, 24px);
      font-size: clamp(14px, 2.2vw, 18px);
      color: var(--muted);
      max-width: 70ch; text-wrap: balance;
    }

    /* Portal — a circular viewport */
    .v161 .portal {
      position: relative;
      margin: clamp(10px, 5vw, 36px) auto;
      width: min(86vw, 860px);
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      border: 1px solid var(--ring);
      background:
        radial-gradient(120% 120% at 25% 20%, hsl(0 0% 100% / 0.9), transparent 60%),
        linear-gradient(180deg, hsl(0 0% 100%), hsl(44 55% 98%));
      box-shadow:
        inset 0 1px 0 hsl(0 0% 100% / 0.9),
        0 30px 80px hsl(35 60% 40% / 0.20);
      overflow: clip;
    }
    .v161 canvas { position: absolute; inset: 0; width: 100%; height: 100%; display: block; z-index: 0; }

    /* Decorative orbits */
    .v161 .orbit {
      position: absolute; inset: 0; border-radius: 50%; pointer-events: none;
      border: 1px dashed hsl(230 15% 20% / 0.14);
      mix-blend-mode: overlay;
      animation: orbit-spin 36s linear infinite;
    }
    .v161 .o1 { transform: scale(0.66); }
    .v161 .o2 { transform: scale(0.84); animation-direction: reverse; }
    .v161 .o3 { transform: scale(0.94); animation-duration: 54s; }
    @keyframes orbit-spin { to { transform: rotate(360deg) scale(var(--s,1)); } }

    /* HUD */
    .v161 .hud {
      position: absolute; left: 50%; bottom: 14px; transform: translateX(-50%);
      display: grid; grid-auto-flow: column; gap: 10px; align-items: center;
      background: hsl(0 0% 100% / 0.75);
      border: 1px solid var(--ring);
      border-radius: 999px;
      padding: 8px 10px;
      box-shadow: 0 16px 32px hsl(35 60% 40% / 0.15), inset 0 1px 0 hsl(0 0% 100% / 0.9);
      backdrop-filter: blur(12px) saturate(160%);
      z-index: 3;
      color: var(--ink);
    }
    .v161 .btn { appearance:none; border:1px solid var(--ring); border-radius: 999px; padding: 8px 12px; font-size: 12px; font-weight: 800; background: linear-gradient(180deg, hsl(0 0% 100%), hsl(0 0% 100% / 0.7)); box-shadow: inset 0 1px 0 hsl(0 0% 100%), 0 10px 22px hsl(35 60% 40% / 0.12); cursor: pointer; transition: transform 160ms ease, box-shadow 220ms ease; color: var(--ink); }
    .v161 .btn:hover { transform: translateY(-1px); }
    .v161 .btn.primary { color:white; background: linear-gradient(92deg, var(--g2), var(--g3)); border-color: transparent; box-shadow: 0 18px 34px hsl(196 95% 58% / 0.28), inset 0 1px 0 hsl(0 0% 100% / 0.55); }

    .v161 .slider {
      display: grid; grid-template-columns: auto 1fr auto; gap: 10px; align-items: center;
      padding: 6px 10px; border-radius: 999px; border: 1px dashed var(--ring);
      background: hsl(0 0% 100% / 0.75);
      backdrop-filter: blur(6px);
    }
    .v161 .slider span { font-weight: 800; font-size: 12px; color: var(--ink); }
    .v161 input[type="range"] {
      accent-color: var(--g3);
      width: 150px; height: 6px; border-radius: 999px;
      appearance: none; outline: none; cursor: pointer;
      background: linear-gradient(90deg, var(--g1), var(--g2), var(--g3), var(--g4));
    }
    .v161 input[type="range"]::-webkit-slider-thumb {
      appearance: none; width: 18px; height: 18px; border-radius: 50%;
      background: white; border: 2px solid var(--ring);
      box-shadow: 0 6px 12px hsl(35 60% 40% / 0.18);
      margin-top: -6px;
    }
    .v161 input[type="range"]::-moz-range-thumb {
      width: 18px; height: 18px; border-radius: 50%;
      background: white; border: 2px solid var(--ring);
    }
    .v161 .val { font-variant-numeric: tabular-nums; font-weight: 800; min-width: 2.5ch; text-align: right; }

    .v161 .note {
      display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap;
      color: var(--muted); font-size: 12px;
      padding: 16px clamp(18px, 7vw, 60px) 28px;
    }
    .v161 .tags { display: flex; gap: 8px; flex-wrap: wrap; }
    .v161 .tag {
      padding: 6px 10px; border-radius: 999px; border: 1px solid var(--ring);
      background: hsl(0 0% 100% / 0.75); backdrop-filter: blur(2px);
      color: var(--ink);
    }

    /* Dark variant */
    .v161[data-theme="obsidian"] {
      --paper-0: hsl(230 25% 8%);
      --paper-1: hsl(232 30% 12%);
      --ink: hsl(210 25% 96%);
      --muted: hsl(220 12% 74%);
      --ring: hsl(210 20% 90% / 0.14);
      --g1: hsl(195 90% 60%);
      --g2: hsl(265 88% 66%);
      --g3: hsl(48 95% 62%);
      --g4: hsl(338 80% 62%);
    }
    .v161[data-theme="obsidian"] .hud,
    .v161[data-theme="obsidian"] .slider,
    .v161[data-theme="obsidian"] .btn {
      background: hsl(0 0% 100% / 0.06);
      color: var(--ink);
      border-color: hsl(0 0% 100% / 0.12);
      box-shadow: 0 16px 32px hsl(220 60% 6% / 0.35), inset 0 1px 0 hsl(0 0% 100% / 0.15);
    }
    .v161[data-theme="obsidian"] .btn.primary { color:black; }

    .v161.rm * { animation: none !important; transition: none !important; }
  </style>

  <div class="chrome">
    <div class="brand"><span class="sig" aria-hidden="true"></span> Edition 161 — Æther Bloom</div>
    <div class="controls">
      <button class="chip" id="v161-theme" type="button" aria-label="Toggle theme">Theme: Pearl</button>
      <button class="chip primary" id="v161-play" type="button" aria-pressed="true" aria-label="Play/Pause">Pause</button>
    </div>
  </div>

  <div class="wrap">
    <h1 class="title">Æther Bloom</h1>
    <p class="subtitle">Resonant circles of color. Click to drop a bloom; drag to lens the light.</p>

    <div class="portal" id="v161-portal" aria-label="Circular field of animated ripples">
      <canvas id="v161-canvas" role="img" aria-label="Concentric, shimmering rings of light that expand and fade"></canvas>
      <div class="orbit o1" style="--s:0.66"></div>
      <div class="orbit o2" style="--s:0.84"></div>
      <div class="orbit o3" style="--s:0.94"></div>

      <div class="hud" aria-label="Controls">
        <label class="slider" for="v161-pulse">
          <span>Pulse</span>
          <input id="v161-pulse" type="range" min="10" max="250" value="120" />
          <span class="val" id="v161-pulse-val">120</span>
        </label>
        <label class="slider" for="v161-spread">
          <span>Spread</span>
          <input id="v161-spread" type="range" min="20" max="100" value="60" />
          <span class="val" id="v161-spread-val">60</span>
        </label>
        <button class="btn" id="v161-rand" type="button" aria-label="Randomize">Randomize</button>
        <button class="btn" id="v161-save" type="button" aria-label="Save image">Save</button>
      </div>
    </div>
  </div>

  <div class="note">
    <div class="tags" role="list" aria-label="design notes">
      <span class="tag" role="listitem">Concentric dynamics</span>
      <span class="tag" role="listitem">Additive light</span>
      <span class="tag" role="listitem">Circular viewport</span>
      <span class="tag" role="listitem">Pearl ↔ Obsidian</span>
      <span class="tag" role="listitem">Glass controls</span>
    </div>
    <small><span id="last-updated">Last updated: 2025-10-23 23:36:01 EST</span></small>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.v161');
      const portal = root.querySelector('#v161-portal');
      const canvas = root.querySelector('#v161-canvas');
      const ctx = canvas.getContext('2d', { alpha: true });
      const sig = root.querySelector('.sig');
      const updated = root.querySelector('#last-updated');

      // Timestamp
      try {
        const fmt = new Intl.DateTimeFormat([], { dateStyle: 'medium', timeStyle: 'short' });
        updated.textContent = 'Updated ' + fmt.format(new Date());
      } catch { updated.textContent = 'Updated ' + new Date().toLocaleString(); }

      // Reduced motion
      const reducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (reducedMotion) root.classList.add('rm');

      // Controls
      const themeBtn = root.querySelector('#v161-theme');
      const playBtn = root.querySelector('#v161-play');
      const randBtn = root.querySelector('#v161-rand');
      const saveBtn = root.querySelector('#v161-save');
      const pulseEl = root.querySelector('#v161-pulse');
      const spreadEl = root.querySelector('#v161-spread');
      const pulseVal = root.querySelector('#v161-pulse-val');
      const spreadVal = root.querySelector('#v161-spread-val');

      // Size + DPR
      let dpr = 1;
      function size() {
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        const rect = portal.getBoundingClientRect();
        canvas.width = Math.floor(rect.width * dpr);
        canvas.height = Math.floor(rect.height * dpr);
        canvas.style.width = rect.width + 'px';
        canvas.style.height = rect.height + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        ctx.clearRect(0, 0, rect.width, rect.height);
      }
      size();
      addEventListener('resize', size);

      // Theme
      let theme = 'pearl';
      function setTheme(next) {
        theme = next;
        if (theme === 'obsidian') {
          root.setAttribute('data-theme','obsidian');
          themeBtn.textContent = 'Theme: Obsidian';
        } else {
          root.removeAttribute('data-theme');
          themeBtn.textContent = 'Theme: Pearl';
        }
        flash(themeBtn);
      }

      // State
      let running = !reducedMotion;
      let t = 0;
      let seed = Math.random() * 1000;

      // Parameters
      let pulse = Number(pulseEl.value); // lower = slower
      let spread = Number(spreadEl.value); // 20..100
      pulseVal.textContent = String(pulse);
      spreadVal.textContent = String(spread);

      // Pointer and lens
      const pointer = { x: 0.5, y: 0.5, down: false, sx: 0.5, sy: 0.5 };

      function clamp(x,a,b){ return Math.max(a, Math.min(b, x)); }
      function lerp(a,b,x){ return a + (b-a)*x; }
      function fract(x){ return x - Math.floor(x); }
      function rand(n){ return fract(Math.sin(n * 12345.678 + seed) * 43758.5453123); }
      function hsla(h,s,l,a){ return `hsla(${h} ${s}% ${l}% / ${a})`; }

      // Palette sampling
      function samplePearl(u){
        const h = lerp(12, 208, u);
        const s = lerp(88, 92, u);
        const l = lerp(64, 60, u);
        return { h, s, l };
      }
      function sampleObsidian(u){
        const h = lerp(195, 338, u);
        const s = lerp(90, 80, u);
        const l = lerp(60, 62, u);
        return { h, s, l };
      }
      function sample(u){
        return (root.getAttribute('data-theme') === 'obsidian') ? sampleObsidian(u) : samplePearl(u);
      }

      // Events
      function setPointer(e) {
        const rect = portal.getBoundingClientRect();
        const p = e.touches ? e.touches[0] : e;
        pointer.sx = clamp((p.clientX - rect.left) / rect.width, 0, 1);
        pointer.sy = clamp((p.clientY - rect.top) / rect.height, 0, 1);
      }
      portal.addEventListener('pointermove', setPointer, { passive: true });
      portal.addEventListener('pointerdown', e => { pointer.down = true; setPointer(e); drop(pointer.sx, pointer.sy); });
      addEventListener('pointerup', () => { pointer.down = false; });

      // UI handlers
      playBtn.addEventListener('click', () => {
        running = !running;
        playBtn.setAttribute('aria-pressed', running ? 'true' : 'false');
        playBtn.textContent = running ? 'Pause' : 'Play';
        flash(playBtn);
        if (running && !reducedMotion) raf = requestAnimationFrame(loop);
        else cancelAnimationFrame(raf);
      });
      themeBtn.addEventListener('click', () => setTheme(theme === 'pearl' ? 'obsidian' : 'pearl'));
      randBtn.addEventListener('click', () => { seed = Math.random() * 1000; randomize(); flash(randBtn); });
      saveBtn.addEventListener('click', () => {
        try {
          const link = document.createElement('a');
          link.download = 'aether-bloom.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
          flash(saveBtn);
        } catch {}
      });
      pulseEl.addEventListener('input', e => { pulse = Number(e.target.value); pulseVal.textContent = String(pulse); });
      spreadEl.addEventListener('input', e => { spread = Number(e.target.value); spreadVal.textContent = String(spread); });

      // Keyboard
      root.addEventListener('keydown', (e) => {
        const k = e.key.toLowerCase();
        if (k === ' ') { e.preventDefault(); playBtn.click(); }
        if (k === 't') themeBtn.click();
        if (k === 'r') randBtn.click();
        if (k === 's') saveBtn.click();
      });

      // Flash helper
      function flash(el) {
        el.classList.add('primary');
        setTimeout(() => el.classList.remove('primary'), 280);
      }

      // Bloom system
      const blooms = [];
      function drop(nx, ny) {
        const c = center();
        const dx = (nx - 0.5);
        const dy = (ny - 0.5);
        const angle = Math.atan2(dy, dx);
        const hueOff = (angle / (Math.PI * 2)) + 0.5 + rand(t) * 0.15;
        blooms.push({
          x: nx, y: ny,
          t0: t,
          hueOff,
          rings: 8 + Math.floor(rand(t + nx + ny) * 8),
          life: 1.8 + rand(nx * ny + t) * 1.2
        });
        if (blooms.length > 32) blooms.shift();
      }

      function randomize() {
        const n = 4 + Math.floor(rand(seed) * 4);
        for (let i = 0; i < n; i++) {
          drop(rand(i + 1), rand(i + 2));
        }
      }

      // Helpers
      function center() { return { x: portal.clientWidth * 0.5, y: portal.clientHeight * 0.5 }; }

      // Initial seeds
      randomize();

      // Draw loop
      function draw() {
        const w = portal.clientWidth, h = portal.clientHeight;
        ctx.clearRect(0, 0, w, h);

        // Spin badge
        sig.style.setProperty('--spin', ((t * 0.05) % 360) + 'deg');

        // Ease pointer
        pointer.x = lerp(pointer.x, pointer.sx, 0.1);
        pointer.y = lerp(pointer.y, pointer.sy, 0.1);

        // Ambient radial glow drifting
        const pal = sample(0.5 + 0.45 * Math.sin(t * 0.0002 + seed));
        const cx = lerp(w*0.3, w*0.7, 0.5 + 0.45 * Math.sin(t * 0.00025 + seed));
        const cy = lerp(h*0.3, h*0.7, 0.5 + 0.45 * Math.cos(t * 0.00022 + seed));
        const r = Math.min(w, h) * (0.35 + 0.08 * Math.sin(t*0.0003 + seed));
        const bg = ctx.createRadialGradient(cx, cy, 0, cx, cy, r);
        bg.addColorStop(0, hsla(pal.h, pal.s, pal.l, 0.18));
        bg.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.globalCompositeOperation = (root.getAttribute('data-theme') === 'obsidian') ? 'screen' : 'multiply';
        ctx.fillStyle = bg;
        ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI * 2); ctx.fill();

        // Blooms
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        ctx.globalCompositeOperation = (root.getAttribute('data-theme') === 'obsidian') ? 'screen' : 'lighter';

        const speed = (300 - pulse) * 0.006 + 0.15; // 0.15..1.15
        const maxR = Math.min(w, h) * 0.56;
        for (let i = blooms.length - 1; i >= 0; i--) {
          const b = blooms[i];
          const age = (t - b.t0) / 1000;
          const life = b.life;
          if (age > life + 0.6) { blooms.splice(i, 1); continue; }

          for (let k = 0; k < b.rings; k++) {
            const ringOffset = k * (1 - spread / 140); // wider when spread low
            const prog = age * speed - ringOffset * 0.1;
            if (prog < 0) continue;

            const u = (k / (b.rings - 1 || 1));
            const c = sample((u + b.hueOff) % 1);
            const rr = prog * maxR;
            const fade = Math.exp(-prog * (1.2 + (spread/100)));
            const alpha = 0.24 * fade * (0.6 + 0.4 * (1 - Math.abs(0.5 - u) * 2));

            ctx.strokeStyle = hsla(c.h, c.s, c.l, alpha);
            ctx.shadowColor = hsla(c.h, c.s, c.l, alpha * 0.8);
            ctx.shadowBlur = 8 + 22 * (1 - u);
            ctx.lineWidth = 2 + 6 * (1 - u);

            const px = b.x * w;
            const py = b.y * h;

            ctx.beginPath();
            ctx.arc(px, py, rr, 0, Math.PI * 2);
            ctx.stroke();
          }
        }

        // Lens under pointer
        const lensR = Math.min(w, h) * 0.14;
        const lx = pointer.x * w;
        const ly = pointer.y * h;
        const lens = ctx.createRadialGradient(lx, ly, 0, lx, ly, lensR);
        const lc = sample((0.35 + 0.35 * Math.sin(t * 0.0004 + seed)) % 1);
        lens.addColorStop(0, hsla(lc.h, lc.s, lc.l, 0.25));
        lens.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.globalCompositeOperation = (root.getAttribute('data-theme') === 'obsidian') ? 'screen' : 'multiply';
        ctx.fillStyle = lens;
        ctx.beginPath(); ctx.arc(lx, ly, lensR, 0, Math.PI*2); ctx.fill();

        t += 16;
      }

      // Loop
      let raf;
      function loop() {
        if (!running) return;
        draw();
        if (!reducedMotion) raf = requestAnimationFrame(loop);
      }

      // Init
      setTheme(theme);
      if (!reducedMotion) raf = requestAnimationFrame(loop);
      else draw();
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


