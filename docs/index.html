<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<style>
  .orrery-815 {
    --ink: hsl(222 30% 12%);
    --muted: hsl(222 12% 42%);
    --edge: hsl(222 30% 85% / .5);
    --glass: hsl(0 0% 100% / .68);
    --ax: 0deg;
    --ay: 0deg;
    --glow: 220;
    position: relative;
    border-radius: 28px;
    padding: clamp(18px, 4.8vw, 56px);
    color: var(--ink);
    overflow: hidden;
    isolation: isolate;
    background:
      radial-gradient(1200px 900px at -10% -10%, hsl(204 100% 92% / .7), transparent 60%),
      radial-gradient(1000px 800px at 110% 120%, hsl(276 100% 94% / .6), transparent 62%),
      linear-gradient(180deg, hsl(210 70% 98%), hsl(210 65% 97%));
    box-shadow: 0 28px 80px hsl(220 50% 20% / .12), inset 0 0 0 1px var(--edge);
  }
  .orrery-815[data-theme="night"] {
    --ink: hsl(0 0% 98%);
    --muted: hsl(210 18% 82%);
    --edge: hsl(0 0% 100% / .1);
    --glass: hsl(0 0% 100% / .12);
    --glow: 200;
    background:
      radial-gradient(1200px 900px at -10% -10%, hsl(230 70% 20% / .7), transparent 60%),
      radial-gradient(1000px 800px at 110% 120%, hsl(260 70% 18% / .65), transparent 62%),
      linear-gradient(180deg, hsl(230 45% 9%), hsl(232 50% 8%));
    box-shadow: 0 28px 90px hsl(220 70% 8% / .6), inset 0 0 0 1px var(--edge);
  }
  .orrery-815::after {
    content: "";
    position: absolute; inset: -20%;
    background:
      radial-gradient(60% 60% at 25% 10%, hsl(0 0% 100% / .2), transparent 50%),
      repeating-linear-gradient(135deg, hsl(0 0% 100% / .06) 0 2px, transparent 2px 4px);
    mix-blend-mode: soft-light;
    opacity: .35;
    pointer-events: none;
    z-index: 0;
  }

  .orrery-815 .bar {
    position: relative; z-index: 3;
    display: grid; grid-template-columns: 1fr auto; gap: clamp(12px, 2.8vw, 28px);
    align-items: start;
    margin-bottom: clamp(16px, 3.6vw, 40px);
  }
  .orrery-815 .brand {
    display: grid; gap: 8px;
  }
  .orrery-815 .brand h1 {
    margin: 0;
    font: 900 clamp(32px, 7.5vw, 96px)/.95 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    letter-spacing: -0.02em;
    background:
      linear-gradient(90deg, var(--ink), var(--ink)) padding-box,
      conic-gradient(from 0deg, hsl(var(--glow) 90% 55%), hsl(calc(var(--glow) + 60) 90% 58%), hsl(calc(var(--glow) + 120) 90% 60%), hsl(var(--glow) 90% 55%)) text;
    -webkit-background-clip: padding-box, text; background-clip: padding-box, text;
    color: transparent; -webkit-text-fill-color: transparent;
  }
  .orrery-815 .brand p {
    margin: 0;
    font: 600 clamp(12px, 1.5vw, 16px)/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    color: var(--muted);
  }

  .orrery-815 .controls {
    display: grid; grid-auto-flow: column; gap: 10px; align-items: center;
  }
  .orrery-815 .pill {
    appearance: none; border: 0; cursor: pointer;
    font: 800 12px/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    padding: 11px 14px; border-radius: 999px; color: var(--ink);
    background: linear-gradient(180deg, var(--glass), hsl(0 0% 100% / .58));
    border: 1px solid var(--edge);
    box-shadow: 0 10px 20px hsl(220 30% 20% / .12), inset 0 1px 0 hsl(0 0% 100% / .6);
    transform: translateZ(0);
    transition: transform 160ms ease, box-shadow 160ms ease;
    position: relative; overflow: hidden;
  }
  .orrery-815[data-theme="night"] .pill {
    background: linear-gradient(180deg, hsl(0 0% 100% / .1), hsl(0 0% 100% / .08));
    color: hsl(0 0% 98%);
    box-shadow: 0 10px 22px hsl(220 30% 6% / .45), inset 0 1px 0 hsl(0 0% 100% / .15);
  }
  .orrery-815 .pill:hover { transform: translateY(-2px); box-shadow: 0 16px 30px hsl(220 30% 20% / .18); }
  .orrery-815 .pill .ink {
    position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
    background: radial-gradient(160px 160px at var(--mx,50%) var(--my,50%), hsl(0 0% 100% / .35), transparent 66%);
    opacity: 0; transition: opacity 160ms ease;
  }
  .orrery-815 .pill:hover .ink { opacity: 1; }

  .orrery-815 .knob {
    display: inline-grid; grid-auto-flow: column; align-items: center; gap: 10px;
    padding: 8px 12px; border-radius: 999px;
    background: linear-gradient(180deg, var(--glass), hsl(0 0% 100% / .56));
    border: 1px solid var(--edge);
    box-shadow: inset 0 1px 0 hsl(0 0% 100% / .6);
    color: var(--ink);
    font: 600 12px ui-sans-serif, system-ui;
  }
  .orrery-815 input[type="range"] {
    -webkit-appearance: none; appearance: none; width: 140px; height: 28px; background: transparent;
  }
  .orrery-815 input[type="range"]::-webkit-slider-runnable-track {
    height: 8px; border-radius: 999px;
    background: linear-gradient(90deg, hsl(calc(var(--glow) - 10) 90% 55%), hsl(calc(var(--glow) + 70) 90% 58%));
    box-shadow: inset 0 1px 0 hsl(0 0% 100% / .5);
  }
  .orrery-815 input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none; appearance: none; width: 18px; height: 18px; margin-top: -5px; border-radius: 50%;
    background: white; border: 1px solid var(--edge);
    box-shadow: 0 4px 10px hsl(220 30% 20% / .2);
  }
  .orrery-815 input[type="range"]::-moz-range-track {
    height: 8px; border-radius: 999px;
    background: linear-gradient(90deg, hsl(calc(var(--glow) - 10) 90% 55%), hsl(calc(var(--glow) + 70) 90% 58%));
  }
  .orrery-815 input[type="range"]::-moz-range-thumb {
    width: 18px; height: 18px; border-radius: 50%; background: white; border: 1px solid var(--edge);
  }

  .orrery-815 .stage-wrap {
    position: relative; z-index: 1; perspective: 1600px;
  }
  .orrery-815 .stage {
    position: relative; border-radius: 24px; overflow: hidden;
    min-height: clamp(280px, 48vw, 560px);
    border: 1px solid var(--edge);
    background: linear-gradient(180deg, hsl(0 0% 100% / .72), hsl(0 0% 100% / .5));
    box-shadow: 0 40px 80px hsl(220 40% 20% / .14), inset 0 1px 0 hsl(0 0% 100% / .65);
    transform-style: preserve-3d;
    transform: rotateX(var(--ax)) rotateY(var(--ay));
  }
  .orrery-815[data-theme="night"] .stage {
    background: linear-gradient(180deg, hsl(0 0% 100% / .08), hsl(0 0% 100% / .06));
    box-shadow: 0 40px 100px hsl(220 40% 8% / .5), inset 0 1px 0 hsl(0 0% 100% / .12);
  }
  .orrery-815 .sky { position: absolute; inset: -1px; width: 100%; height: 100%; display: block; }
  .orrery-815 .halo {
    position: absolute; inset: -10%;
    background:
      radial-gradient(80% 80% at 20% 10%, hsl(calc(var(--glow) + 20) 100% 70% / .35), transparent 60%),
      radial-gradient(90% 90% at 80% 90%, hsl(calc(var(--glow) + 120) 100% 70% / .3), transparent 60%),
      radial-gradient(120% 120% at 50% 50%, hsl(calc(var(--glow) + 200) 100% 70% / .18), transparent 68%);
    mix-blend-mode: soft-light; filter: blur(40px);
    pointer-events: none; z-index: 0;
  }
  .orrery-815 .gridlines {
    position: absolute; inset: 0; pointer-events: none; z-index: 1; opacity: .16;
    background:
      linear-gradient(0deg, transparent 49%, hsl(0 0% 0% / .8) 50%, transparent 51%),
      linear-gradient(90deg, transparent 49%, hsl(0 0% 0% / .8) 50%, transparent 51%);
    background-size: 28px 28px; mix-blend-mode: overlay;
  }
  .orrery-815[data-theme="night"] .gridlines { opacity: .12; }

  .orrery-815 .title {
    position: relative; z-index: 2; display: grid; place-items: center; text-align: center;
    padding: clamp(18px, 4vw, 28px);
  }
  .orrery-815 .title .big {
    font: 900 clamp(24px, 5.6vw, 64px)/1 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    letter-spacing: -0.02em; margin: 0 0 8px 0;
    background: linear-gradient(90deg, var(--ink), var(--ink)) text;
    -webkit-background-clip: text; background-clip: text; color: transparent; -webkit-text-fill-color: transparent;
  }
  .orrery-815 .title .sub {
    font: 500 clamp(13px, 1.6vw, 18px)/1.6 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    color: var(--muted); transition: opacity 300ms ease, transform 300ms ease;
  }
  .orrery-815 .title .sub.fade { opacity: 0; transform: translateY(6px); }

  .orrery-815 .foot {
    position: relative; z-index: 2;
    margin-top: clamp(16px, 3.2vw, 26px);
    display: flex; justify-content: space-between; align-items: center; gap: 12px;
    color: var(--muted);
    font: 500 12px/1.4 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  }
  .orrery-815 .hint {
    font: 700 11px/1 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    background: hsl(0 0% 100% / .55);
    border: 1px solid var(--edge);
    padding: 6px 8px; border-radius: 8px; color: var(--ink);
  }
  .orrery-815[data-theme="night"] .hint { background: hsl(0 0% 100% / .12); color: hsl(0 0% 98%); }
</style>

<div class="orrery-815" id="orr815" role="region" aria-label="Orrery 815" data-theme="dawn" data-reduced="false">
  <div class="bar">
    <div class="brand">
      <h1>ORRERY · 815</h1>
      <p>Orbital timepiece. Quiet motion, lucid color, glassy calm.</p>
    </div>
    <div class="controls" role="group" aria-label="Controls">
      <button class="pill" id="mode815" type="button" aria-pressed="false"><span class="ink" aria-hidden="true"></span>Night / Dawn</button>
      <button class="pill" id="const815" type="button"><span class="ink" aria-hidden="true"></span>Constellate</button>
      <span class="knob" aria-label="Speed">
        <span>Speed</span>
        <input id="spd815" type="range" min="0" max="200" value="90" aria-label="Speed slider">
      </span>
      <span class="knob" aria-label="Bodies">
        <span>Bodies</span>
        <input id="bod815" type="range" min="3" max="24" value="10" aria-label="Bodies slider">
      </span>
      <button class="pill" id="motion815" type="button" aria-pressed="false"><span class="ink" aria-hidden="true"></span>Pause</button>
    </div>
  </div>

  <div class="stage-wrap">
    <div class="stage" id="stage815" tabindex="0" aria-live="polite">
      <canvas class="sky" id="sky815" aria-hidden="true"></canvas>
      <div class="halo" aria-hidden="true"></div>
      <div class="gridlines" aria-hidden="true"></div>
      <div class="title">
        <p class="big" id="tbig815">Time in orbits.</p>
        <p class="sub" id="tsub815">Move your cursor to tilt. Double‑click to remix the heavens.</p>
      </div>
    </div>
  </div>

  <div class="foot">
    <span class="hint" aria-hidden="true">Tip: orbits follow your cursor subtly · trails emerge at higher speeds</span>
    <span id="last-updated">Last updated: 2025-11-22 18:16:44 EST</span>
  </div>
</div>

<script>
  (function () {
    const root = document.getElementById('orr815');
    const stage = document.getElementById('stage815');
    const canvas = document.getElementById('sky815');
    const ctx = canvas.getContext('2d');

    const modeBtn = document.getElementById('mode815');
    const constBtn = document.getElementById('const815');
    const spd = document.getElementById('spd815');
    const bod = document.getElementById('bod815');
    const motion = document.getElementById('motion815');

    const tbig = document.getElementById('tbig815');
    const tsub = document.getElementById('tsub815');
    const last = document.getElementById('last-updated');

    // Timestamp
    try {
      const now = new Date();
      const opts = { year: 'numeric', month: 'short', day: '2-digit', hour: '2-digit', minute: '2-digit' };
      last.textContent = 'Last updated: ' + now.toLocaleString(undefined, opts);
    } catch { last.textContent = 'Last updated: just now'; }

    // Ink hover
    function inkPos(e) {
      const b = e.currentTarget.getBoundingClientRect();
      e.currentTarget.style.setProperty('--mx', ((e.clientX - b.left) / b.width) * 100 + '%');
      e.currentTarget.style.setProperty('--my', ((e.clientY - b.top) / b.height) * 100 + '%');
    }
    [modeBtn, constBtn, motion].forEach(btn => btn.addEventListener('pointermove', inkPos, { passive: true }));

    // Theme
    modeBtn.addEventListener('click', () => {
      const night = root.getAttribute('data-theme') === 'night';
      root.setAttribute('data-theme', night ? 'dawn' : 'night');
      modeBtn.setAttribute('aria-pressed', String(!night));
    });

    // Motion / reduced
    const setReduced = (state) => root.setAttribute('data-reduced', state ? 'true' : 'false');
    const media = window.matchMedia('(prefers-reduced-motion: reduce)');
    setReduced(media.matches);
    media.addEventListener?.('change', (e) => setReduced(e.matches));
    motion.addEventListener('click', () => {
      const now = root.getAttribute('data-reduced') === 'true';
      setReduced(!now);
      motion.setAttribute('aria-pressed', String(!now));
      if (!now) { drawStatic(); stop(); } else { start(); }
    });

    // Tilt/parallax
    function tilt(e) {
      const r = stage.getBoundingClientRect();
      const px = (e.clientX - r.left) / r.width - 0.5;
      const py = (e.clientY - r.top) / r.height - 0.5;
      const max = 8;
      root.style.setProperty('--ay', (px * max).toFixed(2) + 'deg');
      root.style.setProperty('--ax', (-py * max).toFixed(2) + 'deg');
      mouse.x = e.clientX * dpr;
      mouse.y = e.clientY * dpr;
      mouse.active = true;
    }
    stage.addEventListener('pointermove', tilt, { passive: true });
    stage.addEventListener('mouseleave', () => {
      root.style.setProperty('--ay', '0deg');
      root.style.setProperty('--ax', '0deg');
      mouse.active = false;
    });
    stage.addEventListener('dblclick', () => remix(true));

    // Canvas + simulation
    let w = 0, h = 0, dpr = Math.max(1, window.devicePixelRatio || 1);
    let raf = null;

    const mouse = { x: 0, y: 0, active: false };
    let stars = [];
    let bodies = [];
    let orbits = [];
    let speedFactor = 0.9;

    spd.addEventListener('input', e => {
      speedFactor = Math.max(0, e.target.value / 100);
    });
    bod.addEventListener('input', () => build());

    constBtn.addEventListener('click', () => remix());

    function fit() {
      const b = stage.getBoundingClientRect();
      w = Math.max(1, Math.floor(b.width));
      h = Math.max(1, Math.floor(b.height));
      canvas.width = Math.floor(w * dpr);
      canvas.height = Math.floor(h * dpr);
      canvas.style.width = w + 'px';
      canvas.style.height = h + 'px';
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }

    function seedStars() {
      const count = Math.round((w * h) / 1800);
      stars = [];
      for (let i = 0; i < count; i++) {
        stars.push({
          x: Math.random() * w,
          y: Math.random() * h,
          r: Math.random() * 1.2 + 0.2,
          a: Math.random() * Math.PI * 2,
          tw: Math.random() * 0.6 + 0.2
        });
      }
    }

    function build() {
      const center = { x: w / 2, y: h / 2 };
      const rings = Math.max(3, Math.min(24, parseInt(bod.value, 10) || 10));
      orbits = [];
      bodies = [];
      const maxR = Math.min(w, h) * 0.44;
      for (let i = 0; i < rings; i++) {
        const r = (i + 1) / (rings + 1) * maxR;
        orbits.push({ r });
        const count = (i % 2 === 0 ? 1 : 2);
        for (let k = 0; k < count; k++) {
          const hue = (i * 27 + k * 60 + Math.random() * 40) % 360;
          bodies.push({
            orbit: r,
            angle: Math.random() * Math.PI * 2,
            speed: (0.0006 + i * 0.0005) * (Math.random() < 0.5 ? 1 : -1) * (0.6 + Math.random() * 0.6),
            size: Math.max(1.5, 2.2 + (i / rings) * 3.4),
            hue,
            drift: (Math.random() * 0.6 + 0.4)
          });
        }
      }
      // ensure at least one central body
      bodies.push({
        orbit: 0,
        angle: 0,
        speed: 0,
        size: 6,
        hue: (Math.random() * 360) | 0,
        drift: 0
      });
    }

    function remix(jolt = false) {
      // shuffle hues and maybe speeds
      bodies.forEach((b, i) => {
        if (i === bodies.length - 1) return;
        b.hue = (b.hue + 60 + Math.random() * 120) % 360;
        if (jolt) b.speed *= (Math.random() < 0.5 ? -1 : 1) * (0.8 + Math.random() * 0.6);
      });
      // copy updates to CSS glow
      const base = bodies[0]?.hue || 220;
      root.style.setProperty('--glow', Math.round(base));
      // text shuffle
      cycleLines();
    }

    function drawBackground(t) {
      // starfield twinkle
      const night = root.getAttribute('data-theme') === 'night';
      for (let i = 0; i < stars.length; i++) {
        const s = stars[i];
        const tw = 0.4 + Math.sin(t * 0.001 + s.a) * s.tw;
        ctx.fillStyle = night ? `hsla(0,0%,100%,${0.15 + tw * 0.25})` : `hsla(220,10%,10%,${0.06 + tw * 0.12})`;
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function drawOrbits() {
      ctx.save();
      ctx.translate(w / 2, h / 2);
      ctx.lineWidth = 1;
      ctx.strokeStyle = root.getAttribute('data-theme') === 'night'
        ? 'hsla(0,0%,100%,.12)' : 'hsla(220, 20%, 20%, .12)';
      orbits.forEach(o => {
        ctx.beginPath();
        ctx.arc(0, 0, o.r, 0, Math.PI * 2);
        ctx.stroke();
      });
      ctx.restore();
    }

    function drawBodies(t) {
      const night = root.getAttribute('data-theme') === 'night';
      const cx = w / 2, cy = h / 2;

      for (let i = 0; i < bodies.length; i++) {
        const b = bodies[i];
        if (b.orbit > 0) b.angle += b.speed * speedFactor;

        // gentle mouse attraction
        if (mouse.active && b.orbit > 0) {
          const bx = cx + Math.cos(b.angle) * b.orbit;
          const by = cy + Math.sin(b.angle) * b.orbit;
          const dx = (mouse.x / dpr) - bx;
          const dy = (mouse.y / dpr) - by;
          const dist = Math.max(1, Math.hypot(dx, dy));
          const pull = Math.min(0.0008, 20 / (dist * dist)) * b.drift;
          const target = Math.atan2(by - (mouse.y / dpr), bx - (mouse.x / dpr));
          b.angle -= pull * Math.sign(Math.sin(b.angle - target)); // nudge
        }

        const x = cx + Math.cos(b.angle) * b.orbit;
        const y = cy + Math.sin(b.angle) * b.orbit;

        const alpha = night ? 0.22 : 0.18;
        const grd = ctx.createRadialGradient(x, y, 0, x, y, b.size * 3.5);
        grd.addColorStop(0, `hsla(${b.hue}, 90%, ${night ? 70 : 50}%, ${alpha * 1.6})`);
        grd.addColorStop(1, `hsla(${(b.hue + 60) % 360}, 80%, ${night ? 50 : 60}%, 0)`);

        ctx.fillStyle = grd;
        ctx.beginPath();
        ctx.arc(x, y, b.size * 2.4, 0, Math.PI * 2);
        ctx.fill();

        // core
        ctx.fillStyle = night ? `hsla(${b.hue}, 100%, 85%, .9)` : `hsla(${b.hue}, 90%, 45%, .9)`;
        ctx.beginPath();
        ctx.arc(x, y, b.size, 0, Math.PI * 2);
        ctx.fill();

        // subtle tail
        if (speedFactor > 0.7 && b.orbit > 0) {
          const tx = cx + Math.cos(b.angle - 0.15) * b.orbit;
          const ty = cy + Math.sin(b.angle - 0.15) * b.orbit;
          ctx.strokeStyle = night ? `hsla(${b.hue}, 90%, 70%, .18)` : `hsla(${b.hue}, 90%, 40%, .14)`;
          ctx.lineWidth = Math.max(0.5, b.size * 0.35);
          ctx.beginPath();
          ctx.moveTo(tx, ty);
          ctx.lineTo(x, y);
          ctx.stroke();
        }
      }
    }

    function frame(t) {
      if (root.getAttribute('data-reduced') === 'true') return;
      // trail fade for motion persistence
      const night = root.getAttribute('data-theme') === 'night';
      ctx.fillStyle = night ? 'rgba(5,7,12,0.24)' : 'rgba(255,255,255,0.24)';
      ctx.fillRect(0, 0, w, h);

      drawBackground(t);
      drawOrbits();
      drawBodies(t);

      raf = requestAnimationFrame(frame);
    }

    function drawStatic() {
      // crisp static snapshot
      ctx.clearRect(0, 0, w, h);
      drawBackground(performance.now());
      drawOrbits();
      drawBodies(performance.now());
    }

    function start() {
      stop();
      raf = requestAnimationFrame(frame);
    }
    function stop() {
      if (raf) cancelAnimationFrame(raf);
      raf = null;
    }

    function boot() {
      fit();
      seedStars();
      build();
      remix(false);
      if (root.getAttribute('data-reduced') === 'true') {
        drawStatic();
      } else {
        start();
      }
    }

    window.addEventListener('resize', () => {
      fit();
      seedStars();
      build();
      if (root.getAttribute('data-reduced') === 'true') drawStatic();
    });

    // Text cycle
    const lines = [
      ['Time in orbits.', 'Let motion explain the shape of things.'],
      ['Quiet mechanics.', 'Elegance is what remains.'],
      ['Draw circles with light.', 'Everything returns, slightly changed.'],
      ['Touch the cosmos.', 'Small inputs, vast ripples.']
    ];
    let idx = 0;
    function cycleLines() {
      idx = (idx + 1) % lines.length;
      tsub.classList.add('fade');
      setTimeout(() => {
        tbig.textContent = lines[idx][0];
        tsub.textContent = lines[idx][1];
        tsub.classList.remove('fade');
      }, 260);
    }
    let cycleTimer = setInterval(cycleLines, 4600);

    // Initialize
    boot();

    // Clean up timers on unload
    window.addEventListener('beforeunload', () => {
      clearInterval(cycleTimer);
      stop();
    });
  })();
</script>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


