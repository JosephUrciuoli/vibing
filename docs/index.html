<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div id="halo2102" aria-label="Prismatic Halo 2102" data-scheme="dark" data-play="true" data-cycling="false">
  <style>
    /* Root aesthetic */
    #halo2102 {
      --h: 262; /* spectrum hue */
      --s: 92%;
      --l: 60%;
      --accent: hsl(var(--h), var(--s), var(--l));
      --accent-2: hsl(calc(var(--h) + 40), 85%, 62%);
      --accent-3: hsl(calc(var(--h) - 40), 85%, 62%);
      --fg: #eaf0ff;
      --fg-soft: #b9c3da;
      --bg-0: #0a0f1d;
      --bg-1: #0e1630;
      --panel: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.12);

      position: relative;
      border-radius: 28px;
      padding: clamp(22px, 4.5vw, 48px);
      color: var(--fg);
      background:
        radial-gradient(1400px 700px at 20% -10%, rgba(64,96,255,0.15), transparent 60%),
        radial-gradient(1400px 700px at 120% 110%, rgba(0,180,255,0.12), transparent 60%),
        linear-gradient(180deg, var(--bg-0), var(--bg-1));
      box-shadow: 0 30px 90px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.04);
      font: 500 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow: hidden;
      isolation: isolate;
    }
    #halo2102[data-scheme="light"] {
      --fg: #101424;
      --fg-soft: #44507a;
      --bg-0: #f7faff;
      --bg-1: #eef4ff;
      --panel: rgba(255,255,255,0.7);
      --stroke: rgba(12,18,32,0.12);
      background:
        radial-gradient(1200px 700px at -20% -10%, rgba(150,190,255,0.25), transparent 55%),
        radial-gradient(1200px 700px at 120% 110%, rgba(255,200,160,0.18), transparent 55%),
        linear-gradient(180deg, var(--bg-0), var(--bg-1));
      box-shadow: 0 30px 90px rgba(10,40,120,0.14), inset 0 1px 0 rgba(255,255,255,0.8);
    }

    #halo2102 * { box-sizing: border-box; }

    /* Starfield canvas + glow layers */
    #halo2102 .stars { position: absolute; inset: 0; z-index: 0; filter: saturate(1.1) brightness(1.05); }
    #halo2102 .mist {
      position: absolute; inset: -30%;
      background:
        radial-gradient(60% 40% at 20% 10%, hsla(calc(var(--h) + 60), 95%, 70%, 0.10), transparent 70%),
        radial-gradient(50% 35% at 90% 80%, hsla(calc(var(--h) - 60), 95%, 70%, 0.10), transparent 70%),
        conic-gradient(from 180deg at 50% 20%, transparent, hsla(var(--h),85%,60%,0.08), transparent 70%);
      filter: blur(30px);
      z-index: 0;
      animation: driftMist 38s ease-in-out infinite alternate;
      pointer-events: none;
    }
    @keyframes driftMist {
      0% { transform: translate3d(-2%, -1%, 0) scale(1); }
      100% { transform: translate3d(2%, 1%, 0) scale(1.08); }
    }

    /* Header */
    #halo2102 .crest {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 8px 14px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
      backdrop-filter: blur(8px);
      border-radius: 999px;
      text-transform: uppercase;
      letter-spacing: .14em;
      font-size: 12px;
      color: var(--fg-soft);
      box-shadow: 0 10px 30px rgba(0,0,0,0.18), inset 0 1px 0 rgba(255,255,255,0.08);
      position: relative;
      z-index: 2;
    }
    #halo2102 .crest .bead {
      width: 10px; height: 10px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--accent), rgba(255,255,255,0.15));
      box-shadow: 0 0 14px hsla(var(--h), 90%, 60%, 0.8);
    }
    #halo2102 h1 {
      margin: 16px 0 10px;
      font-size: clamp(38px, 7.4vw, 86px);
      line-height: 1;
      letter-spacing: -0.02em;
      font-weight: 850;
      background: linear-gradient(90deg, var(--fg) 0%, var(--accent) 40%, var(--accent-2) 60%, var(--fg) 100%);
      -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 16px 50px hsla(var(--h), 90%, 55%, 0.25);
      position: relative; z-index: 2;
    }
    #halo2102 .lede {
      margin: 0 0 26px 0;
      max-width: 70ch;
      color: var(--fg-soft);
      font-size: clamp(14px, 1.8vw, 18px);
      line-height: 1.7;
      position: relative; z-index: 2;
    }

    /* Halo stage */
    #halo2102 .stage {
      position: relative; z-index: 2;
      display: grid; place-items: center;
      margin: clamp(8px, 3vw, 24px) 0;
    }
    #halo2102 .sphere {
      --tiltX: 0deg; --tiltY: 0deg;
      width: clamp(280px, 60vmin, 640px);
      aspect-ratio: 1/1;
      border-radius: 50%;
      position: relative;
      background:
        radial-gradient(60% 60% at 30% 25%, hsla(var(--h),85%,70%,0.22), transparent 60%),
        radial-gradient(80% 80% at 70% 75%, hsla(calc(var(--h) + 90),85%,60%,0.18), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.06), rgba(0,0,0,0.06));
      border: 1px solid var(--stroke);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.2),
        inset 0 -80px 120px rgba(0,0,0,0.25),
        0 30px 80px rgba(0,0,0,0.35);
      transform: rotateX(var(--tiltX)) rotateY(var(--tiltY));
      transform-style: preserve-3d;
      overflow: visible;
    }
    #halo2102 .sphere::before {
      content: ""; position: absolute; inset: -2%;
      border-radius: 50%;
      background: conic-gradient(from calc(var(--h) * 1deg), hsla(var(--h), 95%, 65%, 0.25), transparent 40%, transparent 60%, hsla(calc(var(--h)+120), 95%, 60%, 0.25));
      filter: blur(18px);
      animation: haloSpin 54s linear infinite;
    }
    #halo2102 .sphere::after {
      content: ""; position: absolute; inset: 12%; border-radius: 50%;
      background: radial-gradient(closest-side, rgba(255,255,255,0.08), transparent 70%);
      pointer-events: none;
    }
    @keyframes haloSpin { to { transform: rotate(360deg); } }

    /* Rings */
    #halo2102 .ring {
      position: absolute; inset: 0; border-radius: 50%;
      -webkit-mask:
        radial-gradient(closest-side, transparent calc(50% - 1px), #000 calc(50% - 0px)),
        radial-gradient(farthest-side, #000 calc(50% - 6px), transparent calc(50% - 5px));
              mask:
        radial-gradient(closest-side, transparent calc(50% - 1px), #000 calc(50% - 0px)),
        radial-gradient(farthest-side, #000 calc(50% - 6px), transparent calc(50% - 5px));
      pointer-events: none;
    }
    #halo2102 .ring.a {
      background:
        conic-gradient(from 0deg,
          transparent 0 10deg, hsla(var(--h),90%,60%,0.8) 10deg 12deg, transparent 12deg 24deg,
          hsla(calc(var(--h)+60),90%,65%,0.7) 24deg 26deg, transparent 26deg 40deg,
          hsla(calc(var(--h)-60),90%,65%,0.7) 40deg 42deg, transparent 42deg 360deg);
      animation: spinA 30s linear infinite;
    }
    #halo2102 .ring.b {
      inset: 6%; 
      background:
        conic-gradient(from 90deg,
          transparent 0 2deg, hsla(var(--h),95%,60%,0.8) 2deg 3deg, transparent 3deg 6deg) 0 0/20deg 20deg repeat,
        conic-gradient(from 180deg,
          transparent 0 1deg, hsla(calc(var(--h)+120),95%,60%,0.6) 1deg 2deg, transparent 2deg 6deg) 0 0/30deg 30deg repeat;
      filter: drop-shadow(0 0 10px hsla(var(--h),90%,60%,0.4));
      animation: spinB 18s linear infinite reverse;
    }
    @keyframes spinA { to { transform: rotate(360deg); } }
    @keyframes spinB { to { transform: rotate(-360deg); } }

    /* Orbiting node */
    #halo2102 .orbit {
      position: absolute; inset: -2%; border-radius: 50%;
      animation: orbitRoll 10s linear infinite;
    }
    @keyframes orbitRoll { to { transform: rotate(360deg); } }
    #halo2102 .node {
      position: absolute; left: 50%; top: -6px; transform: translateX(-50%);
      width: 14px; height: 14px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent));
      box-shadow: 0 0 22px hsla(var(--h), 90%, 60%, 0.9), 0 0 0 8px hsla(var(--h), 90%, 60%, 0.12);
      border: 1px solid rgba(255,255,255,0.6);
    }

    /* Readout */
    #halo2102 .readout {
      position: absolute; inset: 26% 26%;
      display: grid; place-items: center;
      border-radius: 50%;
      border: 1px dashed var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
    }
    #halo2102 .num {
      font-feature-settings: "tnum" 1, "zero" 1;
      font-variant-numeric: tabular-nums;
      font-weight: 800;
      font-size: clamp(28px, 6.2vmin, 56px);
      letter-spacing: -0.02em;
      background: linear-gradient(90deg, var(--accent-3), var(--accent), var(--accent-2));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 10px 40px hsla(var(--h), 90%, 55%, 0.35);
    }
    #halo2102 .label {
      margin-top: 4px;
      color: var(--fg-soft);
      font-size: 12px;
      letter-spacing: .18em;
      text-transform: uppercase;
    }

    /* Scene chips around the halo */
    #halo2102 .scenes { position: absolute; inset: 0; }
    #halo2102 .scene {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.02));
      color: var(--fg);
      font-size: 12px; letter-spacing: .08em; text-transform: uppercase;
      display: inline-flex; align-items: center; gap: 8px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.28), inset 0 1px 0 rgba(255,255,255,0.06);
      cursor: pointer; user-select: none;
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
    }
    #halo2102 .scene:hover { box-shadow: 0 14px 34px rgba(0,0,0,0.34); transform: translate(-50%, -50%) scale(1.06); }
    #halo2102 .scene[aria-selected="true"] { outline: 2px solid var(--accent); outline-offset: 2px; }
    #halo2102 .scene .dot {
      width: 8px; height: 8px; border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, var(--accent), hsla(var(--h), 90%, 50%, 0.6));
      box-shadow: 0 0 10px hsla(var(--h), 95%, 60%, 0.8);
    }
    #halo2102 .scene.dawn { transform: translate(-50%, -50%) rotate(-20deg) translateY(calc(-50% - 8vmin)) rotate(20deg); }
    #halo2102 .scene.noon { transform: translate(-50%, -50%) rotate(70deg) translateY(calc(-50% - 8vmin)) rotate(-70deg); }
    #halo2102 .scene.dusk { transform: translate(-50%, -50%) rotate(160deg) translateY(calc(-50% - 8vmin)) rotate(-160deg); }
    #halo2102 .scene.night { transform: translate(-50%, -50%) rotate(250deg) translateY(calc(-50% - 8vmin)) rotate(-250deg); }

    /* Controls */
    #halo2102 .controls {
      margin-top: clamp(16px, 3vw, 28px);
      display: grid;
      grid-template-columns: 1fr auto auto auto;
      gap: 12px;
      align-items: center;
      position: relative; z-index: 2;
    }
    #halo2102 .sliderWrap {
      display: grid; grid-template-columns: 50px 1fr; gap: 10px;
      padding: 12px; border-radius: 16px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.02));
      box-shadow: 0 10px 24px rgba(0,0,0,0.24), inset 0 1px 0 rgba(255,255,255,0.06);
    }
    #halo2102 .swatch {
      width: 50px; height: 50px; border-radius: 12px;
      background: conic-gradient(from calc(var(--h)*1deg), hsl(0,90%,55%), hsl(60,90%,55%), hsl(120,90%,45%), hsl(180,90%,55%), hsl(240,90%,65%), hsl(300,90%,60%), hsl(360,90%,55%));
      border: 1px solid var(--stroke);
      box-shadow: inset 0 0 0 6px rgba(255,255,255,0.06);
    }
    #halo2102 .slider {
      appearance: none; width: 100%; height: 14px; border-radius: 999px;
      background: linear-gradient(90deg, hsl(0,90%,55%), hsl(60,90%,55%), hsl(120,90%,45%), hsl(180,90%,55%), hsl(240,90%,65%), hsl(300,90%,60%), hsl(360,90%,55%));
      border: 1px solid var(--stroke);
      outline: none;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
    }
    #halo2102 .slider::-webkit-slider-thumb {
      appearance: none; width: 22px; height: 22px; border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, #fff, var(--accent));
      border: 1px solid rgba(255,255,255,0.7);
      box-shadow: 0 10px 24px hsla(var(--h),90%,50%,0.45), inset 0 0 0 3px rgba(255,255,255,0.4);
      cursor: pointer;
    }

    #halo2102 .btn {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 10px 14px; border-radius: 14px; font-weight: 600;
      color: var(--fg);
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.02));
      border: 1px solid var(--stroke);
      box-shadow: 0 8px 22px rgba(0,0,0,0.22), inset 0 1px 0 rgba(255,255,255,0.06);
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
      cursor: pointer; user-select: none;
    }
    #halo2102 .btn:hover { transform: translateY(-1px); box-shadow: 0 16px 34px rgba(0,0,0,0.28); }
    #halo2102 .btn:active { transform: translateY(0); }
    #halo2102 .btn .pulse {
      width: 9px; height: 9px; border-radius: 50%;
      background: radial-gradient(circle at 35% 35%, var(--accent), hsla(var(--h), 90%, 60%, 0.7));
      box-shadow: 0 0 10px hsla(var(--h), 95%, 55%, 0.8);
      animation: pulse2102 3s ease-in-out infinite;
    }
    @keyframes pulse2102 {
      0%,100% { transform: scale(1); box-shadow: 0 0 10px hsla(var(--h),95%,55%,0.8); }
      50% { transform: scale(1.22); box-shadow: 0 0 20px hsla(var(--h),95%,60%,1); }
    }
    #halo2102[data-play="false"] .btn .pulse { animation-play-state: paused; }

    /* Footer */
    #halo2102 .foot {
      display: flex; justify-content: space-between; align-items: center; gap: 12px;
      margin-top: 22px; padding-top: 16px; border-top: 1px dashed var(--stroke);
      color: var(--fg-soft); font-size: 13px; position: relative; z-index: 2;
    }
    #halo2102 .stamp {
      display: inline-flex; align-items: center; gap: 10px;
      padding: 8px 12px; border-radius: 12px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, var(--panel), rgba(255,255,255,0.02));
      box-shadow: 0 6px 18px rgba(0,0,0,0.2);
    }

    /* Ripple */
    #halo2102 .ripple {
      position: absolute; width: 12px; height: 12px; border-radius: 50%;
      pointer-events: none;
      background: radial-gradient(circle, var(--accent) 0%, transparent 70%);
      mix-blend-mode: screen; opacity: 0.7; transform: translate(-50%, -50%) scale(0.6);
      animation: ripple2102 900ms ease-out forwards;
      z-index: 3;
    }
    @keyframes ripple2102 { to { transform: translate(-50%, -50%) scale(7); opacity: 0; } }

    /* Motion pause switch */
    #halo2102[data-play="false"] .ring,
    #halo2102[data-play="false"] .orbit,
    #halo2102[data-play="false"] .mist { animation-play-state: paused !important; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #halo2102 .ring, #halo2102 .orbit, #halo2102 .mist, #halo2102 .btn .pulse { animation: none !important; }
    }
  </style>

  <canvas class="stars" aria-hidden="true"></canvas>
  <div class="mist" aria-hidden="true"></div>

  <div class="head">
    <div class="crest"><span class="bead" aria-hidden="true"></span> Prismatic Halo • 2102</div>
    <h1>Color, choreographed.</h1>
    <p class="lede">A circular instrument for mood and light. Drag the spectrum, pick a scene, and let the halo compose your atmosphere.</p>
  </div>

  <div class="stage">
    <div class="sphere" role="region" aria-label="Spectral dial">
      <div class="ring a anim" aria-hidden="true"></div>
      <div class="ring b anim" aria-hidden="true"></div>
      <div class="orbit anim" aria-hidden="true"><span class="node"></span></div>

      <div class="readout" aria-live="polite">
        <div class="num" id="read-hue">262</div>
        <div class="label">HUE</div>
      </div>

      <nav class="scenes" role="tablist" aria-label="Scenes">
        <button class="scene dawn" role="tab" aria-selected="false" data-scene="dawn" title="Dawn">
          <span class="dot" aria-hidden="true"></span> Dawn
        </button>
        <button class="scene noon" role="tab" aria-selected="false" data-scene="noon" title="Noon">
          <span class="dot" aria-hidden="true"></span> Noon
        </button>
        <button class="scene dusk" role="tab" aria-selected="false" data-scene="dusk" title="Dusk">
          <span class="dot" aria-hidden="true"></span> Dusk
        </button>
        <button class="scene night" role="tab" aria-selected="true" data-scene="night" title="Night">
          <span class="dot" aria-hidden="true"></span> Night
        </button>
      </nav>
    </div>
  </div>

  <div class="controls" role="group" aria-label="Controls">
    <div class="sliderWrap" role="region" aria-label="Hue">
      <div class="swatch" aria-hidden="true"></div>
      <input id="hue2102" class="slider" type="range" min="0" max="360" value="262" aria-label="Hue slider">
    </div>
    <button id="theme2102" class="btn" type="button" aria-pressed="true" title="Toggle light/dark theme">
      <span class="pulse" aria-hidden="true"></span> Theme
    </button>
    <button id="motion2102" class="btn" type="button" aria-pressed="true" title="Pause or play motion">
      <span class="pulse" aria-hidden="true"></span> Pause
    </button>
    <button id="cycle2102" class="btn" type="button" aria-pressed="false" title="Auto-cycle hue">
      <span class="pulse" aria-hidden="true"></span> Auto
    </button>
  </div>

  <div class="foot">
    <div class="stamp">Composed • <span id="last-updated">Last updated: 2026-01-21 11:42:28 EST</span></div>
    <div class="hint" aria-hidden="true">Tip: hover the halo to tilt it, or try the Dawn/Dusk scenes.</div>
  </div>

  <script>
    (function(){
      const root = document.getElementById('halo2102');
      const slider = root.querySelector('#hue2102');
      const readout = root.querySelector('#read-hue');
      const themeBtn = root.querySelector('#theme2102');
      const motionBtn = root.querySelector('#motion2102');
      const cycleBtn = root.querySelector('#cycle2102');
      const scenes = Array.from(root.querySelectorAll('.scene'));
      const sphere = root.querySelector('.sphere');
      const canvas = root.querySelector('.stars');
      const ctx = canvas.getContext('2d', { alpha: true });
      const updated = root.querySelector('#last-updated');

      // Updated timestamp
      try {
        const now = new Date();
        const opts = { year:'numeric', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' };
        updated.textContent = new Intl.DateTimeFormat(undefined, opts).format(now);
      } catch {
        updated.textContent = new Date().toLocaleString();
      }

      // Utilities
      const setHue = (v) => {
        root.style.setProperty('--h', v);
        readout.textContent = String(Math.round(v)).padStart(3, '0');
      };

      // Slider
      slider.addEventListener('input', e => setHue(e.target.value));
      setHue(slider.value);

      // Theme toggle
      const toggleTheme = () => {
        const isDark = root.getAttribute('data-scheme') === 'dark';
        root.setAttribute('data-scheme', isDark ? 'light' : 'dark');
        themeBtn.setAttribute('aria-pressed', (!isDark).toString());
      };
      themeBtn.addEventListener('click', toggleTheme);

      // Motion toggle
      const setPlay = (play) => {
        root.setAttribute('data-play', play ? 'true' : 'false');
        motionBtn.setAttribute('aria-pressed', play ? 'true' : 'false');
        motionBtn.lastChild.nodeValue = play ? ' Pause' : ' Play';
      };
      motionBtn.addEventListener('click', () => {
        const now = root.getAttribute('data-play') !== 'true';
        setPlay(now);
      });

      // Scenes
      const sceneMap = {
        dawn:  { hue: 28,  scheme: 'light' },
        noon:  { hue: 200, scheme: 'light' },
        dusk:  { hue: 320, scheme: 'dark'  },
        night: { hue: 210, scheme: 'dark'  }
      };
      scenes.forEach(btn => {
        btn.addEventListener('click', () => {
          const data = sceneMap[btn.dataset.scene];
          if (!data) return;
          slider.value = data.hue;
          setHue(data.hue);
          root.setAttribute('data-scheme', data.scheme);
          themeBtn.setAttribute('aria-pressed', (data.scheme === 'light' ? 'false' : 'true'));
          scenes.forEach(b => b.setAttribute('aria-selected','false'));
          btn.setAttribute('aria-selected','true');
        });
      });

      // Auto cycle
      let cycling = false;
      let lastT = 0;
      cycleBtn.addEventListener('click', () => {
        cycling = !cycling;
        root.setAttribute('data-cycling', cycling ? 'true' : 'false');
        cycleBtn.setAttribute('aria-pressed', cycling ? 'true' : 'false');
      });

      // Parallax tilt
      let tx = 0, ty = 0, rx = 0, ry = 0;
      const lerp = (a,b,t)=>a+(b-a)*t;
      const onMove = (e) => {
        const rect = sphere.getBoundingClientRect();
        const x = (e.clientX - rect.left) / rect.width - 0.5;
        const y = (e.clientY - rect.top) / rect.height - 0.5;
        tx = x * 14; // deg
        ty = -y * 14;
      };
      sphere.addEventListener('pointermove', onMove);
      sphere.addEventListener('pointerleave', ()=>{ tx=0; ty=0; });

      // Ripples on clicks
      root.addEventListener('pointerdown', (e) => {
        const r = document.createElement('span');
        r.className = 'ripple';
        r.style.left = e.clientX + 'px';
        r.style.top = e.clientY + 'px';
        root.appendChild(r);
        setTimeout(() => r.remove(), 900);
      });

      // Starfield
      let stars = [];
      const initStars = () => {
        const { width, height } = root.getBoundingClientRect();
        const ratio = Math.min(window.devicePixelRatio || 1, 2);
        canvas.width = Math.max(1, Math.floor(width * ratio));
        canvas.height = Math.max(1, Math.floor(height * ratio));
        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';
        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);
        const count = Math.floor((width * height) / 5500);
        stars = Array.from({length: count}, () => ({
          x: Math.random() * width,
          y: Math.random() * height,
          r: Math.random() * 1.4 + 0.4,
          tw: Math.random() * 2 * Math.PI,
          sp: 0.4 + Math.random() * 0.8
        }));
      };
      const drawStars = (t) => {
        const { width, height } = root.getBoundingClientRect();
        ctx.clearRect(0, 0, width, height);
        for (const s of stars) {
          s.tw += 0.01 * s.sp;
          const a = 0.4 + Math.sin(s.tw) * 0.3;
          ctx.globalAlpha = Math.max(0, Math.min(1, a));
          ctx.fillStyle = 'white';
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
          ctx.fill();
        }
        ctx.globalAlpha = 1;
      };
      let resizeTO;
      const onResize = () => {
        clearTimeout(resizeTO);
        resizeTO = setTimeout(initStars, 120);
      };
      window.addEventListener('resize', onResize, { passive: true });
      initStars();

      // Main loop
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (reduce) { setPlay(false); }
      let raf = null;
      const loop = (ts) => {
        raf = requestAnimationFrame(loop);
        // tilt easing
        rx = lerp(rx, ty, 0.08);
        ry = lerp(ry, tx, 0.08);
        sphere.style.setProperty('--tiltX', rx + 'deg');
        sphere.style.setProperty('--tiltY', ry + 'deg');

        // cycle hue
        if (cycling && root.getAttribute('data-play') === 'true') {
          const dt = lastT ? (ts - lastT) : 16;
          let h = parseFloat(getComputedStyle(root).getPropertyValue('--h')) || parseFloat(slider.value);
          h = (h + dt * 0.02) % 360; // ~7.2 deg per second
          slider.value = h;
          setHue(h);
        }
        lastT = ts;

        // stars
        if (root.getAttribute('data-play') === 'true' && !reduce) {
          drawStars(ts);
        }
      };
      raf = requestAnimationFrame(loop);

      // Clean up if ever removed
      const stop = () => { if (raf) cancelAnimationFrame(raf); raf = null; };
      window.addEventListener('visibilitychange', () => {
        if (document.hidden) stop(); else raf = requestAnimationFrame(loop);
      });

    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


