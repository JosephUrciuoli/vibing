<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<section class="poster" data-theme="aurora" aria-label="AETHER — A Kinetic Poster">
  <style>
    .poster {
      --r: 28px;
      --ink: #0f1222;
      --muted:#5b6a86;
      --line: rgba(10,16,30,0.14);

      /* Aurora */
      --bg1:#fbfdff; --bg2:#f7fff9;
      --c1:#89d6ff; --c2:#ffb8a1; --c3:#9cffd2; --c4:#ffe78a;

      position: relative;
      border-radius: var(--r);
      border: 1px solid var(--line);
      padding: clamp(16px, 3.6vw, 48px);
      color: var(--ink);
      background:
        radial-gradient(160% 140% at 15% -10%, rgba(255,184,161,0.25), transparent 55%),
        radial-gradient(160% 140% at 110% 120%, rgba(137,214,255,0.28), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.85),
        0 40px 130px rgba(20,25,40,0.18),
        0 16px 36px rgba(20,25,40,0.12);
      overflow: hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      isolation: isolate;
    }
    /* THEMES */
    .poster[data-theme="aurora"] { --bg1:#fbfdff; --bg2:#f7fff9; --ink:#0f1222; --muted:#5b6a86; --line:rgba(10,16,30,0.14); --c1:#89d6ff; --c2:#ffb8a1; --c3:#9cffd2; --c4:#ffe78a; }
    .poster[data-theme="nocturne"] { --bg1:#0a0d19; --bg2:#0f1326; --ink:#ebf2ff; --muted:#9fb0d8; --line:rgba(255,255,255,0.14); --c1:#8aa0ff; --c2:#64ffd6; --c3:#ffd37a; --c4:#b6c7ff; }
    .poster[data-theme="bloom"] { --bg1:#fff8fb; --bg2:#fffdf6; --ink:#161018; --muted:#6a5c77; --line:rgba(16,10,24,0.14); --c1:#ff9bd0; --c2:#ffa98a; --c3:#ffd97a; --c4:#a8ffcf; }
    .poster[data-theme="mono"] { --bg1:#f7f9fb; --bg2:#eef2f5; --ink:#101418; --muted:#5d6a76; --line:rgba(16,20,24,0.16); --c1:#88aaff; --c2:#88aaff; --c3:#88aaff; --c4:#88aaff; }

    .poster::before {
      content:"";
      position:absolute; inset:-30% -20% auto -20%; height:60%;
      background:
        radial-gradient(60% 80% at 18% 30%, var(--c2) 0%, transparent 60%),
        radial-gradient(70% 70% at 82% 24%, var(--c1) 0%, transparent 60%),
        radial-gradient(80% 90% at 50% 86%, var(--c3) 0%, transparent 65%);
      opacity:.16; filter: blur(28px); mix-blend-mode: screen; pointer-events:none;
      animation: float-veil 18s ease-in-out infinite alternate;
    }
    @keyframes float-veil { to { transform: translate3d(0, 14px, 0) scale(1.05); } }

    .mast {
      display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom: 10px;
    }
    .badge {
      display:inline-grid; grid-auto-flow:column; align-items:center; gap:12px;
      letter-spacing:.22em; text-transform:uppercase; font-weight:900; font-size:11px; color:var(--muted);
    }
    .mark {
      --s:30px; width:var(--s); height:var(--s);
      border-radius:10px; position:relative; display:grid; place-items:center; overflow:hidden;
      background:linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.35));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.8), 0 8px 20px rgba(20,25,40,0.18);
    }
    .mark::before,.mark::after{ content:""; position:absolute; border-radius:50%; inset:6px; border:2px solid rgba(16,21,36,0.12); }
    .chip {
      font-size:10px; letter-spacing:.18em; text-transform:uppercase;
      padding:6px 10px; border-radius:999px; border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.55));
      color:var(--ink); box-shadow:0 12px 24px rgba(20,25,40,0.16);
    }
    .poster[data-theme="nocturne"] .chip {
      background:linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.06));
      color:var(--ink);
    }

    .hero { margin: 6px 0 16px; }
    .kicker { color:var(--muted); text-transform:uppercase; letter-spacing:.22em; font-size:10px; font-weight:800; margin:0 0 8px; }
    .title {
      margin:0;
      font-size: clamp(48px, 9.6vw, 132px);
      line-height:.86; font-weight:1000; letter-spacing:-0.03em;
      background: conic-gradient(from 120deg, var(--c1), var(--c2), var(--c4), var(--c3), var(--c1));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      filter: drop-shadow(0 14px 28px rgba(20,25,40,0.20));
    }
    .tag { margin:8px 0 0; max-width:72ch; font-size:clamp(14px, 2.2vw, 18px); color:var(--muted); }

    .stage {
      position:relative;
      min-height: clamp(540px, 66vh, 960px);
      border-radius: 24px;
      border:1px solid var(--line);
      overflow:hidden;
      transform-style: preserve-3d;
      transition: transform 220ms ease, box-shadow 220ms ease;
      background:
        radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,0.55), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.45), rgba(255,255,255,0.24));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.78), 0 26px 70px rgba(20,25,40,0.18);
    }
    .poster[data-theme="nocturne"] .stage,
    .poster[data-theme="mono"] .stage {
      background:
        radial-gradient(120% 100% at 50% -10%, rgba(255,255,255,0.12), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.06));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.25), 0 28px 80px rgba(0,0,0,0.45);
    }

    canvas.flow { position:absolute; inset:0; display:block; width:100%; height:100%; }
    .grain {
      position:absolute; inset:0; pointer-events:none; opacity:.12; mix-blend-mode: overlay;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140" viewBox="0 0 140 140"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.35"/></svg>');
      background-size: 280px 280px;
      animation: gr 12s steps(2) infinite;
    }
    @keyframes gr { to { transform: translate3d(12px, -8px, 0); } }

    .orb {
      position:absolute; width: 18px; height: 18px; border-radius:50%;
      left:0; top:0; transform: translate(-200px,-200px);
      background: radial-gradient(circle at 35% 35%, #fff, #fff0 60%);
      box-shadow: 0 0 26px var(--c1), 0 0 10px var(--c2);
      pointer-events:none; mix-blend-mode: screen; opacity:0;
      transition: width 160ms ease, height 160ms ease, opacity 160ms ease;
    }

    .controls {
      margin-top: 16px;
      display:flex; flex-wrap:wrap; align-items:center; gap:10px;
      padding:10px; border-radius:16px; border:1px solid var(--line);
      background:linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.60));
      backdrop-filter: blur(10px) saturate(1.05);
      box-shadow:0 16px 40px rgba(20,25,40,0.16);
    }
    .poster[data-theme="nocturne"] .controls,
    .poster[data-theme="mono"] .controls {
      background:linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.06));
    }

    .btn, .pill {
      appearance:none; cursor:pointer; user-select:none;
      border:1px solid var(--line); border-radius: 999px; color:var(--ink);
      background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.55));
      padding:8px 12px; font-size:13px; white-space:nowrap;
      transition: transform 140ms ease, background 140ms ease, color 140ms ease, box-shadow 140ms ease;
      box-shadow:0 10px 22px rgba(20,25,40,0.14);
    }
    .btn:hover, .pill:hover { transform: translateY(-2px); background:linear-gradient(180deg, #fff, rgba(255,255,255,0.65)); }
    .btn:focus-visible, .pill:focus-visible { outline:2px solid var(--c1); outline-offset:2px; }

    .slider {
      appearance:none; width: clamp(140px, 24vw, 260px); height:28px; border-radius:999px;
      border:1px solid var(--line);
      background:linear-gradient(90deg, rgba(10,18,40,0.08), rgba(10,18,40,0.02));
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.65);
    }
    .slider::-webkit-slider-thumb {
      appearance:none; width:20px; height:20px; border-radius:50%;
      background:linear-gradient(180deg, #fff, #e9eef3); border:2px solid rgba(10,18,40,0.18); box-shadow:0 2px 12px rgba(20,25,40,0.18); cursor:pointer;
    }
    .slider::-moz-range-thumb {
      width:20px; height:20px; border-radius:50%;
      background:linear-gradient(180deg, #fff, #e9eef3); border:2px solid rgba(10,18,40,0.18); box-shadow:0 2px 12px rgba(20,25,40,0.18); cursor:pointer;
    }

    .themes { display:inline-flex; gap:8px; margin-left:auto; }
    .swatch {
      width:28px; height:28px; border-radius:50%; border:1px solid var(--line);
      box-shadow:0 10px 22px rgba(20,25,40,0.18); cursor:pointer; transition: transform 140ms ease;
    }
    .swatch:hover { transform: translateY(-2px) rotate(-4deg); }
    .swatch[data-theme="aurora"] { background: conic-gradient(var(--c1), var(--c2), var(--c4), var(--c3), var(--c1)); }
    .swatch[data-theme="nocturne"] { background: conic-gradient(#8aa0ff, #64ffd6, #ffd37a, #b6c7ff, #8aa0ff); }
    .swatch[data-theme="bloom"] { background: conic-gradient(#ff9bd0, #ffa98a, #ffd97a, #a8ffcf, #ff9bd0); }
    .swatch[data-theme="mono"] { background: conic-gradient(#88aaff, #7796ee, #9bb7ff, #7796ee, #88aaff); }

    .meta { display:flex; flex-wrap:wrap; align-items:center; gap:12px; margin-top:10px; font-size:12px; color:var(--muted); }
    .meta .sep { opacity:.5; }
  </style>

  <div class="mast">
    <div class="badge">
      <div class="mark" aria-hidden="true"></div>
      Studio Radiant
    </div>
    <div class="chip" aria-hidden="true">Aether Poster</div>
  </div>

  <div class="hero">
    <p class="kicker">KINETIC BLOOM</p>
    <h1 class="title">AETHER</h1>
    <p class="tag">A living poster: petals breathe, colors drift, and light responds to your touch. Click to bloom, S to save.</p>
  </div>

  <div class="stage" aria-label="Aether Field">
    <canvas class="flow" aria-hidden="true"></canvas>
    <div class="grain" aria-hidden="true"></div>
    <div class="orb" aria-hidden="true"></div>
  </div>

  <div class="controls" role="group" aria-label="Controls">
    <button type="button" class="btn play" aria-pressed="false" title="Pause/Resume">Pause</button>

    <label class="pill" style="padding:0 10px; display:inline-flex; align-items:center; gap:8px;">
      <span style="opacity:.8; font-size:12px;">Morph</span>
      <input class="slider speed" type="range" min="0.2" max="2.0" step="0.1" value="1.0" aria-label="Morph speed">
    </label>

    <label class="pill" style="padding:0 10px; display:inline-flex; align-items:center; gap:8px;">
      <span style="opacity:.8; font-size:12px;">Glow</span>
      <input class="slider glow" type="range" min="0.4" max="2.0" step="0.1" value="1.1" aria-label="Glow intensity">
    </label>

    <label class="pill" style="padding:0 10px; display:inline-flex; align-items:center; gap:8px;">
      <span style="opacity:.8; font-size:12px;">Petals</span>
      <input class="slider petals" type="range" min="6" max="30" step="1" value="14" aria-label="Petal count">
    </label>

    <button type="button" class="btn pulse" title="Bloom">Bloom</button>
    <button type="button" class="btn shuffle" title="Shuffle seed">Shuffle</button>
    <button type="button" class="btn snap" title="Save image">Capture</button>

    <div class="themes" role="group" aria-label="Theme">
      <button class="swatch" type="button" data-theme="aurora" title="Aurora"></button>
      <button class="swatch" type="button" data-theme="nocturne" title="Nocturne"></button>
      <button class="swatch" type="button" data-theme="bloom" title="Bloom"></button>
      <button class="swatch" type="button" data-theme="mono" title="Mono"></button>
    </div>
  </div>

  <div class="meta" aria-label="Meta">
    <span id="last-updated">Last updated: 2025-11-03 10:19:02 EST</span>
    <span class="sep">•</span>
    <span class="hint">Move: tilt • Click: bloom • Space: pause • S: snapshot • 1–4: theme</span>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.poster');
      const stage = root.querySelector('.stage');
      const canvas = root.querySelector('canvas.flow');
      const ctx = canvas.getContext('2d', { alpha: true });
      const playBtn = root.querySelector('.play');
      const speedInput = root.querySelector('.speed');
      const glowInput = root.querySelector('.glow');
      const petalsInput = root.querySelector('.petals');
      const pulseBtn = root.querySelector('.pulse');
      const shuffleBtn = root.querySelector('.shuffle');
      const snapBtn = root.querySelector('.snap');
      const themeBtns = root.querySelectorAll('.swatch');
      const orb = root.querySelector('.orb');

      // Last updated
      const stamp = root.querySelector('#last-updated');
      try {
        const now = new Date();
        const fmt = new Intl.DateTimeFormat([], {
          year:'numeric', month:'short', day:'2-digit',
          hour:'2-digit', minute:'2-digit', second:'2-digit',
          hour12:true, timeZoneName:'short'
        });
        stamp.textContent = 'Updated ' + fmt.format(now);
      } catch { stamp.textContent = 'Updated ' + new Date().toLocaleString(); }

      // Theme persistence
      const savedTheme = localStorage.getItem('aether-theme');
      if (savedTheme) root.setAttribute('data-theme', savedTheme);
      themeBtns.forEach(b => b.addEventListener('click', ()=>{
        const t = b.getAttribute('data-theme');
        root.setAttribute('data-theme', t);
        localStorage.setItem('aether-theme', t);
        resize();
        seed();
      }));

      // Palettes
      function palette(){
        const t = root.getAttribute('data-theme') || 'aurora';
        if (t === 'nocturne') return ['#8aa0ff','#64ffd6','#ffd37a','#b6c7ff','#9bb6ff'];
        if (t === 'bloom') return ['#ff9bd0','#ffa98a','#ffd97a','#a8ffcf','#ffc4e7'];
        if (t === 'mono') return ['#88aaff','#7796ee','#9bb7ff','#88aaff','#6f8fe0'];
        return ['#89d6ff','#ffb8a1','#9cffd2','#ffe78a','#a7ebff'];
      }

      // DPI + sizing
      const DPR = Math.min(2, window.devicePixelRatio || 1);
      let W=0, H=0, CX=0, CY=0, R=0;
      function resize(){
        const r = stage.getBoundingClientRect();
        W = Math.max(1, Math.floor(r.width));
        H = Math.max(1, Math.floor(r.height));
        CX = W/2; CY = H/2; R = Math.min(W,H)*0.42;
        canvas.width = Math.floor(W * DPR);
        canvas.height = Math.floor(H * DPR);
        canvas.style.width = W + 'px';
        canvas.style.height = H + 'px';
        ctx.setTransform(DPR,0,0,DPR,0,0);
        drawBackground(true);
      }
      const ro = new ResizeObserver(resize);
      ro.observe(stage);
      window.addEventListener('orientationchange', ()=> setTimeout(resize, 120));

      // State
      let speed = parseFloat(localStorage.getItem('aether-speed') ?? '1.0');
      let glow = parseFloat(localStorage.getItem('aether-glow') ?? '1.1');
      let petals = parseInt(localStorage.getItem('aether-petals') ?? '14', 10);

      speedInput.value = String(speed);
      glowInput.value = String(glow);
      petalsInput.value = String(petals);

      speedInput.addEventListener('input', e => {
        speed = parseFloat(e.target.value || '1');
        localStorage.setItem('aether-speed', String(speed));
      });
      glowInput.addEventListener('input', e => {
        glow = parseFloat(e.target.value || '1');
        localStorage.setItem('aether-glow', String(glow));
      });
      petalsInput.addEventListener('input', e => {
        petals = parseInt(e.target.value || '14', 10);
        localStorage.setItem('aether-petals', String(petals));
        seed();
      });

      // Seed parameters
      let PHI=0, SPREAD=0.42, TWIST=1.18, AMP=0.26, FREQ=1.8;
      function randomIn(a,b){ return a + Math.random()*(b-a); }
      function seed(){
        PHI = randomIn(0, Math.PI*2);
        SPREAD = randomIn(0.34, 0.58);
        TWIST = randomIn(0.9, 1.4);
        AMP = randomIn(0.22, 0.34);
        FREQ = randomIn(1.2, 2.4);
        drawBackground(true);
      }
      shuffleBtn.addEventListener('click', seed);

      // Pulses
      let pulses = [];
      function addPulse(x, y){
        pulses.push({ x, y, r: Math.min(W,H)*0.02, life: 1.0 });
        popCursor();
      }

      // Controls
      let paused = matchMedia('(prefers-reduced-motion: reduce)').matches;
      function setPaused(p){
        paused = p;
        playBtn.setAttribute('aria-pressed', String(p));
        playBtn.textContent = p ? 'Resume' : 'Pause';
      }
      playBtn.addEventListener('click', ()=> setPaused(!paused));
      setPaused(paused);

      function snapshot(){
        try {
          const link = document.createElement('a');
          link.download = 'aether-poster.png';
          link.href = canvas.toDataURL('image/png');
          link.click();
        } catch {}
      }
      snapBtn.addEventListener('click', snapshot);
      pulseBtn.addEventListener('click', ()=> addPulse(CX, CY));

      // Pointer/tilt
      const pointer = { x:0.5, y:0.5, inside:false, px:CX, py:CY };
      function setPointer(eX, eY){
        const r = stage.getBoundingClientRect();
        const x = eX - r.left, y = eY - r.top;
        pointer.x = x / r.width;
        pointer.y = y / r.height;
        pointer.px = x; pointer.py = y;
        pointer.inside = true;
        orb.style.transform = `translate(${x - 9}px, ${y - 9}px)`;
      }
      function popCursor(){
        orb.style.width = '24px';
        orb.style.height = '24px';
        orb.style.opacity = '1';
        setTimeout(()=>{ orb.style.width = '18px'; orb.style.height = '18px'; orb.style.opacity = pointer.inside ? '0.85' : '0.0'; }, 180);
      }
      stage.addEventListener('mousemove', e => setPointer(e.clientX, e.clientY));
      stage.addEventListener('mouseenter', e => { setPointer(e.clientX, e.clientY); orb.style.opacity='0.85'; });
      stage.addEventListener('mouseleave', ()=> { pointer.inside = false; orb.style.opacity='0'; });
      stage.addEventListener('click', e => {
        const r = stage.getBoundingClientRect();
        addPulse(e.clientX - r.left, e.clientY - r.top);
      });

      // Keyboard
      root.tabIndex = 0;
      root.addEventListener('keydown', (e)=>{
        const k = e.key.toLowerCase();
        if (e.code === 'Space'){ e.preventDefault(); setPaused(!paused); }
        if (k === 's'){ snapshot(); }
        if (k === '1'){ themeBtns[0].click(); }
        if (k === '2'){ themeBtns[1].click(); }
        if (k === '3'){ themeBtns[2].click(); }
        if (k === '4'){ themeBtns[3].click(); }
      });

      // Background
      function drawBackground(hard){
        const t = root.getAttribute('data-theme') || 'aurora';
        const g = ctx.createRadialGradient(CX, CY*0.9, 0, CX, CY*0.9, Math.max(W,H)*0.9);
        if (t === 'nocturne'){
          g.addColorStop(0, 'rgba(22,26,52,' + (hard? 1 : 0.16*glow) + ')');
          g.addColorStop(1, 'rgba(9,12,26,' + (hard? 1 : 0.16*glow) + ')');
        } else if (t === 'mono'){
          g.addColorStop(0, 'rgba(240,244,250,' + (hard? 1 : 0.12*glow) + ')');
          g.addColorStop(1, 'rgba(240,244,250,' + (hard? 1 : 0.12*glow) + ')');
        } else {
          g.addColorStop(0, 'rgba(255,255,255,' + (hard? 1 : 0.12*glow) + ')');
          g.addColorStop(1, 'rgba(255,255,255,' + (hard? 1 : 0.12*glow) + ')');
        }
        ctx.globalCompositeOperation = 'source-over';
        ctx.fillStyle = g;
        ctx.fillRect(0,0,W,H);
      }

      // Utils
      function hexToRGBA(hex, a){
        let h = hex.replace('#','');
        if (h.length === 3) h = h.split('').map(c=>c+c).join('');
        const r = parseInt(h.slice(0,2),16);
        const g = parseInt(h.slice(2,4),16);
        const b = parseInt(h.slice(4,6),16);
        return `rgba(${r},${g},${b},${a})`;
      }

      // Animation
      let t0 = performance.now();
      function tick(now){
        const dt = Math.min(0.05, (now - t0)/1000);
        t0 = now;

        // Tilt
        const nx = (pointer.inside ? (pointer.x - 0.5) : 0) * 2;
        const ny = (pointer.inside ? (pointer.y - 0.5) : 0) * 2;
        stage.style.transform = `perspective(1000px) rotateX(${ny * -6}deg) rotateY(${nx * 10}deg) translateZ(0)`;

        if (!paused){
          drawBackground(false);

          const P = palette();
          const base = R * 0.36;
          const amp = R * AMP;
          const spread = SPREAD;
          const twist = TWIST;
          const freq = FREQ;

          // Center glow
          const cg = ctx.createRadialGradient(CX, CY, 0, CX, CY, base*1.2);
          cg.addColorStop(0, hexToRGBA('#ffffff', 0.25*glow));
          cg.addColorStop(1, hexToRGBA('#ffffff', 0.0));
          ctx.globalCompositeOperation = 'lighter';
          ctx.fillStyle = cg; ctx.beginPath(); ctx.arc(CX, CY, base*1.2, 0, Math.PI*2); ctx.fill();

          // Petals
          for (let i=0; i<petals; i++){
            const c = P[i % P.length];
            const a0 = (i/petals) * Math.PI*2;
            const t = (now*0.0006 * speed * 2*Math.PI) + PHI + i*0.08;
            const angle = a0 + Math.sin(t * twist + i*0.12) * 0.25;

            // Tip radius (morphing)
            const tipR = base + Math.sin(t*freq + i*0.9) * amp + (pointer.inside ? (Math.cos(angle - Math.atan2(pointer.py-CY, pointer.px-CX)) * 14) : 0);

            // Control points for petal belly
            const leftA = angle - spread;
            const rightA = angle + spread;
            const ctrlR = tipR * (0.52 + 0.12*Math.sin(t + i));

            const tipX = CX + Math.cos(angle)*tipR;
            const tipY = CY + Math.sin(angle)*tipR;
            const c1x = CX + Math.cos(leftA)*ctrlR;
            const c1y = CY + Math.sin(leftA)*ctrlR;
            const c2x = CX + Math.cos(rightA)*ctrlR;
            const c2y = CY + Math.sin(rightA)*ctrlR;

            // Glow shadow
            ctx.save();
            ctx.shadowColor = hexToRGBA(c, 0.35*glow);
            ctx.shadowBlur = 24*glow;

            // Fill gradient from center to tip
            const g = ctx.createRadialGradient(CX, CY, 0, CX, CY, tipR);
            g.addColorStop(0.0, hexToRGBA(c, 0.06*glow));
            g.addColorStop(0.55, hexToRGBA(c, 0.22*glow));
            g.addColorStop(1.0, hexToRGBA(c, 0.0));
            ctx.globalCompositeOperation = 'lighter';
            ctx.fillStyle = g;

            ctx.beginPath();
            ctx.moveTo(CX, CY);
            ctx.quadraticCurveTo(c1x, c1y, tipX, tipY);
            ctx.quadraticCurveTo(c2x, c2y, CX, CY);
            ctx.closePath();
            ctx.fill();

            ctx.restore();

            // Pollen at tip
            const dotR = 2 + (i%3===0 ? 1.2 : 0);
            const pg = ctx.createRadialGradient(tipX, tipY, 0, tipX, tipY, 18*glow);
            pg.addColorStop(0, hexToRGBA(c, 0.88));
            pg.addColorStop(1, hexToRGBA(c, 0.0));
            ctx.fillStyle = pg;
            ctx.beginPath(); ctx.arc(tipX, tipY, 18*glow, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = 'rgba(255,255,255,0.95)';
            ctx.beginPath(); ctx.arc(tipX, tipY, dotR, 0, Math.PI*2); ctx.fill();
          }

          // Subtle halo ring
          ctx.globalCompositeOperation = 'lighter';
          ctx.lineWidth = 1.6;
          ctx.strokeStyle = hexToRGBA(P[0], 0.22*glow);
          ctx.beginPath(); ctx.arc(CX, CY, base*0.92, 0, Math.PI*2); ctx.stroke();

          // Pulses overlay
          for (let i=pulses.length-1; i>=0; i--){
            const p = pulses[i];
            p.r += (140 * dt) * (0.8 + glow*0.4);
            p.life -= dt*0.5;
            const gg = ctx.createRadialGradient(p.x, p.y, p.r*0.6, p.x, p.y, p.r);
            gg.addColorStop(0, 'rgba(255,255,255,0)');
            gg.addColorStop(1, hexToRGBA(P[i % P.length], 0.16 * Math.max(0,p.life)));
            ctx.fillStyle = gg;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill();
            if (p.life <= 0) pulses.splice(i,1);
          }
        }

        requestAnimationFrame(tick);
      }

      // Init
      resize();
      seed();
      requestAnimationFrame(tick);

      // Reduced motion: still composition
      if (matchMedia('(prefers-reduced-motion: reduce)').matches){
        setPaused(true);
        drawBackground(true);
        const P = palette();
        const base = R * 0.36;
        for (let i=0; i<petals; i++){
          const angle = (i/petals) * Math.PI*2;
          const tipR = base * (1.0 + (i%3)*0.03);
          const tipX = CX + Math.cos(angle)*tipR;
          const tipY = CY + Math.sin(angle)*tipR;
          const c = P[i % P.length];
          const g = ctx.createRadialGradient(CX, CY, 0, CX, CY, tipR);
          g.addColorStop(0.2, hexToRGBA(c, 0.18));
          g.addColorStop(1.0, hexToRGBA(c, 0.0));
          ctx.fillStyle = g;
          ctx.beginPath(); ctx.moveTo(CX, CY); ctx.lineTo(tipX, tipY); ctx.arc(CX, CY, tipR, angle, angle + 0.08, false); ctx.closePath(); ctx.fill();
        }
      }
    })();
  </script>
</section>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


