<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<style>
/* Scoped to this snippet only — Iteration 779: KINETIK POSTER FOUNDRY */
.kinetik {
  --ink: #0e0f15;
  --muted: #5a6075;
  --edge: rgba(14,15,21,0.12);
  --bg-1: #f9fbff;
  --bg-2: #edf2ff;
  --p1: #7c3aed; /* violet */
  --p2: #22d3ee; /* lagoon */
  --p3: #84cc16; /* lime */
  --mx: 50%;
  --my: 50%;
  --depth: 18;        /* tilt intensity */
  --spin: 26s;        /* swirl duration */
  position: relative;
  border-radius: 30px;
  overflow: hidden;
  color: var(--ink);
  font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, system-ui;
  background:
    radial-gradient(1000px 700px at var(--mx) var(--my), color-mix(in oklab, var(--p2) 20%, transparent), transparent 60%),
    linear-gradient(180deg, var(--bg-1), var(--bg-2));
  box-shadow: 0 50px 140px rgba(16,24,40,0.18);
  isolation: isolate;
}

/* Night theme */
.kinetik[data-theme="night"] {
  --ink: #e8edff;
  --muted: #9aa3be;
  --edge: rgba(232,237,255,0.14);
  --bg-1: #080a12;
  --bg-2: #0f1422;
  box-shadow: 0 50px 160px rgba(4,8,18,0.7);
  background:
    radial-gradient(900px 700px at var(--mx) var(--my), color-mix(in oklab, var(--p1) 18%, transparent), transparent 60%),
    linear-gradient(180deg, var(--bg-1), var(--bg-2));
}

/* soft grain + film */
.kinetik::before {
  content: "";
  position: absolute; inset: 0;
  background:
    repeating-linear-gradient(0deg, rgba(255,255,255,0.06) 0 1px, transparent 1px 32px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.06) 0 1px, transparent 1px 32px);
  mix-blend-mode: overlay;
  pointer-events: none;
  opacity: .28;
  z-index: 0;
}

/* header */
.kinetik .bar {
  position: relative;
  display: flex; align-items: center; justify-content: space-between; gap: 12px;
  padding: 16px 18px;
  border-bottom: 1px solid var(--edge);
  background: linear-gradient(to bottom, rgba(255,255,255,0.70), rgba(255,255,255,0));
  backdrop-filter: blur(10px);
  z-index: 2;
}
.kinetik[data-theme="night"] .bar { background: linear-gradient(to bottom, rgba(255,255,255,0.08), rgba(255,255,255,0)); }
.kinetik .brand { display:flex; align-items:center; gap: 12px; }
.kinetik .logo {
  width: 28px; height: 28px; border-radius: 10px; position: relative; overflow: hidden;
  background: conic-gradient(from 0deg, var(--p1), var(--p2), var(--p3), var(--p1));
  filter: saturate(120%) contrast(105%);
  box-shadow: 0 12px 34px rgba(0,0,0,0.18), inset 0 1px 1px rgba(255,255,255,0.5);
  animation: logo-spin 16s linear infinite;
}
@keyframes logo-spin { to { transform: rotate(360deg); } }
.kinetik .name { font-weight: 800; letter-spacing: .4px; font-size: 13px; opacity: .95; }

.kinetik .ctrls { display:flex; align-items:center; gap: 10px; flex-wrap: wrap; }
.kinetik .btn {
  appearance: none; border: 1px solid var(--edge);
  background: linear-gradient(135deg, rgba(124,58,237,0.10), rgba(34,211,238,0.10));
  color: var(--ink);
  padding: 8px 12px; border-radius: 999px; font-size: 12px; cursor:pointer;
  transition: transform .15s ease, box-shadow .25s ease, background .2s ease;
  box-shadow: 0 12px 30px rgba(0,0,0,0.14);
}
.kinetik[data-theme="night"] .btn { background: rgba(255,255,255,0.06); }
.kinetik .btn:hover { transform: translateY(-1px); box-shadow: 0 18px 44px rgba(0,0,0,0.22); }
.kinetik .btn[aria-pressed="true"] { outline: 2px solid var(--p2); outline-offset: 2px; }

.kinetik .knob {
  -webkit-appearance:none; appearance:none;
  width: 140px; height: 10px; border-radius: 999px;
  background: linear-gradient(90deg, var(--p1), var(--p3));
  border: 1px solid var(--edge);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08), 0 12px 30px rgba(0,0,0,0.14);
}
.kinetik .knob::-webkit-slider-thumb,
.kinetik .knob::-moz-range-thumb {
  -webkit-appearance: none; appearance: none;
  width: 18px; height: 18px; border-radius: 50%;
  background: #fff; border: 2px solid rgba(0,0,0,0.06);
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  cursor: grab;
}

/* layout */
.kinetik .stage {
  display: grid;
  grid-template-columns: 1.15fr .85fr;
  gap: 24px;
  padding: 22px;
  min-height: 500px;
  z-index: 1;
}
@media (max-width: 980px) { .kinetik .stage { grid-template-columns: 1fr; } }

/* Poster */
.kinetik .poster {
  position: relative;
  border: 1px solid var(--edge);
  border-radius: 22px;
  background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.5));
  backdrop-filter: blur(6px);
  box-shadow: 0 26px 70px rgba(0,0,0,0.16);
  overflow: hidden;
  display: grid; place-items:center;
  min-height: 420px;
}
.kinetik[data-theme="night"] .poster { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); box-shadow: 0 30px 90px rgba(0,0,0,0.35); }

.kinetik .canvas {
  position: relative;
  width: min(720px, 100%);
  aspect-ratio: 16 / 9;
  border-radius: 20px;
  border: 1px solid var(--edge);
  overflow: hidden;
  transform-style: preserve-3d;
  will-change: transform, filter;
  box-shadow: 0 50px 120px rgba(0,0,0,0.18), inset 0 1px 0 rgba(255,255,255,0.4);
  background:
    radial-gradient(160% 120% at var(--mx) var(--my), color-mix(in oklab, var(--p2) 22%, transparent), transparent 60%),
    conic-gradient(from 210deg, color-mix(in oklab, var(--p1) 30%, transparent) 0 25%, transparent 25% 50%, color-mix(in oklab, var(--p3) 20%, transparent) 50% 75%, transparent 75% 100%);
}

/* Layers */
.kinetik .layer.glow {
  position:absolute; inset: -40%;
  background: radial-gradient(closest-corner at var(--mx) var(--my), color-mix(in oklab, var(--p3) 22%, transparent), transparent 70%);
  mix-blend-mode: screen; filter: blur(20px); opacity: .5;
  transform: translateZ(60px);
}
.kinetik .layer.swirl {
  position:absolute; inset:-10%;
  background: conic-gradient(from 0deg, color-mix(in oklab, var(--p1) 35%, transparent), transparent, color-mix(in oklab, var(--p2) 35%, transparent), transparent, color-mix(in oklab, var(--p3) 35%, transparent));
  filter: blur(20px) saturate(110%);
  animation: swirl var(--spin) linear infinite;
  opacity: .55;
  transform: translateZ(30px);
}
@keyframes swirl { to { transform: translateZ(30px) rotate(360deg); } }

.kinetik .layer.grid {
  position: absolute; inset: 0;
  background:
    repeating-linear-gradient(0deg, rgba(255,255,255,0.08) 0 1px, transparent 1px 32px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.08) 0 1px, transparent 1px 32px);
  mix-blend-mode: overlay; opacity: .35;
  transform: translateZ(40px);
}

/* moving stripe */
.kinetik .stripe {
  position: absolute;
  --angle: 18deg;
  inset: -20% -40%;
  background: linear-gradient(var(--angle), color-mix(in oklab, var(--p1) 40%, transparent), color-mix(in oklab, var(--p2) 50%, transparent) 45%, color-mix(in oklab, var(--p3) 40%, transparent));
  mask: linear-gradient(90deg, transparent 0 8%, #000 12% 88%, transparent 92% 100%);
  animation: sweep 14s ease-in-out infinite alternate;
  transform: translateZ(50px);
}
@keyframes sweep { 0% { transform: translateZ(50px) translateX(-8%); } 100% { transform: translateZ(50px) translateX(8%); } }

/* Floaters */
.kinetik .shape {
  position: absolute; border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,0)), var(--grad);
  box-shadow: 0 10px 40px color-mix(in oklab, var(--col) 40%, transparent);
  width: var(--sz); height: var(--sz);
  left: calc(var(--x)*1%); top: calc(var(--y)*1%);
  transform: translate(-50%, -50%) translateZ(var(--z, 70px));
  filter: saturate(120%);
  animation: float var(--dur) ease-in-out infinite;
}
@keyframes float {
  0%,100% { transform: translate(-50%, -50%) translateZ(var(--z, 70px)) translateY(-4px); }
  50% { transform: translate(-50%, -50%) translateZ(var(--z, 70px)) translateY(6px); }
}

/* Title */
.kinetik .title {
  position: absolute; left: 24px; bottom: 64px; right: 24px;
  transform: translateZ(90px);
}
.kinetik .title .k1 {
  display:block;
  font-family: ui-serif, Georgia, serif;
  font-weight: 800; letter-spacing: -0.02em;
  font-size: clamp(34px, 6.4vw, 88px);
  line-height: .9;
  background: linear-gradient(120deg, var(--ink), var(--p1), var(--p2));
  -webkit-background-clip: text; background-clip: text; color: transparent;
  filter: drop-shadow(0 14px 40px color-mix(in oklab, var(--p1) 30%, transparent));
  animation: chroma 10s ease-in-out infinite alternate;
}
.kinetik .title .k2 {
  display:block; margin-top: 6px;
  font-size: clamp(14px, 1.6vw, 18px);
  letter-spacing: .2em; text-transform: uppercase;
  color: var(--muted);
}
@keyframes chroma { 0% { background-position: 0% 50%; } 100% { background-position: 120% 50%; } }

/* Ticker */
.kinetik .ticker {
  position: absolute; left:0; right:0; bottom:0;
  background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,0.06)), rgba(255,255,255,0.4);
  color: var(--ink);
  border-top: 1px solid var(--edge);
  backdrop-filter: blur(4px);
  overflow: hidden;
  transform: translateZ(110px);
}
.kinetik[data-theme="night"] .ticker { background: linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,0.06)), rgba(255,255,255,0.06); }
.kinetik .marquee {
  display: inline-block; white-space: nowrap;
  padding: 8px 0;
  animation: marquee 18s linear infinite;
}
@keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

/* Side panel */
.kinetik .panel {
  position: relative;
  border: 1px solid var(--edge);
  border-radius: 22px;
  background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.5));
  box-shadow: 0 26px 70px rgba(0,0,0,0.16);
  padding: 24px;
}
.kinetik[data-theme="night"] .panel { background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)); box-shadow: 0 30px 90px rgba(0,0,0,0.35); }
.kinetik .kicker {
  display:inline-block; font-size: 11px; letter-spacing: .28em; text-transform: uppercase;
  background: linear-gradient(90deg, var(--p1), var(--p2));
  -webkit-background-clip: text; background-clip: text; color: transparent;
}
.kinetik h2 {
  margin: 10px 0 8px;
  font-family: ui-serif, Georgia, "Times New Roman", serif;
  line-height: 1; letter-spacing: -0.01em;
  font-size: clamp(22px, 2.6vw, 34px);
  color: var(--ink);
}
.kinetik .sub { color: var(--muted); font-size: 14px; line-height: 1.7; }
.kinetik .list { margin-top: 14px; display:grid; gap: 10px; }
.kinetik .li {
  display:flex; gap: 10px; align-items:flex-start; color: var(--muted); font-size: 13px;
  border: 1px solid var(--edge); border-radius: 14px; padding: 10px 12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.8), rgba(255,255,255,0.45));
}
.kinetik[data-theme="night"] .li { background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); }
.kinetik .dot {
  width: 16px; height: 16px; border-radius: 6px;
  background: linear-gradient(135deg, var(--p1), var(--p3));
  box-shadow: inset 0 1px 1px rgba(255,255,255,0.8);
  flex: 0 0 auto; margin-top: 2px;
}
.kinetik .panel .cta-row { display:flex; flex-wrap:wrap; gap: 10px; margin-top: 16px; }
.kinetik .panel .cta {
  border: 1px solid var(--edge); border-radius: 999px;
  padding: 10px 14px; font-size: 13px;
  background: linear-gradient(135deg, color-mix(in oklab, var(--p2) 20%, transparent), color-mix(in oklab, var(--p3) 14%, transparent));
  color: var(--ink); cursor:pointer;
  box-shadow: 0 16px 40px rgba(0,0,0,0.18);
  transition: transform .15s ease, box-shadow .25s ease, background .2s ease;
}
.kinetik[data-theme="night"] .panel .cta { background: rgba(255,255,255,0.06); }
.kinetik .panel .cta:hover { transform: translateY(-1px); box-shadow: 0 22px 60px rgba(0,0,0,0.26); }

/* spark on click */
.kinetik .spark {
  position: absolute; width: 14px; height: 14px; border-radius: 50%;
  pointer-events: none; z-index: 5;
  left: var(--x); top: var(--y);
  background: radial-gradient(circle, rgba(255,255,255,0.95), rgba(255,255,255,0) 70%);
  box-shadow: 0 0 20px color-mix(in oklab, var(--p2) 60%, transparent);
  transform: translate(-50%, -50%) scale(1);
  animation: spark 900ms ease-out forwards;
  mix-blend-mode: screen;
}
@keyframes spark { to { transform: translate(-50%, -50%) scale(12); opacity: 0; } }

/* accessibility */
@media (prefers-reduced-motion: reduce) {
  .kinetik * { animation: none !important; transition: none !important; }
}
</style>

<div class="kinetik" data-theme="day" role="region" aria-label="Kinetic Poster Foundry 779">
  <div class="bar">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div class="name">Kinetik Foundry — 779</div>
    </div>
    <div class="ctrls" aria-label="Controls">
      <button class="btn" data-action="theme" aria-pressed="false" title="Toggle theme">Light</button>
      <button class="btn" data-action="palette" aria-pressed="false" title="Cycle palette">Palette</button>
      <button class="btn" data-action="weave" title="Re-weave layout">Weave</button>
      <input class="knob" type="range" min="8" max="36" step="1" value="18" aria-label="Depth">
      <button class="btn" data-action="snapshot" title="Generate snapshot">Snapshot</button>
    </div>
  </div>

  <div class="stage">
    <section class="poster" aria-label="Kinetic canvas">
      <div class="canvas">
        <div class="layer glow" aria-hidden="true"></div>
        <div class="layer swirl" aria-hidden="true"></div>
        <div class="layer grid" aria-hidden="true"></div>
        <div class="stripe" aria-hidden="true"></div>

        <div class="shape" style="--x:18; --y:34; --sz:120px; --z:80px; --grad:linear-gradient(135deg, var(--p1), var(--p2)); --col: var(--p1); --dur: 8s;"></div>
        <div class="shape" style="--x:78; --y:24; --sz:84px; --z:60px; --grad:linear-gradient(135deg, var(--p2), var(--p3)); --col: var(--p2); --dur: 10s;"></div>
        <div class="shape" style="--x:62; --y:70; --sz:66px; --z:70px; --grad:linear-gradient(135deg, var(--p3), var(--p1)); --col: var(--p3); --dur: 12s;"></div>

        <div class="title">
          <span class="k1">Design motion.</span>
          <span class="k2">Type, light, and rhythm — in your hands.</span>
        </div>

        <div class="ticker" aria-hidden="true">
          <div class="marquee">
            Make light move • Make type breathe • Design for delight • Make light move • Make type breathe • Design for delight •
          </div>
        </div>
      </div>
    </section>

    <aside class="panel">
      <span class="kicker">Instruments for vivid clarity</span>
      <h2>Build kinetic posters in the browser.</h2>
      <p class="sub">Tilt the canvas with your pointer. Shift palettes, re‑weave the layout, and set depth for a tactile sense of space.</p>
      <div class="list" role="list">
        <div class="li" role="listitem">
          <div class="dot" aria-hidden="true"></div>
          <div><strong style="color:var(--ink)">Live tilt</strong><br>3D parallax that follows your cursor—no libraries.</div>
        </div>
        <div class="li" role="listitem">
          <div class="dot" style="background:linear-gradient(135deg, var(--p2), var(--p3))" aria-hidden="true"></div>
          <div><strong style="color:var(--ink)">Palette engine</strong><br>Cycle expressive colorways tuned for contrast.</div>
        </div>
        <div class="li" role="listitem">
          <div class="dot" style="background:linear-gradient(135deg, var(--p3), var(--p1))" aria-hidden="true"></div>
          <div><strong style="color:var(--ink)">Weave</strong><br>Shuffle geometry for fresh compositions.</div>
        </div>
      </div>

      <div class="cta-row">
        <button class="cta" data-action="pulse">Pulse</button>
        <button class="cta" data-action="center">Center Glow</button>
      </div>

      <div style="margin-top:14px; color:var(--muted); font-size:12px; display:flex; justify-content:space-between; gap:10px;">
        <span>“Less noise. More intention.”</span>
        <span id="last-updated">Last updated: 2025-11-21 04:19:10 EST</span>
      </div>
    </aside>
  </div>
</div>

<script>
(function(){
  const root = document.currentScript.previousElementSibling;
  if (!root || !root.classList.contains('kinetik')) return;

  // Prefer system theme
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  root.dataset.theme = prefersDark ? 'night' : 'day';

  // Elements
  const canvas = root.querySelector('.canvas');
  const stripe = root.querySelector('.stripe');
  const shapes = Array.from(root.querySelectorAll('.shape'));
  const themeBtn = root.querySelector('[data-action="theme"]');
  const paletteBtn = root.querySelector('[data-action="palette"]');
  const weaveBtn = root.querySelector('[data-action="weave"]');
  const snapBtn  = root.querySelector('[data-action="snapshot"]');
  const pulseBtn = root.querySelector('[data-action="pulse"]');
  const centerBtn= root.querySelector('[data-action="center"]');
  const depth = root.querySelector('.knob');

  // Last updated
  const lu = root.querySelector('#last-updated');
  try {
    const now = new Date();
    const fmt = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'short' });
    lu.textContent = 'Last updated: ' + fmt.format(now);
  } catch(e) { lu.textContent = 'Last updated: ' + new Date().toLocaleString(); }

  // Theme button label
  function setThemeLabel(){
    themeBtn.textContent = root.dataset.theme === 'night' ? 'Dark' : 'Light';
    themeBtn.setAttribute('aria-pressed', String(root.dataset.theme === 'night'));
  }
  setThemeLabel();

  // Palettes
  const palettes = [
    ['#7c3aed','#22d3ee','#84cc16'], // violet lagoon lime
    ['#2563eb','#f43f5e','#06b6d4'], // azure coral cyan
    ['#f59e0b','#14b8a6','#38bdf8'], // amber teal sky
    ['#ff7aa2','#7dd3fc','#a7f3d0'], // blossom ice mint
    ['#a78bfa','#34d399','#60a5fa']  // velvet mint blue
  ];
  let pIndex = 0;
  function applyPalette([a,b,c]){
    root.style.setProperty('--p1', a);
    root.style.setProperty('--p2', b);
    root.style.setProperty('--p3', c);
    pulse(canvas, 360);
  }

  function pulse(el, duration=420){
    if (!el || !el.animate) return;
    el.animate(
      [{ filter:'saturate(130%) brightness(1.08)' }, { filter:'saturate(100%) brightness(1)' }],
      { duration, easing:'ease' }
    );
  }

  // Tilt + pointer glow
  let rect = null;
  function updateRect(){ rect = canvas.getBoundingClientRect(); }
  updateRect();
  window.addEventListener('resize', updateRect);

  function move(e){
    if (!rect) return;
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const cx = x / rect.width - 0.5;
    const cy = y / rect.height - 0.5;
    const tiltX = (-cy) * (parseFloat(getComputedStyle(root).getPropertyValue('--depth')) || 18);
    const tiltY = (cx) * (parseFloat(getComputedStyle(root).getPropertyValue('--depth')) || 18);
    canvas.style.transform = `rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
    root.style.setProperty('--mx', (x/rect.width*100).toFixed(2) + '%');
    root.style.setProperty('--my', (y/rect.height*100).toFixed(2) + '%');
  }
  function leave(){
    canvas.style.transform = 'rotateX(0deg) rotateY(0deg)';
  }
  canvas.addEventListener('mousemove', move);
  canvas.addEventListener('mouseleave', leave);

  // Spark on click
  canvas.addEventListener('click', (e)=>{
    const r = canvas.getBoundingClientRect();
    const s = document.createElement('span');
    s.className = 'spark';
    s.style.setProperty('--x', (e.clientX - r.left) + 'px');
    s.style.setProperty('--y', (e.clientY - r.top) + 'px');
    canvas.appendChild(s);
    s.addEventListener('animationend', ()=> s.remove());
  });

  // Controls
  themeBtn.addEventListener('click', () => {
    root.dataset.theme = root.dataset.theme === 'night' ? 'day' : 'night';
    setThemeLabel(); pulse(canvas, 420);
  });

  paletteBtn.addEventListener('click', () => {
    pIndex = (pIndex + 1) % palettes.length;
    applyPalette(palettes[pIndex]);
    paletteBtn.setAttribute('aria-pressed', String(pIndex !== 0));
  });

  weaveBtn.addEventListener('click', () => {
    shapes.forEach((el, i) => {
      const x = 10 + Math.random()*80;
      const y = 14 + Math.random()*72;
      const s = 56 + Math.random()*90;
      const z = 50 + Math.random()*60;
      const dur = 8 + Math.random()*6;
      el.style.setProperty('--x', x.toFixed(1));
      el.style.setProperty('--y', y.toFixed(1));
      el.style.setProperty('--sz', s.toFixed(0)+'px');
      el.style.setProperty('--z', z.toFixed(0)+'px');
      el.style.setProperty('--dur', dur.toFixed(1)+'s');
    });
    // stripe angle
    const ang = (Math.random()*50 - 25).toFixed(1) + 'deg';
    stripe.style.setProperty('--angle', ang);
    pulse(canvas, 240);
  });

  depth.addEventListener('input', () => {
    const val = parseFloat(depth.value) || 18;
    root.style.setProperty('--depth', val);
    // map depth to spin speed (subtle)
    const base = 30 - (val - 8) * 0.6; // between ~30 and ~18
    root.style.setProperty('--spin', Math.max(16, base).toFixed(1) + 's');
  });

  pulseBtn.addEventListener('click', () => pulse(root, 420));
  centerBtn.addEventListener('click', () => {
    // center the glow
    const r = canvas.getBoundingClientRect();
    const fake = { clientX: r.left + r.width/2, clientY: r.top + r.height/2 };
    move(fake);
    pulse(canvas, 320);
  });

  snapBtn.addEventListener('click', () => {
    try {
      const p1 = getVar('--p1'), p2 = getVar('--p2'), p3 = getVar('--p3');
      const ink = getVar('--ink');
      const svg = `
        <svg xmlns='http://www.w3.org/2000/svg' width='1280' height='720'>
          <defs>
            <linearGradient id='g1' x1='0' y1='0' x2='1' y2='1'>
              <stop offset='0' stop-color='${p1}'/><stop offset='1' stop-color='${p2}'/>
            </linearGradient>
            <linearGradient id='g2' x1='1' y1='0' x2='0' y2='1'>
              <stop offset='0' stop-color='${p2}'/><stop offset='1' stop-color='${p3}'/>
            </linearGradient>
          </defs>
          <rect width='100%' height='100%' fill='${getVar('--bg-1')}'/>
          <rect x='-200' y='0' width='1800' height='720' transform='rotate(18 640 360)' fill='url(#g1)' opacity='0.45'/>
          <circle cx='260' cy='260' r='120' fill='url(#g2)' opacity='0.9'/>
          <circle cx='980' cy='180' r='84' fill='url(#g1)' opacity='0.9'/>
          <text x='60' y='520' font-family='-apple-system, Segoe UI, Roboto, Arial' font-size='96' font-weight='800' fill='${ink}' opacity='0.95'>Kinetik Poster — 779</text>
          <text x='60' y='560' font-family='-apple-system, Segoe UI, Roboto, Arial' font-size='20' fill='${ink}' opacity='0.7'>Generated in-browser · ${new Date().toLocaleString()}</text>
        </svg>`;
      const dataURL = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svg);
      const w = window.open('', '_blank');
      if (w) w.document.write('<title>Snapshot — Kinetik</title><img alt="Snapshot" style="display:block;max-width:100%;height:auto" src="'+dataURL+'"/>');
    } catch(e) { /* ignore */ }
  });

  // Helpers
  function getVar(n){ return getComputedStyle(root).getPropertyValue(n).trim() || '#000'; }

  // Focus rings
  root.querySelectorAll('button, input[type="range"]').forEach(el => {
    el.addEventListener('focus', () => el.style.outline = `2px solid var(--p2)`);
    el.addEventListener('blur', () => el.style.outline = 'none');
  });

  // Initialize center glow and theme label
  const rr = canvas.getBoundingClientRect();
  move({ clientX: rr.left + rr.width/2, clientY: rr.top + rr.height/2 });
})();
</script>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


