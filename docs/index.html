<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibing</title>
    <style>
      :root {
        --bg: #0f1221;
        --fg: #e6e8f0;
        --muted: #9aa3b2;
        --accent: #8b5cf6;
      }
      html, body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--fg);
        background: radial-gradient(1200px 800px at 70% 10%, #1b1f3a, var(--bg));
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .card {
        width: min(720px, 92vw);
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 28px 24px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        backdrop-filter: blur(6px);
      }
      h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        letter-spacing: 0.3px;
      }
      .muted {
        color: var(--muted);
        font-size: 14px;
        margin-bottom: 18px;
      }
      #content {
        font-size: 18px;
        line-height: 1.6;
        background: rgba(255,255,255,0.04);
        border: 1px dashed rgba(255,255,255,0.12);
        border-radius: 12px;
        padding: 16px;
      }
      .footer {
        margin-top: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 14px;
        color: var(--muted);
      }
      .badge {
        display: inline-block;
        background: rgba(139, 92, 246, 0.18);
        color: #d4c2ff;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        border: 1px solid rgba(139, 92, 246, 0.35);
        letter-spacing: 0.2px;
      }
    </style>
  </head>
  <body>
    <!-- BEGIN_EDITABLE -->
      <section id="content">
<div class="loom-2300" data-theme="night" aria-label="Loom 2300 — Liminal Garden">
  <style>
    .loom-2300 {
      --sans: ui-sans-serif, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Inter, Roboto, "Helvetica Neue", Arial;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;

      /* Night (default) */
      --bg0: #070b12;
      --bg1: #0c1220;
      --ink: #eef2ff;
      --sub: #9aa6c3;
      --line: rgba(255,255,255,.12);
      --glass1: rgba(255,255,255,.05);
      --glass2: rgba(255,255,255,.10);

      --c1: #7dd3fc;
      --c2: #a78bfa;
      --c3: #f472b6;
      --c4: #f59e0b;

      position: relative;
      isolation: isolate;
      min-height: 640px;
      border-radius: 30px;
      overflow: clip;
      color: var(--ink);
      font-family: var(--sans);
      background:
        radial-gradient(1200px 900px at var(--mx,50%) var(--my,50%), rgba(125,211,252,.10), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      box-shadow:
        0 44px 90px rgba(0,0,0,.55),
        inset 0 1px 0 rgba(255,255,255,.05),
        inset 0 -1px 0 rgba(255,255,255,.04);
      container-type: inline-size;
    }
    .loom-2300[data-theme="day"]{
      --bg0: #f7fafc;
      --bg1: #e8eef8;
      --ink: #0b1220;
      --sub: #5b6a86;
      --line: rgba(8,12,26,.14);
      --glass1: rgba(255,255,255,.80);
      --glass2: rgba(255,255,255,.60);
      box-shadow:
        0 34px 72px rgba(9,14,30,.16),
        inset 0 1px 0 rgba(255,255,255,.95),
        inset 0 -1px 0 rgba(0,0,0,.05);
    }
    .loom-2300::before{
      content:"2300";
      position:absolute; inset: auto -6% -16% auto;
      font: 800 clamp(120px, 26cqw, 340px)/.8 var(--mono);
      letter-spacing:-.035em;
      color: transparent;
      -webkit-text-stroke: 1px rgba(255,255,255,.12);
      text-stroke: 1px rgba(255,255,255,.12);
      opacity:.6;
      pointer-events:none;
      mix-blend-mode: overlay;
      transform: rotate(-6deg);
    }
    .loom-2300::after{
      content:"";
      position:absolute; inset:0;
      pointer-events:none;
      background:
        radial-gradient(110% 110% at -10% -10%, rgba(255,255,255,.06), transparent 50%),
        radial-gradient(110% 110% at 110% 110%, rgba(0,0,0,.24), transparent 50%),
        repeating-linear-gradient(90deg, transparent 0 28px, rgba(255,255,255,.025) 28px 29px);
      opacity:.7;
    }

    /* Canvas layer */
    .loom-2300 .weave {
      position:absolute; inset:0; z-index:1; display:block;
      filter: saturate(1.05) contrast(1.04);
    }

    /* UI Layout */
    .loom-2300 .ui {
      position: relative; z-index:2;
      display: grid;
      grid-template-columns: 1.2fr .9fr;
      gap: clamp(16px, 4cqw, 28px);
      padding: clamp(16px, 4cqw, 28px);
    }
    @container (max-width: 900px) {
      .loom-2300 .ui { grid-template-columns: 1fr; }
    }

    /* Top bar */
    .loom-2300 .top {
      grid-column: 1 / -1;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding-bottom:12px; border-bottom:1px dashed var(--line);
    }
    .loom-2300 .brand {
      display:inline-grid; grid-auto-flow: column; align-items:center; gap:10px;
      font-weight: 900; letter-spacing:.2px;
    }
    .loom-2300 .gem {
      width:22px; height:22px; border-radius:8px; display:grid; place-items:center;
      background:
        radial-gradient(circle at 30% 30%, var(--c1), transparent 58%),
        radial-gradient(circle at 68% 70%, var(--c2), transparent 60%),
        radial-gradient(circle at 40% 85%, var(--c3), transparent 60%);
      box-shadow: 0 0 0 6px rgba(125,211,252,.10), 0 12px 22px rgba(0,0,0,.25);
      animation: l300-gem 10s ease-in-out infinite;
    }
    @keyframes l300-gem {
      0%,100%{ transform: rotate(0deg) scale(1); border-radius: 12px 16px 10px 16px / 14px 10px 16px 12px; }
      50%{ transform: rotate(10deg) scale(1.08); border-radius: 18px 12px 18px 12px / 12px 18px 12px 18px; }
    }

    /* Controls */
    .loom-2300 .controls { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .loom-2300 .pill, .loom-2300 .seg button {
      --h: 36px;
      display:inline-grid; place-items:center; grid-auto-flow: column; gap:8px;
      height:var(--h); padding:6px 12px; border-radius:999px;
      border:1px solid var(--line);
      background: linear-gradient(180deg, var(--glass1), var(--glass2));
      color: var(--ink);
      backdrop-filter: blur(6px);
      font-size:13px; cursor:pointer; user-select:none;
      transition: transform .12s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease, color .2s ease;
    }
    .loom-2300 .pill:where(:hover, :focus-visible),
    .loom-2300 .seg button:where(:hover, :focus-visible) {
      transform: translateY(-1px);
      outline: none;
      box-shadow: 0 8px 20px rgba(0,0,0,.18);
    }
    .loom-2300 .theme-dot {
      width:10px; height:10px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--c1), var(--c2));
      box-shadow: 0 0 0 3px rgba(125,211,252,.18);
    }
    .loom-2300 .seg {
      display:inline-grid; grid-auto-flow: column; gap:0;
      border-radius:999px; overflow:hidden; border:1px solid var(--line);
      background: linear-gradient(180deg, var(--glass1), var(--glass2));
      backdrop-filter: blur(6px);
    }
    .loom-2300 .seg button {
      border:0; border-right:1px solid var(--line); border-radius:0; padding:6px 12px;
      background: transparent;
    }
    .loom-2300 .seg button:last-child { border-right:0; }
    .loom-2300 .seg button[aria-pressed="true"]{
      background: linear-gradient(180deg, color-mix(in oklab, var(--c2) 14%, transparent), color-mix(in oklab, var(--c1) 14%, transparent));
      color: var(--ink);
      box-shadow: inset 0 0 0 999px rgba(255,255,255,.02);
    }

    /* Hero copy */
    .loom-2300 .hero {
      display:grid; align-content:start; gap: clamp(10px, 2.6cqw, 18px);
      padding-top: clamp(8px, 2cqw, 12px);
    }
    .loom-2300 .kicker {
      color: var(--sub); font-size: 12px; letter-spacing: .22em; text-transform: uppercase;
    }
    .loom-2300 .title {
      margin:0; font-weight:900; letter-spacing:-0.02em;
      font-size: clamp(40px, 10.2cqw, 96px); line-height:.92;
      background: linear-gradient(90deg, var(--ink), var(--c1), var(--c2), var(--c3), var(--c4));
      -webkit-background-clip:text; background-clip:text; color: transparent;
      animation: l300-sheen 16s ease-in-out infinite;
    }
    @keyframes l300-sheen { 0%,100%{background-position:0% 50%} 50%{background-position:100% 50%} }
    .loom-2300 .lead { margin:0; color: var(--sub); max-width: 62ch; font-size: clamp(14px, 3cqw, 19px); }
    .loom-2300 .swatches { display:flex; gap:8px; flex-wrap:wrap; padding-top:4px; }
    .loom-2300 .sw {
      width:28px; height:28px; border-radius:9px; border:1px solid var(--line);
      cursor:pointer; box-shadow: 0 8px 16px rgba(0,0,0,.18); transition: transform .12s ease;
    }
    .loom-2300 .sw:active { transform: scale(.96); }

    /* Side */
    .loom-2300 .side { display:grid; align-content:start; gap:14px; padding-top: clamp(8px, 2cqw, 12px); }
    .loom-2300 .card {
      border:1px solid var(--line); border-radius: 18px;
      background: linear-gradient(180deg, var(--glass1), var(--glass2));
      backdrop-filter: blur(9px);
      padding: clamp(12px, 3cqw, 18px);
      transition: transform .2s ease;
    }
    .loom-2300 .card:hover { transform: translateY(-2px); }
    .loom-2300 .stats {
      display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;
    }
    .loom-2300 .stat {
      display:grid; place-items:center; gap:6px;
      border: 1px dashed var(--line);
      border-radius: 14px; min-height:74px; text-align:center; padding:8px;
    }
    .loom-2300 .stat .n {
      font-family: var(--mono); font-weight:800;
      font-size: clamp(18px, 4.4cqw, 28px);
      background: linear-gradient(90deg, var(--c1), var(--c2), var(--c3), var(--c4));
      -webkit-background-clip:text; background-clip:text; color: transparent;
      font-variant-numeric: tabular-nums;
    }
    .loom-2300 .stat span:last-child { color: var(--sub); font-size:12px; letter-spacing:.2px; }

    /* Footer */
    .loom-2300 .foot {
      grid-column: 1 / -1;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-top:6px; padding-top:12px; border-top:1px dashed var(--line); color: var(--sub); font-size:12px;
    }
    .loom-2300 .kbd {
      border: 1px solid var(--line);
      padding: 3px 6px; border-radius: 8px;
      background: var(--glass1); color: var(--ink);
      font: inherit; font-size: 11px;
    }

    /* Motion preferences */
    @media (prefers-reduced-motion: reduce) {
      .loom-2300 .gem, .loom-2300 .title { animation: none !important; }
      .loom-2300::before { display:none !important; }
    }
  </style>

  <canvas class="weave" aria-hidden="true"></canvas>

  <div class="ui" role="region" aria-labelledby="l300-title">
    <div class="top">
      <div class="brand">
        <span class="gem" aria-hidden="true"></span>
        Liminal Garden
      </div>
      <div class="controls">
        <button class="pill theme" type="button" aria-label="Toggle theme" aria-pressed="false"><span class="theme-dot" aria-hidden="true"></span><span class="tlabel">Night</span></button>
        <button class="pill play" type="button" aria-label="Toggle motion" aria-pressed="true">Pause</button>
        <div class="seg" role="tablist" aria-label="Modes">
          <button type="button" role="tab" aria-selected="true" aria-pressed="true" data-mode="weave">Weave</button>
          <button type="button" role="tab" aria-selected="false" aria-pressed="false" data-mode="ripple">Ripple</button>
          <button type="button" role="tab" aria-selected="false" aria-pressed="false" data-mode="bloom">Bloom</button>
        </div>
      </div>
    </div>

    <section class="hero">
      <span class="kicker">Edition 2300</span>
      <h1 id="l300-title" class="title">Soft systems, vivid calm</h1>
      <p class="lead">Guide a living canvas. Threads drift, circles echo, petals turn—your pointer is the wind. Try the palettes and modes to reshape the garden.</p>
      <div class="swatches" role="listbox" aria-label="Palettes">
        <button class="sw" role="option" aria-label="Aurora" data-palette="aurora" style="background: linear-gradient(135deg,#7dd3fc,#a78bfa,#f472b6)"></button>
        <button class="sw" role="option" aria-label="Citrus" data-palette="citrus" style="background: linear-gradient(135deg,#f59e0b,#f97316,#84cc16)"></button>
        <button class="sw" role="option" aria-label="Lagoon" data-palette="lagoon" style="background: linear-gradient(135deg,#22d3ee,#34d399,#14b8a6)"></button>
        <button class="sw" role="option" aria-label="Orchid" data-palette="orchid" style="background: linear-gradient(135deg,#c084fc,#e879f9,#60a5fa)"></button>
        <button class="sw" role="option" aria-label="Monet" data-palette="monet" style="background: linear-gradient(135deg,#60a5fa,#93c5fd,#fca5a5)"></button>
      </div>
    </section>

    <aside class="side">
      <div class="card">
        <div class="stats" aria-hidden="true">
          <div class="stat"><span class="n count" data-base="1200">1200</span><span>threads</span></div>
          <div class="stat"><span class="n count" data-base="2300">2300</span><span>edition</span></div>
          <div class="stat"><span class="n fps">—</span><span>fps</span></div>
        </div>
      </div>
      <div class="card">
        <p class="lead" style="margin:0">
          Shortcuts:
          <span class="kbd">T</span> theme •
          <span class="kbd">Space</span> play •
          <span class="kbd">1/2/3</span> modes •
          <span class="kbd">C</span> clear •
          <span class="kbd">P</span> palette
        </p>
      </div>
    </aside>

    <div class="foot">
      <span>Refreshed <span id="last-updated">Last updated: 2026-01-30 17:23:09 EST</span></span>
      <span>Accessible contrast • Pointer-aware • No libraries</span>
    </div>
  </div>

  <script>
    (function(){
      const root = document.currentScript.closest('.loom-2300');
      const canvas = root.querySelector('.weave');
      const ctx = canvas.getContext('2d', { alpha: true });
      const themeBtn = root.querySelector('.theme');
      const themeLabel = root.querySelector('.tlabel');
      const playBtn = root.querySelector('.play');
      const modeBtns = root.querySelectorAll('[data-mode]');
      const fpsEl = root.querySelector('.fps');
      const last = root.querySelector('#last-updated');
      const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      // Timestamp
      try {
        const now = new Date();
        last.textContent = now.toLocaleString([], {
          year: 'numeric', month: 'short', day: '2-digit',
          hour: '2-digit', minute: '2-digit', second: '2-digit'
        });
      } catch(_) {}

      // Sizing
      function size(){
        const dpr = Math.min(2, window.devicePixelRatio || 1);
        const rect = root.getBoundingClientRect();
        canvas.width = Math.max(1, Math.floor(rect.width * dpr));
        canvas.height = Math.max(1, Math.floor(rect.height * dpr));
        canvas.style.width = rect.width + 'px';
        canvas.style.height = rect.height + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }
      size();
      if ('ResizeObserver' in window) new ResizeObserver(size).observe(root);
      else window.addEventListener('resize', size);

      // Palettes
      const palettes = {
        aurora: ['#7dd3fc','#a78bfa','#f472b6','#f59e0b'],
        citrus: ['#f59e0b','#f97316','#84cc16','#22c55e'],
        lagoon: ['#22d3ee','#34d399','#14b8a6','#0ea5e9'],
        orchid: ['#c084fc','#e879f9','#60a5fa','#8b5cf6'],
        monet:  ['#60a5fa','#93c5fd','#fca5a5','#fde68a']
      };
      let paletteKey = 'aurora';
      function applyPalette(key){
        const pal = palettes[key] || palettes.aurora;
        root.style.setProperty('--c1', pal[0]);
        root.style.setProperty('--c2', pal[1]);
        root.style.setProperty('--c3', pal[2]);
        root.style.setProperty('--c4', pal[3]);
      }
      root.querySelectorAll('.sw').forEach(sw => {
        sw.addEventListener('click', () => {
          paletteKey = sw.getAttribute('data-palette') || 'aurora';
          applyPalette(paletteKey);
          softClear();
        });
      });

      // Field
      const state = {
        running: !reduce,
        mode: 'weave',
        t: 0,
        center: { x: 0.5, y: 0.5, tx: 0.5, ty: 0.5 },
        particles: [],
        count: 1200,
        burst: 0,
        lastFps: 0
      };

      // Particles
      function resetParticles(){
        const { width, height } = canvas;
        state.particles.length = 0;
        for (let i=0; i<state.count; i++){
          state.particles.push({
            x: Math.random()*width,
            y: Math.random()*height,
            px: null, py: null,
            hue: i / state.count
          });
        }
      }
      resetParticles();

      function getColors(){
        const cs = getComputedStyle(root);
        return [
          cs.getPropertyValue('--c1').trim(),
          cs.getPropertyValue('--c2').trim(),
          cs.getPropertyValue('--c3').trim(),
          cs.getPropertyValue('--c4').trim()
        ];
      }

      // Utility: soft clear
      function softClear(){
        const { width, height } = canvas;
        ctx.clearRect(0,0,width,height);
      }

      // Modes’ vector fields
      function fieldWeave(x, y, t, cx, cy){
        const s = 0.0009;
        const dx = x - cx, dy = y - cy;
        const r = Math.hypot(dx, dy) + 1;
        const a = Math.sin(y*s*6 + t*0.0015) + Math.cos(x*s*5 - t*0.0012);
        const vx = (-dy/r) * 0.6 + Math.sin(a) * 0.8;
        const vy = ( dx/r) * 0.6 + Math.cos(a) * 0.8;
        return [vx, vy];
      }
      function fieldRipple(x, y, t, cx, cy){
        const dx = x - cx, dy = y - cy;
        const r = Math.max(8, Math.hypot(dx, dy));
        const wave = Math.sin(r*0.05 - t*0.02) * 1.2;
        return [dx/r * wave, dy/r * wave];
      }
      function fieldBloom(x, y, t, cx, cy){
        const dx = x - cx, dy = y - cy;
        const r = Math.hypot(dx, dy) + 1;
        const ang = Math.atan2(dy, dx);
        const petals = 6;
        const rose = Math.sin(petals*ang + t*0.01) * 1.6;
        const spin = 0.9;
        const vx = Math.cos(ang + Math.PI/2)*spin + (dx/r)*rose*0.4;
        const vy = Math.sin(ang + Math.PI/2)*spin + (dy/r)*rose*0.4;
        return [vx, vy];
      }

      // Draw
      let raf, lastTS = 0, frames = 0, fpsTime = 0;
      function draw(ts){
        if (!canvas.width || !canvas.height) return;
        if (!state.running){ return; }

        // FPS
        const dt = ts - lastTS; lastTS = ts;
        frames++; fpsTime += dt;
        if (fpsTime > 500){
          const fps = Math.round((frames / fpsTime) * 1000);
          state.lastFps = fps;
          if (fpsEl) fpsEl.textContent = String(fps);
          frames = 0; fpsTime = 0;
        }

        state.t = ts;

        // ease center
        state.center.x += (state.center.tx - state.center.x) * 0.08;
        state.center.y += (state.center.ty - state.center.y) * 0.08;

        const { width, height } = canvas;
        // Trails
        ctx.fillStyle = (root.dataset.theme === 'day') ? 'rgba(247,250,252,.06)' : 'rgba(7,11,18,.08)';
        ctx.fillRect(0,0,width,height);

        // Composite
        ctx.globalCompositeOperation = 'lighter';

        const cx = width * state.center.x;
        const cy = height * state.center.y;

        const colors = getColors();
        const colCount = colors.length;

        // Field selector
        const field = state.mode === 'weave' ? fieldWeave : (state.mode === 'ripple' ? fieldRipple : fieldBloom);

        for (let i=0; i<state.particles.length; i++){
          const p = state.particles[i];
          const [vx, vy] = field(p.x, p.y, state.t, cx, cy);
          const speed = 0.9 + (i % 7) * 0.04;
          p.x += vx * speed;
          p.y += vy * speed;

          // wrap
          if (p.x < -2) p.x = width + 2;
          if (p.x > width + 2) p.x = -2;
          if (p.y < -2) p.y = height + 2;
          if (p.y > height + 2) p.y = -2;

          // draw segment
          if (p.px != null){
            const ci = Math.floor((p.hue * colCount + i*0.003) % colCount);
            ctx.strokeStyle = colors[ci] + 'AA';
            ctx.lineWidth = 1.1;
            ctx.beginPath();
            ctx.moveTo(p.px, p.py);
            ctx.lineTo(p.x, p.y);
            ctx.stroke();

            // sparkle
            if ((i + Math.floor(state.t*0.02)) % 240 === 0){
              ctx.beginPath();
              ctx.arc(p.x, p.y, 1.5, 0, Math.PI*2);
              ctx.fillStyle = colors[(ci+1)%colCount];
              ctx.fill();
            }
          }
          p.px = p.x; p.py = p.y;
        }

        ctx.globalCompositeOperation = 'source-over';

        raf = requestAnimationFrame(draw);
      }
      if (state.running && !reduce) raf = requestAnimationFrame(draw);
      else {
        // still render a static frame
        softClear();
      }

      // Theme toggle
      function setTheme(next){
        root.dataset.theme = next;
        const pressed = next === 'day';
        themeBtn.setAttribute('aria-pressed', String(pressed));
        themeLabel.textContent = pressed ? 'Day' : 'Night';
        if (reduce){ softClear(); }
      }
      themeBtn.addEventListener('click', () => {
        setTheme(root.dataset.theme === 'night' ? 'day' : 'night');
      });

      // Play/Pause
      function setRunning(run){
        state.running = run && !reduce;
        playBtn.setAttribute('aria-pressed', String(run));
        playBtn.textContent = run ? 'Pause' : 'Play';
        if (state.running && !raf) raf = requestAnimationFrame(draw);
      }
      playBtn.addEventListener('click', () => {
        setRunning(!state.running);
      });

      // Modes
      function setMode(m){
        state.mode = m;
        modeBtns.forEach(b => {
          const on = b.getAttribute('data-mode') === m;
          b.setAttribute('aria-selected', String(on));
          b.setAttribute('aria-pressed', String(on));
        });
        softClear();
      }
      modeBtns.forEach(b => b.addEventListener('click', () => setMode(b.getAttribute('data-mode'))));

      // Pointer interactions
      function applyTargetFromPointer(x, y, intense){
        const r = root.getBoundingClientRect();
        const nx = x / r.width, ny = y / r.height;
        const lerp = intense ? 0.18 : 0.10;
        state.center.tx = 0.5 + (nx - 0.5) * lerp * 5;
        state.center.ty = 0.5 + (ny - 0.5) * lerp * 5;
      }
      root.addEventListener('pointermove', (e) => {
        const r = root.getBoundingClientRect();
        const x = e.clientX - r.left;
        const y = e.clientY - r.top;
        root.style.setProperty('--mx', x + 'px');
        root.style.setProperty('--my', y + 'px');
        applyTargetFromPointer(x, y, e.shiftKey);
      });
      root.addEventListener('pointerleave', () => {
        state.center.tx = 0.5; state.center.ty = 0.5;
      });
      canvas.addEventListener('click', (e) => {
        // mini burst: randomize previous points for a starry pulse
        for (let i=0; i<state.particles.length; i+=4){
          const p = state.particles[i];
          p.px = null; p.py = null;
        }
      });

      // Keyboard
      root.addEventListener('keydown', (e) => {
        const k = e.key.toLowerCase();
        if (k === 't') setTheme(root.dataset.theme === 'night' ? 'day' : 'night');
        if (k === ' ') { e.preventDefault(); setRunning(!state.running); }
        if (k === '1') setMode('weave');
        if (k === '2') setMode('ripple');
        if (k === '3') setMode('bloom');
        if (k === 'c') softClear();
        if (k === 'p') {
          const keys = Object.keys(palettes);
          const i = (keys.indexOf(paletteKey) + 1) % keys.length;
          paletteKey = keys[i]; applyPalette(paletteKey); softClear();
        }
      });

      // Counters
      root.querySelectorAll('.count').forEach(el => {
        const base = Number(el.dataset.base || '0');
        let delta = 0;
        if (!reduce) {
          setInterval(() => {
            delta = (delta + 1) % 9;
            el.textContent = (base + delta).toString();
          }, 1200 + Math.random()*600);
        } else {
          el.textContent = String(base);
        }
      });

      // Initial palette
      applyPalette(paletteKey);
    })();
  </script>
</div>
      </section>
      <!-- END_EDITABLE -->
    <script>
      // Only show a local placeholder if the agent hasn't written a timestamp yet
      const el = document.getElementById('last-updated');
      if (el && (!el.textContent || el.textContent.includes('not yet'))) {
        const now = new Date();
        el.textContent = `Last updated: ${now.toLocaleString(undefined, { hour12: false })}`;
      }
    </script>
  </body>
  </html>


